[{"path":"index.html","id":"about","chapter":"1 About","heading":"1 About","text":"","code":""},{"path":"index.html","id":"background","chapter":"1 About","heading":"1.1 Background","text":"common practice managing powdery mildew mungbean couple fungicide insecticide spray early development crop, usually disease detected. despite current recommendations best yield protection achieved fungicide first applied first sign disease. recommendations based individual studies, many lacked sufficient power draw significant conclusions. undertook meta-analysis determine, first fungicide spray applied mungbean maximise yield protection.","code":""},{"path":"index.html","id":"compendium-contents","chapter":"1 About","heading":"1.2 Compendium contents","text":"research compendium details importing summarising raw data, application selection criteria, defining moderator variables fungicide spray timing, statistical analysis methods meta-analysis fungicide efficacy trials controlling powdery mildew mungbean.\nmeta-analysis’s main aim determine:optimum time spray fungicide limit effect powdery mildew mungbean yields?completeness also evaluated efficacy spray schedules disease severity field.","code":""},{"path":"index.html","id":"main-chapters","chapter":"1 About","heading":"1.3 Main chapters","text":"compendium broken four sections:Details experiments, application inclusion criteria analysisPreliminary data explorationincluding summary cleaned trial data treatmentsGrain yield meta-analysisPowdery mildew severity Meta-analysisThese sections detail methods process undertook meta-analysis.","code":""},{"path":"index.html","id":"links-to-manuscript","chapter":"1 About","heading":"1.4 Links to manuscript","text":"manuscript publishing results presented compendium can found ….Preprint ………","code":""},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"trials-considered-for-inclusion-in-meta-analysis","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2 Trials considered for inclusion in meta-analysis","text":"Trials testing fungicide efficacy powdery mildew mungbean Grains Research Development Corporation (GRDC) northern grains region sourced meta-analysis.Data collected number researchers Department Agriculture Fisheries (DAF), University Southern Queensland (USQ) National Growers Association (NGA).\nlike acknowledge particular Professor Malcolm Riley’s Dr. Sue Thompson’s effort establishing coordinating early field trials 2010 2014 GRDC funding many trials included meta-analysis.","code":""},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"load-required-r-packages","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.0.1 Load required R packages","text":"","code":"\nif (!require(\"pacman\"))\n   install.packages(\"pacman\")## Loading required package: pacman\npacman::p_load(tidyverse, kableExtra, leaflet, htmltools, lubridate, here)\n\nif (!require(\"theme.usq\"))\n   remotes::install_github(\"adamhsparks/theme.usq\")## Loading required package: theme.usq\nlibrary(theme.usq)\ntheme_set(theme_usq())"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"criteria-for-inclusion-in-meta-analysis","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.1 Criteria for inclusion in meta-analysis","text":"field trial testing efficacy fungicide powdery mildew afflicted mungbean plants eastern Australia.Trial data needed include:\nFungicide active ingredients.\ndemethylase inhibitor (DMI) fungicide.\ndate powdery mildew first appeared trial.\nDisease severity end growing seasons.\nFungicide application dates.\nFungicide dose.\nCrop yield.\nTreatment means accompanying variance.\nFungicide active ingredients.demethylase inhibitor (DMI) fungicide.date powdery mildew first appeared trial.Disease severity end growing seasons.Fungicide application dates.Fungicide dose.Crop yield.Treatment means accompanying variance.","code":""},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"import-data","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.2 Import data","text":"Import data trials raw data availableImport dataset manual entriesImport dataset manually entered trial reportsBind raw transcribed datasets.","code":"\nPM_MB_raw <-\n   rbind(\n      read.csv(\n         here(\"cache/2010 PMmung Hermitage means.csv\"),\n         stringsAsFactors = FALSE\n      ),\n      read.csv(here(\"cache/2011 PMmung Herm means.csv\"), stringsAsFactors = FALSE),\n      read.csv(\n         here(\"cache/2011 PMmung Kingaroy means.csv\"),\n         stringsAsFactors = FALSE\n      ),\n      read.csv(here(\"cache/AM1305_Goolhi_means.csv\"), stringsAsFactors = FALSE),\n      read.csv(\n         here(\"cache/AM1304-MarysMount_means.csv\"),\n         stringsAsFactors = FALSE\n      ),\n      read.csv(\n         here(\"cache/AM1303-Premer-Disease_means.csv\"),\n         stringsAsFactors = FALSE\n      ),\n      read.csv(\n         here(\"cache/BB1305_Millmerran_means.csv\"),\n         stringsAsFactors = FALSE\n      ),\n      read.csv(here(\"cache/Herm_16_means.csv\"), stringsAsFactors = FALSE),\n      read.csv(here(\"cache/King_16_means.csv\"), stringsAsFactors = FALSE),\n      read.csv(here(\"cache/Fogerty_17_mean.csv\"), stringsAsFactors = FALSE),\n      read.csv(here(\"cache/Hermitage_17_mean.csv\"), stringsAsFactors = FALSE),\n      read.csv(here(\"cache/Wellcamp_18_mean.csv\"), stringsAsFactors = FALSE),\n      read.csv(here(\"cache/Hermitage_19_mean.csv\"), stringsAsFactors = FALSE)\n   )\nwrite.csv(\n   PM_MB_raw,\n   file = here(\"cache/PM_Mungbean_SummaryOfTrialsWithRawData\"),\n   row.names = FALSE\n)\nPM_MB_man <-\n   read.csv(here(\"cache/PM_Mungbean_DataManuallyEntered.csv\"),\n            stringsAsFactors = FALSE)\nPM_MB_dat <-\n   rbind(PM_MB_raw,\n         PM_MB_man)"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"summary-of-all-trials","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.3 Summary of all trials","text":"\n(#tab:data_summary)Description Experiments\n","code":"\nPM_MB_dat %>%\n   arrange(year, location) %>%\n   group_by(trial_ref) %>%\n   summarise(\n      Year = unique(year),\n      Location = unique(location),\n      `Replicates per treatment` = if (all(replicates[1] == replicates)) {\n         as.character(replicates[1])\n      } else{\n         as.character(paste(min(replicates), \"-\", max(replicates)))\n      },\n      `Trial design` = unique(trial_design),\n      `Planting date` = unique(planting_date),\n      `First sign of disease` = unique(first_sign_disease),\n      `Fungicide treatments` = length(n_treatment),\n   ) %>%\n   arrange(Year) %>%\n   kable(\n      caption = \"Description of Experiments\",\n      align = \"c\",\n      col.names = c(\n         \"Unique Trial\\nReference\",\n         \"Year\",\n         \"Location\",\n         \"Replicates\\nper treatments\",\n         \"Trial design\",\n         \"Planting date\",\n         \"First sign\\nof disease\",\n         \"Fungicide\\n treatments\"\n      )\n   )  %>%\n   kable_styling(fixed_thead = TRUE, full_width = TRUE) %>%\n   column_spec(c(3, 5:6), width = \"3cm\") %>%\n   scroll_box(height = \"500px\") "},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"experiment-locations","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.3.1 Experiment locations","text":"Trial locations occurring GRDC Northern Grains Region.","code":""},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"subset-data-to-selection-criteria","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.4 Subset data to selection criteria","text":"Let’s apply selection criteria dataset.\ntrials identified meta-analysis reported:fungicide active ingredient,dose,first sign disease.Therefore trials need removed satisfy criteria.Retain trials including: Yield\nThree trials omitted due reporting yieldsRetain trials including: Disease severity\nOne trial removed report disease severity.Retain trials including: fungicide application dates\ntrials subset need removed reporting fungicide application dates.Retain trials including: fungicide dose\ntrials subset need removed reporting fungicide dose.Exclude fungicides tested trials\nmeta-analysis focused fungicides mode action.\nFungicides best represented group retained.demethylation inhibitors (DMI), tebuconazole propiconazole, used highest frequencies.\nDMIs fungicide mode action good candidates pooled meta-analysis.Amistar Xtra Custodia contain strobilurin triazole, however, contain differing dose ratios (inverted) pooling may appropriate therefore removed.Retain fungicides DMI actionNow remove non-DMI treatments controls","code":"\nPM_MB_dat %>%\n   filter(is.na(grain_yield.t.ha.)) %>%\n   distinct(trial_ref, year, location)##     trial_ref year  location\n## 1 mung0102/01 2002 Bongeen_2\n## 2 mung0102/02 2002 Hermitage\n## 3 mung0102/03 2002 Hermitage\nPM_MB_dat <- PM_MB_dat %>%\n   filter(!is.na(grain_yield.t.ha.))\nPM_MB_dat %>%\n   filter(is.na(PM_final_severity)) %>%\n   distinct(trial_ref, year, location)##     trial_ref year location\n## 1 mung1415/02 2015    Dalby\nPM_MB_dat <- PM_MB_dat %>%\n   filter(!is.na(PM_final_severity))\nPM_MB_dat %>%\n   group_by(trial_ref) %>%\n   summarise(No_Record_Of_Fungicide_Application_Dates = all(is.na(fungicide_application_1)),\n             .groups = 'drop') %>%\n   filter(No_Record_Of_Fungicide_Application_Dates)## # A tibble: 0 x 2\n## # … with 2 variables: trial_ref <chr>,\n## #   No_Record_Of_Fungicide_Application_Dates <lgl>\nPM_MB_dat %>%\n   group_by(trial_ref) %>%\n   summarise(No_Record_Of_Fungicide_Dose = all(is.na(dose_ai.ha)),\n             .groups = 'drop') %>%\n   filter(No_Record_Of_Fungicide_Dose)## # A tibble: 0 x 2\n## # … with 2 variables: trial_ref <chr>, No_Record_Of_Fungicide_Dose <lgl>\nPM_MB_dat %>%\n   group_by(fungicide_ai, trial_ref) %>%\n   summarise() %>%\n   count(sort = TRUE) %>%\n   rename(Trials = n) %>%\n   ggplot(aes(x = reorder(fungicide_ai, Trials), y = Trials)) +\n   xlab(\"Fungicide active ingredient\") +\n   ylab(\"N Trials\") +\n   geom_col() +\n   scale_fill_usq() +\n   ggtitle(label = \"Number of trials in which the\\nspecified fungicide was used\") +\n   scale_colour_usq() +\n   coord_flip()## `summarise()` has grouped output by 'fungicide_ai'. You can override using the `.groups` argument.\nDMI_Trials <-\n   PM_MB_dat %>%\n   filter(fungicide_ai == \"tebuconazole\" |\n             fungicide_ai == \"propiconazole\") %>%\n   distinct(trial_ref) %>%\n   pull()\n\nPM_MB_dat <-\n   PM_MB_dat[PM_MB_dat$trial_ref %in% DMI_Trials, ]\nPM_MB_dat <-\n   PM_MB_dat %>%\n   filter(\n      fungicide_ai == \"control\" |\n         fungicide_ai == \"tebuconazole\" |\n         fungicide_ai == \"propiconazole\"\n   )"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"classify-dataset-variables","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.4.1 Classify dataset variables","text":"Importantly, class variable data defined, retaining variables relevant analysis.","code":"\nsource(\"R/classify_PM_data.R\") # use a custom code\n\n# classify dataset with Trials in both \nPM_MB_dat <-\n   classify_PM_data(PM_MB_dat)"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"defining-spray-schedule-variable","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.5 Defining spray schedule variable","text":"First going calculate time first sign disease fungicide applications.ensure sufficient number replicates, treatments binned first fungicide application date three categorical variables relating first fungicide application made, relative first sign disease.categorical variables named:\n- Early: First fungicide application prior first sign disease.\n- Recommended: First fungicide application applied day powdery mildew observed, within three days first sign.\n- Late: First fungicide application four days first sign disease observed.number follow-sprays need also defined.Simplify clusters data-setNow view number break-spray_management treatments yield disease severity data-sets‘Early_plus’ treatments number, treatments comparisons treatments meta-analysis provide accurate results. Therefore remove ‘Early_plus’ analysis.","code":"\n# collective data\nPM_MB_dat %<>%\n   mutate(fungicide_timing_1 = fungicide_application_1 - first_sign_disease) %>%\n   mutate(fungicide_timing_2 = fungicide_application_2 - fungicide_application_1) %>%\n   mutate(fungicide_timing_3 = fungicide_application_3 - fungicide_application_2)\ndata.frame(\n   TreatmentName = c(\n      \"Early\",\n      \"Recommended\",\n      \"Late\",\n      \"EarlyPlus\",\n      \"RecommendedPlus\",\n      \"LatePlus\"\n   ),\n   n_sprays = rep(c(\"Single\", \"Two - Three\"), each = 3),\n   DaysRelativeToFirstSign = c(\n      \"Prior to first sign of Powdery Mildew\",\n      \"1 - 3 days after first sign of Powdery Mildew\",\n      \"7 - 8 days after first sign of Powdery Mildew\"\n   )\n) %>%\n   kable()\nPM_MB_dat <- PM_MB_dat %>%\n   mutate(\n      spray_management = case_when(\n         fungicide_timing_1 < 0 &\n            is.na(fungicide_application_2) &\n            is.na(fungicide_application_3) ~ \"Early\",\n         fungicide_timing_1 >= 0 &\n            fungicide_timing_1 < 4 &\n            is.na(fungicide_application_2) &\n            is.na(fungicide_application_3) ~ \"Recommended\",\n         fungicide_timing_1 >= 4 &\n            is.na(fungicide_application_2) &\n            is.na(fungicide_application_3) ~ \"Late\",\n         fungicide_timing_1 < 0 &\n            !is.na(fungicide_application_2) ~ \"Early_plus\",\n         fungicide_timing_1 >= 0 &\n            fungicide_timing_1 < 4 &\n            !is.na(fungicide_application_2) ~ \"Recommended_plus\",\n         fungicide_timing_1 >= 4 &\n            !is.na(fungicide_application_2) ~ \"Late_plus\",\n         TRUE ~ \"Other\"\n      )\n   )\n\nPM_MB_dat[PM_MB_dat$fungicide_ai == \"control\",\n          c(\n             \"fungicide_timing_1\",\n             \"fungicide_timing_2\",\n             \"fungicide_timing_3\",\n             \"spray_management\"\n          )] <- \"control\"\ntable(PM_MB_dat$spray_management)## \n##          control            Early       Early_plus             Late \n##               40               13                5               17 \n##        Late_plus      Recommended Recommended_plus \n##               20               32               46\nPM_MB_dat <-\n   PM_MB_dat %>%\n   filter(spray_management != \"Early_plus\") %>%\n   select(-c(fungicide_timing_1, # remove the following columns which no longer have use\n             fungicide_timing_2,\n             fungicide_timing_3,\n             fungicide_application_1,\n             fungicide_application_2,\n             fungicide_application_3,\n             fungicide_application_4,\n             fungicide_application_5,\n             fungicide_application_6,\n             fungicide_application_7,\n             ))"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"identify-variance","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.6 Identify variance","text":"need variance accompanying mean observations treatment successfully undertake meta-analysis.\nLets investigate included trials included variance response variables interest, yield disease severity.Remove one trial Emerald report disease variance yield variance.Following inspection yield disease variance determined imputation suitable therefore must exclude trials report variance.\nanalysis, yield disease severity separate data-set created, including trials report variance respective response variableOne trial removed yield data set PM_dat_Y reporting yield variance.Two trials removed disease severity data set PM_dat_D reporting yield variance.","code":"\nPM_MB_dat %>%\n   mutate(MA_analysis = case_when(\n      is.na(yield_error & disease_error) == FALSE ~ \"Yield and Disease\",\n      is.na(yield_error) == FALSE & \n         is.na(disease_error) ~ \"Yield\",\n      is.na(disease_error) == FALSE & \n         is.na(yield_error) ~ \"Disease\",\n      TRUE ~ \"Nil\"\n   )) %>%\n   distinct(trial_ref, location, year, MA_analysis) %>%\n   arrange(year) %>%\n   kable()\n# Remove trials without variance for both Disease and yield for data_set `PM_MB_dat\nPM_MB_dat <- \n   PM_MB_dat %>%\n   mutate(contains_var = case_when(\n      is.na(yield_error) &\n         is.na(disease_error) ~ NA_character_,\n      TRUE ~ trial_ref)) %>%\n   filter(trial_ref %in% contains_var) %>%\n   select(-contains_var) \nPM_MB_dat %>%\n   mutate(No_Var = is.na(yield_error)) %>%\n   filter(No_Var == TRUE) %>%\n   distinct(trial_ref, year, location)##     trial_ref year location\n## 1 mung1112/01 2012   Gatton\nPM_dat_Y <- \n   PM_MB_dat %>%\n   mutate(contains_var = case_when(\n      is.na(yield_error) ~ NA_character_,\n      TRUE ~ trial_ref)) %>%\n   filter(trial_ref %in% contains_var) %>%\n   select(-contains_var)\nPM_MB_dat %>%\n   mutate(No_Var = is.na(disease_error)) %>%\n   filter(No_Var == TRUE) %>%\n   distinct(trial_ref, year, location)##     trial_ref year  location\n## 1 mung1516/01 2016 Hermitage\n## 2 mung1516/02 2016  Kingaroy\nPM_dat_D <- \n   PM_MB_dat %>%\n   mutate(contains_var = case_when(\n      is.na(disease_error) ~ NA_character_,\n      TRUE ~ trial_ref)) %>%\n   filter(trial_ref %in% contains_var) %>%\n   select(-contains_var)"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"standardise-variance","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.7 Standardise Variance","text":"variance types need converted sample variance.\nFirst start standardising yield variance according method reported Ngugi et.al (2011).","code":""},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"yield-variance-standardisation","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.7.1 Yield variance standardisation","text":"","code":"\nPM_dat_Y <-\n   PM_dat_Y %>%\n   mutate(\n      vi =\n         case_when(\n            Y_error_type == \"stdev\" ~ yield_error ^ 2,\n            Y_error_type == \"lsd (P=0.05)\" ~\n               (replicates * ((yield_error / 1.96) ^ 2) / 2)\n         ),\n      id = row_number(),\n      spray_management = fct_relevel(spray_management, sort)\n   ) %>%\n   select(-c(yield_error,\n             Y_error_type))"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"disease-severity-variance-standardisation","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.7.2 Disease severity variance standardisation","text":"","code":"\nPM_dat_D <-\n   PM_dat_D %>%\n   mutate(\n      vi =\n         case_when(\n            D_error_type == \"stdev\" ~ disease_error ^ 2,\n            D_error_type == \"lsd (P=0.05)\" ~\n               (replicates * ((disease_error / 1.96) ^ 2) / 2)\n         ),\n      id = row_number(),\n      spray_management = fct_relevel(spray_management, sort)\n   ) %>%\n   select(-c(disease_error,\n             D_error_type))"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"save-the-cleaned-data","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.7.2.1 Save the cleaned data","text":"","code":"\nwrite.csv(PM_dat_Y, file = \"cache/PM_yield_clean_data.csv\", row.names = FALSE)\nwrite.csv(PM_dat_D, file = \"cache/PM_disease_clean_data.csv\", row.names = FALSE)\nwrite.csv(PM_MB_dat, file = \"cache/PM_MB_clean_data.csv\", row.names = FALSE)\nsave(PM_MB_dat, PM_dat_D, PM_dat_Y, file = here(\"cache/ImportDataAndSelectTrials01.Rdata\"))"},{"path":"preliminary-analysis.html","id":"preliminary-analysis","chapter":"3 Preliminary Analysis","heading":"3 Preliminary Analysis","text":"","code":"\nif (!require(\"pacman\"))\n   install.packages(\"pacman\")\npacman::p_load(tidyverse,\n               lubridate,\n               bomrang,\n               openxlsx,\n               devtools,\n               reshape2,\n               lme4,\n               kableExtra,\n               flextable,\n               here,\n               gridExtra)\n\nif (!require(\"theme.usq\"))\n   remotes::install_github(\"adamhsparks/theme.usq\")\nlibrary(theme.usq)\ntheme_set(theme_usq()\n)\nload(\"cache/ImportDataAndSelectTrials01.Rdata\")"},{"path":"preliminary-analysis.html","id":"trial-summary-statistics","chapter":"3 Preliminary Analysis","heading":"3.1 Trial summary statistics","text":"data explored PM_MB_dat data frame clean data frame focusing trials met selection criteria testing DMI fungicides (tebuconazole / propiconazole) spray controls.","code":""},{"path":"preliminary-analysis.html","id":"trial-seasons","chapter":"3 Preliminary Analysis","heading":"3.1.1 Trial seasons","text":"many trials undertaken season.yearn2011220122201342015120162201722018120192","code":"\nPM_MB_dat %>%\n   distinct(trial_ref, location, year) %>%\n   arrange(year) %>%\n   group_by(year) %>%\n   summarise(n = n())%>%\n   flextable()"},{"path":"preliminary-analysis.html","id":"trial-locations","chapter":"3 Preliminary Analysis","heading":"3.1.2 Trial locations","text":"location trials including DMI fungicides.locationnGatton1Goolhi1Hermitage6Kingaroy3Marys Mount1Millmerran1Missen Flats1Premer1Wellcamp1","code":"\nPM_MB_dat %>%\n   distinct(trial_ref, location, year) %>%\n   group_by(location) %>%\n   summarise(n = n())%>%\n   flextable()"},{"path":"preliminary-analysis.html","id":"powdery-mildew-severity-and-mungbean-grain-yield-summary-per-trial","chapter":"3 Preliminary Analysis","heading":"3.1.3 Powdery mildew severity and mungbean grain yield summary per trial","text":"Show summary powdery mildew severity mungbean grain yield means ranges trials including DMI fungicides.\n(#tab:Full_Trial_Summary_table)Table 1: Mean yield severity trials included meta-analysis. Powdery mildew (PM) onset date, number treatments per trial (n), PM median plot severity non-fungicide treated plots severity range fungicide treatments, bracketed numbers refer number pooled control treatments summarised; Mean yield non-fungicide treated control range yields fungicide treatments tonnes per hectare\nTrial codeLocationYearSowing datePM onsetnControl medianPM severityPM severityrangeControlmean yieldYield range(t / ha)1011/01Hermitage20112011-01-242011-03-2844.83 (2)2 - 2.331.5251.544 - 1.7691011/02Kingaroy20112011-02-022011-03-2267.83 (2)3.33 - 5.330.7980.73 - 1.0591112/01Gatton20122012-02-202012-04-0277.5 (1)2 - 6.30.7380.81 - 0.9481112/02Kingaroy20122012-02-032012-03-1278 (1)1.7 - 80.7511.036 - 1.323AM1303Premer20132012-12-282013-02-2848 (1)2 - 7.831.4221.334 - 1.45AM1304Marys Mount20132012-12-242013-03-1623 (1)3.17 - 3.171.0941.265 - 1.265AM1305Goolhi20132013-01-232013-03-2547 (1)1 - 3.750.6940.604 - 0.722BB1305Millmerran20132013-01-122013-03-1348 (1)1.62 - 80.8020.744 - 0.8031415/01Hermitage20152015-01-192015-03-1657.8 (1)5.4 - 6.62.0452.018 - 2.1761516/01Hermitage20162016-02-032016-03-0878 (1)3 - 7.51.8032.141 - 2.371516/02Kingaroy20162016-02-112016-03-0978.25 (1)2.25 - 7.750.8110.873 - 1.0341617/01Hermitage20172017-02-132017-03-24398 (9)5.33 - 80.4760.327 - 0.6831617/02Missen Flats20172017-01-272017-03-07399 (9)7.67 - 91.5611.13 - 2.5261718/01Wellcamp20182018-02-132018-03-21188.17 (6)5.67 - 7.671.1941.084 - 1.691819/01Hermitage20192018-02-042018-04-1247.5 (1)5 - 7.170.5870.543 - 0.5711819/02Hermitage20192018-02-182018-04-1247.83 (1)4.6 - 7.330.2890.276 - 0.312","code":"\nSev_yield_table <-\n   PM_MB_dat %>%\n   mutate(PM_sev_control = case_when(fungicide_ai == \"control\" ~ PM_final_severity,\n                                     TRUE ~ NA_real_)) %>%\n   mutate(PM_sev_treat = case_when(fungicide_ai != \"control\" ~ PM_final_severity,\n                                   TRUE ~ NA_real_)) %>%\n   mutate(PM_y_control = case_when(fungicide_ai == \"control\" ~ grain_yield.t.ha.,\n                                   TRUE ~ NA_real_)) %>%\n   mutate(PM_y_treat = case_when(fungicide_ai != \"control\" ~ grain_yield.t.ha.,\n                                 TRUE ~ NA_real_)) %>%\n   mutate(trial_ref = str_remove(trial_ref, \"mung\")) %>%  # remove \"mung\" prefix from trial_ref\n   group_by(trial_ref,\n            location,\n            year,\n            planting_date,\n            first_sign_disease) %>%\n   summarise(\n      n = n(),\n      m_PM_sev_control = round(median(PM_sev_control, na.rm = TRUE), digits = 2),\n      n_controls = sum(is.na(PM_sev_control) == FALSE),\n      min_PM_sev = round(min(PM_sev_treat, na.rm = TRUE), digits = 2),\n      max_PM_sev = round(max(PM_sev_treat, na.rm = TRUE), digits = 2),\n      m_PM_yield_control = round(mean(PM_y_control, na.rm = TRUE), digits = 3),\n      min_PM_yield = round(min(PM_y_treat, na.rm = TRUE), digits = 3),\n      max_PM_yield = round(max(PM_y_treat, na.rm = TRUE), digits = 3),\n      .groups = \"drop\"\n   ) %>%\n   arrange(year) %>%\n   mutate(PM_sev_range = paste(min_PM_sev, max_PM_sev, sep = \" - \")) %>%\n   mutate(yield_range = paste(min_PM_yield, max_PM_yield, sep = \" - \")) %>%\n   mutate(m_PM_sev_control = paste(m_PM_sev_control, \" (\", n_controls, \")\", sep = \"\")) %>%\n   select(-c(min_PM_sev, max_PM_sev, min_PM_yield, max_PM_yield, n_controls)) %>%\n   select(c(1:7, 9, 8, 10)) %>% # order columns\n   flextable() %>%\n   set_header_labels(\n      trial_ref = \"Trial code\",\n      location = \"Location\",\n      year = \"Year\",\n      planting_date = \"Sowing date\",\n      first_sign_disease = \"PM onset\",\n      n = \"n\",\n      m_PM_sev_control = \"Control median\\nPM severity\",\n      PM_sev_range = \"PM severity\\nrange\",\n      m_PM_yield_control = \"Control\\nmean yield\",\n      yield_range = \"Yield range\\n(t / ha)\"\n   ) %>%\n   fontsize(size = 8, part = \"body\") %>%\n   fontsize(size = 10, part = \"header\") %>%\n   align(j = 3:10, align = \"center\", part = \"all\") %>%\n   autofit() %>%\n   width(j = 7:10, width = 1) %>%\n   width(j = 3, width = 0.5) %>%\n   set_caption(\n      \"Table 1: Mean yield and severity for trials included in the meta-analysis. Powdery mildew (PM) onset date, number of treatments per trial (n), PM median plot severity of the non-fungicide treated plots and the severity range in fungicide treatments, bracketed numbers refer to the number of pooled control treatments summarised; Mean yield in non-fungicide treated control and the range of yields in the fungicide treatments in tonnes per hectare\"\n   )\nSev_yield_table"},{"path":"preliminary-analysis.html","id":"summary-plots","chapter":"3 Preliminary Analysis","heading":"3.1.4 Summary plots","text":"","code":""},{"path":"preliminary-analysis.html","id":"seasonal-disease-pressure-in-the-control","chapter":"3 Preliminary Analysis","heading":"3.1.4.1 Seasonal disease pressure in the control","text":"","code":"\nsev_control_plot <- \n   PM_MB_dat %>%\n   filter(fungicide_ai == \"control\") %>%\n   ggplot(aes(x = year, y = PM_final_severity)) +\n   geom_boxplot(outlier.alpha = 0) +\n   geom_jitter(size = 2, colour = \"cadetblue\",alpha = 0.4,width = 0.15) +\n   scale_y_continuous(breaks = c(1,3,5,7,9), limits = c(0.9,9.1)) +\n   ylab(\"PM severity (1 -9)\")+\n   # xlab(\"Crop season\")+\n   # theme(axis.title.x=element_blank(),\n   #      axis.text.x=element_blank(),\n   #      axis.ticks.x=element_blank())+\n   ggtitle(\"A\")\n\nsev_control_plot      "},{"path":"preliminary-analysis.html","id":"disease-severity-range-for-each-spray-schedule","chapter":"3 Preliminary Analysis","heading":"3.1.4.2 Disease severity range for each spray schedule","text":"","code":"\nsev_schedule_plot <-\n   PM_MB_dat %>%\n   ggplot(aes(x = spray_management, y = PM_final_severity)) +\n   geom_boxplot(outlier.alpha = 0) +\n   geom_jitter(\n      size = 2,\n      colour = \"cadetblue\",\n      alpha = 0.4,\n      width = 0.15\n   ) +\n   scale_y_continuous(breaks = c(1, 3, 5, 7, 9), limits = c(0.9, 9.1)) +\n   scale_x_discrete(labels = c(\n      \"control\",\n      \"early\",\n      \"late\",\n      \"late+\",\n      \"recommended\",\n      \"recomended+\"\n   )) +\n   ylab(\"PM severity (1 -9)\") +\n   # xlab(\"Spray Schedule\")+\n   ggtitle(\"B\")\n   \nsev_schedule_plot"},{"path":"preliminary-analysis.html","id":"seasonal-grain-yield-in-the-control","chapter":"3 Preliminary Analysis","heading":"3.1.4.3 Seasonal grain yield in the control","text":"","code":"\nY_control_plot <-\n   PM_MB_dat %>%\n   filter(fungicide_ai == \"control\") %>%\n   ggplot(aes(x = year, y = grain_yield.t.ha.)) +\n   geom_boxplot() +\n   geom_jitter(\n      size = 2,\n      colour = \"coral\",\n      alpha = 0.4,\n      width = 0.15\n   ) +\n   scale_y_continuous(breaks = seq(0, 2.5, by = 0.5), limits = c(0, 2.6)) +\n   ylab(bquote('Mungbean grain yield ' *  ~  ~ t ~ ha ^ -1 * \"\")) +\n   xlab(\"Crop season\") +\n   theme(axis.text.x = element_text(angle = 20, hjust = 0.75),\n         plot.margin = margin(0.2, 0, 0.71, 0, \"cm\"),\n         axis.title.x = element_text(vjust = -5))\n\nY_control_plot"},{"path":"preliminary-analysis.html","id":"mungbean-yield-for-each-spray-schedule","chapter":"3 Preliminary Analysis","heading":"3.1.4.4 Mungbean yield for each spray schedule","text":"Box plots unsprayed control treatments means PM severity (top) crop yield (bottom), indicating within-season variation (), trial treatment means spray schedule (B).","code":"\nY_schedule_plot <- \n   PM_MB_dat %>%\n   ggplot(aes(x = spray_management, y = grain_yield.t.ha.)) +\n   geom_boxplot(outlier.alpha = 0) +\n   geom_jitter(\n      size = 2,\n      colour = \"coral\",\n      alpha = 0.4,\n      width = 0.15\n   ) +\n   scale_y_continuous(breaks = seq(0, 2.5, by = 0.5), limits = c(0, 2.6)) +\n   scale_x_discrete(labels = c(\n      \"control\",\n      \"early\",\n      \"late\",\n      \"late+\",\n      \"recommended\",\n      \"recomended+\"\n   )) +\n   #ylab(bquote('Mungbean grain yield ' *  ~  ~ t ~ ha ^ -1 * \"\")) +\n   xlab(\"Spray Schedule\")+\n    theme(\n      axis.title.y = element_blank(),\n      axis.text.x = element_text(angle = 20, hjust = 0.75))\n\nY_schedule_plot"},{"path":"preliminary-analysis.html","id":"treatment-focused-summaries","chapter":"3 Preliminary Analysis","heading":"3.2 Treatment focused summaries","text":"Various factors studied collated trials may influence subsequent meta-analysis.\nquick inspection following factors done examine possible influence variables may mungbean grain yield /powdery mildew mean plot severity.Fungicide type (propiconazole tebuconazole)Fungicide DosesNumber fungicide spraysHost cultivar (probably co-variate season due changing cultivars time)Row spacingFinal disease rating / disease pressureMoisture availability cropThe data plotted 16 field trials (2011 - 2019) details described Trials considered inclusion meta-analysis.","code":""},{"path":"preliminary-analysis.html","id":"fungicide-type","chapter":"3 Preliminary Analysis","heading":"3.2.1 Fungicide type","text":"","code":""},{"path":"preliminary-analysis.html","id":"powdery-mildew-severity","chapter":"3 Preliminary Analysis","heading":"3.2.1.1 Powdery mildew severity","text":"","code":"\nn_C <- sum(PM_MB_dat$fungicide_ai == \"control\")\nn_P <- sum(PM_MB_dat$fungicide_ai == \"propiconazole\")\nn_T <- sum(PM_MB_dat$fungicide_ai == \"tebuconazole\")\n\nPM_MB_dat %>%\n   ggplot(aes(y = PM_final_severity, x = as.factor(fungicide_ai))) +\n   xlab(\"Fungicide treatment\") +\n   ggtitle(label = \"Powdery mildew severity for each fungicide active ingredient\") +\n   labs(caption = paste(\"Control n:\", n_C,\n                        \"; Propiconazole n:\", n_P,\n                        \"; Tebuconazole n:\", n_T, sep = \"\")) +\n   geom_boxplot()"},{"path":"preliminary-analysis.html","id":"yield-effect","chapter":"3 Preliminary Analysis","heading":"3.2.1.2 Yield effect","text":"","code":"\nPM_MB_dat %>%\n   ggplot(aes(y = grain_yield.t.ha., x = as.factor(fungicide_ai))) +\n   xlab(\"Fungicide treatment\") +\n   ggtitle(label = \"Grain yield for each fungicide active ingredient\") +\n   labs(caption = paste(\"Control n:\", n_C,\n                        \"; Propiconazole n:\", n_P,\n                        \"; Tebuconazole n:\", n_T, sep = \"\")) +\n   geom_boxplot()"},{"path":"preliminary-analysis.html","id":"fungicide-doses","chapter":"3 Preliminary Analysis","heading":"3.2.2 Fungicide Doses","text":"analysis focuses DMI fungicides, tebuconazole propiconazole, trialled often.check fungicide doses used roughly , compare trials dose might different.trials used tebuconazole used approximately dose.\nDose active ingredient ranged 62.35 g per hectare 60 g per hectare.Doses propiconazole range 62.5 g 125 g, large variation.\nLet’s inspect difference yields dose.dose effect investigated meta-analysis.many treatments dose investigated per trial?","code":"\nPM_MB_dat %>%\n   filter(fungicide_ai == \"tebuconazole\" |\n             fungicide_ai == \"propiconazole\") %>%\n   ggplot(aes(x = as.factor(dose_ai.ha), fill = fungicide_ai)) +\n   xlab(\"Dose (g ai/ha)\") +\n   ggtitle(label = \"Total number of treatments for each respective tebuconazole\\nor propiconazole dose\") +\n   geom_bar() +\n   scale_fill_usq() +\n   scale_colour_usq()\nPM_MB_dat %>%\n   filter(fungicide_ai == \"propiconazole\") %>%\n   ggplot(aes(x = relevel(as.factor(dose_ai.ha), \"62.5\"), y = grain_yield.t.ha.)) +\n   xlab(\"Dose (g ai/ha)\") +\n   labs(label = \"Yield for each respective propiconazole dose\",\n        caption = \"Facets indicate the number of applications\") +\n   geom_boxplot(fill = usq_cols(\"usq charcoal\"), alpha = 0.5) +\n   ylab(\"Grain yield t / ha\") +\n   facet_grid(cols = vars(total_fungicide))\ntable(as.character(PM_MB_dat[PM_MB_dat$fungicide_ai == \"propiconazole\",]$trial_ref),\n      PM_MB_dat[PM_MB_dat$fungicide_ai == \"propiconazole\",]$dose_ai.ha)##              \n##               62.5 125\n##   AM1303         3   0\n##   AM1304         1   0\n##   AM1305         3   0\n##   BB1305         3   0\n##   mung1112/01    2   2\n##   mung1112/02    2   2\n##   mung1617/01    0  15\n##   mung1617/02    0  15\n##   mung1718/01    0   6"},{"path":"preliminary-analysis.html","id":"number-of-fungicide-sprays","chapter":"3 Preliminary Analysis","heading":"3.2.3 Number of fungicide sprays","text":"Inspect frequency sprays per fungicide.treatments sprayed three times AM1305, AM1303, BB1305, mung1516/01, mung1516/02","code":"\ntable(PM_MB_dat$fungicide_ai, PM_MB_dat$total_fungicide)##                \n##                  0  1  2  3\n##   control       39  0  0  0\n##   propiconazole  0 26 25  3\n##   tebuconazole   0 34 32  2"},{"path":"preliminary-analysis.html","id":"mungbean-cultivars","chapter":"3 Preliminary Analysis","heading":"3.2.4 Mungbean cultivars","text":"Australian mungbean varieties following resistance powdery mildew.Berken: Highly susceptibleBerken: Highly susceptibleCrystal: SusceptibleCrystal: SusceptibleJade: Moderately susceptibleJade: Moderately susceptibleLet’s view stacked bar plot number sprays demethylation inhibitors, tebuconazole propiconazole cultivar.","code":"\nPM_MB_dat %>%\n   filter(fungicide_ai == \"tebuconazole\" |\n             fungicide_ai == \"propiconazole\") %>%\n   group_by(host_genotype, fungicide_ai, trial_ref) %>%\n   summarise() %>%\n   count() %>%\n   rename(Treatments = n) %>%\n   ggplot(aes(x = host_genotype, y = Treatments, fill = fungicide_ai)) +\n   xlab(\"Cultivar\") +\n   ylab(\"N Trials\") +\n   ggtitle(label = \"Cultivars used in either tebuconazole or propiconazole trials\") +\n   geom_col() +\n   scale_fill_usq(name = \"Fungicide AI\")"},{"path":"preliminary-analysis.html","id":"yield-loss-in-cultivar-jade","chapter":"3 Preliminary Analysis","heading":"3.2.4.1 Yield loss in cultivar Jade","text":"Cultivar Jade shows best quantitative resistance powdery mildew.\nBased 2016 GRDC report Sue Thompson (2016) want know possible yield loss moderately susceptible cultivar.trial_reflocationyearcontrol_yieldFungicideTreated_yieldpercentDiffmung1516/01Hermitage20161.80292.282183321.001090.4792833mung1516/02Kingaroy20160.81070.954116715.031360.1434167","code":"\nPM_MB_dat %>%\n   filter(year == \"2016\",\n          host_genotype == \"Jade\") %>%\n   mutate(Treatment = case_when(fungicide_ai == \"control\" ~ \"control_yield\",\n                                TRUE ~ \"FungicideTreated_yield\")) %>%\n   group_by(location, Treatment) %>%\n   summarise(\n      trial_ref = trial_ref,\n      location = location,\n      year = year,\n      Yield = mean(grain_yield.t.ha., na.rm = TRUE),\n      .groups = \"drop\"\n   ) %>%\n   distinct() %>%\n   pivot_wider(names_from = Treatment, values_from = Yield) %>%\n   mutate(Diff = FungicideTreated_yield - control_yield) %>%\n   mutate(percent = (Diff / FungicideTreated_yield) * 100) %>%\n   select(trial_ref,\n          location,\n          year,\n          control_yield,\n          FungicideTreated_yield,\n          percent,\n          Diff) %>%\n   flextable()"},{"path":"preliminary-analysis.html","id":"row-spacing","chapter":"3 Preliminary Analysis","heading":"3.2.5 Row spacing","text":"experiments designed investigate effect row spacing plant density powdery mildew disease well fungicide timing efficacy.\nresults showed row spacing statistically significant effect powdery mildew, narrower rows cases increased yield significantly.\nfinding also shown several researchers’ work Queensland New South Wales well.plotting row spacing treatments show differences response variables, yield disease severity.\nmain questions :statistical differences mungbean yield powdery mildew severity row spacing treatments?statistical differences mungbean yield powdery mildew severity row spacing treatments?, can pool certain row spacing significant difference?, can pool certain row spacing significant difference?little difference row spacing treatments, Let’s look trial location effect disease pressure lead varying results.Wellcamp site, wider row spacing reduces PM severity, sites seems enough variation make distinction row spacing treatments.plots seem imply yield limited, presumably abiotic factors, effect row spacing yield, like Hermitage trial.\nHowever, average yield approximately 1 t/ha smaller row spacing potential provide greater yield per hectare.Overall row spacing may influence powdery mildew severity yield.\nHowever, trial reports, significant interaction found row spacing, powdery mildew severity yield.\n, narrower row spacing appeared increase yield even amount powdery mildew increased relationship detected interaction three.","code":"\nPM_MB_dat %>%\n   filter(fungicide_ai == \"tebuconazole\" |\n             fungicide_ai == \"propiconazole\") %>%\n   group_by(fungicide_ai, row_spacing, trial_ref) %>%\n   summarise() %>%\n   count() %>%\n   rename(Trials = n) %>%\n   ggplot(aes(x = as.factor(row_spacing), y = Trials)) +\n   xlab(\"Row Spacing (m)\") +\n   ylab(\"N Trials\") +\n   ggtitle(label = \"Trial row spacing using tebuconazole\") +\n   geom_col(aes(fill = fungicide_ai),\n            position = \"dodge\") +\n   scale_fill_usq(name = \"Fungicide AI\")## `summarise()` has grouped output by 'fungicide_ai', 'row_spacing'. You can override using the `.groups` argument.\n# Which row spacing leads to the higher disease severity\nPM_MB_dat %>%\n   filter(year == 2017 |\n             year == 2018) %>%\n   filter(fungicide_ai == \"control\") %>%\n   ggplot(aes(y = PM_final_severity, x = factor(row_spacing))) +\n   geom_boxplot(fill = usq_cols(\"usq charcoal\"), alpha = 0.5) +\n   ylab(\"Final severity rating\") +\n   xlab(\"Row spacing (m)\") +\n   ggtitle(\"Powdery mildew severity between different row spacing across all trials\")\n# Does trial year and location interact between row spacing and disease severity\nPM_MB_dat %>%\n   filter(year == 2017 |\n             year == 2018) %>%\n   filter(fungicide_ai == \"control\") %>%\n   ggplot(aes(y = PM_final_severity, x = factor(row_spacing))) +\n   geom_boxplot(fill = usq_cols(\"usq charcoal\"), alpha = 0.5) +\n   facet_grid(cols = vars(location)) +\n   ggtitle(\"Powdery mildew variation between different row spacing\") +\n   ylab(\"Final severity rating\") +\n   xlab(\"Row spacing (m)\")\n# Which row spacing leads to the higher yield potential\nPM_MB_dat %>%\n   filter(year == 2017 |\n             year == 2018) %>%\n   ggplot(aes(\n      y = as.numeric(grain_yield.t.ha.),\n      x = as.factor(row_spacing),\n      colour = location\n   )) +\n   geom_jitter(width = 0.05) +\n   ggtitle(\"Grain yield results for different row spacing at three locations\") +\n   xlab(\"Row spacing (m)\") +\n   ylab(\"Grain yield (t/ha)\") +\n   scale_colour_usq()"},{"path":"preliminary-analysis.html","id":"disease-pressure","chapter":"3 Preliminary Analysis","heading":"3.2.6 Disease pressure","text":"amount disease pressure seasons another variable impact mungbean yield meta-analysis effect size.plots difficult determine interaction disease pressure yield saved, interaction exists fungicide efficacy general greater potential save yield disease pressure higher.\nworth noting sufficient variation control plot disease severity produce medium disease severity category.","code":"\n# Assess the effect of yield pressure on the spray schedule efficacy\n# Use quantiles to separate disease pressure into High, Medium and low disease pressure categories\nDP33 <- \n   PM_MB_dat %>%\n   filter(fungicide_ai == \"control\") %>%\n   pull(PM_final_severity) %>%\n   quantile(0.3333)\n\nDP66 <- \n   PM_MB_dat %>%\n   filter(fungicide_ai == \"control\") %>%\n   pull(PM_final_severity) %>%\n   quantile(0.6666)\n\n\n   \n\nPM_MB_dat %>%\n   mutate(yc = case_when(fungicide_ai == \"control\" ~ grain_yield.t.ha.,\n                         TRUE ~ NA_real_))%>%\n   group_by(trial_ref)%>%\n   mutate(yc = mean(yc, na.rm=TRUE)) %>%\n   mutate(yield_saved = case_when(fungicide_ai != \"control\" ~ grain_yield.t.ha. - yc,\n                    fungicide_ai == \"control\" ~ NA_real_)) %>%\n   mutate(dc = case_when(fungicide_ai == \"control\" ~ PM_final_severity,\n                         TRUE ~ NA_real_))%>%\n   mutate(dc = mean(dc, na.rm = TRUE))%>%\n   ungroup() %>%\n   mutate(disease_pressure = case_when(dc <= DP33 ~ \"low\",\n                                 dc <= DP66 &\n                                 dc > DP33 ~ \"medium\",\n                                 dc > DP66 ~ \"high\",\n                                 TRUE ~ NA_character_))%>%\n   filter(spray_management != \"control\") %>%\n   ggplot(aes(disease_pressure, yield_saved))+\n   geom_boxplot()+ \n   facet_grid(. ~ spray_management)"},{"path":"preliminary-analysis.html","id":"in-crop-rainfall","chapter":"3 Preliminary Analysis","heading":"3.2.7 In-crop rainfall","text":"","code":""},{"path":"preliminary-analysis.html","id":"whole-season","chapter":"3 Preliminary Analysis","heading":"3.2.7.1 Whole season","text":"season rainfall known contribute significantly crop yields, however timing rainfall likely important.First inspection rainfall within season","code":"\nsource(\"R/add_lat_longs.R\") # code adds the latitude- and longitude to PM_MB_dat\nsource(\"R/crop_rain.R\")\n\n# Obtain rainfall from bomrang\nPM_MB_dat$sum_rain <-\n   crop_rain(location_name = PM_MB_dat$location,\n          latitude = PM_MB_dat$lat,\n          longitude = PM_MB_dat$lon,\n          first_day = PM_MB_dat$planting_date,\n          last_day = PM_MB_dat$harvest_date)\n\n# plot yield vs rainfall\nPM_MB_dat %>%\n   ggplot(aes(y = grain_yield.t.ha., x = sum_rain)) + \n   geom_point()## Warning: Removed 20 rows containing missing values (geom_point).\nsummary(lm(grain_yield.t.ha. ~ sum_rain, data = PM_MB_dat))## \n## Call:\n## lm(formula = grain_yield.t.ha. ~ sum_rain, data = PM_MB_dat)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -1.19469 -0.55873 -0.03576  0.57633  1.37833 \n## \n## Coefficients:\n##               Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)  1.6762255  0.2009508   8.341 6.49e-14 ***\n## sum_rain    -0.0017944  0.0007276  -2.466   0.0149 *  \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 0.6295 on 139 degrees of freedom\n##   (20 observations deleted due to missingness)\n## Multiple R-squared:  0.04192,    Adjusted R-squared:  0.03502 \n## F-statistic: 6.081 on 1 and 139 DF,  p-value: 0.01488"},{"path":"preliminary-analysis.html","id":"early-season-rainfall","chapter":"3 Preliminary Analysis","heading":"3.2.7.2 Early-season rainfall","text":"look effect rainfall planting date first sign disease.\nchoosing first sign disease mid point crop maturity.significant negative association , indicating rain fall early crop development negatively affects mungbean yields. However low R-squared value indicates strong one.","code":"\nPM_MB_dat$early_rain <-\n   crop_rain(location_name = PM_MB_dat$location,\n          latitude = PM_MB_dat$lat,\n          longitude = PM_MB_dat$lon,\n          first_day = PM_MB_dat$planting_date,\n          last_day = PM_MB_dat$first_sign_disease)\n\nPM_MB_dat %>%\n   ggplot(aes(y = grain_yield.t.ha., x = early_rain)) + \n   geom_point()\nsummary(lm(grain_yield.t.ha. ~ early_rain, data = PM_MB_dat))## \n## Call:\n## lm(formula = grain_yield.t.ha. ~ early_rain, data = PM_MB_dat)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -1.02549 -0.54188  0.01965  0.52195  1.18905 \n## \n## Coefficients:\n##               Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)  1.6187927  0.1084723  14.924  < 2e-16 ***\n## early_rain  -0.0033201  0.0007248  -4.581 9.31e-06 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 0.573 on 159 degrees of freedom\n## Multiple R-squared:  0.1166, Adjusted R-squared:  0.111 \n## F-statistic: 20.98 on 1 and 159 DF,  p-value: 9.308e-06"},{"path":"preliminary-analysis.html","id":"late-season-rainfall","chapter":"3 Preliminary Analysis","heading":"3.2.7.3 Late-season rainfall","text":"look effect rainfall first sign disease crop harvest.significant positive association , indicating rainfall disease commences likely lead increased yield. However low R-squared value indicates strong one.","code":"\nPM_MB_dat$late_rain <-\n   crop_rain(location_name = PM_MB_dat$location,\n          latitude = PM_MB_dat$lat,\n          longitude = PM_MB_dat$lon,\n          first_day = PM_MB_dat$first_sign_disease,\n          last_day = PM_MB_dat$harvest_date)\n\n\nPM_MB_dat %>%\n   ggplot(aes(y = grain_yield.t.ha., x = late_rain)) + \n   geom_point()## Warning: Removed 20 rows containing missing values (geom_point).\nsummary(lm(grain_yield.t.ha. ~ late_rain, data = PM_MB_dat))## \n## Call:\n## lm(formula = grain_yield.t.ha. ~ late_rain, data = PM_MB_dat)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -0.92828 -0.64258  0.03875  0.49696  1.23659 \n## \n## Coefficients:\n##              Estimate Std. Error t value Pr(>|t|)    \n## (Intercept) 1.0467776  0.1112158   9.412   <2e-16 ***\n## late_rain   0.0011816  0.0007598   1.555    0.122    \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 0.6376 on 139 degrees of freedom\n##   (20 observations deleted due to missingness)\n## Multiple R-squared:  0.0171, Adjusted R-squared:  0.01003 \n## F-statistic: 2.418 on 1 and 139 DF,  p-value: 0.1222"},{"path":"preliminary-analysis.html","id":"mid-season-rainfall","chapter":"3 Preliminary Analysis","heading":"3.2.7.4 Mid-season rainfall","text":"look effect rainfall 20 days planting 80 days planting.association mid season rain crop yields.plots shown can draw conclusion lack sufficient information.\nlikely available soil water trials along unobserved variables influence rainfall mungbean crops therefore investigate .\n******","code":"\nPM_MB_dat$mid_rain <-\n   crop_rain(location_name = PM_MB_dat$location,\n          latitude = PM_MB_dat$lat,\n          longitude = PM_MB_dat$lon,\n          first_day = ymd(PM_MB_dat$planting_date) + days(45),\n          last_day = ymd(PM_MB_dat$planting_date) + days(75)\n   )\n\nPM_MB_dat %>%\n   ggplot(aes(y = grain_yield.t.ha., x = mid_rain)) + \n   geom_point()\nsummary(lm(grain_yield.t.ha. ~ mid_rain, data = PM_MB_dat))## \n## Call:\n## lm(formula = grain_yield.t.ha. ~ mid_rain, data = PM_MB_dat)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -0.91273 -0.58233 -0.00342  0.39919  1.30604 \n## \n## Coefficients:\n##              Estimate Std. Error t value Pr(>|t|)    \n## (Intercept) 0.9047111  0.0841268  10.754  < 2e-16 ***\n## mid_rain    0.0025537  0.0006853   3.726 0.000269 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 0.5846 on 159 degrees of freedom\n## Multiple R-squared:  0.08032,    Adjusted R-squared:  0.07454 \n## F-statistic: 13.89 on 1 and 159 DF,  p-value: 0.0002694"},{"path":"preliminary-analysis.html","id":"fao-mungbean-data","chapter":"3 Preliminary Analysis","heading":"3.2.8 FAO mungbean data","text":"important consideration carry work mungbean diseases value crop provides.\nLet’s pull data FAOSTAT website area mungbean crops harvested.","code":"\nbeans <- read.csv(here(\"data/FAOSTAT_data_7-6-2020.csv\"))\n\nstr(beans)## 'data.frame':    473 obs. of  15 variables:\n##  $ Domain.Code     : chr  \"QC\" \"QC\" \"QC\" \"QC\" ...\n##  $ Domain          : chr  \"Crops\" \"Crops\" \"Crops\" \"Crops\" ...\n##  $ Area.Code       : int  10 10 10 10 10 10 10 10 10 10 ...\n##  $ Area            : chr  \"Australia\" \"Australia\" \"Australia\" \"Australia\" ...\n##  $ Element.Code    : int  5312 5419 5510 5312 5419 5510 5312 5419 5510 5312 ...\n##  $ Element         : chr  \"Area harvested\" \"Yield\" \"Production\" \"Area harvested\" ...\n##  $ Item.Code       : int  176 176 176 176 176 176 176 176 176 176 ...\n##  $ Item            : chr  \"Beans, dry\" \"Beans, dry\" \"Beans, dry\" \"Beans, dry\" ...\n##  $ Year.Code       : int  1961 1961 1961 1962 1962 1962 1963 1963 1963 1964 ...\n##  $ Year            : int  1961 1961 1961 1962 1962 1962 1963 1963 1963 1964 ...\n##  $ Unit            : chr  \"ha\" \"hg/ha\" \"tonnes\" \"ha\" ...\n##  $ Value           : int  809 5525 447 809 11001 890 2023 5151 1042 1214 ...\n##  $ Flag            : chr  \"\" \"Fc\" \"\" \"\" ...\n##  $ Flag.Description: chr  \"Official data\" \"Calculated data\" \"Official data\" \"Official data\" ...\n##  $ Note            : logi  NA NA NA NA NA NA ...\nbeans %>%\n   filter(Item == \"Beans, dry\",\n          Element == \"Area harvested\") %>%\n   select(Year, Value) %>%\n   ggplot(aes(y = Value, x = Year)) +\n   geom_point() +\n   geom_smooth()## `geom_smooth()` using method = 'loess' and formula 'y ~ x'"},{"path":"grain-yield-meta-analysis.html","id":"grain-yield-meta-analysis","chapter":"4 Grain yield meta-analysis","heading":"4 Grain yield meta-analysis","text":"Let’s get started analysis first finding best fitting model answers research question., relation PM establishment crop, farmers begin spraying mungbean mitigate yield loss: PM establishing, immediately first sign PM establishing, PM become established crop.secondary question aim : given time first spray occurred second spray provide worthwhile yield protection., model use main variables:Grain yield response variable (t / ha)Grain yield response variable (t / ha)Trial, resolves combinations categorical random variables:\nyear\nlocation\nrow spacing\ncultivar\nTrial, resolves combinations categorical random variables:yearlocationrow spacingcultivarspray_management moderator evaluate difference effect size attributed fungicide application timing.spray_management moderator evaluate difference effect size attributed fungicide application timing.id random variable indicating treatment independentid random variable indicating treatment independent","code":"\n# load R packages\nif (!require(\"pacman\"))\n   install.packages(\"pacman\")\npacman::p_load(\n   tidyverse,\n   kableExtra,\n   bomrang,\n   RColorBrewer,\n   metafor,\n   here,\n   netmeta,\n   multcomp,\n   flextable\n)\n\nif (!require(\"theme.usq\"))\n   remotes::install_github(\"adamhsparks/theme.usq\")\nlibrary(theme.usq)\ntheme_set(theme_usq())\nsource(here(\"R/reportP.R\"))\n\n# Data\nPM_dat_Y <-\n   read.csv(\"cache/PM_yield_clean_data.csv\", stringsAsFactors = FALSE\n   )"},{"path":"grain-yield-meta-analysis.html","id":"define-trial","chapter":"4 Grain yield meta-analysis","heading":"4.0.1 Define Trial","text":"","code":"\nPM_dat_Y <-\n   PM_dat_Y %>%\n   mutate(trial = paste(trial_ref,\n                        year,\n                        location,\n                        host_genotype,\n                        row_spacing,\n                        sep = \"_\")) "},{"path":"grain-yield-meta-analysis.html","id":"spray-schedule-meta-analysis","chapter":"4 Grain yield meta-analysis","heading":"4.1 Spray schedule meta-analysis","text":"spray_management moderator evaluated first model.\nmodel tested models incorporating, time disease onset, disease pressure variance-covariance matrix structures.","code":""},{"path":"grain-yield-meta-analysis.html","id":"spray-schedule-moderator","chapter":"4 Grain yield meta-analysis","heading":"4.1.1 Spray schedule moderator","text":"grain yield meta-analysis multi-variate meta-analysis, using metafor package function rma.mv() (Viechtbauer 2010).using spray_management variable moderator interactive random term trial random variable. variance-covariance matrix specified unstructured (UN) allow correlations within trials.","code":"\nPM_mv <- rma.mv(\n   yi = grain_yield.t.ha.,\n   V = vi,\n   mods = ~ spray_management,\n   method = \"ML\",\n   random = list( ~ spray_management | trial, ~ 1 | id),\n   struct = \"UN\",\n   control = list(optimizer = \"optim\"),\n   data = PM_dat_Y\n)## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0."},{"path":"grain-yield-meta-analysis.html","id":"disease-onset-interaction-with-spray-schedule","chapter":"4 Grain yield meta-analysis","heading":"4.1.2 Disease onset interaction with spray schedule","text":"determine time disease occurs cropping season influences efficacy fungicide applications protect yield create categorical variable defining early late disease onset.early late categories divided number close median days sowing signs disease first observed ensure roughly even numbers category.choose 42 days average days flowering mungbean.\naddition, Kelly et. al. (2017) noted yield losses higher cultivar Berken disease establishes flowering.Now let’s define continuous variablefirst_sign_days categorical variable onset.Inspect histogram first sign occurred crop.early_onset contains 117 treatments ,late_onset contains 37 treatments.","code":"\nPM_dat_Y %>%\n   mutate(first_sign_days = lubridate::ymd(first_sign_disease) -\n             lubridate::ymd(planting_date)) %>%\n   pull(first_sign_days) %>%\n   median()## Time difference of 39 days\nPM_dat_Y <- PM_dat_Y %>%\n   mutate(first_sign_days = lubridate::ymd(first_sign_disease) -\n             lubridate::ymd(planting_date)) %>%\n   mutate(onset = case_when(\n      first_sign_days <= 42 ~ \"early_onset\",\n      first_sign_days > 42 ~ \"late_onset\"\n   ))\nPM_dat_Y %>%\n   ggplot(aes(x = as.integer(first_sign_days))) +\n   geom_histogram(binwidth = 1) +\n   geom_vline(xintercept = 42)"},{"path":"grain-yield-meta-analysis.html","id":"metafor-onset-analysis","chapter":"4 Grain yield meta-analysis","heading":"4.1.2.1 metafor onset analysis","text":"adding onset variable moderator test interaction spray_management variable moderator interactive term trial random variable.comparison tells us meta-analysis including onset explained residual heterogeneity, shown lower QE value, better fit, indicated higher log-likelihood additional onset parameters.\nHowever higher AIC indicates model additional onset parameters sufficiently improve model fit warrant including parameters therefore ‘reduced’ model better option.\ninference also reflected chi-squared test, uncertain onset model significantly better indicated ANOVA pval 0.361.","code":"\nPM_mv_onset <- rma.mv(\n   yi = grain_yield.t.ha.,\n   V = vi,\n   mods = ~ spray_management * onset,\n   method = \"ML\",\n   random = list( ~ spray_management | trial, ~ 1 | id),\n   struct = \"UN\",\n   control = list(optimizer = \"optim\"),\n   data = PM_dat_Y\n)## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\nanova(PM_mv, PM_mv_onset)## \n##         df      AIC     BIC     AICc  logLik    LRT   pval        QE \n## Full    33 -38.5465 61.6730 -19.8465 52.2732               7982.9638 \n## Reduced 27 -43.9598 38.0379 -31.9598 48.9799 6.5867 0.3608 9993.0956"},{"path":"grain-yield-meta-analysis.html","id":"disease-pressure-interaction-with-spray-schedule","chapter":"4 Grain yield meta-analysis","heading":"4.1.3 Disease pressure interaction with spray schedule","text":"determine seasonal disease pressure influences efficacy fungicide applications protect yield categorical variable defining high_pressure low_pressure can defined.high_pressure low_pressure divided median disease severity spray control treatments end season.Now define two new variables, low_pressure high_pressure data.Inspect histogram final severity values crop.","code":"\nPM_dat_Y %>%\n   filter(fungicide_ai == \"control\") %>%\n   pull(PM_final_severity) %>%\n   median()## [1] 8\nPM_dat_Y <- PM_dat_Y %>%\n   mutate(\n      d_pressure = case_when(\n         PM_final_severity < 8 ~ \"low_pressure\",\n         PM_final_severity >= 8 ~ \"high_pressure\"\n      )\n   )\nPM_dat_Y %>%\n   ggplot(aes(x = PM_final_severity)) +\n   geom_histogram(binwidth = 1) +\n   geom_vline(xintercept = 8)"},{"path":"grain-yield-meta-analysis.html","id":"metafor-disease-pressure-interaction","chapter":"4 Grain yield meta-analysis","heading":"4.1.3.1 metafor disease pressure interaction","text":"Test d_pressure variable addition moderator evaluate ’s interaction spray_management influence grain yield effect size.comparison tells us meta-analysis including d_pressure explained residual heterogeneity, shown lower QE value, better fit, indicated higher log-likelihood additional d_pressure parameter.\nHowever lower AIC ‘Full’ model indicates retaining model including additional d_pressure variables reasonable decision.\naddition chi-squared test indicates d_pressure model better indicated pval 0.0468.However worth noting Late plus schedules experienced low disease pressure.\nEven though disease pressure interaction moderators deemed significant (P = 0.0468), division schedules due disease pressure (reducing k) makes drawing conclusions risky. data needed explore possible effect.spray_managementd_pressuren()controlhigh_pressure29controllow_pressure9Earlyhigh_pressure10Earlylow_pressure3Latehigh_pressure7Latelow_pressure10Late_pluslow_pressure19Recommendedhigh_pressure13Recommendedlow_pressure14Recommended_plushigh_pressure10Recommended_pluslow_pressure30","code":"\nPM_mv_dp <- rma.mv(\n   yi = grain_yield.t.ha.,\n   V = vi,\n   mods = ~ spray_management * d_pressure,\n   method = \"ML\",\n   random = list( ~ spray_management | trial, ~ 1 | id),\n   struct = \"UN\",\n   control = list(optimizer = \"optim\"),\n   data = PM_dat_Y\n)## Warning in rma.mv(yi = grain_yield.t.ha., V = vi, mods = ~spray_management * :\n## Redundant predictors dropped from the model.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\nanova(PM_mv, PM_mv_dp)## \n##         df      AIC     BIC     AICc  logLik     LRT   pval        QE \n## Full    32 -45.1999 51.9826 -27.7454 54.6000                7550.9672 \n## Reduced 27 -43.9598 38.0379 -31.9598 48.9799 11.2401 0.0468 9993.0956\n# show the division of spray schedules by the d_pressure moderator\nPM_dat_Y %>%\n   group_by(spray_management, d_pressure) %>%\n   summarise(n()) %>%\n   flextable()## `summarise()` has grouped output by 'spray_management'. You can override using the `.groups` argument.\nsummary(PM_mv_dp)## \n## Multivariate Meta-Analysis Model (k = 154; method: ML)\n## \n##   logLik  Deviance       AIC       BIC      AICc \n##  54.6000  215.2690  -45.1999   51.9826  -27.7454   \n## \n## Variance Components:\n## \n##             estim    sqrt  nlvls  fixed  factor \n## sigma^2    0.0000  0.0000    154     no      id \n## \n## outer factor: trial            (nlvls = 23)\n## inner factor: spray_management (nlvls = 6)\n## \n##             estim    sqrt  k.lvl  fixed             level \n## tau^2.1    0.2063  0.4542     38     no           control \n## tau^2.2    0.2528  0.5028     13     no             Early \n## tau^2.3    0.3116  0.5582     17     no              Late \n## tau^2.4    0.3578  0.5981     19     no         Late_plus \n## tau^2.5    0.2989  0.5467     27     no       Recommended \n## tau^2.6    0.3586  0.5989     40     no  Recommended_plus \n## \n##                   rho.cntr  rho.Erly  rho.Late  rho.Lt_p  rho.Rcmm  rho.Rcm_ \n## control                  1    0.9908    0.9992    0.9987    0.9953    0.9972   \n## Early               0.9908         1    0.9953    0.0000    0.9993    0.9981   \n## Late                0.9992    0.9953         1    0.9999    0.9983    0.9994   \n## Late_plus           0.9987    0.0000    0.9999         1    0.9990    0.9997   \n## Recommended         0.9953    0.9993    0.9983    0.9990         1    0.9997   \n## Recommended_plus    0.9972    0.9981    0.9994    0.9997    0.9997         1   \n##                   cntr  Erly  Late  Lt_p  Rcmm  Rcm_ \n## control              -    no    no    no    no    no \n## Early                7     -    no   yes    no    no \n## Late                11     6     -    no    no    no \n## Late_plus            6     0     3     -    no    no \n## Recommended         19     6    11     3     -    no \n## Recommended_plus    17     6    11     3    17     - \n## \n## Test for Residual Heterogeneity:\n## QE(df = 143) = 7550.9672, p-val < .0001\n## \n## Test of Moderators (coefficients 2:11):\n## QM(df = 10) = 69.6611, p-val < .0001\n## \n## Model Results:\n## \n##                                                          estimate      se \n## intrcpt                                                    1.0965  0.0973 \n## spray_managementEarly                                      0.0694  0.0424 \n## spray_managementLate                                       0.2519  0.0661 \n## spray_managementLate_plus                                  0.1017  0.0551 \n## spray_managementRecommended                                0.1994  0.0355 \n## spray_managementRecommended_plus                           0.4024  0.0709 \n## d_pressurelow_pressure                                     0.0091  0.0406 \n## spray_managementEarly:d_pressurelow_pressure               0.0053  0.0966 \n## spray_managementLate:d_pressurelow_pressure               -0.1641  0.0766 \n## spray_managementRecommended:d_pressurelow_pressure        -0.1267  0.0542 \n## spray_managementRecommended_plus:d_pressurelow_pressure   -0.2739  0.0739 \n##                                                             zval    pval \n## intrcpt                                                  11.2687  <.0001 \n## spray_managementEarly                                     1.6368  0.1017 \n## spray_managementLate                                      3.8101  0.0001 \n## spray_managementLate_plus                                 1.8439  0.0652 \n## spray_managementRecommended                               5.6114  <.0001 \n## spray_managementRecommended_plus                          5.6739  <.0001 \n## d_pressurelow_pressure                                    0.2234  0.8232 \n## spray_managementEarly:d_pressurelow_pressure              0.0549  0.9562 \n## spray_managementLate:d_pressurelow_pressure              -2.1409  0.0323 \n## spray_managementRecommended:d_pressurelow_pressure       -2.3367  0.0195 \n## spray_managementRecommended_plus:d_pressurelow_pressure  -3.7075  0.0002 \n##                                                            ci.lb    ci.ub \n## intrcpt                                                   0.9058   1.2872  *** \n## spray_managementEarly                                    -0.0137   0.1524      \n## spray_managementLate                                      0.1223   0.3815  *** \n## spray_managementLate_plus                                -0.0064   0.2098    . \n## spray_managementRecommended                               0.1297   0.2690  *** \n## spray_managementRecommended_plus                          0.2634   0.5414  *** \n## d_pressurelow_pressure                                   -0.0705   0.0887      \n## spray_managementEarly:d_pressurelow_pressure             -0.1841   0.1947      \n## spray_managementLate:d_pressurelow_pressure              -0.3143  -0.0139    * \n## spray_managementRecommended:d_pressurelow_pressure       -0.2330  -0.0204    * \n## spray_managementRecommended_plus:d_pressurelow_pressure  -0.4187  -0.1291  *** \n## \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"grain-yield-meta-analysis.html","id":"test-variance-covavriance-matrix-structure","chapter":"4 Grain yield meta-analysis","heading":"4.1.4 Test variance-covavriance matrix structure","text":"Test model implied simpler variance-covariance matrix, “compound symmetry” (CS), examine unstructured matrix suitable.PM_mv (Full) prevails better model (p = 0.0014; AIC = -45.4359) therefore keep unstructured variance-covariance matrix.Therefore model PM_mv, preffered model data.","code":"\nPM_mv_cs <- rma.mv(\n   yi = grain_yield.t.ha.,\n   V = vi,\n   mods = ~ spray_management,\n   method = \"ML\",\n   random = list( ~ spray_management | trial, ~ 1 | id),\n   struct = \"CS\",\n   control = list(optimizer = \"optim\"),\n   data = PM_dat_Y\n)\n\nanova(PM_mv, PM_mv_cs)## \n##         df      AIC      BIC     AICc  logLik     LRT   pval        QE \n## Full    27 -43.9598  38.0379 -31.9598 48.9799                9993.0956 \n## Reduced  9 -38.8791 -11.5465 -37.6291 28.4395 41.0807 0.0015 9993.0956"},{"path":"grain-yield-meta-analysis.html","id":"summarise-pm_mv-model","chapter":"4 Grain yield meta-analysis","heading":"4.2 Summarise PM_mv model","text":"first table PM_mv output shows tau^2 (trial variance) random effect intercept (spray_management) trial number occurrences treatment analysis.\neffectively shows heterogeneity trials particular treatments.table shows Recommended_plus showed highest heterogeneity trials followed Late_plus, Late Recommended, Early -spray control showing least heterogeneity.second table two parts (left right).\nleft part, rho, correlation variation specified treatments.\ncomparisons acceptable except comparison Early Late_plus, indicating 0.000 rho.\nEarly Late_plus treatments never occurred within trial, indicated right side table (hence earlier warnings).\nconcern type network meta-analysis differences treatments can inferred differences treatments (Madden, Piepho, Paul 2016).result can see Early treatment significantly different intercept, case mean spray control.\nHowever treatments significantly different -spray control (intercept).\n\\(Q_M\\) omnibus test moderators, shows moderators significantly influence model (\\(Q_M =\\) 37.3595017 \\(,df =\\) 5, P < 0.0001) can reject null hypothesis (\\(H_0 : \\beta_1 = \\beta_2 = \\beta_3 =\\beta_4 = 0\\)) difference moderators (Viechtbauer 2010).\nanalysis shows still significant amount residual heterogeneity (\\(Q_E =\\) 9993.095615 \\(,df=\\) 149, P < 0.0001 ) captured spray management moderator indicating possible moderators might influence grain yield.","code":"\nsummary(PM_mv)## \n## Multivariate Meta-Analysis Model (k = 154; method: ML)\n## \n##   logLik  Deviance       AIC       BIC      AICc \n##  48.9799  226.5092  -43.9598   38.0379  -31.9598   \n## \n## Variance Components:\n## \n##             estim    sqrt  nlvls  fixed  factor \n## sigma^2    0.0000  0.0005    154     no      id \n## \n## outer factor: trial            (nlvls = 23)\n## inner factor: spray_management (nlvls = 6)\n## \n##             estim    sqrt  k.lvl  fixed             level \n## tau^2.1    0.2070  0.4549     38     no           control \n## tau^2.2    0.2203  0.4694     13     no             Early \n## tau^2.3    0.3288  0.5734     17     no              Late \n## tau^2.4    0.4023  0.6342     19     no         Late_plus \n## tau^2.5    0.2863  0.5351     27     no       Recommended \n## tau^2.6    0.4053  0.6366     40     no  Recommended_plus \n## \n##                   rho.cntr  rho.Erly  rho.Late  rho.Lt_p  rho.Rcmm  rho.Rcm_ \n## control                  1    0.9738    0.9925    0.9893    0.9886    0.9834   \n## Early               0.9738         1    0.9918    0.0000    0.9969    0.9945   \n## Late                0.9925    0.9918         1    0.9997    0.9981    0.9982   \n## Late_plus           0.9893    0.0000    0.9997         1    0.9986    0.9993   \n## Recommended         0.9886    0.9969    0.9981    0.9986         1    0.9969   \n## Recommended_plus    0.9834    0.9945    0.9982    0.9993    0.9969         1   \n##                   cntr  Erly  Late  Lt_p  Rcmm  Rcm_ \n## control              -    no    no    no    no    no \n## Early                7     -    no   yes    no    no \n## Late                11     6     -    no    no    no \n## Late_plus            6     0     3     -    no    no \n## Recommended         19     6    11     3     -    no \n## Recommended_plus    17     6    11     3    17     - \n## \n## Test for Residual Heterogeneity:\n## QE(df = 148) = 9993.0956, p-val < .0001\n## \n## Test of Moderators (coefficients 2:6):\n## QM(df = 5) = 37.3595, p-val < .0001\n## \n## Model Results:\n## \n##                                   estimate      se     zval    pval    ci.lb \n## intrcpt                             1.0903  0.0969  11.2569  <.0001   0.9004 \n## spray_managementEarly               0.0029  0.0439   0.0672  0.9464  -0.0830 \n## spray_managementLate                0.1374  0.0440   3.1226  0.0018   0.0512 \n## spray_managementLate_plus           0.1301  0.0578   2.2507  0.0244   0.0168 \n## spray_managementRecommended         0.1378  0.0339   4.0606  <.0001   0.0713 \n## spray_managementRecommended_plus    0.1891  0.0530   3.5692  0.0004   0.0853 \n##                                    ci.ub \n## intrcpt                           1.2801  *** \n## spray_managementEarly             0.0889      \n## spray_managementLate              0.2237   ** \n## spray_managementLate_plus         0.2433    * \n## spray_managementRecommended       0.2043  *** \n## spray_managementRecommended_plus  0.2930  *** \n## \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"grain-yield-meta-analysis.html","id":"meta-analysis-results-summary","chapter":"4 Grain yield meta-analysis","heading":"4.3 Meta-analysis results summary","text":"","code":""},{"path":"grain-yield-meta-analysis.html","id":"moderator-estimates-table","chapter":"4 Grain yield meta-analysis","heading":"4.3.1 Moderator estimates table","text":"Let’s present meta-analysis results moderator variables table estimates.\n(#tab:metafor_results_table_yield)Table 2: Estimated mungbean yield mean difference spray control (intercept) spray schedule treatment. Yield estimates (u) calculated network meta-analysis data obtained grey literature reports ‘k’ field trials undertaken Eastern Australia. P values indicate statistical significance comparison intercept.\nModeratorNakbmucseCI_{L}dCI_{U}ePfEarly1370.00290.0439-0.08300.08890.9464Recommended27190.13780.03390.07130.2043< 0.0001Recommended+40170.18910.05300.08530.29300.0004Late17110.13740.04400.05120.22370.0018Late+1960.13010.05780.01680.24330.0244anumber treatment means categorised spray schedule; bnumber trials respective spray schedule; cestimated mean yield determined meta-analysis; dLower range 95% confidence interval; eUpper range 95% confidence interval; findicates significance respective spray schedule spray control (intercept)","code":"\n# obtain number of treatments included in each moderator variable\nk5 <-\n   as.data.frame(table(PM_dat_Y$trial, PM_dat_Y$spray_management)) %>%\n   filter(Freq != 0) %>%\n   group_by(Var2) %>%\n   summarise(n()) %>%\n   pull()\n\n# create data.frame\nresults_mv <- data.frame(\n   Moderator = c(\n      \"Intercept / No Spray control\",\n      \"Early\",\n      \"Late\",\n      \"Late+\",\n      \"Recommended\",\n      \"Recommended+\"\n   ),\n   N = PM_mv$g.levels.k,\n   k = k5,\n   Effect = round(PM_mv$b, 4),\n   se = round(PM_mv$se, 4),\n   CI_lower = round(PM_mv$ci.lb, 4),\n   CI_upper = round(PM_mv$ci.ub, 4),\n   z_val = round(PM_mv$zval, 4),\n   p_val = reportP(PM_mv$pval, AsNumeric = FALSE, P_prefix = FALSE)\n)\n\n# rename colnames to give table headings\ncolnames(results_mv)[c(2:5, 7:10)] <-\n   c(\"Treatment\",\n     \"N\",\n     \"k\",\n     \"mu\",\n     \"CI_{L}\",\n     \"CI_{U}\",\n     \"Z\",\n     \"P\")\n\nyield_estimates_table <-\n   flextable(results_mv[c(2, 5, 6, 3, 4), c(1, 3:8, 10)]) %>%\n   align(j = 3:8, align = \"center\", part = \"all\") %>%\n   fontsize(size = 8, part = \"body\") %>%\n   fontsize(size = 10, part = \"header\") %>%\n   italic(italic = TRUE, part = \"header\") %>%\n   set_caption(\n      \"Table 2: Estimated mungbean yield mean difference to the no spray control (intercept) for each spray schedule treatment. Yield estimates (u) were calculated from a network meta-analysis of data obtained from grey literature reports of 'k' field trials undertaken in Eastern Australia. P values indicate statistical significance in comparison to the intercept.\"\n   ) %>%\n   autofit() %>%\n   footnote(\n      i = 1,\n      j = c(2:4, 6:8),\n      value = as_paragraph(\n         c(\n            \"number of treatment means categorised to each spray schedule\",\n            \"number of trials with the respective spray schedule\",\n            \"estimated mean yield determined by the meta-analysis\",\n            \"Lower range of the 95% confidence interval\",\n            \"Upper range of the 95% confidence interval\",\n            \"indicates the significance between each respective spray schedule and the no spray control (intercept)\"\n         )\n      ),\n      ref_symbols = letters[1:6],\n      part = \"header\",\n      inline = TRUE\n   )\n\nyield_estimates_table"},{"path":"grain-yield-meta-analysis.html","id":"moderator-estimates-plot","chapter":"4 Grain yield meta-analysis","heading":"4.3.2 Moderator estimates plot","text":"View moderator comparisons plot.","code":"\nresults_mv %>%\n   filter(Treatment != \"control\") %>%\n   mutate(Treatment = factor(Treatment, levels = rev(\n      c(\n         \"Early\",\n         \"Recommended\",\n         \"Recommended_plus\",\n         \"Late\",\n         \"Late_plus\"\n      )\n   ))) %>%\n   ggplot(aes(Treatment, mu)) +\n   geom_hline(\n      yintercept = seq(-0.05, 0.3, by = 0.05),\n      color = usq_cols(\"usq charcoal\"),\n      linetype = 3\n   ) +\n   geom_point(aes(size = 1 / se), shape = 15) +\n   geom_linerange(aes(ymin = `CI_{L}`, ymax = `CI_{U}`)) +\n   coord_flip() +\n   labs(caption = \"Bars indicate 95% confidence intervals\")+\n   ylab(expression(paste(\n      \"Mean yield difference to control (t ha\" ^ -1, \")\", sep = \"\"\n   ))) +\n   scale_x_discrete(\n      \"Moderator variable\",\n      labels = c(\n         expression(\"Late\"[\"plus\"]),\n         expression(\"Late\"[\"single\"]),\n         expression(\"Recommended\"[\"plus\"]),\n         expression(\"Recommended\"[\"single\"]),\n         expression(\"Early\"[\"single\"])\n      )\n   )\nggsave(\"paper/figures/Fig2_means_difference.png\",\n       height = 3,\n       dpi = 500)## Saving 7 x 3 in image"},{"path":"grain-yield-meta-analysis.html","id":"moderator-contrasts","chapter":"4 Grain yield meta-analysis","heading":"4.3.3 Moderator contrasts","text":"Calculate treatment contrastscontrastcoefficientsStdErrZvaluepvalssigEarly - control-1.08730.1100-9.88610.0001***Late - control-0.95290.0865-11.01500.0001***Late_plus - control-0.96020.0812-11.82290.0001***Recommended - control-0.95250.0907-10.49830.0001***Recommended_plus - control-0.90110.0781-11.53410.0001***Late - Early0.13450.04742.83720.0046**Late_plus - Early0.12710.06242.03770.0416*Recommended - Early0.13480.02924.61130.0001***Recommended_plus - Early0.18620.05043.69170.0002***Late_plus - Late-0.00730.0473-0.15510.8767Recommended - Late0.00040.03380.01140.9909Recommended_plus - Late0.05170.03771.37100.1704Recommended - Late_plus0.00770.04890.15810.8744Recommended_plus - Late_plus0.05910.04551.29980.1937Recommended_plus - Recommended0.05140.03491.47100.1413These contrasts can viewed plot.","code":"\nsource(\"R/simple_summary.R\") #function to provide a table that includes the treatment names in the contrasts\nsummary(glht(PM_mv, linfct = cbind(contrMat(rep(\n   1, 6\n), type = \"Tukey\"))), test = adjusted(\"none\"))## \n##   Simultaneous Tests for General Linear Hypotheses\n## \n## Fit: rma.mv(yi = grain_yield.t.ha., V = vi, mods = ~spray_management, \n##     random = list(~spray_management | trial, ~1 | id), struct = \"UN\", \n##     data = PM_dat_Y, method = \"ML\", control = list(optimizer = \"optim\"))\n## \n## Linear Hypotheses:\n##              Estimate Std. Error z value Pr(>|z|)    \n## 2 - 1 == 0 -1.0873327  0.1099858  -9.886  < 2e-16 ***\n## 3 - 1 == 0 -0.9528742  0.0865069 -11.015  < 2e-16 ***\n## 4 - 1 == 0 -0.9602137  0.0812167 -11.823  < 2e-16 ***\n## 5 - 1 == 0 -0.9524872  0.0907279 -10.498  < 2e-16 ***\n## 6 - 1 == 0 -0.9011339  0.0781280 -11.534  < 2e-16 ***\n## 3 - 2 == 0  0.1344585  0.0473917   2.837 0.004552 ** \n## 4 - 2 == 0  0.1271189  0.0623833   2.038 0.041579 *  \n## 5 - 2 == 0  0.1348455  0.0292425   4.611    4e-06 ***\n## 6 - 2 == 0  0.1861988  0.0504372   3.692 0.000223 ***\n## 4 - 3 == 0 -0.0073395  0.0473195  -0.155 0.876738    \n## 5 - 3 == 0  0.0003871  0.0338151   0.011 0.990867    \n## 6 - 3 == 0  0.0517403  0.0377384   1.371 0.170367    \n## 5 - 4 == 0  0.0077266  0.0488628   0.158 0.874355    \n## 6 - 4 == 0  0.0590798  0.0454538   1.300 0.193677    \n## 6 - 5 == 0  0.0513532  0.0349093   1.471 0.141278    \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## (Adjusted p values reported -- none method)\ncontrast_Ssum <-\n   simple_summary(summary(glht(PM_mv, linfct = cbind(\n      contrMat(rep(1, 6), type = \"Tukey\")\n   )), test = adjusted(\"none\")))\ncontrast_Ssum %>%\n   flextable()%>%\n   autofit()\npar(mar = c(5, 13, 4, 2) + 0.1)\nplot(glht(PM_mv, linfct = cbind(contrMat(rep(\n   1, 6\n), type = \"Tukey\"))), yaxt = 'n')\naxis(\n   2,\n   at = seq_along(contrast_Ssum$contrast),\n   labels = rev(contrast_Ssum$contrast),\n   las = 2,\n   cex.axis = 0.8\n)"},{"path":"grain-yield-meta-analysis.html","id":"profile-plots","chapter":"4 Grain yield meta-analysis","heading":"4.3.4 Profile plots","text":"inspection profile plots ensure model -fitted can undertaken.\nexpect see estimate align peak curve.\nAlso shape line curve.\nplots take long time generate evaluated.","code":"\nprofile(PM_mv, tau2 = 1)\nprofile(PM_mv, tau2 = 2)\nprofile(PM_mv, tau2 = 3)\nprofile(PM_mv, tau2 = 4)\nprofile(PM_mv, tau2 = 5)\nprofile(PM_mv, tau2 = 6)"},{"path":"grain-yield-meta-analysis.html","id":"netmeta-analysis","chapter":"4 Grain yield meta-analysis","heading":"4.4 netmeta analysis","text":"netmeta package can provide graphical representation pairwise comparisons.netmeta package uses frequentist approach focusing pairwise comparisons treatments.\nresults can used evaluate outcome metafor package robust.","code":"\ndatPM3 <- PM_dat_Y %>%\n   group_by(trial, spray_management, replicates) %>%\n   summarize(yi_mean = mean(grain_yield.t.ha.),\n             vi_mean = mean(vi)) %>%\n   ungroup()## `summarise()` has grouped output by 'trial', 'spray_management'. You can override using the `.groups` argument.\nPM_con <- pairwise(\n   treat = spray_management,\n   n = replicates,\n   mean = yi_mean,\n   sd = sqrt(vi_mean),\n   studlab = trial,\n   data = datPM3,\n   sm = \"MD\"\n)\n\nnet_con <- netmeta(TE,\n                   seTE,\n                   treat1,\n                   treat2,\n                   studlab,\n                   data = PM_con,\n                   sm = \"MD\")\n\nsummary(net_con)## Number of studies: k = 23\n## Number of treatments: n = 6\n## Number of pairwise comparisons: m = 126\n## Number of designs: d = 7\n## \n## Fixed effects model\n## \n## Treatment estimate (sm = 'MD'):\n##                  control   Early    Late Late_plus Recommended Recommended_plus\n## control                . -0.0422 -0.0630   -0.1609     -0.0574          -0.1039\n## Early             0.0422       . -0.0208   -0.1187     -0.0152          -0.0618\n## Late              0.0630  0.0208       .   -0.0980      0.0055          -0.0410\n## Late_plus         0.1609  0.1187  0.0980         .      0.1035           0.0570\n## Recommended       0.0574  0.0152 -0.0055   -0.1035           .          -0.0465\n## Recommended_plus  0.1039  0.0618  0.0410   -0.0570      0.0465                .\n## \n## Lower 95%-confidence limit:\n##                  control   Early    Late Late_plus Recommended Recommended_plus\n## control                . -0.1207 -0.0999   -0.2160     -0.0937          -0.1466\n## Early            -0.0363       . -0.1017   -0.2107     -0.0967          -0.1454\n## Late              0.0260 -0.0601       .   -0.1513     -0.0293          -0.0814\n## Late_plus         0.1058  0.0267  0.0447         .      0.0476           0.0016\n## Recommended       0.0212 -0.0662 -0.0404   -0.1594           .          -0.0884\n## Recommended_plus  0.0613 -0.0219  0.0005   -0.1123      0.0046                .\n## \n## Upper 95%-confidence limit:\n##                  control  Early    Late Late_plus Recommended Recommended_plus\n## control                . 0.0363 -0.0260   -0.1058     -0.0212          -0.0613\n## Early             0.1207      .  0.0601   -0.0267      0.0662           0.0219\n## Late              0.0999 0.1017       .   -0.0447      0.0404          -0.0005\n## Late_plus         0.2160 0.2107  0.1513         .      0.1594           0.1123\n## Recommended       0.0937 0.0967  0.0293   -0.0476           .          -0.0046\n## Recommended_plus  0.1466 0.1454  0.0814   -0.0016      0.0884                .\n## \n## Random effects model\n## \n## Treatment estimate (sm = 'MD'):\n##                  control   Early    Late Late_plus Recommended Recommended_plus\n## control                . -0.0481 -0.1249   -0.1893     -0.0876          -0.1378\n## Early             0.0481       . -0.0768   -0.1412     -0.0395          -0.0897\n## Late              0.1249  0.0768       .   -0.0644      0.0373          -0.0129\n## Late_plus         0.1893  0.1412  0.0644         .      0.1017           0.0515\n## Recommended       0.0876  0.0395 -0.0373   -0.1017           .          -0.0502\n## Recommended_plus  0.1378  0.0897  0.0129   -0.0515      0.0502                .\n## \n## Lower 95%-confidence limit:\n##                  control   Early    Late Late_plus Recommended Recommended_plus\n## control                . -0.1567 -0.2030   -0.2949     -0.1529          -0.2083\n## Early            -0.0606       . -0.1945   -0.2852     -0.1536          -0.2054\n## Late              0.0467 -0.0409       .   -0.1766     -0.0434          -0.0953\n## Late_plus         0.0837 -0.0028 -0.0477         .     -0.0086          -0.0600\n## Recommended       0.0222 -0.0746 -0.1179   -0.2120           .          -0.1225\n## Recommended_plus  0.0672 -0.0260 -0.0696   -0.1631     -0.0221                .\n## \n## Upper 95%-confidence limit:\n##                  control  Early    Late Late_plus Recommended Recommended_plus\n## control                . 0.0606 -0.0467   -0.0837     -0.0222          -0.0672\n## Early             0.1567      .  0.0409    0.0028      0.0746           0.0260\n## Late              0.2030 0.1945       .    0.0477      0.1179           0.0696\n## Late_plus         0.2949 0.2852  0.1766         .      0.2120           0.1631\n## Recommended       0.1529 0.1536  0.0434    0.0086           .           0.0221\n## Recommended_plus  0.2083 0.2054  0.0953    0.0600      0.1225                .\n## \n## Quantifying heterogeneity / inconsistency:\n## tau^2 = 0.0099; tau = 0.0995; I^2 = 55.2% [39.4%; 66.8%]\n## \n## Tests of heterogeneity (within designs) and inconsistency (between designs):\n##                      Q d.f.  p-value\n## Total           122.66   55 < 0.0001\n## Within designs   70.51   44   0.0068\n## Between designs  52.15   11 < 0.0001"},{"path":"grain-yield-meta-analysis.html","id":"netmeta-estimates-plot","chapter":"4 Grain yield meta-analysis","heading":"4.4.1 netmeta estimates plot","text":"Visualise netmeta results forest plot.","code":"\nforest(\n   net_con,\n   reference.group = 1,\n   rightcols = c(\"effect\", \"ci\", \"Pscore\"),\n   rightlabs = \"P-Score\",\n   small.values = \"bad\"\n)"},{"path":"grain-yield-meta-analysis.html","id":"moderator-netgraph","chapter":"4 Grain yield meta-analysis","heading":"4.4.2 Moderator netgraph","text":"netmeta analysis suggests spray schedule commencing early different treatment including spray control.\nestimates mean similar recommended treatments.\nRecommended_plus Late_plus treatments show higher mean estimates, however significantly different Early estimate.","code":"\nnetgraph(\n   net_con,\n   plastic = FALSE,\n   col = usq_cols(\"support orange\"),\n   thickness =  \"number.of.studies\",\n   points = FALSE,\n   col.points = usq_cols(\"usq charcoal\"),\n   cex.points = 1,\n   number.of.studies = TRUE,\n   cex.number.of.studies = 1,\n   col.number.of.studies = \"black\",\n   bg.number.of.studies = usq_cols(\"support orange\"),\n   multiarm = FALSE,\n   col.multiarm = usq_cols(\"support turquiose\"),\n   pos.number.of.studies = 0.4\n)\nnetleague(net_con)## League table (fixed effects model):\n##                                                       \n##                     control -0.1047 [-0.1936; -0.0157]\n##  -0.0422 [-0.1207;  0.0363]                      Early\n##  -0.0630 [-0.0999; -0.0260] -0.0208 [-0.1017;  0.0601]\n##  -0.1609 [-0.2160; -0.1058] -0.1187 [-0.2107; -0.0267]\n##  -0.0574 [-0.0937; -0.0212] -0.0152 [-0.0967;  0.0662]\n##  -0.1039 [-0.1466; -0.0613] -0.0618 [-0.1454;  0.0219]\n##                                                       \n##  -0.0674 [-0.1122; -0.0226] -0.2666 [-0.3469; -0.1862]\n##  -0.1503 [-0.2707; -0.0299]                          .\n##                        Late -0.0684 [-0.1392;  0.0024]\n##  -0.0980 [-0.1513; -0.0447]                  Late_plus\n##   0.0055 [-0.0293;  0.0404]  0.1035 [ 0.0476;  0.1594]\n##  -0.0410 [-0.0814; -0.0005]  0.0570 [ 0.0016;  0.1123]\n##                                                       \n##  -0.0486 [-0.0860; -0.0111] -0.0989 [-0.1442; -0.0536]\n##  -0.0778 [-0.2109;  0.0554] -0.1506 [-0.2839; -0.0172]\n##   0.0041 [-0.0350;  0.0432] -0.0473 [-0.0944; -0.0002]\n##   0.1602 [ 0.0643;  0.2561] -0.0018 [-0.0742;  0.0706]\n##                 Recommended -0.0359 [-0.0797;  0.0079]\n##  -0.0465 [-0.0884; -0.0046]           Recommended_plus\n## \n## League table (random effects model):\n##                                                       \n##                     control -0.0874 [-0.2110;  0.0362]\n##  -0.0481 [-0.1567;  0.0606]                      Early\n##  -0.1249 [-0.2030; -0.0467] -0.0768 [-0.1945;  0.0409]\n##  -0.1893 [-0.2949; -0.0837] -0.1412 [-0.2852;  0.0028]\n##  -0.0876 [-0.1529; -0.0222] -0.0395 [-0.1536;  0.0746]\n##  -0.1378 [-0.2083; -0.0672] -0.0897 [-0.2054;  0.0260]\n##                                                       \n##  -0.1317 [-0.2195; -0.0440] -0.2440 [-0.3702; -0.1179]\n##  -0.1225 [-0.2733;  0.0283]                          .\n##                        Late -0.0459 [-0.1834;  0.0917]\n##  -0.0644 [-0.1766;  0.0477]                  Late_plus\n##   0.0373 [-0.0434;  0.1179]  0.1017 [-0.0086;  0.2120]\n##  -0.0129 [-0.0953;  0.0696]  0.0515 [-0.0600;  0.1631]\n##                                                       \n##  -0.0863 [-0.1532; -0.0195] -0.1314 [-0.2047; -0.0581]\n##  -0.0841 [-0.2420;  0.0738] -0.1605 [-0.3177; -0.0034]\n##   0.0366 [-0.0533;  0.1265] -0.0506 [-0.1411;  0.0400]\n##   0.1468 [-0.0061;  0.2997]  0.0043 [-0.1471;  0.1557]\n##                 Recommended -0.0496 [-0.1233;  0.0241]\n##  -0.0502 [-0.1225;  0.0221]           Recommended_plus\ndecomp.design(net_con)## Q statistics to assess homogeneity / consistency\n## \n##                      Q df  p-value\n## Total           122.66 55 < 0.0001\n## Within designs   70.51 44   0.0068\n## Between designs  52.15 11 < 0.0001\n## \n## Design-specific decomposition of within-designs Q statistic\n## \n##                                               Design     Q df p-value\n##                                    control:Late_plus  0.70  2  0.7036\n##                                  control:Recommended  0.10  1  0.7469\n##      control:Early:Late:Recommended:Recommended_plus 28.07 20  0.1077\n##  control:Late:Late_plus:Recommended:Recommended_plus 18.73  8  0.0164\n##            control:Late:Recommended:Recommended_plus  0.66  3  0.8830\n##                 control:Recommended:Recommended_plus 22.25 10  0.0139\n## \n## Between-designs Q statistic after detaching of single designs\n## \n##                                      Detached design     Q df  p-value\n##                                        control:Early 47.35 10 < 0.0001\n##                                    control:Late_plus 51.33 10 < 0.0001\n##                                  control:Recommended 50.79 10 < 0.0001\n##      control:Early:Late:Recommended:Recommended_plus 38.25  7 < 0.0001\n##  control:Late:Late_plus:Recommended:Recommended_plus 23.35  7   0.0015\n##            control:Late:Recommended:Recommended_plus 33.30  8 < 0.0001\n##                 control:Recommended:Recommended_plus 45.22  9 < 0.0001\n## \n## Q statistic to assess consistency under the assumption of\n## a full design-by-treatment interaction random effects model\n## \n##                     Q df p-value tau.within tau2.within\n## Between designs 18.09 11  0.0795     0.0799      0.0064\nnetsplit(net_con)## Separate indirect from direct evidence (SIDE) using back-calculation method\n## \n## Fixed effects model: \n## \n##                    comparison  k prop     nma  direct  indir.    Diff     z p-value\n##                 control:Early  7 0.78 -0.0422 -0.1047  0.1783 -0.2830 -2.93  0.0034\n##                  control:Late 11 0.68 -0.0630 -0.0674 -0.0536 -0.0138 -0.34  0.7329\n##             control:Late_plus  6 0.47 -0.1609 -0.2666 -0.0672 -0.1993 -3.54  0.0004\n##           control:Recommended 19 0.94 -0.0574 -0.0486 -0.1936  0.1451  1.88  0.0604\n##      control:Recommended_plus 17 0.89 -0.1039 -0.0989 -0.1432  0.0443  0.64  0.5198\n##                    Early:Late  6 0.45 -0.0208 -0.1503  0.0858 -0.2361 -2.85  0.0044\n##               Early:Late_plus  0    0 -0.1187       . -0.1187       .     .       .\n##             Early:Recommended  6 0.37 -0.0152 -0.0778  0.0222 -0.0999 -1.16  0.2445\n##        Early:Recommended_plus  6 0.39 -0.0618 -0.1506 -0.0042 -0.1463 -1.68  0.0939\n##                Late:Late_plus  3 0.57 -0.0980 -0.0684 -0.1366  0.0682  1.24  0.2142\n##              Late:Recommended 11 0.79  0.0055  0.0041  0.0110 -0.0069 -0.16  0.8755\n##         Late:Recommended_plus 11 0.74 -0.0410 -0.0473 -0.0233 -0.0240 -0.51  0.6086\n##         Late_plus:Recommended  3 0.34  0.1035  0.1602  0.0743  0.0859  1.43  0.1538\n##    Late_plus:Recommended_plus  3 0.58  0.0570 -0.0018  0.1396 -0.1414 -2.47  0.0136\n##  Recommended:Recommended_plus 17 0.92 -0.0465 -0.0359 -0.1619  0.1259  1.63  0.1025\n## \n## Random effects model: \n## \n##                    comparison  k prop     nma  direct  indir.    Diff     z p-value\n##                 control:Early  7 0.77 -0.0481 -0.0874  0.0857 -0.1731 -1.31  0.1907\n##                  control:Late 11 0.79 -0.1249 -0.1317 -0.0986 -0.0331 -0.34  0.7362\n##             control:Late_plus  6 0.70 -0.1893 -0.2440 -0.0611 -0.1830 -1.56  0.1198\n##           control:Recommended 19 0.96 -0.0876 -0.0863 -0.1148  0.0285  0.17  0.8613\n##      control:Recommended_plus 17 0.93 -0.1378 -0.1314 -0.2165  0.0851  0.62  0.5336\n##                    Early:Late  6 0.61 -0.0768 -0.1225 -0.0054 -0.1171 -0.95  0.3415\n##               Early:Late_plus  0    0 -0.1412       . -0.1412       .     .       .\n##             Early:Recommended  6 0.52 -0.0395 -0.0841  0.0093 -0.0934 -0.80  0.4233\n##        Early:Recommended_plus  6 0.54 -0.0897 -0.1605 -0.0058 -0.1548 -1.31  0.1915\n##                Late:Late_plus  3 0.66 -0.0644 -0.0459 -0.1013  0.0554  0.46  0.6476\n##              Late:Recommended 11 0.81  0.0373  0.0366  0.0401 -0.0035 -0.03  0.9728\n##         Late:Recommended_plus 11 0.83 -0.0129 -0.0506  0.1695 -0.2201 -1.97  0.0487\n##         Late_plus:Recommended  3 0.52  0.1017  0.1468  0.0528  0.0940  0.83  0.4041\n##    Late_plus:Recommended_plus  3 0.54  0.0515  0.0043  0.1076 -0.1034 -0.90  0.3656\n##  Recommended:Recommended_plus 17 0.96 -0.0502 -0.0496 -0.0646  0.0150  0.08  0.9379\n## \n## Legend:\n##  comparison - Treatment comparison\n##  k          - Number of studies providing direct evidence\n##  prop       - Direct evidence proportion\n##  nma        - Estimated treatment effect (MD) in network meta-analysis\n##  direct     - Estimated treatment effect (MD) derived from direct evidence\n##  indir.     - Estimated treatment effect (MD) derived from indirect evidence\n##  Diff       - Difference between direct and indirect treatment estimates\n##  z          - z-value of test for disagreement (direct versus indirect)\n##  p-value    - p-value of test for disagreement (direct versus indirect)\nnm1 <- netmeasures(net_con)\n\nplot(\n   nm1$meanpath,\n   nm1$minpar,\n   pch = \"\",\n   xlab = \"Mean path length\",\n   ylab = \"Minimal parallelism\"\n)\ntext(nm1$meanpath, nm1$minpar, names(nm1$meanpath), cex = 0.8)\nsave(PM_dat_Y,\n     PM_mv,\n     contrast_Ssum,\n     file = here(\"cache/Meta-analysisData.Rdata\"))"},{"path":"powdery-mildew-severity-meta-analysis.html","id":"powdery-mildew-severity-meta-analysis","chapter":"5 Powdery mildew severity Meta-analysis","heading":"5 Powdery mildew severity Meta-analysis","text":"additional question main aim: spray schedule similar effect disease severity?model similar grain yield meta-analysis use main variables:Powdery mildew severity response variable (1-9 scale)Powdery mildew severity response variable (1-9 scale)Trial, resolves combinations categorical random variables:\nyear\nlocation\nrow spacing\ncultivar\nTrial, resolves combinations categorical random variables:yearlocationrow spacingcultivarspray_management moderator evaluate difference effect size attributed fungicide application timing.spray_management moderator evaluate difference effect size attributed fungicide application timing.id random variable indicating treatment independentid random variable indicating treatment independentLoad libraries data","code":"\nif (!require(\"pacman\"))\n   install.packages(\"pacman\")\npacman::p_load(tidyverse,\n               kableExtra,\n               bomrang,\n               RColorBrewer,\n               metafor,\n               here,\n               netmeta,\n               multcomp,\n               dplyr,\n               flextable)\n\nif (!require(\"theme.usq\"))\n   remotes::install_github(\"adamhsparks/theme.usq\")\nlibrary(theme.usq)\ntheme_set(theme_usq())\nsource(here(\"R/reportP.R\"))\n\n# Data\nPM_dat_D <-\n   read.csv(\"cache/PM_disease_clean_data.csv\", stringsAsFactors = FALSE)"},{"path":"powdery-mildew-severity-meta-analysis.html","id":"define-trial-1","chapter":"5 Powdery mildew severity Meta-analysis","heading":"5.0.1 Define Trial","text":"Inspect disease severity normality.","code":"\nPM_dat_D <-\n   PM_dat_D %>%\n   mutate(trial = paste(trial_ref,\n                        year,\n                        location,\n                        host_genotype,\n                        row_spacing,\n                        sep = \"_\")) \nhist(PM_dat_D$PM_final_severity)"},{"path":"powdery-mildew-severity-meta-analysis.html","id":"disease-severity-spray-schedule-meta-analysis","chapter":"5 Powdery mildew severity Meta-analysis","heading":"5.1 Disease severity spray schedule meta-analysis","text":"spray schedules effective lowering disease severity end season.\nRecommended_plus reduced powdery mildew incidence .","code":"\nPMsev_mv <- rma.mv(\n   yi = PM_final_severity,\n   vi,\n   mods = ~ spray_management,\n   method = \"ML\",\n   random = list( ~ spray_management | trial, ~ 1 | id),\n   struct = \"UN\",\n   control = list(optimizer = \"optim\"),\n   data = PM_dat_D\n)## Warning in rma.mv(yi = PM_final_severity, vi, mods = ~spray_management, : There\n## are outcomes with non-positive sampling variances.## Warning in rma.mv(yi = PM_final_severity, vi, mods = ~spray_management, : 'V'\n## appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\nsummary(PMsev_mv)## \n## Multivariate Meta-Analysis Model (k = 147; method: ML)\n## \n##    logLik   Deviance        AIC        BIC       AICc \n## -141.8960        Inf   337.7920   418.5336   350.4978   \n## \n## Variance Components:\n## \n##             estim    sqrt  nlvls  fixed  factor \n## sigma^2    0.0367  0.1916    147     no      id \n## \n## outer factor: trial            (nlvls = 22)\n## inner factor: spray_management (nlvls = 6)\n## \n##             estim    sqrt  k.lvl  fixed             level \n## tau^2.1    1.5387  1.2405     37     no           control \n## tau^2.2    3.1114  1.7639     13     no             Early \n## tau^2.3    0.8044  0.8969     15     no              Late \n## tau^2.4    0.0609  0.2468     13     no         Late_plus \n## tau^2.5    4.3670  2.0897     28     no       Recommended \n## tau^2.6    9.5330  3.0875     41     no  Recommended_plus \n## \n##                   rho.cntr  rho.Erly  rho.Late  rho.Lt_p  rho.Rcmm  rho.Rcm_ \n## control                  1    0.9461    0.9847    0.9972    0.9450    0.8654   \n## Early               0.9461         1    0.9810    0.0000    0.8850    0.9806   \n## Late                0.9847    0.9810         1    0.9888    0.8986    0.9253   \n## Late_plus           0.9972    0.0000    0.9888         1    0.9524    0.8969   \n## Recommended         0.9450    0.8850    0.8986    0.9524         1    0.8158   \n## Recommended_plus    0.8654    0.9806    0.9253    0.8969    0.8158         1   \n##                   cntr  Erly  Late  Lt_p  Rcmm  Rcm_ \n## control              -    no    no    no    no    no \n## Early                7     -    no   yes    no    no \n## Late                 9     6     -    no    no    no \n## Late_plus            4     0     1     -    no    no \n## Recommended         18     6     9     1     -    no \n## Recommended_plus    16     6     9     1    16     - \n## \n## Test of Moderators (coefficients 2:6):\n## QM(df = 5) = 233.2206, p-val < .0001\n## \n## Model Results:\n## \n##                                   estimate      se     zval    pval    ci.lb \n## intrcpt                             7.5456  0.2741  27.5283  <.0001   7.0083 \n## spray_managementEarly              -0.7874  0.1941  -4.0562  <.0001  -1.1678 \n## spray_managementLate               -0.6906  0.1154  -5.9851  <.0001  -0.9167 \n## spray_managementLate_plus          -1.2617  0.2362  -5.3414  <.0001  -1.7246 \n## spray_managementRecommended        -1.1094  0.2625  -4.2269  <.0001  -1.6238 \n## spray_managementRecommended_plus   -3.3270  0.5144  -6.4680  <.0001  -4.3351 \n##                                     ci.ub \n## intrcpt                            8.0828  *** \n## spray_managementEarly             -0.4069  *** \n## spray_managementLate              -0.4644  *** \n## spray_managementLate_plus         -0.7987  *** \n## spray_managementRecommended       -0.5950  *** \n## spray_managementRecommended_plus  -2.3188  *** \n## \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"powdery-mildew-severity-meta-analysis.html","id":"disease-severity-moderator-contrasts","chapter":"5 Powdery mildew severity Meta-analysis","heading":"5.1.1 Disease severity moderator contrasts","text":"Calculate treatment contrastscontrastcoefficientsStdErrZvaluepvalssigEarly - control-8.33300.2647-31.48070.0001***Late - control-8.23610.3660-22.50340.0001***Late_plus - control-8.80720.5020-17.54250.0001***Recommended - control-8.65500.2574-33.62560.0001***Recommended_plus - control-10.87260.4350-24.99680.0001***Late - Early0.09680.22250.43510.6635Late_plus - Early-0.47430.3576-1.32630.1848Recommended - Early-0.32200.2807-1.14710.2513Recommended_plus - Early-2.53960.3451-7.36000.0001***Late_plus - Late-0.57110.1800-3.17230.0015**Recommended - Late-0.41880.3342-1.25320.2101Recommended_plus - Late-2.63640.5391-4.89070.0001***Recommended - Late_plus0.15230.43280.35190.7249Recommended_plus - Late_plus-2.06530.6645-3.10810.0019**Recommended_plus - Recommended-2.21760.4821-4.60040.0001***Recommended_plus limited disease severity significantly better spray treatment.\nLate_plus limited disease severity significantly better single Late application.\nindicates two spray treatments significantly better single application, timing fungicide application critical.","code":"\nsource(\"R/simple_summary.R\") #function to provide a table that includes the treatment names in the contrasts\n\ncontrast_Ssum <-\n   simple_summary(summary(glht(PMsev_mv, linfct = cbind(\n      contrMat(rep(1, 6), type = \"Tukey\")\n   )), test = adjusted(\"none\")))\n\ncontrast_Ssum %>%\n   flextable()%>%\n   autofit()\npar(mar = c(5, 13, 4, 2) + 0.1)\nplot(glht(PMsev_mv, linfct = cbind(contrMat(rep(\n   1, 6\n), type = \"Tukey\"))), yaxt = 'n')\naxis(\n   2,\n   at = seq_along(contrast_Ssum$contrast),\n   labels = rev(contrast_Ssum$contrast),\n   las = 2,\n   cex.axis = 0.8\n)"},{"path":"powdery-mildew-severity-meta-analysis.html","id":"meta-analysis-summary-table","chapter":"5 Powdery mildew severity Meta-analysis","heading":"5.1.2 Meta-analysis summary table","text":"\n(#tab:metafor_results)Table 3: Estimated powdery mildew severity mean difference (\\(u\\)) spray control (intercept) spray schedule treatment. Estimates calculated network meta-analysis data obtained grey literature reports (k) field trials undertaken Eastern Australia. P values indicate statistical significance comparison intercept.\nEffect SizePM controlModeratorNakbmucCI_{L}dCI_{U}ePfEfficacygEff CI_lowerdEff CI uppereEarly133-0.7874-1.1678-0.4069< 0.000110.435.3915.48Recommended2812-1.1094-1.6238-0.5950< 0.000114.707.8821.52Recommended+4111-3.3270-4.3351-2.3188< 0.000144.0930.7357.45Late155-0.6906-0.9167-0.4644< 0.00019.156.1512.15Late+132-1.2617-1.7246-0.7987< 0.000116.7210.5922.86anumber treatment means categorised spray schedule; bnumber trials respective spray schedule; cestimated mean yield determined meta-analysis; dLower range 95% confidence interval; eUpper range 95% confidence interval; findicates significance respective spray schedule spray control (intercept); gFungicide spray schedule efficacy; dLower range 95% confidence interval; eUpper range 95% confidence interval","code":"\n# obtain number of treatments included in each moderator variable\nk5 <-\n   as.data.frame(table(PM_dat_D$spray_management)) %>%\n   filter(Freq != 0) %>%\n   pull(Freq)\n\nk6 <-\n   as.data.frame(table(PM_dat_D$trial_ref, PM_dat_D$spray_management)) %>%\n   filter(Freq != 0) %>%\n   group_by(Var2) %>%\n   summarise(n()) %>%\n   pull()\n\nintercept <- round(PMsev_mv$b, 4)[1,1]\n\n# create data.frame\nresults_mv <- data.frame(\n   Moderator = c(\n   \"Intercept / No Spray control\",\n   \"Early\",\n   \"Late\",\n   \"Late+\",\n   \"Recommended\",\n   \"Recommended+\"\n   ),\n   N = k5,\n   k = k6,\n   Effect = round(PMsev_mv$b, 4),\n   se = round(PMsev_mv$se, 4),\n   CI_lower = round(PMsev_mv$ci.lb, 4),\n   CI_upper = round(PMsev_mv$ci.ub, 4),\n   z_val = round(PMsev_mv$zval, 4),\n   p_val = reportP(PMsev_mv$pval, AsNumeric = FALSE, P_prefix = FALSE),\n   eff_bar = round(1 -(intercept + PMsev_mv$b)/intercept,4)*100,\n   eff_CI_high = round(1 -(intercept + PMsev_mv$ci.ub)/intercept,4)*100,\n   eff_CI_low = round(1 -(intercept + PMsev_mv$ci.lb)/intercept,4)*100\n   \n)\n\n# rename colnames to give table headings\ncolnames(results_mv)[c(1:4,6:12 )] <-\n   c(\"Moderator\",\n     \"N\",\n     \"k\",\n     \"mu\",\n     \"CI_{L}\",\n     \"CI_{U}\",\n     \"Z\",\n     \"P\",\n     \"Efficacy\",\n     \"Eff CI_lower\",\n     \"Eff CI upper\")\n\ndisease_estimates_table <-\n   flextable(results_mv[c(2,5,6,3,4), c(1:4,6:7, 9:12)]) %>%\n   align(j = 2:10, align = \"center\", part = \"all\") %>%\n   fontsize(size = 8, part = \"body\") %>%\n   fontsize(size = 10, part = \"header\") %>%\n   italic(italic = TRUE, part = \"header\") %>%\n   set_caption(\n      \"Table 3: Estimated powdery mildew severity mean difference ($u$) to the no spray control (intercept) for each spray schedule treatment. Estimates were calculated from a network meta-analysis of data obtained from grey literature reports of (k) field trials undertaken in Eastern Australia. P values indicate statistical significance in comparison to the intercept.\"\n   ) %>%\n   autofit() %>%\n   footnote(\n      i = 1,\n      j = c(2:10),\n      value = as_paragraph(\n         c(\n            \"number of treatment means categorised to each spray schedule\",\n            \"number of trials with the respective spray schedule\",\n            \"estimated mean yield determined by the meta-analysis\",\n            \"Lower range of the 95% confidence interval\",\n            \"Upper range of the 95% confidence interval\",\n            \"indicates the significance between each respective spray schedule and the no spray control (intercept)\",\n            \"Fungicide spray schedule efficacy\",\n            \"Lower range of the 95% confidence interval\",\n            \"Upper range of the 95% confidence interval\"\n         )\n      ),\n      ref_symbols = letters[c(1:7,4,5)],\n      part = \"header\",\n      inline = TRUE\n   )%>%\n   add_header(Moderator = \"\",\n              N = \"\",\n              k = \"\",\n              mu = \"Effect Size\",\n              `CI_{L}` = \"Effect Size\",\n              `CI_{U}` = \"Effect Size\",\n              P  = \"Effect Size\",\n              Efficacy = \"PM control\",\n              `Eff CI_lower` = \"PM control\",\n              `Eff CI upper` = \"PM control\") %>%\n   merge_h( part = \"header\")%>%\n   hline_top(part=\"all\", border = officer::fp_border(color = \"black\", width = 2) )\n\ndisease_estimates_table"}]
