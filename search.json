[{"path":"index.html","id":"about","chapter":"1 About","heading":"1 About","text":"","code":""},{"path":"index.html","id":"background","chapter":"1 About","heading":"1.1 Background","text":"common practice managing powdery mildew mungbean couple fungicide insecticide spray early development crop, usually disease detected. despite current recommendations best yield protection achieved fungicide first applied first sign disease. recommendations based individual studies, many lacked sufficient power draw significant conclusions. undertook meta-analysis determine, first fungicide spray applied mungbean maximise yield protection.","code":""},{"path":"index.html","id":"compendium-contents","chapter":"1 About","heading":"1.2 Compendium contents","text":"research compendium details importing summarising raw data, application selection criteria, defining moderator variables fungicide spray timing, statistical analysis methods meta-analysis fungicide efficacy trials controlling powdery mildew mungbean.\nmeta-analysis’s main aim determine:optimum time spray fungicide limit effect powdery mildew mungbean yields?completeness, also evaluated efficacy spray schedules disease severity field.","code":""},{"path":"index.html","id":"main-chapters","chapter":"1 About","heading":"1.3 Main chapters","text":"compendium broken four sections:Details experiments, application inclusion criteria analysisPreliminary data explorationincluding summary cleaned trial data treatmentsGrain yield meta-analysisPowdery mildew severity Meta-analysisThese sections detail methods process undertook meta-analysis.","code":""},{"path":"index.html","id":"links-to-manuscript","chapter":"1 About","heading":"1.4 Links to manuscript","text":"preprint available agriRxiv: https://doi.org/10.31220/agriRxiv.2021.00042.","code":""},{"path":"index.html","id":"acknowledgments","chapter":"1 About","heading":"1.5 Acknowledgments","text":"meta-analysis carried funding assistance Grains Research Development Corporation Australia Western Australia Agriculture Authority. Raw data work contributed University Southern Queensland, Queensland Department Agriculture, Fisheries Forestry (DAF), Northern Grower Alliance. Additional thanks Malcolm Riley, Sue Thompson Lawrie Price.","code":""},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"trials-considered-for-inclusion-in-meta-analysis","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2 Trials considered for inclusion in meta-analysis","text":"Trials testing fungicide efficacy powdery mildew mungbean Grains Research Development Corporation (GRDC) northern grains region sourced meta-analysis.Data collected number researchers Department Agriculture Fisheries (DAF), University Southern Queensland (USQ) Northern Growers Alliance (NGA).\nlike acknowledge particular Professor Malcolm Riley’s Dr. Sue Thompson’s effort establishing coordinating early field trials 2010 2014 GRDC funding many trials included meta-analysis.","code":""},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"load-required-r-packages","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.0.1 Load required R packages","text":"","code":"\nif (!require(\"pacman\"))\n   install.packages(\"pacman\")## Loading required package: pacman## Warning in library(package, lib.loc = lib.loc, character.only = TRUE,\n## logical.return = TRUE, : there is no package called 'pacman'## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependency 'remotes'\npacman::p_load(tidyverse, kableExtra, leaflet, htmltools, lubridate, here)## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependencies 'colorspace', 'sys', 'bit', 'ps', 'rematch', 'farver', 'labeling', 'munsell', 'RColorBrewer', 'viridisLite', 'askpass', 'bit64', 'prettyunits', 'processx', 'backports', 'generics', 'assertthat', 'blob', 'DBI', 'lifecycle', 'tidyselect', 'withr', 'data.table', 'gargle', 'uuid', 'cellranger', 'curl', 'ids', 'rematch2', 'gtable', 'isoband', 'scales', 'cpp11', 'pkgconfig', 'mime', 'openssl', 'Rcpp', 'utf8', 'clipr', 'vroom', 'tzdb', 'progress', 'callr', 'selectr', 'broom', 'cli', 'crayon', 'dbplyr', 'dplyr', 'dtplyr', 'forcats', 'googledrive', 'googlesheets4', 'ggplot2', 'haven', 'hms', 'httr', 'lubridate', 'modelr', 'pillar', 'purrr', 'readr', 'readxl', 'reprex', 'rstudioapi', 'rvest', 'tibble', 'tidyr'## \n## tidyverse installed## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependencies 'systemfonts', 'webshot', 'svglite'## \n## kableExtra installed## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependencies 'lazyeval', 'gridExtra', 'crosstalk', 'htmlwidgets', 'markdown', 'png', 'raster', 'sp', 'viridis', 'leaflet.providers'## \n## leaflet installed## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependency 'rprojroot'## \n## here installed"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"criteria-for-inclusion-in-meta-analysis","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.1 Criteria for inclusion in meta-analysis","text":"field trial testing efficacy fungicide powdery mildew afflicted mungbean plants eastern Australia.Trial data needed include:\nFungicide active ingredients.\ndemethylase inhibitor (DMI) fungicide.\ndate powdery mildew first appeared trial.\nDisease severity end growing seasons.\nFungicide application dates.\nFungicide dose.\nCrop yield.\nTreatment means accompanying variance.\nFungicide active ingredients.demethylase inhibitor (DMI) fungicide.date powdery mildew first appeared trial.Disease severity end growing seasons.Fungicide application dates.Fungicide dose.Crop yield.Treatment means accompanying variance.","code":""},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"import-data","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.2 Import data","text":"Import data trials raw data availableImport dataset manual entriesImport dataset manually entered trial reportsBind raw transcribed datasets.","code":"\nPM_MB_raw <-\n   rbind(\n      read.csv(\n         here(\"cache/2010 PMmung Hermitage means.csv\"),\n         stringsAsFactors = FALSE\n      ),\n      read.csv(here(\"cache/2011 PMmung Herm means.csv\"), stringsAsFactors = FALSE),\n      read.csv(\n         here(\"cache/2011 PMmung Kingaroy means.csv\"),\n         stringsAsFactors = FALSE\n      ),\n      read.csv(here(\"cache/AM1305_Goolhi_means.csv\"), stringsAsFactors = FALSE),\n      read.csv(\n         here(\"cache/AM1304-MarysMount_means.csv\"),\n         stringsAsFactors = FALSE\n      ),\n      read.csv(\n         here(\"cache/AM1303-Premer-Disease_means.csv\"),\n         stringsAsFactors = FALSE\n      ),\n      read.csv(\n         here(\"cache/BB1305_Millmerran_means.csv\"),\n         stringsAsFactors = FALSE\n      ),\n      read.csv(here(\"cache/Herm_16_means.csv\"), stringsAsFactors = FALSE),\n      read.csv(here(\"cache/King_16_means.csv\"), stringsAsFactors = FALSE),\n      read.csv(here(\"cache/Fogerty_17_mean.csv\"), stringsAsFactors = FALSE),\n      read.csv(here(\"cache/Hermitage_17_mean.csv\"), stringsAsFactors = FALSE),\n      read.csv(here(\"cache/Wellcamp_18_mean.csv\"), stringsAsFactors = FALSE),\n      read.csv(here(\"cache/Hermitage_19_mean.csv\"), stringsAsFactors = FALSE)\n   )\nwrite.csv(\n   PM_MB_raw,\n   file = here(\"cache/PM_Mungbean_SummaryOfTrialsWithRawData\"),\n   row.names = FALSE\n)\nPM_MB_man <-\n   read.csv(here(\"cache/PM_Mungbean_DataManuallyEntered.csv\"),\n            stringsAsFactors = FALSE)\nPM_MB_dat <-\n   rbind(PM_MB_raw,\n         PM_MB_man)"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"summary-of-all-trials","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.3 Summary of all trials","text":"\n(#tab:data_summary)Description Experiments\n","code":"\nPM_MB_dat %>%\n   arrange(year, location) %>%\n   group_by(trial_ref) %>%\n   summarise(\n      Year = unique(year),\n      Location = unique(location),\n      `Replicates per treatment` = if (all(replicates[1] == replicates)) {\n         as.character(replicates[1])\n      } else{\n         as.character(paste(min(replicates), \"-\", max(replicates)))\n      },\n      `Trial design` = unique(trial_design),\n      `Planting date` = unique(planting_date),\n      `First sign of disease` = unique(first_sign_disease),\n      `Fungicide treatments` = length(n_treatment),\n   ) %>%\n   arrange(Year) %>%\n   kable(\n      caption = \"Description of Experiments\",\n      align = \"c\",\n      col.names = c(\n         \"Unique Trial\\nReference\",\n         \"Year\",\n         \"Location\",\n         \"Replicates\\nper treatments\",\n         \"Trial design\",\n         \"Planting date\",\n         \"First sign\\nof disease\",\n         \"Fungicide\\n treatments\"\n      )\n   )  %>%\n   kable_styling(fixed_thead = TRUE, full_width = TRUE) %>%\n   column_spec(c(3, 5:6), width = \"3cm\") %>%\n   scroll_box(height = \"500px\") "},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"experiment-locations","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.3.1 Experiment locations","text":"Trial locations occurring GRDC Northern Grains Region.","code":""},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"subset-data-to-selection-criteria","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.4 Subset data to selection criteria","text":"Let’s apply selection criteria dataset.\ntrials identified meta-analysis reported:fungicide active ingredient,dose,first sign disease.Therefore trials need removed satisfy criteria.Retain trials including: Yield\nThree trials omitted due reporting yieldsRetain trials including: Disease severity\nOne trial removed report disease severity.Retain trials including: fungicide application dates\ntrials subset need removed reporting fungicide application dates.Retain trials including: fungicide dose\ntrials subset need removed reporting fungicide dose.Exclude fungicides tested trials\nmeta-analysis focused fungicides mode action.\nFungicides best represented group retained.demethylation inhibitors (DMI), tebuconazole propiconazole, used highest frequencies.\nDMIs fungicide mode action good candidates pooled meta-analysis.Amistar Xtra Custodia contain strobilurin triazole, however, contain differing dose ratios (inverted) pooling may appropriate therefore removed.Retain fungicides DMI actionNow remove non-DMI treatments controls","code":"\nPM_MB_dat %>%\n   filter(is.na(grain_yield.t.ha.)) %>%\n   distinct(trial_ref, year, location)##     trial_ref year  location\n## 1 mung0102/01 2002 Bongeen_2\n## 2 mung0102/02 2002 Hermitage\n## 3 mung0102/03 2002 Hermitage\nPM_MB_dat <- PM_MB_dat %>%\n   filter(!is.na(grain_yield.t.ha.))\nPM_MB_dat %>%\n   filter(is.na(PM_final_severity)) %>%\n   distinct(trial_ref, year, location)##     trial_ref year location\n## 1 mung1415/02 2015    Dalby\nPM_MB_dat <- PM_MB_dat %>%\n   filter(!is.na(PM_final_severity))\nPM_MB_dat %>%\n   group_by(trial_ref) %>%\n   summarise(No_Record_Of_Fungicide_Application_Dates = all(is.na(fungicide_application_1)),\n             .groups = 'drop') %>%\n   filter(No_Record_Of_Fungicide_Application_Dates)## # A tibble: 0 × 2\n## # … with 2 variables: trial_ref <chr>,\n## #   No_Record_Of_Fungicide_Application_Dates <lgl>\nPM_MB_dat %>%\n   group_by(trial_ref) %>%\n   summarise(No_Record_Of_Fungicide_Dose = all(is.na(dose_ai.ha)),\n             .groups = 'drop') %>%\n   filter(No_Record_Of_Fungicide_Dose)## # A tibble: 0 × 2\n## # … with 2 variables: trial_ref <chr>, No_Record_Of_Fungicide_Dose <lgl>\nPM_MB_dat %>%\n   group_by(fungicide_ai, trial_ref) %>%\n   summarise() %>%\n   count(sort = TRUE) %>%\n   rename(Trials = n) %>%\n   ggplot(aes(x = reorder(fungicide_ai, Trials), y = Trials)) +\n   xlab(\"Fungicide active ingredient\") +\n   ylab(\"N Trials\") +\n   geom_col() +\n   ggtitle(label = \"Number of trials in which the\\nspecified fungicide was used\") +\n   coord_flip()## `summarise()` has grouped output by 'fungicide_ai'. You can override using the `.groups` argument.\nDMI_Trials <-\n   PM_MB_dat %>%\n   filter(fungicide_ai == \"tebuconazole\" |\n             fungicide_ai == \"propiconazole\") %>%\n   distinct(trial_ref) %>%\n   pull()\n\nPM_MB_dat <-\n   PM_MB_dat[PM_MB_dat$trial_ref %in% DMI_Trials, ]\nPM_MB_dat <-\n   PM_MB_dat %>%\n   filter(\n      fungicide_ai == \"control\" |\n         fungicide_ai == \"tebuconazole\" |\n         fungicide_ai == \"propiconazole\"\n   )"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"classify-dataset-variables","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.4.1 Classify dataset variables","text":"Importantly, class variable data defined, retaining variables relevant analysis.","code":"\nsource(\"R/classify_PM_data.R\") # use a custom code\n\n# classify dataset with Trials in both \nPM_MB_dat <-\n   classify_PM_data(PM_MB_dat)"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"defining-spray-schedule-variable","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.5 Defining spray schedule variable","text":"First going calculate time first sign disease fungicide applications.ensure sufficient number replicates, treatments binned first fungicide application date three categorical variables relating first fungicide application made, relative first sign disease.categorical variables named:\n- Early: First fungicide application prior first sign disease.\n- Recommended: First fungicide application applied day powdery mildew observed, within three days first sign.\n- Late: First fungicide application four days first sign disease observed.number follow-sprays need also defined.Simplify clusters data-setNow view number break-spray_management treatments yield disease severity data-sets‘Early_plus’ treatments number, treatments comparisons treatments meta-analysis provide accurate results. Therefore remove ‘Early_plus’ analysis.","code":"\n# collective data\nPM_MB_dat %<>%\n   mutate(fungicide_timing_1 = fungicide_application_1 - first_sign_disease) %>%\n   mutate(fungicide_timing_2 = fungicide_application_2 - fungicide_application_1) %>%\n   mutate(fungicide_timing_3 = fungicide_application_3 - fungicide_application_2)\ndata.frame(\n   TreatmentName = c(\n      \"Early\",\n      \"Recommended\",\n      \"Late\",\n      \"EarlyPlus\",\n      \"RecommendedPlus\",\n      \"LatePlus\"\n   ),\n   n_sprays = rep(c(\"Single\", \"Two - Three\"), each = 3),\n   DaysRelativeToFirstSign = c(\n      \"Prior to first sign of Powdery Mildew\",\n      \"1 - 3 days after first sign of Powdery Mildew\",\n      \"7 - 8 days after first sign of Powdery Mildew\"\n   )\n) %>%\n   kable()\nPM_MB_dat <- PM_MB_dat %>%\n   mutate(\n      spray_management = case_when(\n         fungicide_timing_1 < 0 &\n            is.na(fungicide_application_2) &\n            is.na(fungicide_application_3) ~ \"Early\",\n         fungicide_timing_1 >= 0 &\n            fungicide_timing_1 < 4 &\n            is.na(fungicide_application_2) &\n            is.na(fungicide_application_3) ~ \"Recommended\",\n         fungicide_timing_1 >= 4 &\n            is.na(fungicide_application_2) &\n            is.na(fungicide_application_3) ~ \"Late\",\n         fungicide_timing_1 < 0 &\n            !is.na(fungicide_application_2) ~ \"Early_plus\",\n         fungicide_timing_1 >= 0 &\n            fungicide_timing_1 < 4 &\n            !is.na(fungicide_application_2) ~ \"Recommended_plus\",\n         fungicide_timing_1 >= 4 &\n            !is.na(fungicide_application_2) ~ \"Late_plus\",\n         TRUE ~ \"Other\"\n      )\n   )\n\nPM_MB_dat[PM_MB_dat$fungicide_ai == \"control\",\n          c(\n             \"fungicide_timing_1\",\n             \"fungicide_timing_2\",\n             \"fungicide_timing_3\",\n             \"spray_management\"\n          )] <- \"control\"\ntable(PM_MB_dat$spray_management)## \n##          control            Early       Early_plus             Late \n##               40               13                5               17 \n##        Late_plus      Recommended Recommended_plus \n##               20               32               46\nPM_MB_dat <-\n   PM_MB_dat %>%\n   filter(spray_management != \"Early_plus\") %>%\n   select(-c(fungicide_timing_1, # remove the following columns which no longer have use\n             fungicide_timing_2,\n             fungicide_timing_3,\n             fungicide_application_1,\n             fungicide_application_2,\n             fungicide_application_3,\n             fungicide_application_4,\n             fungicide_application_5,\n             fungicide_application_6,\n             fungicide_application_7,\n             ))"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"identify-variance","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.6 Identify variance","text":"need variance accompanying mean observations treatment successfully undertake meta-analysis.\nLet’s investigate included trials included variance response variables interest, yield disease severity.Remove one trial Emerald report disease variance yield variance.Following inspection yield disease variance determined imputation suitable therefore must exclude trials report variance.\nanalysis, yield disease severity separate data-set created, including trials report variance respective response variableOne trial removed yield data set PM_dat_Y reporting yield variance.Two trials removed disease severity data set PM_dat_D reporting yield variance.","code":"\nPM_MB_dat %>%\n   mutate(MA_analysis = case_when(\n      is.na(yield_error & disease_error) == FALSE ~ \"Yield and Disease\",\n      is.na(yield_error) == FALSE & \n         is.na(disease_error) ~ \"Yield\",\n      is.na(disease_error) == FALSE & \n         is.na(yield_error) ~ \"Disease\",\n      TRUE ~ \"Nil\"\n   )) %>%\n   distinct(trial_ref, location, year, MA_analysis) %>%\n   arrange(year) %>%\n   kable()\n# Remove trials without variance for both Disease and yield for data_set `PM_MB_dat\nPM_MB_dat <- \n   PM_MB_dat %>%\n   mutate(contains_var = case_when(\n      is.na(yield_error) &\n         is.na(disease_error) ~ NA_character_,\n      TRUE ~ trial_ref)) %>%\n   filter(trial_ref %in% contains_var) %>%\n   select(-contains_var) \nPM_MB_dat %>%\n   mutate(No_Var = is.na(yield_error)) %>%\n   filter(No_Var == TRUE) %>%\n   distinct(trial_ref, year, location)##     trial_ref year location\n## 1 mung1112/01 2012   Gatton\nPM_dat_Y <- \n   PM_MB_dat %>%\n   mutate(contains_var = case_when(\n      is.na(yield_error) ~ NA_character_,\n      TRUE ~ trial_ref)) %>%\n   filter(trial_ref %in% contains_var) %>%\n   select(-contains_var)\nPM_MB_dat %>%\n   mutate(No_Var = is.na(disease_error)) %>%\n   filter(No_Var == TRUE) %>%\n   distinct(trial_ref, year, location)##     trial_ref year  location\n## 1 mung1516/01 2016 Hermitage\n## 2 mung1516/02 2016  Kingaroy\nPM_dat_D <- \n   PM_MB_dat %>%\n   mutate(contains_var = case_when(\n      is.na(disease_error) ~ NA_character_,\n      TRUE ~ trial_ref)) %>%\n   filter(trial_ref %in% contains_var) %>%\n   select(-contains_var)"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"standardise-variance","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.7 Standardise Variance","text":"variance types need converted sample variance.\nFirst start standardising yield variance according method reported Ngugi et.al (2011).","code":""},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"yield-variance-standardisation","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.7.1 Yield variance standardisation","text":"","code":"\nPM_dat_Y <-\n   PM_dat_Y %>%\n   mutate(\n      vi =\n         case_when(\n            Y_error_type == \"stdev\" ~ yield_error ^ 2,\n            Y_error_type == \"lsd (P=0.05)\" ~\n               (replicates * ((yield_error / 1.96) ^ 2) / 2)\n         ),\n      id = row_number(),\n      spray_management = fct_relevel(spray_management, sort)\n   ) %>%\n   select(-c(yield_error,\n             Y_error_type))"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"disease-severity-variance-standardisation","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.7.2 Disease severity variance standardisation","text":"","code":"\nPM_dat_D <-\n   PM_dat_D %>%\n   mutate(\n      vi =\n         case_when(\n            D_error_type == \"stdev\" ~ disease_error ^ 2,\n            D_error_type == \"lsd (P=0.05)\" ~\n               (replicates * ((disease_error / 1.96) ^ 2) / 2)\n         ),\n      id = row_number(),\n      spray_management = fct_relevel(spray_management, sort)\n   ) %>%\n   select(-c(disease_error,\n             D_error_type))"},{"path":"trials-considered-for-inclusion-in-meta-analysis.html","id":"save-the-cleaned-data","chapter":"2 Trials considered for inclusion in meta-analysis","heading":"2.7.2.1 Save the cleaned data","text":"","code":"\nwrite.csv(PM_dat_Y, file = \"cache/PM_yield_clean_data.csv\", row.names = FALSE)\nwrite.csv(PM_dat_D, file = \"cache/PM_disease_clean_data.csv\", row.names = FALSE)\nwrite.csv(PM_MB_dat, file = \"cache/PM_MB_clean_data.csv\", row.names = FALSE)\nsave(PM_MB_dat, PM_dat_D, PM_dat_Y, file = here(\"cache/ImportDataAndSelectTrials01.Rdata\"))"},{"path":"preliminary-analysis.html","id":"preliminary-analysis","chapter":"3 Preliminary Analysis","heading":"3 Preliminary Analysis","text":"\n## Define powdery mildew severity\nPowdery mildew severity assessed 1 - 9 scale.\n(#tab:disease_scale)Table 2: Powdery mildew severity rating scale calculated percent severity ordinal rating\nSeverity ratingDescriptionEquivalent percent severity1No sign powdery mildew0.002Small colonies lower 1/3 canopy 75% plants infected16.503Colonies lower half canopy 75% plants infected43.504Colonies lower 2/3 canopy 75% plants infected49.505Colonies lower 2/3 canopy 75% plants infected57.426Colonies lower 2/3 canopy 100% plants infected66.007Colonies lower 2/3 canopy 100% plants infected, plants colonies top 1/3 canopy75.008Colonies way top plant 75% plants affected87.009Colonies way top plant severe leaf drop100.00","code":"\nif (!require(\"pacman\"))\n   install.packages(\"pacman\")## Loading required package: pacman\npacman::p_load(tidyverse,\n               lubridate,\n               openxlsx,\n               devtools,\n               remotes,\n               reshape2,\n               lme4,\n               kableExtra,\n               flextable,\n               here,\n               gridExtra)## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependency 'zip'## \n## openxlsx installed## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependencies 'credentials', 'gitcreds', 'ini', 'diffobj', 'gert', 'gh', 'whisker', 'cachem', 'xopen', 'brew', 'commonmark', 'praise', 'waldo', 'usethis', 'desc', 'memoise', 'pkgbuild', 'pkgload', 'rcmdcheck', 'roxygen2', 'rversions', 'sessioninfo', 'testthat'## \n## devtools installed## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependency 'plyr'## \n## reshape2 installed## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependencies 'minqa', 'nloptr', 'RcppEigen'## \n## lme4 installed## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependencies 'officer', 'gdtools'## \n## flextable installed\nload(\"cache/ImportDataAndSelectTrials01.Rdata\")\nd_rating_table <-\n   data.frame(\n      Severity_rating = 1:9,\n      Description = c(\n         \"No sign of powdery mildew\",\n         \"Small colonies in the lower 1/3 of canopy with up to 75% of plants infected\",\n         \"Colonies in lower half of canopy with more than 75% of plants infected\",\n         \"Colonies in lower 2/3 of canopy with up to 75% of plants infected\",\n         \"Colonies in lower 2/3 of canopy with more than 75% of plants infected\",\n         \"Colonies in lower 2/3 of canopy with 100% of plants infected\",\n         \"Colonies in lower 2/3 of canopy with 100% of plants infected, some plants with colonies in the top 1/3 of the canopy\",\n         \"Colonies all the way to the top of the plant with more than 75% of plants affected\",\n         \"Colonies all the way to the top of the plant with severe leaf drop\"\n      ),\n      percent = c(0,0.33 * 0.5, 0.5 * 0.87, 0.66*0.75, 0.66 * 0.87,\n                  0.66, 0.75, 0.87, 1) *100\n   ) %>%\n   flextable() %>%\n   fontsize(size = 8, part = \"body\") %>%\n   fontsize(size = 10, part = \"header\") %>%\n   autofit() %>%\n   set_header_labels(Severity_rating = \"Severity rating\",\n                     percent = \"Equivalent percent severity\") %>%\n   width(j = 1, width = 0.8) %>%\n   width(j = 2, width = 4) %>%\n   width(j = 3, width = 1.2) %>%\n   align(j = 1, align = \"center\") %>%\n   set_caption(\"Table 2: Powdery mildew severity rating scale and calculated percent severity for each ordinal rating\")\nd_rating_table"},{"path":"preliminary-analysis.html","id":"trial-summary-statistics","chapter":"3 Preliminary Analysis","heading":"3.1 Trial summary statistics","text":"data explored PM_MB_dat data frame clean data frame focusing trials met selection criteria testing DMI fungicides (tebuconazole / propiconazole) spray controls.","code":""},{"path":"preliminary-analysis.html","id":"trial-seasons","chapter":"3 Preliminary Analysis","heading":"3.1.1 Trial seasons","text":"many trials undertaken season.yearn2011220122201342015120162201722018120192","code":"\nPM_MB_dat %>%\n   distinct(trial_ref, location, year) %>%\n   arrange(year) %>%\n   group_by(year) %>%\n   summarise(n = n())%>%\n   flextable()"},{"path":"preliminary-analysis.html","id":"trial-locations","chapter":"3 Preliminary Analysis","heading":"3.1.2 Trial locations","text":"location trials including DMI fungicides.locationnGatton1Goolhi1Hermitage6Kingaroy3Marys Mount1Millmerran1Missen Flats1Premer1Wellcamp1","code":"\nPM_MB_dat %>%\n   distinct(trial_ref, location, year) %>%\n   group_by(location) %>%\n   summarise(n = n())%>%\n   flextable()"},{"path":"preliminary-analysis.html","id":"powdery-mildew-severity-and-mungbean-grain-yield-summary-per-trial","chapter":"3 Preliminary Analysis","heading":"3.1.3 Powdery mildew severity and mungbean grain yield summary per trial","text":"Show summary powdery mildew severity mungbean grain yield means ranges trials including DMI fungicides.\n(#tab:Full_Trial_Summary_table)Table 1: Mean yield severity trials included meta-analysis. Powdery mildew (PM) onset date, number treatments per trial (n), PM median plot severity non-fungicide treated plots severity range fungicide treatments, bracketed numbers refer number pooled control treatments summarised; Mean yield non-fungicide treated control range yields fungicide treatments tonnes per hectare\nTrial codeLocationYearSowing datePM onsetnControl medianPM severityPM severityrangeControlmedian yieldYield range(t / ha)1011/01Hermitage20112011-01-242011-03-2844.83 (2)2 - 2.331.5251.544 - 1.7691011/02Kingaroy20112011-02-022011-03-2267.83 (2)3.33 - 5.330.7980.73 - 1.0591112/01Gatton20122012-02-202012-04-0277.5 (1)2 - 6.30.7380.81 - 0.9481112/02aKingaroy20122012-02-032012-03-1278 (1)1.7 - 80.7511.036 - 1.323AM1303Premer20132012-12-282013-02-2848 (1)2 - 7.831.4221.334 - 1.45AM1304Marys Mount20132012-12-242013-03-1623 (1)3.17 - 3.171.0941.265 - 1.265AM1305Goolhi20132013-01-232013-03-2549 (1)1 - 3.750.6940.604 - 0.722BB1305Millmerran20132013-01-122013-03-1348 (1)1.62 - 80.8020.744 - 0.8031415/01Hermitage20152015-01-192015-03-1657.8 (1)5.4 - 6.62.0452.018 - 2.1761516/01Hermitage20162016-02-032016-03-0878 (1)3 - 7.51.8032.141 - 2.371516/02bKingaroy20162016-02-112016-03-0978.25 (1)2.25 - 7.750.8110.873 - 1.0341617/01bHermitage20172017-02-132017-03-24398 (9)5.33 - 80.4740.327 - 0.6831617/02Missen Flats20172017-01-272017-03-07399 (9)7.67 - 91.5051.13 - 2.5261718/01Wellcamp20182018-02-132018-03-21188.17 (6)5.67 - 7.671.0911.084 - 1.691819/01Hermitage20192018-02-042018-04-1247.5 (1)5 - 7.170.5870.543 - 0.5711819/02Hermitage20192018-02-182018-04-1247.83 (1)4.6 - 7.330.2890.276 - 0.312aTrials reported PM severity variance yield variance therefore excluded yield protection meta-analysis;bTrials report powdery mildew (PM) severity variance therefore excluded PM severity meta-analysis","code":"\nSev_yield_table <-\n   PM_MB_dat %>%\n   mutate(PM_sev_control = case_when(fungicide_ai == \"control\" ~ PM_final_severity,\n                                     TRUE ~ NA_real_)) %>%\n   mutate(PM_sev_treat = case_when(fungicide_ai != \"control\" ~ PM_final_severity,\n                                   TRUE ~ NA_real_)) %>%\n   mutate(PM_y_control = case_when(fungicide_ai == \"control\" ~ grain_yield.t.ha.,\n                                   TRUE ~ NA_real_)) %>%\n   mutate(PM_y_treat = case_when(fungicide_ai != \"control\" ~ grain_yield.t.ha.,\n                                 TRUE ~ NA_real_)) %>%\n   mutate(trial_ref = str_remove(trial_ref, \"mung\")) %>%  # remove \"mung\" prefix from trial_ref\n   group_by(trial_ref,\n            location,\n            year,\n            planting_date,\n            first_sign_disease) %>%\n   summarise(\n      n = n(),\n      m_PM_sev_control = round(median(PM_sev_control, na.rm = TRUE), digits = 2),\n      n_controls = sum(is.na(PM_sev_control) == FALSE),\n      min_PM_sev = round(min(PM_sev_treat, na.rm = TRUE), digits = 2),\n      max_PM_sev = round(max(PM_sev_treat, na.rm = TRUE), digits = 2),\n      m_PM_yield_control = round(median(PM_y_control, na.rm = TRUE), digits = 3),\n      min_PM_yield = round(min(PM_y_treat, na.rm = TRUE), digits = 3),\n      max_PM_yield = round(max(PM_y_treat, na.rm = TRUE), digits = 3),\n      .groups = \"drop\"\n   ) %>%\n   arrange(year) %>%\n   mutate(PM_sev_range = paste(min_PM_sev, max_PM_sev, sep = \" - \")) %>%\n   mutate(yield_range = paste(min_PM_yield, max_PM_yield, sep = \" - \")) %>%\n   mutate(m_PM_sev_control = paste(m_PM_sev_control, \" (\", n_controls, \")\", sep = \"\")) %>%\n   select(-c(min_PM_sev, max_PM_sev, min_PM_yield, max_PM_yield, n_controls)) %>%\n   select(c(1:7, 9, 8, 10)) %>% # order columns\n   flextable() %>%\n   set_header_labels(\n      trial_ref = \"Trial code\",\n      location = \"Location\",\n      year = \"Year\",\n      planting_date = \"Sowing date\",\n      first_sign_disease = \"PM onset\",\n      n = \"n\",\n      m_PM_sev_control = \"Control median\\nPM severity\",\n      PM_sev_range = \"PM severity\\nrange\",\n      m_PM_yield_control = \"Control\\nmedian yield\",\n      yield_range = \"Yield range\\n(t / ha)\"\n   ) %>%\n   fontsize(size = 8, part = \"body\") %>%\n   fontsize(size = 10, part = \"header\") %>%\n   align(j = 3:10, align = \"center\", part = \"all\") %>%\n   #autofit() %>%\n   width(j = 1, width = 0.6) %>%\n   width(j = 2, width = 0.8) %>%\n   width(j = 3, width = 0.5) %>%\n   width(j = 4:5, width = 0.8) %>%\n   width(j = 6, width = 0.3) %>%\n   width(j = 7, width = 0.9) %>%\n   width(j = 8, width = 0.7) %>%\n   width(j = 9, width = 0.6) %>%\n   width(j = 10, width = 1) %>%\n   set_caption(\n      \"Table 1: Mean yield and severity for trials included in the meta-analysis. Powdery mildew (PM) onset date, number of treatments per trial (n), PM median plot severity of the non-fungicide treated plots and the severity range in fungicide treatments, bracketed numbers refer to the number of pooled control treatments summarised; Mean yield in non-fungicide treated control and the range of yields in the fungicide treatments in tonnes per hectare\"\n   ) %>%\n   footnote(\n      i = 4,\n      j = 1,\n      value = as_paragraph(\n         c(\"Trials which reported PM severity variance and not yield variance and therefore excluded in the yield protection meta-analysis;\")),\n      ref_symbols = \"a\") %>%\n   footnote(\n      i = c(11,12),\n      j = 1,\n      value = as_paragraph(\n         c(\"Trials which did not report powdery mildew (PM) severity variance and therefore excluded in the PM severity meta-analysis\")),\n      ref_symbols = \"b\")\n\nSev_yield_table"},{"path":"preliminary-analysis.html","id":"summary-plots","chapter":"3 Preliminary Analysis","heading":"3.1.4 Summary plots","text":"","code":""},{"path":"preliminary-analysis.html","id":"seasonal-disease-pressure-in-the-control","chapter":"3 Preliminary Analysis","heading":"3.1.4.1 Seasonal disease pressure in the control","text":"","code":"\nsev_control_plot <- \n   PM_MB_dat %>%\n   filter(fungicide_ai == \"control\") %>%\n   ggplot(aes(x = year, y = PM_final_severity)) +\n   geom_boxplot(outlier.alpha = 0) +\n   geom_jitter(size = 2, colour = \"cadetblue\",alpha = 0.4,width = 0.15) +\n   scale_y_continuous(breaks = c(1,3,5,7,9), limits = c(0.9,9.1)) +\n   ylab(\"PM severity (1 -9)\")+\n   # xlab(\"Crop season\")+\n   # theme(axis.title.x=element_blank(),\n   #      axis.text.x=element_blank(),\n   #      axis.ticks.x=element_blank())+\n   ggtitle(\"A\") +\n   theme_minimal()\n\nsev_control_plot      "},{"path":"preliminary-analysis.html","id":"disease-severity-range-for-each-spray-schedule","chapter":"3 Preliminary Analysis","heading":"3.1.4.2 Disease severity range for each spray schedule","text":"","code":"\nsev_schedule_plot <-\n   PM_MB_dat %>%\n   ggplot(aes(x = spray_management, y = PM_final_severity)) +\n   geom_boxplot(outlier.alpha = 0) +\n   geom_jitter(\n      size = 2,\n      colour = \"cadetblue\",\n      alpha = 0.4,\n      width = 0.15\n   ) +\n   scale_y_continuous(breaks = c(1, 3, 5, 7, 9), limits = c(0.9, 9.1)) +\n   scale_x_discrete(labels = c(\n      \"control\",\n      \"early\",\n      \"late\",\n      \"late+\",\n      \"recommended\",\n      \"recomended+\"\n   )) +\n   ylab(\"PM severity (1 -9)\") +\n   # xlab(\"Spray Schedule\")+\n   ggtitle(\"B\")+\n   theme_minimal()\n   \nsev_schedule_plot"},{"path":"preliminary-analysis.html","id":"seasonal-grain-yield-in-the-control","chapter":"3 Preliminary Analysis","heading":"3.1.4.3 Seasonal grain yield in the control","text":"","code":"\nY_control_plot <-\n   PM_MB_dat %>%\n   filter(fungicide_ai == \"control\") %>%\n   ggplot(aes(x = year, y = grain_yield.t.ha.)) +\n   geom_boxplot() +\n   geom_jitter(\n      size = 2,\n      colour = \"coral\",\n      alpha = 0.4,\n      width = 0.15\n   ) +\n   scale_y_continuous(breaks = seq(0, 2.5, by = 0.5), limits = c(0, 2.6)) +\n   ylab(bquote('Mungbean grain yield ' *  ~  ~ t ~ ha ^ -1 * \"\")) +\n   xlab(\"Crop season\") +\n   theme(axis.text.x = element_text(angle = 20, hjust = 0.75),\n         plot.margin = margin(0.2, 0, 0.71, 0, \"cm\"),\n         axis.title.x = element_text(vjust = -5))\n\nY_control_plot"},{"path":"preliminary-analysis.html","id":"mungbean-yield-for-each-spray-schedule","chapter":"3 Preliminary Analysis","heading":"3.1.4.4 Mungbean yield for each spray schedule","text":"Box plots unsprayed control treatments means PM severity (top) crop yield (bottom), indicating within-season variation (), trial treatment means spray schedule (B).","code":"\nY_schedule_plot <- \n   PM_MB_dat %>%\n   ggplot(aes(x = spray_management, y = grain_yield.t.ha.)) +\n   geom_boxplot(outlier.alpha = 0) +\n   geom_jitter(\n      size = 2,\n      colour = \"coral\",\n      alpha = 0.4,\n      width = 0.15\n   ) +\n   scale_y_continuous(breaks = seq(0, 2.5, by = 0.5), limits = c(0, 2.6)) +\n   scale_x_discrete(labels = c(\n      \"control\",\n      \"early\",\n      \"late\",\n      \"late+\",\n      \"recommended\",\n      \"recomended+\"\n   )) +\n   #ylab(bquote('Mungbean grain yield ' *  ~  ~ t ~ ha ^ -1 * \"\")) +\n   xlab(\"Spray schedule\")+\n   theme_minimal()+\n   theme(axis.title.y = element_blank(),\n         axis.text.x = element_text(angle = 20, hjust = 0.75))\n\nY_schedule_plot"},{"path":"preliminary-analysis.html","id":"treatment-focused-summaries","chapter":"3 Preliminary Analysis","heading":"3.2 Treatment focused summaries","text":"Various factors studied collated trials may influence subsequent meta-analysis.\nquick inspection following factors done examine possible influence variables may mungbean grain yield /powdery mildew mean plot severity.Fungicide type (propiconazole tebuconazole)\nFungicide Doses\nNumber fungicide sprays\nHost cultivar (probably co-variate season due changing cultivars time)\nRow spacing\nFinal disease rating / disease pressure\nMoisture availability crop\nFungicide DosesNumber fungicide spraysHost cultivar (probably co-variate season due changing cultivars time)Row spacingFinal disease rating / disease pressureMoisture availability cropThe data plotted 16 field trials (2011 - 2019) details described Trials considered inclusion meta-analysis.","code":""},{"path":"preliminary-analysis.html","id":"fungicide-type","chapter":"3 Preliminary Analysis","heading":"3.2.1 Fungicide type","text":"","code":""},{"path":"preliminary-analysis.html","id":"powdery-mildew-severity","chapter":"3 Preliminary Analysis","heading":"3.2.1.1 Powdery mildew severity","text":"","code":"\nn_C <- sum(PM_MB_dat$fungicide_ai == \"control\")\nn_P <- sum(PM_MB_dat$fungicide_ai == \"propiconazole\")\nn_T <- sum(PM_MB_dat$fungicide_ai == \"tebuconazole\")\n\nPM_MB_dat %>%\n   ggplot(aes(y = PM_final_severity, x = as.factor(fungicide_ai))) +\n   xlab(\"Fungicide treatment\") +\n   ggtitle(label = \"Powdery mildew severity for each fungicide active ingredient\") +\n   labs(caption = paste(\"Control n:\", n_C,\n                        \"; Propiconazole n:\", n_P,\n                        \"; Tebuconazole n:\", n_T, sep = \"\")) +\n   geom_boxplot()"},{"path":"preliminary-analysis.html","id":"yield-effect","chapter":"3 Preliminary Analysis","heading":"3.2.1.2 Yield effect","text":"","code":"\nPM_MB_dat %>%\n   ggplot(aes(y = grain_yield.t.ha., x = as.factor(fungicide_ai))) +\n   xlab(\"Fungicide treatment\") +\n   ggtitle(label = \"Grain yield for each fungicide active ingredient\") +\n   labs(caption = paste(\"Control n:\", n_C,\n                        \"; Propiconazole n:\", n_P,\n                        \"; Tebuconazole n:\", n_T, sep = \"\")) +\n   geom_boxplot()"},{"path":"preliminary-analysis.html","id":"fungicide-doses","chapter":"3 Preliminary Analysis","heading":"3.2.2 Fungicide Doses","text":"analysis focuses DMI fungicides, tebuconazole propiconazole, trialled often.check fungicide doses used roughly , compare trials dose might different.trials used tebuconazole used approximately dose.\nDose active ingredient ranged 62.35 g per hectare 60 g per hectare.Doses propiconazole range 62.5 g 125 g, large variation.\nLet’s inspect difference yields dose.dose effect investigated meta-analysis.many treatments dose investigated per trial?","code":"\nPM_MB_dat %>%\n   filter(fungicide_ai == \"tebuconazole\" |\n             fungicide_ai == \"propiconazole\") %>%\n   ggplot(aes(x = as.factor(dose_ai.ha), fill = fungicide_ai)) +\n   xlab(\"Dose (g ai/ha)\") +\n   ggtitle(label = \"Total number of treatments for each respective tebuconazole\\nor propiconazole dose\") +\n   geom_bar() \nPM_MB_dat %>%\n   filter(fungicide_ai == \"propiconazole\") %>%\n   ggplot(aes(x = relevel(as.factor(dose_ai.ha), \"62.5\"), y = grain_yield.t.ha.)) +\n   xlab(\"Dose (g ai/ha)\") +\n   labs(label = \"Yield for each respective propiconazole dose\",\n        caption = \"Facets indicate the number of applications\") +\n   geom_boxplot(fill = \"grey\", alpha = 0.5) +\n   ylab(\"Grain yield t / ha\") +\n   facet_grid(cols = vars(total_fungicide))\ntable(as.character(PM_MB_dat[PM_MB_dat$fungicide_ai == \"propiconazole\",]$trial_ref),\n      PM_MB_dat[PM_MB_dat$fungicide_ai == \"propiconazole\",]$dose_ai.ha)##              \n##               62.5 125\n##   AM1303         3   0\n##   AM1304         1   0\n##   AM1305         3   0\n##   BB1305         3   0\n##   mung1112/01    2   2\n##   mung1112/02    2   2\n##   mung1617/01    0  15\n##   mung1617/02    0  15\n##   mung1718/01    0   6"},{"path":"preliminary-analysis.html","id":"number-of-fungicide-sprays","chapter":"3 Preliminary Analysis","heading":"3.2.3 Number of fungicide sprays","text":"Inspect frequency sprays per fungicide.treatments sprayed three times AM1305, AM1303, BB1305, mung1516/01, mung1516/02","code":"\ntable(PM_MB_dat$fungicide_ai, PM_MB_dat$total_fungicide)##                \n##                  0  1  2  3\n##   control       39  0  0  0\n##   propiconazole  0 26 25  3\n##   tebuconazole   0 34 32  2"},{"path":"preliminary-analysis.html","id":"mungbean-cultivars","chapter":"3 Preliminary Analysis","heading":"3.2.4 Mungbean cultivars","text":"Australian mungbean varieties following resistance powdery mildew.Berken: Highly susceptible\nCrystal: Susceptible\nJade: Moderately susceptible\nBerken: Highly susceptibleCrystal: SusceptibleCrystal: SusceptibleJade: Moderately susceptibleJade: Moderately susceptibleLet’s view stacked bar plot number sprays demethylation inhibitors, tebuconazole propiconazole cultivar.","code":"\nPM_MB_dat %>%\n   filter(fungicide_ai == \"tebuconazole\" |\n             fungicide_ai == \"propiconazole\") %>%\n   group_by(host_genotype, fungicide_ai, trial_ref) %>%\n   summarise() %>%\n   count() %>%\n   rename(Treatments = n) %>%\n   ggplot(aes(x = host_genotype, y = Treatments, fill = fungicide_ai)) +\n   xlab(\"Cultivar\") +\n   ylab(\"N Trials\") +\n   ggtitle(label = \"Cultivars used in either tebuconazole or propiconazole trials\") +\n   geom_col() +\n   scale_fill_discrete(name = \"Fungicide AI\")"},{"path":"preliminary-analysis.html","id":"yield-loss-in-cultivar-jade","chapter":"3 Preliminary Analysis","heading":"3.2.4.1 Yield loss in cultivar Jade","text":"Cultivar Jade shows best quantitative resistance powdery mildew.\nBased 2016 GRDC report Sue Thompson (2016) want know possible yield loss moderately susceptible cultivar.trial_reflocationyearcontrol_yieldFungicideTreated_yieldpercentDiffmung1516/01Hermitage20161.80292.282183321.001090.4792833mung1516/02Kingaroy20160.81070.954116715.031360.1434167","code":"\nPM_MB_dat %>%\n   filter(year == \"2016\",\n          host_genotype == \"Jade\") %>%\n   mutate(Treatment = case_when(fungicide_ai == \"control\" ~ \"control_yield\",\n                                TRUE ~ \"FungicideTreated_yield\")) %>%\n   group_by(location, Treatment) %>%\n   summarise(\n      trial_ref = trial_ref,\n      location = location,\n      year = year,\n      Yield = mean(grain_yield.t.ha., na.rm = TRUE),\n      .groups = \"drop\"\n   ) %>%\n   distinct() %>%\n   pivot_wider(names_from = Treatment, values_from = Yield) %>%\n   mutate(Diff = FungicideTreated_yield - control_yield) %>%\n   mutate(percent = (Diff / FungicideTreated_yield) * 100) %>%\n   select(trial_ref,\n          location,\n          year,\n          control_yield,\n          FungicideTreated_yield,\n          percent,\n          Diff) %>%\n   flextable()"},{"path":"preliminary-analysis.html","id":"row-spacing","chapter":"3 Preliminary Analysis","heading":"3.2.5 Row spacing","text":"experiments designed investigate effect row spacing plant density powdery mildew disease well fungicide timing efficacy.\nresults showed row spacing statistically significant effect powdery mildew, narrower rows cases increased yield significantly.\nfinding also shown several researchers’ work Queensland New South Wales well.plotting row spacing treatments show differences response variables, yield disease severity.\nmain questions :statistical differences mungbean yield powdery mildew severity row spacing treatments?\n, can pool certain row spacing significant difference?\nstatistical differences mungbean yield powdery mildew severity row spacing treatments?, can pool certain row spacing significant difference?little difference row spacing treatments, Let’s look trial location effect disease pressure lead varying results.Wellcamp site, wider row spacing reduces PM severity, sites seems enough variation make distinction row spacing treatments.plots seem imply yield limited, presumably abiotic factors, effect row spacing yield, like Hermitage trial.\nHowever, average yield approximately 1 t/ha smaller row spacing potential provide greater yield per hectare.Overall row spacing may influence powdery mildew severity yield.\nHowever, trial reports, significant interaction found row spacing, powdery mildew severity yield.\n, narrower row spacing appeared increase yield even amount powdery mildew increased relationship detected interaction three.","code":"\nPM_MB_dat %>%\n   filter(fungicide_ai == \"tebuconazole\" |\n             fungicide_ai == \"propiconazole\") %>%\n   group_by(fungicide_ai, row_spacing, trial_ref) %>%\n   summarise() %>%\n   count() %>%\n   rename(Trials = n) %>%\n   ggplot(aes(x = as.factor(row_spacing), y = Trials)) +\n   xlab(\"Row Spacing (m)\") +\n   ylab(\"N Trials\") +\n   ggtitle(label = \"Trial row spacing using tebuconazole\") +\n   geom_col(aes(fill = fungicide_ai),\n            position = \"dodge\") +\n   scale_fill_discrete(name = \"Fungicide AI\")## `summarise()` has grouped output by 'fungicide_ai', 'row_spacing'. You can override using the `.groups` argument.\n# Which row spacing leads to the higher disease severity\nPM_MB_dat %>%\n   filter(year == 2017 |\n             year == 2018) %>%\n   filter(fungicide_ai == \"control\") %>%\n   ggplot(aes(y = PM_final_severity, x = factor(row_spacing))) +\n   geom_boxplot(alpha = 0.5) +\n   ylab(\"Final severity rating\") +\n   xlab(\"Row spacing (m)\") +\n   ggtitle(\"Powdery mildew severity between different row spacing across all trials\")\n# Does trial year and location interact between row spacing and disease severity\nPM_MB_dat %>%\n   filter(year == 2017 |\n             year == 2018) %>%\n   filter(fungicide_ai == \"control\") %>%\n   ggplot(aes(y = PM_final_severity, x = factor(row_spacing))) +\n   geom_boxplot(alpha = 0.5) +\n   facet_grid(cols = vars(location)) +\n   ggtitle(\"Powdery mildew variation between different row spacing\") +\n   ylab(\"Final severity rating\") +\n   xlab(\"Row spacing (m)\")\n# Which row spacing leads to the higher yield potential\nPM_MB_dat %>%\n   filter(year == 2017 |\n             year == 2018) %>%\n   ggplot(aes(\n      y = as.numeric(grain_yield.t.ha.),\n      x = as.factor(row_spacing),\n      colour = location\n   )) +\n   geom_jitter(width = 0.05) +\n   ggtitle(\"Grain yield results for different row spacing at three locations\") +\n   xlab(\"Row spacing (m)\") +\n   ylab(\"Grain yield (t/ha)\")+\n   theme_minimal()"},{"path":"preliminary-analysis.html","id":"disease-pressure","chapter":"3 Preliminary Analysis","heading":"3.2.6 Disease pressure","text":"amount disease pressure seasons another variable impact mungbean yield meta-analysis effect size.plots difficult determine interaction disease pressure yield saved, interaction exists fungicide efficacy general greater potential save yield disease pressure higher.\nworth noting sufficient variation control plot disease severity produce medium disease severity category.","code":"\n# Assess the effect of yield pressure on the spray schedule efficacy\n# Use quantiles to separate disease pressure into High, Medium and low disease pressure categories\nDP33 <- \n   PM_MB_dat %>%\n   filter(fungicide_ai == \"control\") %>%\n   pull(PM_final_severity) %>%\n   quantile(0.3333)\n\nDP66 <- \n   PM_MB_dat %>%\n   filter(fungicide_ai == \"control\") %>%\n   pull(PM_final_severity) %>%\n   quantile(0.6666)\n\n\n   \n\nPM_MB_dat %>%\n   mutate(yc = case_when(fungicide_ai == \"control\" ~ grain_yield.t.ha.,\n                         TRUE ~ NA_real_))%>%\n   group_by(trial_ref)%>%\n   mutate(yc = mean(yc, na.rm=TRUE)) %>%\n   mutate(yield_saved = case_when(fungicide_ai != \"control\" ~ grain_yield.t.ha. - yc,\n                    fungicide_ai == \"control\" ~ NA_real_)) %>%\n   mutate(dc = case_when(fungicide_ai == \"control\" ~ PM_final_severity,\n                         TRUE ~ NA_real_))%>%\n   mutate(dc = mean(dc, na.rm = TRUE))%>%\n   ungroup() %>%\n   mutate(disease_pressure = case_when(dc <= DP33 ~ \"low\",\n                                 dc <= DP66 &\n                                 dc > DP33 ~ \"medium\",\n                                 dc > DP66 ~ \"high\",\n                                 TRUE ~ NA_character_))%>%\n   filter(spray_management != \"control\") %>%\n   ggplot(aes(disease_pressure, yield_saved))+\n   geom_boxplot()+ \n   facet_grid(. ~ spray_management)"},{"path":"preliminary-analysis.html","id":"in-crop-rainfall","chapter":"3 Preliminary Analysis","heading":"3.2.7 In-crop rainfall","text":"","code":""},{"path":"preliminary-analysis.html","id":"whole-season","chapter":"3 Preliminary Analysis","heading":"3.2.7.1 Whole season","text":"season rainfall known contribute significantly crop yields, however timing rainfall likely important.First inspection rainfall within season","code":"\nsource(\"R/add_lat_longs.R\") # code adds the latitude- and longitude to PM_MB_dat\nsource(\"R/crop_rain.R\")\n\n# Obtain rainfall from bomrang\nPM_MB_dat$sum_rain <-\n   crop_rain(location_name = PM_MB_dat$location,\n          latitude = PM_MB_dat$lat,\n          longitude = PM_MB_dat$lon,\n          first_day = PM_MB_dat$planting_date,\n          last_day = PM_MB_dat$harvest_date)\n\n# Due to the Bureau of Meteorology in Australia blocking requests using the \n#  R package `bomrang` this code has been changed to import the cached values\n\n# plot yield vs rainfall\nPM_MB_dat %>%\n   ggplot(aes(y = grain_yield.t.ha., x = sum_rain)) + \n   geom_point()## Warning: Removed 20 rows containing missing values (geom_point).\nsummary(lm(grain_yield.t.ha. ~ sum_rain, data = PM_MB_dat))## \n## Call:\n## lm(formula = grain_yield.t.ha. ~ sum_rain, data = PM_MB_dat)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -1.19469 -0.55873 -0.03576  0.57633  1.37833 \n## \n## Coefficients:\n##               Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)  1.6762255  0.2009508   8.341 6.49e-14 ***\n## sum_rain    -0.0017944  0.0007276  -2.466   0.0149 *  \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 0.6295 on 139 degrees of freedom\n##   (20 observations deleted due to missingness)\n## Multiple R-squared:  0.04192,    Adjusted R-squared:  0.03502 \n## F-statistic: 6.081 on 1 and 139 DF,  p-value: 0.01488"},{"path":"preliminary-analysis.html","id":"early-season-rainfall","chapter":"3 Preliminary Analysis","heading":"3.2.7.2 Early-season rainfall","text":"look effect rainfall planting date first sign disease.\nchoosing first sign disease mid point crop maturity.significant negative association , indicating rain fall early crop development negatively affects mungbean yields. However low R-squared value indicates strong one.","code":"\nPM_MB_dat$early_rain <-\n   crop_rain(location_name = PM_MB_dat$location,\n          latitude = PM_MB_dat$lat,\n          longitude = PM_MB_dat$lon,\n          first_day = PM_MB_dat$planting_date,\n          last_day = PM_MB_dat$first_sign_disease)\n\nPM_MB_dat %>%\n   ggplot(aes(y = grain_yield.t.ha., x = early_rain)) + \n   geom_point()\nsummary(lm(grain_yield.t.ha. ~ early_rain, data = PM_MB_dat))## \n## Call:\n## lm(formula = grain_yield.t.ha. ~ early_rain, data = PM_MB_dat)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -1.02549 -0.54188  0.01965  0.52195  1.18905 \n## \n## Coefficients:\n##               Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)  1.6187927  0.1084723  14.924  < 2e-16 ***\n## early_rain  -0.0033201  0.0007248  -4.581 9.31e-06 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 0.573 on 159 degrees of freedom\n## Multiple R-squared:  0.1166, Adjusted R-squared:  0.111 \n## F-statistic: 20.98 on 1 and 159 DF,  p-value: 9.308e-06"},{"path":"preliminary-analysis.html","id":"late-season-rainfall","chapter":"3 Preliminary Analysis","heading":"3.2.7.3 Late-season rainfall","text":"look effect rainfall first sign disease crop harvest.significant positive association , indicating rainfall disease commences likely lead increased yield. However low R-squared value indicates strong one.","code":"\nPM_MB_dat$late_rain <-\n   crop_rain(location_name = PM_MB_dat$location,\n          latitude = PM_MB_dat$lat,\n          longitude = PM_MB_dat$lon,\n          first_day = PM_MB_dat$first_sign_disease,\n          last_day = PM_MB_dat$harvest_date)\n\n\nPM_MB_dat %>%\n   ggplot(aes(y = grain_yield.t.ha., x = late_rain)) + \n   geom_point()## Warning: Removed 20 rows containing missing values (geom_point).\nsummary(lm(grain_yield.t.ha. ~ late_rain, data = PM_MB_dat))## \n## Call:\n## lm(formula = grain_yield.t.ha. ~ late_rain, data = PM_MB_dat)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -0.92828 -0.64258  0.03875  0.49696  1.23659 \n## \n## Coefficients:\n##              Estimate Std. Error t value Pr(>|t|)    \n## (Intercept) 1.0467776  0.1112158   9.412   <2e-16 ***\n## late_rain   0.0011816  0.0007598   1.555    0.122    \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 0.6376 on 139 degrees of freedom\n##   (20 observations deleted due to missingness)\n## Multiple R-squared:  0.0171, Adjusted R-squared:  0.01003 \n## F-statistic: 2.418 on 1 and 139 DF,  p-value: 0.1222"},{"path":"preliminary-analysis.html","id":"mid-season-rainfall","chapter":"3 Preliminary Analysis","heading":"3.2.7.4 Mid-season rainfall","text":"look effect rainfall 20 days planting 80 days planting.association mid season rain crop yields.plots shown can draw conclusion lack sufficient information.\nlikely available soil water trials along unobserved variables influence rainfall mungbean crops therefore investigate .\n******","code":"\nPM_MB_dat$mid_rain <-\n   crop_rain(location_name = PM_MB_dat$location,\n          latitude = PM_MB_dat$lat,\n          longitude = PM_MB_dat$lon,\n          first_day = ymd(PM_MB_dat$planting_date) + days(45),\n          last_day = ymd(PM_MB_dat$planting_date) + days(75)\n   )\n\nPM_MB_dat %>%\n   ggplot(aes(y = grain_yield.t.ha., x = mid_rain)) + \n   geom_point()\nsummary(lm(grain_yield.t.ha. ~ mid_rain, data = PM_MB_dat))## \n## Call:\n## lm(formula = grain_yield.t.ha. ~ mid_rain, data = PM_MB_dat)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -0.91273 -0.58233 -0.00342  0.39919  1.30604 \n## \n## Coefficients:\n##              Estimate Std. Error t value Pr(>|t|)    \n## (Intercept) 0.9047111  0.0841268  10.754  < 2e-16 ***\n## mid_rain    0.0025537  0.0006853   3.726 0.000269 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 0.5846 on 159 degrees of freedom\n## Multiple R-squared:  0.08032,    Adjusted R-squared:  0.07454 \n## F-statistic: 13.89 on 1 and 159 DF,  p-value: 0.0002694"},{"path":"preliminary-analysis.html","id":"fao-mungbean-data","chapter":"3 Preliminary Analysis","heading":"3.2.8 FAO mungbean data","text":"important consideration carry work mungbean diseases value crop provides.\nLet’s pull data FAOSTAT website area mungbean crops harvested.","code":"\nbeans <- read.csv(here(\"data/FAOSTAT_data_7-6-2020.csv\"))\n\nstr(beans)## 'data.frame':    473 obs. of  15 variables:\n##  $ Domain.Code     : chr  \"QC\" \"QC\" \"QC\" \"QC\" ...\n##  $ Domain          : chr  \"Crops\" \"Crops\" \"Crops\" \"Crops\" ...\n##  $ Area.Code       : int  10 10 10 10 10 10 10 10 10 10 ...\n##  $ Area            : chr  \"Australia\" \"Australia\" \"Australia\" \"Australia\" ...\n##  $ Element.Code    : int  5312 5419 5510 5312 5419 5510 5312 5419 5510 5312 ...\n##  $ Element         : chr  \"Area harvested\" \"Yield\" \"Production\" \"Area harvested\" ...\n##  $ Item.Code       : int  176 176 176 176 176 176 176 176 176 176 ...\n##  $ Item            : chr  \"Beans, dry\" \"Beans, dry\" \"Beans, dry\" \"Beans, dry\" ...\n##  $ Year.Code       : int  1961 1961 1961 1962 1962 1962 1963 1963 1963 1964 ...\n##  $ Year            : int  1961 1961 1961 1962 1962 1962 1963 1963 1963 1964 ...\n##  $ Unit            : chr  \"ha\" \"hg/ha\" \"tonnes\" \"ha\" ...\n##  $ Value           : int  809 5525 447 809 11001 890 2023 5151 1042 1214 ...\n##  $ Flag            : chr  \"\" \"Fc\" \"\" \"\" ...\n##  $ Flag.Description: chr  \"Official data\" \"Calculated data\" \"Official data\" \"Official data\" ...\n##  $ Note            : logi  NA NA NA NA NA NA ...\nbeans %>%\n   filter(Item == \"Beans, dry\",\n          Element == \"Area harvested\") %>%\n   select(Year, Value) %>%\n   ggplot(aes(y = Value, x = Year)) +\n   geom_point() +\n   geom_smooth()## `geom_smooth()` using method = 'loess' and formula 'y ~ x'"},{"path":"grain-yield-meta-analysis.html","id":"grain-yield-meta-analysis","chapter":"4 Grain yield meta-analysis","heading":"4 Grain yield meta-analysis","text":"Let’s get started analysis first finding best fitting model answers research question., relation PM establishment crop, farmers begin spraying mungbean mitigate yield loss: PM establishing, immediately first sign PM establishing, PM become established crop.secondary question aim : given time first spray occurred second spray provide worthwhile yield protection., model use main variables:Grain yield response variable (t / ha)\nTrial, resolves combinations categorical random variables:\nyear\nlocation\nrow spacing\ncultivar\n\nspray_management moderator evaluate difference effect size attributed fungicide application timing.\nid random variable indicating treatment independent\nGrain yield response variable (t / ha)Trial, resolves combinations categorical random variables:\nyear\nlocation\nrow spacing\ncultivar\nTrial, resolves combinations categorical random variables:yearlocationrow spacingcultivarspray_management moderator evaluate difference effect size attributed fungicide application timing.spray_management moderator evaluate difference effect size attributed fungicide application timing.id random variable indicating treatment independentid random variable indicating treatment independent","code":"\n# load R packages\nif (!require(\"pacman\"))\n   install.packages(\"pacman\")\npacman::p_load(\n   tidyverse,\n   kableExtra,\n   RColorBrewer,\n   metafor,\n   here,\n   netmeta,\n   multcomp,\n   flextable\n)## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependencies 'mathjaxr', 'pbapply'## \n## metafor installed## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependencies 'CompQuadForm', 'abind', 'meta', 'magic'## \n## netmeta installed## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependencies 'zoo', 'mvtnorm', 'TH.data', 'sandwich'## \n## multcomp installed\nsource(here(\"R/reportP.R\"))\n\n# Data\nPM_dat_Y <-\n   read.csv(\"cache/PM_yield_clean_data.csv\", stringsAsFactors = FALSE\n   )"},{"path":"grain-yield-meta-analysis.html","id":"define-trial","chapter":"4 Grain yield meta-analysis","heading":"4.0.1 Define Trial","text":"","code":"\nPM_dat_Y <-\n   PM_dat_Y %>%\n   mutate(trial = paste(trial_ref,\n                        year,\n                        location,\n                        host_genotype,\n                        row_spacing,\n                        sep = \"_\")) "},{"path":"grain-yield-meta-analysis.html","id":"spray-schedule-meta-analysis","chapter":"4 Grain yield meta-analysis","heading":"4.1 Spray schedule meta-analysis","text":"spray_management moderator evaluated first model.\nmodel tested models incorporating, time disease onset, disease pressure variance-covariance matrix structures.","code":""},{"path":"grain-yield-meta-analysis.html","id":"spray-schedule-moderator","chapter":"4 Grain yield meta-analysis","heading":"4.1.1 Spray schedule moderator","text":"grain yield meta-analysis multi-variate meta-analysis, using metafor package function rma.mv() (Viechtbauer 2010).using spray_management variable moderator interactive random term trial random variable. variance-covariance matrix specified unstructured (UN) allow correlations within trials.","code":"\nPM_mv <- rma.mv(\n   yi = grain_yield.t.ha.,\n   V = vi,\n   mods = ~ spray_management,\n   method = \"ML\",\n   random = list( ~ spray_management | trial, ~ 1 | id),\n   struct = \"UN\",\n   control = list(optimizer = \"optim\"),\n   data = PM_dat_Y\n)## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0."},{"path":"grain-yield-meta-analysis.html","id":"disease-onset-interaction-with-spray-schedule","chapter":"4 Grain yield meta-analysis","heading":"4.1.2 Disease onset interaction with spray schedule","text":"determine time disease occurs cropping season influences efficacy fungicide applications protect yield create categorical variable defining early late disease onset.early late categories divided number close median days sowing signs disease first observed ensure roughly even numbers category.choose 42 days average days flowering mungbean.\naddition, Kelly et. al. (2017) noted yield losses higher cultivar Berken disease establishes flowering.Now let’s define continuous variablefirst_sign_days categorical variable onset.Inspect histogram first sign occurred crop.early_onset contains 117 treatments ,late_onset contains 37 treatments.","code":"\nPM_dat_Y %>%\n   mutate(first_sign_days = lubridate::ymd(first_sign_disease) -\n             lubridate::ymd(planting_date)) %>%\n   pull(first_sign_days) %>%\n   median()## Time difference of 39 days\nPM_dat_Y <- PM_dat_Y %>%\n   mutate(first_sign_days = lubridate::ymd(first_sign_disease) -\n             lubridate::ymd(planting_date)) %>%\n   mutate(onset = case_when(\n      first_sign_days <= 42 ~ \"early_onset\",\n      first_sign_days > 42 ~ \"late_onset\"\n   ))\nPM_dat_Y %>%\n   ggplot(aes(x = as.integer(first_sign_days))) +\n   geom_histogram(binwidth = 1) +\n   geom_vline(xintercept = 42)"},{"path":"grain-yield-meta-analysis.html","id":"metafor-onset-analysis","chapter":"4 Grain yield meta-analysis","heading":"4.1.2.1 metafor onset analysis","text":"adding onset variable moderator test interaction spray_management variable moderator interactive term trial random variable.comparison tells us meta-analysis including onset explained residual heterogeneity, shown lower QE value, better fit, indicated higher log-likelihood additional onset parameters.\nHowever higher AIC indicates model additional onset parameters sufficiently improve model fit warrant including parameters therefore ‘reduced’ model better option.\ninference also reflected chi-squared test, uncertain onset model significantly better indicated ANOVA pval 0.361.","code":"\nPM_mv_onset <- rma.mv(\n   yi = grain_yield.t.ha.,\n   V = vi,\n   mods = ~ spray_management * onset,\n   method = \"ML\",\n   random = list( ~ spray_management | trial, ~ 1 | id),\n   struct = \"UN\",\n   control = list(optimizer = \"optim\"),\n   data = PM_dat_Y\n)## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\nanova(PM_mv, PM_mv_onset)## \n##         df      AIC     BIC     AICc  logLik    LRT   pval        QE \n## Full    33 -38.5465 61.6730 -19.8465 52.2732               7982.9638 \n## Reduced 27 -43.9598 38.0379 -31.9598 48.9799 6.5867 0.3608 9993.0956"},{"path":"grain-yield-meta-analysis.html","id":"disease-pressure-interaction-with-spray-schedule","chapter":"4 Grain yield meta-analysis","heading":"4.1.3 Disease pressure interaction with spray schedule","text":"determine seasonal disease pressure influences efficacy fungicide applications protect yield categorical variable defining high_pressure low_pressure can defined.high_pressure low_pressure divided median disease severity spray control treatments end season.Now define two new variables, low_pressure high_pressure data.Inspect histogram final severity values crop.","code":"\nPM_dat_Y %>%\n   filter(fungicide_ai == \"control\") %>%\n   pull(PM_final_severity) %>%\n   median()## [1] 8\nPM_dat_Y <- PM_dat_Y %>%\n   mutate(\n      d_pressure = case_when(\n         PM_final_severity < 8 ~ \"low_pressure\",\n         PM_final_severity >= 8 ~ \"high_pressure\"\n      )\n   )\nPM_dat_Y %>%\n   ggplot(aes(x = PM_final_severity)) +\n   geom_histogram(binwidth = 1) +\n   geom_vline(xintercept = 8)"},{"path":"grain-yield-meta-analysis.html","id":"metafor-disease-pressure-interaction","chapter":"4 Grain yield meta-analysis","heading":"4.1.3.1 metafor disease pressure interaction","text":"Test d_pressure variable addition moderator evaluate ’s interaction spray_management influence grain yield effect size.comparison tells us meta-analysis including d_pressure explained residual heterogeneity, shown lower QE value, better fit, indicated higher log-likelihood additional d_pressure parameter.\nHowever lower AIC ‘Full’ model indicates retaining model including additional d_pressure variables reasonable decision.\naddition chi-squared test indicates d_pressure model better indicated pval 0.0468.However worth noting Late plus schedules experienced low disease pressure.\nEven though disease pressure interaction moderators deemed significant (P = 0.0468), division schedules due disease pressure (reducing k) makes drawing conclusions risky. data needed explore possible effect.spray_managementd_pressuren()controlhigh_pressure29controllow_pressure9Earlyhigh_pressure10Earlylow_pressure3Latehigh_pressure7Latelow_pressure10Late_pluslow_pressure19Recommendedhigh_pressure13Recommendedlow_pressure14Recommended_plushigh_pressure10Recommended_pluslow_pressure30","code":"\nPM_mv_dp <- rma.mv(\n   yi = grain_yield.t.ha.,\n   V = vi,\n   mods = ~ spray_management * d_pressure,\n   method = \"ML\",\n   random = list( ~ spray_management | trial, ~ 1 | id),\n   struct = \"UN\",\n   control = list(optimizer = \"optim\"),\n   data = PM_dat_Y\n)## Warning in rma.mv(yi = grain_yield.t.ha., V = vi, mods = ~spray_management * :\n## Redundant predictors dropped from the model.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\nanova(PM_mv, PM_mv_dp)## \n##         df      AIC     BIC     AICc  logLik     LRT   pval        QE \n## Full    32 -45.1999 51.9826 -27.7454 54.6000                7550.9672 \n## Reduced 27 -43.9598 38.0379 -31.9598 48.9799 11.2401 0.0468 9993.0956\n# show the division of spray schedules by the d_pressure moderator\nPM_dat_Y %>%\n   group_by(spray_management, d_pressure) %>%\n   summarise(n()) %>%\n   flextable()## `summarise()` has grouped output by 'spray_management'. You can override using the `.groups` argument.\nsummary(PM_mv_dp)## \n## Multivariate Meta-Analysis Model (k = 154; method: ML)\n## \n##   logLik  Deviance       AIC       BIC      AICc \n##  54.6000  215.2690  -45.1999   51.9826  -27.7454   \n## \n## Variance Components:\n## \n##             estim    sqrt  nlvls  fixed  factor \n## sigma^2    0.0000  0.0000    154     no      id \n## \n## outer factor: trial            (nlvls = 23)\n## inner factor: spray_management (nlvls = 6)\n## \n##             estim    sqrt  k.lvl  fixed             level \n## tau^2.1    0.2063  0.4542     38     no           control \n## tau^2.2    0.2528  0.5028     13     no             Early \n## tau^2.3    0.3116  0.5582     17     no              Late \n## tau^2.4    0.3578  0.5981     19     no         Late_plus \n## tau^2.5    0.2989  0.5467     27     no       Recommended \n## tau^2.6    0.3586  0.5989     40     no  Recommended_plus \n## \n##                   rho.cntr  rho.Erly  rho.Late  rho.Lt_p  rho.Rcmm  rho.Rcm_ \n## control                  1    0.9908    0.9992    0.9987    0.9953    0.9972   \n## Early               0.9908         1    0.9953    0.0000    0.9993    0.9981   \n## Late                0.9992    0.9953         1    0.9999    0.9983    0.9994   \n## Late_plus           0.9987    0.0000    0.9999         1    0.9990    0.9997   \n## Recommended         0.9953    0.9993    0.9983    0.9990         1    0.9997   \n## Recommended_plus    0.9972    0.9981    0.9994    0.9997    0.9997         1   \n##                   cntr  Erly  Late  Lt_p  Rcmm  Rcm_ \n## control              -    no    no    no    no    no \n## Early                7     -    no   yes    no    no \n## Late                11     6     -    no    no    no \n## Late_plus            6     0     3     -    no    no \n## Recommended         19     6    11     3     -    no \n## Recommended_plus    17     6    11     3    17     - \n## \n## Test for Residual Heterogeneity:\n## QE(df = 143) = 7550.9672, p-val < .0001\n## \n## Test of Moderators (coefficients 2:11):\n## QM(df = ) = 69.6611, p-val < .0001\n## \n## Model Results:\n## \n##                                                          estimate      se \n## intrcpt                                                    1.0965  0.0973 \n## spray_managementEarly                                      0.0694  0.0424 \n## spray_managementLate                                       0.2519  0.0661 \n## spray_managementLate_plus                                  0.1017  0.0551 \n## spray_managementRecommended                                0.1994  0.0355 \n## spray_managementRecommended_plus                           0.4024  0.0709 \n## d_pressurelow_pressure                                     0.0091  0.0406 \n## spray_managementEarly:d_pressurelow_pressure               0.0053  0.0966 \n## spray_managementLate:d_pressurelow_pressure               -0.1641  0.0766 \n## spray_managementRecommended:d_pressurelow_pressure        -0.1267  0.0542 \n## spray_managementRecommended_plus:d_pressurelow_pressure   -0.2739  0.0739 \n##                                                             zval    pval \n## intrcpt                                                  11.2687  <.0001 \n## spray_managementEarly                                     1.6368  0.1017 \n## spray_managementLate                                      3.8101  0.0001 \n## spray_managementLate_plus                                 1.8439  0.0652 \n## spray_managementRecommended                               5.6114  <.0001 \n## spray_managementRecommended_plus                          5.6739  <.0001 \n## d_pressurelow_pressure                                    0.2234  0.8232 \n## spray_managementEarly:d_pressurelow_pressure              0.0549  0.9562 \n## spray_managementLate:d_pressurelow_pressure              -2.1409  0.0323 \n## spray_managementRecommended:d_pressurelow_pressure       -2.3367  0.0195 \n## spray_managementRecommended_plus:d_pressurelow_pressure  -3.7075  0.0002 \n##                                                            ci.lb    ci.ub \n## intrcpt                                                   0.9058   1.2872  *** \n## spray_managementEarly                                    -0.0137   0.1524      \n## spray_managementLate                                      0.1223   0.3815  *** \n## spray_managementLate_plus                                -0.0064   0.2098    . \n## spray_managementRecommended                               0.1297   0.2690  *** \n## spray_managementRecommended_plus                          0.2634   0.5414  *** \n## d_pressurelow_pressure                                   -0.0705   0.0887      \n## spray_managementEarly:d_pressurelow_pressure             -0.1841   0.1947      \n## spray_managementLate:d_pressurelow_pressure              -0.3143  -0.0139    * \n## spray_managementRecommended:d_pressurelow_pressure       -0.2330  -0.0204    * \n## spray_managementRecommended_plus:d_pressurelow_pressure  -0.4187  -0.1291  *** \n## \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"grain-yield-meta-analysis.html","id":"test-variance-covavriance-matrix-structure","chapter":"4 Grain yield meta-analysis","heading":"4.1.4 Test variance-covavriance matrix structure","text":"Test model implied simpler variance-covariance matrix, “compound symmetry” (CS), examine unstructured matrix suitable.PM_mv (Full) prevails better model (p = 0.0014; AIC = -45.4359) therefore keep unstructured variance-covariance matrix.Therefore model PM_mv, preffered model data.","code":"\nPM_mv_cs <- rma.mv(\n   yi = grain_yield.t.ha.,\n   V = vi,\n   mods = ~ spray_management,\n   method = \"ML\",\n   random = list( ~ spray_management | trial, ~ 1 | id),\n   struct = \"CS\",\n   control = list(optimizer = \"optim\"),\n   data = PM_dat_Y\n)\n\nanova(PM_mv, PM_mv_cs)## \n##         df      AIC      BIC     AICc  logLik     LRT   pval        QE \n## Full    27 -43.9598  38.0379 -31.9598 48.9799                9993.0956 \n## Reduced  9 -38.8791 -11.5465 -37.6291 28.4395 41.0807 0.0015 9993.0956"},{"path":"grain-yield-meta-analysis.html","id":"summarise-pm_mv-model","chapter":"4 Grain yield meta-analysis","heading":"4.2 Summarise PM_mv model","text":"first table PM_mv output shows tau^2 (trial variance) random effect intercept (spray_management) trial number occurrences treatment analysis.\neffectively shows heterogeneity trials particular treatments.table shows Recommended_plus showed highest heterogeneity trials followed Late_plus, Late Recommended, Early -spray control showing least heterogeneity.second table two parts (left right).\nleft part, rho, correlation variation specified treatments.\ncomparisons acceptable except comparison Early Late_plus, indicating 0.000 rho.\nEarly Late_plus treatments never occurred within trial, indicated right side table (hence earlier warnings).\nconcern type network meta-analysis differences treatments can inferred differences treatments (Madden, Piepho, Paul 2016).result can see Early treatment significantly different intercept, case mean spray control.\nHowever treatments significantly different -spray control (intercept).\n\\(Q_M\\) omnibus test moderators, shows moderators significantly influence model (\\(Q_M =\\) 37.3595017 \\(,df =\\) 5, P < 0.0001) can reject null hypothesis (\\(H_0 : \\beta_1 = \\beta_2 = \\beta_3 =\\beta_4 = 0\\)) difference moderators (Viechtbauer 2010).\nanalysis shows still significant amount residual heterogeneity (\\(Q_E =\\) 9993.095615 \\(,df=\\) 149, P < 0.0001 ) captured spray management moderator indicating possible moderators might influence grain yield.","code":"\nsummary(PM_mv)## \n## Multivariate Meta-Analysis Model (k = 154; method: ML)\n## \n##   logLik  Deviance       AIC       BIC      AICc \n##  48.9799  226.5092  -43.9598   38.0379  -31.9598   \n## \n## Variance Components:\n## \n##             estim    sqrt  nlvls  fixed  factor \n## sigma^2    0.0000  0.0005    154     no      id \n## \n## outer factor: trial            (nlvls = 23)\n## inner factor: spray_management (nlvls = 6)\n## \n##             estim    sqrt  k.lvl  fixed             level \n## tau^2.1    0.2070  0.4549     38     no           control \n## tau^2.2    0.2203  0.4694     13     no             Early \n## tau^2.3    0.3288  0.5734     17     no              Late \n## tau^2.4    0.4023  0.6342     19     no         Late_plus \n## tau^2.5    0.2863  0.5351     27     no       Recommended \n## tau^2.6    0.4053  0.6366     40     no  Recommended_plus \n## \n##                   rho.cntr  rho.Erly  rho.Late  rho.Lt_p  rho.Rcmm  rho.Rcm_ \n## control                  1    0.9738    0.9925    0.9893    0.9886    0.9834   \n## Early               0.9738         1    0.9918    0.0000    0.9969    0.9945   \n## Late                0.9925    0.9918         1    0.9997    0.9981    0.9982   \n## Late_plus           0.9893    0.0000    0.9997         1    0.9986    0.9993   \n## Recommended         0.9886    0.9969    0.9981    0.9986         1    0.9969   \n## Recommended_plus    0.9834    0.9945    0.9982    0.9993    0.9969         1   \n##                   cntr  Erly  Late  Lt_p  Rcmm  Rcm_ \n## control              -    no    no    no    no    no \n## Early                7     -    no   yes    no    no \n## Late                11     6     -    no    no    no \n## Late_plus            6     0     3     -    no    no \n## Recommended         19     6    11     3     -    no \n## Recommended_plus    17     6    11     3    17     - \n## \n## Test for Residual Heterogeneity:\n## QE(df = 148) = 9993.0956, p-val < .0001\n## \n## Test of Moderators (coefficients 2:6):\n## QM(df = ) = 37.3595, p-val < .0001\n## \n## Model Results:\n## \n##                                   estimate      se     zval    pval    ci.lb \n## intrcpt                             1.0903  0.0969  11.2569  <.0001   0.9004 \n## spray_managementEarly               0.0029  0.0439   0.0672  0.9464  -0.0830 \n## spray_managementLate                0.1374  0.0440   3.1226  0.0018   0.0512 \n## spray_managementLate_plus           0.1301  0.0578   2.2507  0.0244   0.0168 \n## spray_managementRecommended         0.1378  0.0339   4.0606  <.0001   0.0713 \n## spray_managementRecommended_plus    0.1891  0.0530   3.5692  0.0004   0.0853 \n##                                    ci.ub \n## intrcpt                           1.2801  *** \n## spray_managementEarly             0.0889      \n## spray_managementLate              0.2237   ** \n## spray_managementLate_plus         0.2433    * \n## spray_managementRecommended       0.2043  *** \n## spray_managementRecommended_plus  0.2930  *** \n## \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"grain-yield-meta-analysis.html","id":"meta-analysis-stability-test","chapter":"4 Grain yield meta-analysis","heading":"4.3 Meta-analysis stability test","text":"check stability network analysis rerun chosen model 15 times.\nrun, one 15 trials excluded analysis detect estimates varied significantly indicating unstable network meta-analysis.Trial 9 missen flats changes estimates excluded due high number reps","code":"\nstab_PM_mv <- \n   lapply(unique(PM_dat_Y$trial_ref), function(Trial){\n      \n      #subset to remove a trial\n      dat <- filter(PM_dat_Y, trial_ref != Trial)\n      \n      PM_mv <- rma.mv(\n         yi = grain_yield.t.ha.,\n         V = vi,\n         mods = ~ spray_management,\n         method = \"ML\",\n         random = list(~ spray_management | trial, ~ 1 | id),\n         struct = \"UN\",\n         control = list(optimizer = \"optim\"),\n         data = dat\n      )\n   })## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\n\n## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\nlength(stab_PM_mv)## [1] 15\nest <- lapply(stab_PM_mv, function(e1){\n   data.frame(treat = rownames(e1$b),\n              estimates = e1$b,\n              p = as.numeric(reportP(e1$pval, P_prefix = FALSE,AsNumeric = TRUE)))\n   })\n\nstab_df <- data.table::rbindlist(est)\nstab_df$Tnum <- rep(1:15, each = 6)\n\nstab_df %>%\n   ggplot(aes(Tnum, estimates, colour = treat))+\n   geom_line(size = 1)\nstab_df %>%\n   ggplot(aes(Tnum, p, colour = treat))+\n   geom_line(size = 1)+\n   scale_y_log10()\nstab_df %>%\n   group_by(treat) %>%\n   summarise(minEst = min(estimates),\n             medEst = median(estimates),\n             maxEst = max(estimates),\n             minP = min(p),\n             medP = median(p),\n             maxP= max(p))## # A tibble: 6 x 7\n##   treat                             minEst  medEst maxEst   minP   medP   maxP\n##   <chr>                              <dbl>   <dbl>  <dbl>  <dbl>  <dbl>  <dbl>\n## 1 intrcpt                           1.05   1.10     1.16  0.0001 0.0001 0.0001\n## 2 spray_managementEarly            -0.0261 0.00943  0.124 0.0241 0.819  0.996 \n## 3 spray_managementLate              0.0688 0.142    0.166 0.0008 0.0018 0.0943\n## 4 spray_managementLate_plus         0.0906 0.128    0.191 0.0044 0.02   0.170 \n## 5 spray_managementRecommended       0.0698 0.141    0.154 0.0001 0.0001 0.0174\n## 6 spray_managementRecommended_plus  0.0740 0.198    0.228 0.0001 0.0004 0.0585\nstab_df[Tnum == 9]##                               treat  estimates      p Tnum\n## 1:                          intrcpt 1.04890518 0.0001    9\n## 2:            spray_managementEarly 0.12426838 0.0241    9\n## 3:             spray_managementLate 0.06878672 0.0943    9\n## 4:        spray_managementLate_plus 0.09439121 0.0217    9\n## 5:      spray_managementRecommended 0.06979727 0.0174    9\n## 6: spray_managementRecommended_plus 0.07403166 0.0585    9\nunique(PM_dat_Y$trial_ref)[9]## [1] \"mung1617/02\""},{"path":"grain-yield-meta-analysis.html","id":"between-study-heterogeneity","chapter":"4 Grain yield meta-analysis","heading":"4.3.1 Between study heterogeneity","text":"Calculation ^2This indicates approximate amount total variance attributed trials/ clusters 99%, high.\nHowever given many means included model contained accompanying sample variance zero, might expected.","code":"\nW <- diag(1/(PM_dat_Y$vi))\nX <- model.matrix(PM_mv)\nP <- W - W %*% X %*% solve(t(X) %*% W %*% X) %*% t(X) %*% W\n100 * sum(PM_mv$sigma2) / (sum(PM_mv$sigma2) + (PM_mv$k-PM_mv$p)/sum(diag(P)))## [1] 0.003447115\n100 * PM_mv$sigma2 / (sum(PM_mv$sigma2) + (PM_mv$k-PM_mv$p)/sum(diag(P)))## [1] 0.003447115"},{"path":"grain-yield-meta-analysis.html","id":"meta-analysis-results-summary","chapter":"4 Grain yield meta-analysis","heading":"4.4 Meta-analysis results summary","text":"","code":""},{"path":"grain-yield-meta-analysis.html","id":"moderator-estimates-table","chapter":"4 Grain yield meta-analysis","heading":"4.4.1 Moderator estimates table","text":"Let’s present meta-analysis results moderator variables table estimates.\n(#tab:metafor_results_table_yield)Table 2: Estimated mungbean yield mean difference spray control (intercept) spray schedule treatment. Yield estimates (u) calculated network meta-analysis data obtained grey literature reports ‘k’ field trials undertaken Eastern Australia. P values indicate statistical significance comparison intercept.\nModeratorNakbmucseCI_{L}dCI_{U}ePfEarly1370.00290.0439-0.08300.08890.9464Recommended27190.13780.03390.07130.2043< 0.0001Recommended+40170.18910.05300.08530.29300.0004Late17110.13740.04400.05120.22370.0018Late+1960.13010.05780.01680.24330.0244anumber treatment means categorised spray schedule; bnumber trials respective spray schedule; cestimated mean yield determined meta-analysis; dLower range 95% confidence interval; eUpper range 95% confidence interval; findicates significance respective spray schedule spray control (intercept)","code":"\n# obtain number of treatments included in each moderator variable\nk5 <-\n   as.data.frame(table(PM_dat_Y$trial, PM_dat_Y$spray_management)) %>%\n   filter(Freq != 0) %>%\n   group_by(Var2) %>%\n   summarise(n()) %>%\n   pull()\n\n# create data.frame\nresults_mv <- data.frame(\n   Moderator = c(\n      \"Intercept / No Spray control\",\n      \"Early\",\n      \"Late\",\n      \"Late+\",\n      \"Recommended\",\n      \"Recommended+\"\n   ),\n   N = PM_mv$g.levels.k,\n   k = k5,\n   Effect = round(PM_mv$b, 4),\n   se = round(PM_mv$se, 4),\n   CI_lower = round(PM_mv$ci.lb, 4),\n   CI_upper = round(PM_mv$ci.ub, 4),\n   z_val = round(PM_mv$zval, 4),\n   p_val = reportP(PM_mv$pval, AsNumeric = FALSE, P_prefix = FALSE)\n)\n\n# rename colnames to give table headings\ncolnames(results_mv)[c(2:5, 7:10)] <-\n   c(\"Treatment\",\n     \"N\",\n     \"k\",\n     \"mu\",\n     \"CI_{L}\",\n     \"CI_{U}\",\n     \"Z\",\n     \"P\")\n\nyield_estimates_table <-\n   flextable(results_mv[c(2, 5, 6, 3, 4), c(1, 3:8, 10)]) %>%\n   align(j = 3:8, align = \"center\", part = \"all\") %>%\n   fontsize(size = 8, part = \"body\") %>%\n   fontsize(size = 10, part = \"header\") %>%\n   italic(italic = TRUE, part = \"header\") %>%\n   set_caption(\n      \"Table 2: Estimated mungbean yield mean difference to the no spray control (intercept) for each spray schedule treatment. Yield estimates (u) were calculated from a network meta-analysis of data obtained from grey literature reports of 'k' field trials undertaken in Eastern Australia. P values indicate statistical significance in comparison to the intercept.\"\n   ) %>%\n   autofit() %>%\n   footnote(\n      i = 1,\n      j = c(2:4, 6:8),\n      value = as_paragraph(\n         c(\n            \"number of treatment means categorised to each spray schedule\",\n            \"number of trials with the respective spray schedule\",\n            \"estimated mean yield determined by the meta-analysis\",\n            \"Lower range of the 95% confidence interval\",\n            \"Upper range of the 95% confidence interval\",\n            \"indicates the significance between each respective spray schedule and the no spray control (intercept)\"\n         )\n      ),\n      ref_symbols = letters[1:6],\n      part = \"header\",\n      inline = TRUE\n   )\n\nyield_estimates_table"},{"path":"grain-yield-meta-analysis.html","id":"moderator-estimates-plot","chapter":"4 Grain yield meta-analysis","heading":"4.4.2 Moderator estimates plot","text":"View moderator comparisons plot.","code":"\nresults_mv %>%\n   filter(Treatment != \"control\") %>%\n   mutate(Treatment = factor(Treatment, levels = rev(\n      c(\n         \"Early\",\n         \"Recommended\",\n         \"Recommended_plus\",\n         \"Late\",\n         \"Late_plus\"\n      )\n   ))) %>%\n   ggplot(aes(Treatment, mu)) +\n   geom_hline(\n      yintercept = seq(-0.05, 0.3, by = 0.05),\n      linetype = 3\n   ) +\n   geom_point(aes(size = 1 / se), shape = 15) +\n   geom_linerange(aes(ymin = `CI_{L}`, ymax = `CI_{U}`)) +\n   coord_flip() +\n   labs(caption = \"Bars indicate 95% confidence intervals\")+\n   ylab(expression(paste(\n      \"Mean yield difference to control (t ha\" ^ -1, \")\", sep = \"\"\n   ))) +\n   scale_x_discrete(\n      \"Moderator variable\",\n      labels = c(\n         expression(\"Late\"[\"plus\"]),\n         expression(\"Late\"[\"single\"]),\n         expression(\"Recommended\"[\"plus\"]),\n         expression(\"Recommended\"[\"single\"]),\n         expression(\"Early\"[\"single\"])\n      )\n   )\nggsave(\"paper/figures/Fig2_means_difference.png\",\n       height = 3,\n       dpi = 500)## Saving 7 x 3 in image"},{"path":"grain-yield-meta-analysis.html","id":"moderator-contrasts","chapter":"4 Grain yield meta-analysis","heading":"4.4.3 Moderator contrasts","text":"Calculate treatment contrastscontrastcoefficientsStdErrZvaluepvalssigEarly - control-1.08730.1100-9.8861< 0.0001***Late - control-0.95290.0865-11.0150< 0.0001***Late_plus - control-0.96020.0812-11.8229< 0.0001***Recommended - control-0.95250.0907-10.4983< 0.0001***Recommended_plus - control-0.90110.0781-11.5341< 0.0001***Late - Early0.13450.04742.83720.0046**Late_plus - Early0.12710.06242.03770.0416*Recommended - Early0.13480.02924.6113< 0.0001***Recommended_plus - Early0.18620.05043.69170.0002***Late_plus - Late-0.00730.0473-0.15510.8767Recommended - Late0.00040.03380.01140.9909Recommended_plus - Late0.05170.03771.37100.1704Recommended - Late_plus0.00770.04890.15810.8744Recommended_plus - Late_plus0.05910.04551.29980.1937Recommended_plus - Recommended0.05140.03491.47100.1413These contrasts can viewed plot.","code":"\nsource(\"R/simple_summary.R\") #function to provide a table that includes the treatment names in the contrasts\nsummary(glht(PM_mv, linfct = cbind(contrMat(rep(\n   1, 6\n), type = \"Tukey\"))), test = adjusted(\"none\"))## \n##   Simultaneous Tests for General Linear Hypotheses\n## \n## Fit: rma.mv(yi = grain_yield.t.ha., V = vi, mods = ~spray_management, \n##     random = list(~spray_management | trial, ~1 | id), struct = \"UN\", \n##     data = PM_dat_Y, method = \"ML\", control = list(optimizer = \"optim\"))\n## \n## Linear Hypotheses:\n##              Estimate Std. Error z value Pr(>|z|)    \n## 2 - 1 == 0 -1.0873327  0.1099858  -9.886  < 2e-16 ***\n## 3 - 1 == 0 -0.9528742  0.0865069 -11.015  < 2e-16 ***\n## 4 - 1 == 0 -0.9602137  0.0812167 -11.823  < 2e-16 ***\n## 5 - 1 == 0 -0.9524872  0.0907279 -10.498  < 2e-16 ***\n## 6 - 1 == 0 -0.9011339  0.0781280 -11.534  < 2e-16 ***\n## 3 - 2 == 0  0.1344585  0.0473917   2.837 0.004552 ** \n## 4 - 2 == 0  0.1271189  0.0623833   2.038 0.041579 *  \n## 5 - 2 == 0  0.1348455  0.0292425   4.611    4e-06 ***\n## 6 - 2 == 0  0.1861988  0.0504372   3.692 0.000223 ***\n## 4 - 3 == 0 -0.0073395  0.0473195  -0.155 0.876738    \n## 5 - 3 == 0  0.0003871  0.0338151   0.011 0.990867    \n## 6 - 3 == 0  0.0517403  0.0377384   1.371 0.170367    \n## 5 - 4 == 0  0.0077266  0.0488628   0.158 0.874355    \n## 6 - 4 == 0  0.0590798  0.0454538   1.300 0.193677    \n## 6 - 5 == 0  0.0513532  0.0349093   1.471 0.141278    \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## (Adjusted p values reported -- none method)\ncontrast_Ssum <-\n   simple_summary(summary(glht(PM_mv, linfct = cbind(\n      contrMat(rep(1, 6), type = \"Tukey\")\n   )), test = adjusted(\"none\")))\ncontrast_Ssum %>%\n   flextable()%>%\n   autofit()\npar(mar = c(5, 13, 4, 2) + 0.1)\nplot(glht(PM_mv, linfct = cbind(contrMat(rep(\n   1, 6\n), type = \"Tukey\"))), yaxt = 'n')\naxis(\n   2,\n   at = seq_along(contrast_Ssum$contrast),\n   labels = rev(contrast_Ssum$contrast),\n   las = 2,\n   cex.axis = 0.8\n)"},{"path":"grain-yield-meta-analysis.html","id":"profile-plots","chapter":"4 Grain yield meta-analysis","heading":"4.4.4 Profile plots","text":"inspection profile plots ensure model -fitted can undertaken.\nexpect see estimate align peak curve.\nAlso shape line curve.\nplots take long time generate evaluated.","code":"\nprofile(PM_mv, tau2 = 1)\nprofile(PM_mv, tau2 = 2)\nprofile(PM_mv, tau2 = 3)\nprofile(PM_mv, tau2 = 4)\nprofile(PM_mv, tau2 = 5)\nprofile(PM_mv, tau2 = 6)"},{"path":"grain-yield-meta-analysis.html","id":"netmeta-analysis","chapter":"4 Grain yield meta-analysis","heading":"4.5 netmeta analysis","text":"netmeta package can provide graphical representation pairwise comparisons.netmeta package uses frequentist approach focusing pairwise comparisons treatments.\nresults can used evaluate outcome metafor package robust.","code":"\ndatPM3 <- PM_dat_Y %>%\n   group_by(trial, spray_management, replicates) %>%\n   summarize(yi_mean = mean(grain_yield.t.ha.),\n             vi_mean = mean(vi)) %>%\n   ungroup()## `summarise()` has grouped output by 'trial', 'spray_management'. You can override using the `.groups` argument.\nPM_con <- pairwise(\n   treat = spray_management,\n   n = replicates,\n   mean = yi_mean,\n   sd = sqrt(vi_mean),\n   studlab = trial,\n   data = datPM3,\n   sm = \"MD\"\n)\n\nnet_con <- netmeta(TE,\n                   seTE,\n                   treat1,\n                   treat2,\n                   studlab,\n                   data = PM_con,\n                   sm = \"MD\")\n\nsummary(net_con)## Number of studies: k = 23\n## Number of treatments: n = 6\n## Number of pairwise comparisons: m = 126\n## Number of designs: d = 7\n## \n## Fixed effects model\n## \n## Treatment estimate (sm = 'MD'):\n##                  control   Early    Late Late_plus Recommended Recommended_plus\n## control                . -0.0422 -0.0630   -0.1609     -0.0574          -0.1039\n## Early             0.0422       . -0.0208   -0.1187     -0.0152          -0.0618\n## Late              0.0630  0.0208       .   -0.0980      0.0055          -0.0410\n## Late_plus         0.1609  0.1187  0.0980         .      0.1035           0.0570\n## Recommended       0.0574  0.0152 -0.0055   -0.1035           .          -0.0465\n## Recommended_plus  0.1039  0.0618  0.0410   -0.0570      0.0465                .\n## \n## Lower 95%-confidence limit:\n##                  control   Early    Late Late_plus Recommended Recommended_plus\n## control                . -0.1207 -0.0999   -0.2160     -0.0937          -0.1466\n## Early            -0.0363       . -0.1017   -0.2107     -0.0967          -0.1454\n## Late              0.0260 -0.0601       .   -0.1513     -0.0293          -0.0814\n## Late_plus         0.1058  0.0267  0.0447         .      0.0476           0.0016\n## Recommended       0.0212 -0.0662 -0.0404   -0.1594           .          -0.0884\n## Recommended_plus  0.0613 -0.0219  0.0005   -0.1123      0.0046                .\n## \n## Upper 95%-confidence limit:\n##                  control  Early    Late Late_plus Recommended Recommended_plus\n## control                . 0.0363 -0.0260   -0.1058     -0.0212          -0.0613\n## Early             0.1207      .  0.0601   -0.0267      0.0662           0.0219\n## Late              0.0999 0.1017       .   -0.0447      0.0404          -0.0005\n## Late_plus         0.2160 0.2107  0.1513         .      0.1594           0.1123\n## Recommended       0.0937 0.0967  0.0293   -0.0476           .          -0.0046\n## Recommended_plus  0.1466 0.1454  0.0814   -0.0016      0.0884                .\n## \n## Random effects model\n## \n## Treatment estimate (sm = 'MD'):\n##                  control   Early    Late Late_plus Recommended Recommended_plus\n## control                . -0.0481 -0.1249   -0.1893     -0.0876          -0.1378\n## Early             0.0481       . -0.0768   -0.1412     -0.0395          -0.0897\n## Late              0.1249  0.0768       .   -0.0644      0.0373          -0.0129\n## Late_plus         0.1893  0.1412  0.0644         .      0.1017           0.0515\n## Recommended       0.0876  0.0395 -0.0373   -0.1017           .          -0.0502\n## Recommended_plus  0.1378  0.0897  0.0129   -0.0515      0.0502                .\n## \n## Lower 95%-confidence limit:\n##                  control   Early    Late Late_plus Recommended Recommended_plus\n## control                . -0.1567 -0.2030   -0.2949     -0.1529          -0.2083\n## Early            -0.0606       . -0.1945   -0.2852     -0.1536          -0.2054\n## Late              0.0467 -0.0409       .   -0.1766     -0.0434          -0.0953\n## Late_plus         0.0837 -0.0028 -0.0477         .     -0.0086          -0.0600\n## Recommended       0.0222 -0.0746 -0.1179   -0.2120           .          -0.1225\n## Recommended_plus  0.0672 -0.0260 -0.0696   -0.1631     -0.0221                .\n## \n## Upper 95%-confidence limit:\n##                  control  Early    Late Late_plus Recommended Recommended_plus\n## control                . 0.0606 -0.0467   -0.0837     -0.0222          -0.0672\n## Early             0.1567      .  0.0409    0.0028      0.0746           0.0260\n## Late              0.2030 0.1945       .    0.0477      0.1179           0.0696\n## Late_plus         0.2949 0.2852  0.1766         .      0.2120           0.1631\n## Recommended       0.1529 0.1536  0.0434    0.0086           .           0.0221\n## Recommended_plus  0.2083 0.2054  0.0953    0.0600      0.1225                .\n## \n## Quantifying heterogeneity / inconsistency:\n## tau^2 = 0.0099; tau = 0.0995; I^2 = 55.2% [39.4%; 66.8%]\n## \n## Tests of heterogeneity (within designs) and inconsistency (between designs):\n##                      Q d.f.  p-value\n## Total           122.66   55 < 0.0001\n## Within designs   70.51   44   0.0068\n## Between designs  52.15   11 < 0.0001"},{"path":"grain-yield-meta-analysis.html","id":"netmeta-estimates-plot","chapter":"4 Grain yield meta-analysis","heading":"4.5.1 netmeta estimates plot","text":"Visualise netmeta results forest plot.","code":"\nforest(\n   net_con,\n   reference.group = 1,\n   rightcols = c(\"effect\", \"ci\", \"Pscore\"),\n   rightlabs = \"P-Score\",\n   small.values = \"bad\"\n)"},{"path":"grain-yield-meta-analysis.html","id":"moderator-netgraph","chapter":"4 Grain yield meta-analysis","heading":"4.5.2 Moderator netgraph","text":"netmeta analysis suggests spray schedule commencing early different treatment including spray control.\nestimates mean similar recommended treatments.\nRecommended_plus Late_plus treatments show higher mean estimates, however significantly different Early estimate.","code":"\nnetgraph(\n   net_con,\n   plastic = FALSE,\n   thickness =  \"number.of.studies\",\n   points = FALSE,\n   cex.points = 1,\n   number.of.studies = TRUE,\n   cex.number.of.studies = 1,\n   col.number.of.studies = \"black\",\n   multiarm = FALSE,\n   pos.number.of.studies = 0.4\n)\nnetleague(net_con)## League table (fixed effects model):\n##                                                       \n##                     control -0.1047 [-0.1936; -0.0157]\n##  -0.0422 [-0.1207;  0.0363]                      Early\n##  -0.0630 [-0.0999; -0.0260] -0.0208 [-0.1017;  0.0601]\n##  -0.1609 [-0.2160; -0.1058] -0.1187 [-0.2107; -0.0267]\n##  -0.0574 [-0.0937; -0.0212] -0.0152 [-0.0967;  0.0662]\n##  -0.1039 [-0.1466; -0.0613] -0.0618 [-0.1454;  0.0219]\n##                                                       \n##  -0.0674 [-0.1122; -0.0226] -0.2666 [-0.3469; -0.1862]\n##  -0.1503 [-0.2707; -0.0299]                          .\n##                        Late -0.0684 [-0.1392;  0.0024]\n##  -0.0980 [-0.1513; -0.0447]                  Late_plus\n##   0.0055 [-0.0293;  0.0404]  0.1035 [ 0.0476;  0.1594]\n##  -0.0410 [-0.0814; -0.0005]  0.0570 [ 0.0016;  0.1123]\n##                                                       \n##  -0.0486 [-0.0860; -0.0111] -0.0989 [-0.1442; -0.0536]\n##  -0.0778 [-0.2109;  0.0554] -0.1506 [-0.2839; -0.0172]\n##   0.0041 [-0.0350;  0.0432] -0.0473 [-0.0944; -0.0002]\n##   0.1602 [ 0.0643;  0.2561] -0.0018 [-0.0742;  0.0706]\n##                 Recommended -0.0359 [-0.0797;  0.0079]\n##  -0.0465 [-0.0884; -0.0046]           Recommended_plus\n## \n## League table (random effects model):\n##                                                       \n##                     control -0.0874 [-0.2110;  0.0362]\n##  -0.0481 [-0.1567;  0.0606]                      Early\n##  -0.1249 [-0.2030; -0.0467] -0.0768 [-0.1945;  0.0409]\n##  -0.1893 [-0.2949; -0.0837] -0.1412 [-0.2852;  0.0028]\n##  -0.0876 [-0.1529; -0.0222] -0.0395 [-0.1536;  0.0746]\n##  -0.1378 [-0.2083; -0.0672] -0.0897 [-0.2054;  0.0260]\n##                                                       \n##  -0.1317 [-0.2195; -0.0440] -0.2440 [-0.3702; -0.1179]\n##  -0.1225 [-0.2733;  0.0283]                          .\n##                        Late -0.0459 [-0.1834;  0.0917]\n##  -0.0644 [-0.1766;  0.0477]                  Late_plus\n##   0.0373 [-0.0434;  0.1179]  0.1017 [-0.0086;  0.2120]\n##  -0.0129 [-0.0953;  0.0696]  0.0515 [-0.0600;  0.1631]\n##                                                       \n##  -0.0863 [-0.1532; -0.0195] -0.1314 [-0.2047; -0.0581]\n##  -0.0841 [-0.2420;  0.0738] -0.1605 [-0.3177; -0.0034]\n##   0.0366 [-0.0533;  0.1265] -0.0506 [-0.1411;  0.0400]\n##   0.1468 [-0.0061;  0.2997]  0.0043 [-0.1471;  0.1557]\n##                 Recommended -0.0496 [-0.1233;  0.0241]\n##  -0.0502 [-0.1225;  0.0221]           Recommended_plus\ndecomp.design(net_con)## Q statistics to assess homogeneity / consistency\n## \n##                      Q df  p-value\n## Total           122.66 55 < 0.0001\n## Within designs   70.51 44   0.0068\n## Between designs  52.15 11 < 0.0001\n## \n## Design-specific decomposition of within-designs Q statistic\n## \n##                                               Design     Q df p-value\n##                                    control:Late_plus  0.70  2  0.7036\n##                                  control:Recommended  0.10  1  0.7469\n##      control:Early:Late:Recommended:Recommended_plus 28.07 20  0.1077\n##  control:Late:Late_plus:Recommended:Recommended_plus 18.73  8  0.0164\n##            control:Late:Recommended:Recommended_plus  0.66  3  0.8830\n##                 control:Recommended:Recommended_plus 22.25 10  0.0139\n## \n## Between-designs Q statistic after detaching of single designs\n## \n##                                      Detached design     Q df  p-value\n##                                        control:Early 47.35 10 < 0.0001\n##                                    control:Late_plus 51.33 10 < 0.0001\n##                                  control:Recommended 50.79 10 < 0.0001\n##      control:Early:Late:Recommended:Recommended_plus 38.25  7 < 0.0001\n##  control:Late:Late_plus:Recommended:Recommended_plus 23.35  7   0.0015\n##            control:Late:Recommended:Recommended_plus 33.30  8 < 0.0001\n##                 control:Recommended:Recommended_plus 45.22  9 < 0.0001\n## \n## Q statistic to assess consistency under the assumption of\n## a full design-by-treatment interaction random effects model\n## \n##                     Q df p-value tau.within tau2.within\n## Between designs 18.09 11  0.0795     0.0799      0.0064\nnetsplit(net_con)## Separate indirect from direct evidence (SIDE) using back-calculation method\n## \n## Fixed effects model: \n## \n##                    comparison  k prop     nma  direct  indir.    Diff     z p-value\n##                 control:Early  7 0.78 -0.0422 -0.1047  0.1783 -0.2830 -2.93  0.0034\n##                  control:Late 11 0.68 -0.0630 -0.0674 -0.0536 -0.0138 -0.34  0.7329\n##             control:Late_plus  6 0.47 -0.1609 -0.2666 -0.0672 -0.1993 -3.54  0.0004\n##           control:Recommended 19 0.94 -0.0574 -0.0486 -0.1936  0.1451  1.88  0.0604\n##      control:Recommended_plus 17 0.89 -0.1039 -0.0989 -0.1432  0.0443  0.64  0.5198\n##                    Early:Late  6 0.45 -0.0208 -0.1503  0.0858 -0.2361 -2.85  0.0044\n##               Early:Late_plus  0    0 -0.1187       . -0.1187       .     .       .\n##             Early:Recommended  6 0.37 -0.0152 -0.0778  0.0222 -0.0999 -1.16  0.2445\n##        Early:Recommended_plus  6 0.39 -0.0618 -0.1506 -0.0042 -0.1463 -1.68  0.0939\n##                Late:Late_plus  3 0.57 -0.0980 -0.0684 -0.1366  0.0682  1.24  0.2142\n##              Late:Recommended 11 0.79  0.0055  0.0041  0.0110 -0.0069 -0.16  0.8755\n##         Late:Recommended_plus 11 0.74 -0.0410 -0.0473 -0.0233 -0.0240 -0.51  0.6086\n##         Late_plus:Recommended  3 0.34  0.1035  0.1602  0.0743  0.0859  1.43  0.1538\n##    Late_plus:Recommended_plus  3 0.58  0.0570 -0.0018  0.1396 -0.1414 -2.47  0.0136\n##  Recommended:Recommended_plus 17 0.92 -0.0465 -0.0359 -0.1619  0.1259  1.63  0.1025\n## \n## Random effects model: \n## \n##                    comparison  k prop     nma  direct  indir.    Diff     z p-value\n##                 control:Early  7 0.77 -0.0481 -0.0874  0.0857 -0.1731 -1.31  0.1907\n##                  control:Late 11 0.79 -0.1249 -0.1317 -0.0986 -0.0331 -0.34  0.7362\n##             control:Late_plus  6 0.70 -0.1893 -0.2440 -0.0611 -0.1830 -1.56  0.1198\n##           control:Recommended 19 0.96 -0.0876 -0.0863 -0.1148  0.0285  0.17  0.8613\n##      control:Recommended_plus 17 0.93 -0.1378 -0.1314 -0.2165  0.0851  0.62  0.5336\n##                    Early:Late  6 0.61 -0.0768 -0.1225 -0.0054 -0.1171 -0.95  0.3415\n##               Early:Late_plus  0    0 -0.1412       . -0.1412       .     .       .\n##             Early:Recommended  6 0.52 -0.0395 -0.0841  0.0093 -0.0934 -0.80  0.4233\n##        Early:Recommended_plus  6 0.54 -0.0897 -0.1605 -0.0058 -0.1548 -1.31  0.1915\n##                Late:Late_plus  3 0.66 -0.0644 -0.0459 -0.1013  0.0554  0.46  0.6476\n##              Late:Recommended 11 0.81  0.0373  0.0366  0.0401 -0.0035 -0.03  0.9728\n##         Late:Recommended_plus 11 0.83 -0.0129 -0.0506  0.1695 -0.2201 -1.97  0.0487\n##         Late_plus:Recommended  3 0.52  0.1017  0.1468  0.0528  0.0940  0.83  0.4041\n##    Late_plus:Recommended_plus  3 0.54  0.0515  0.0043  0.1076 -0.1034 -0.90  0.3656\n##  Recommended:Recommended_plus 17 0.96 -0.0502 -0.0496 -0.0646  0.0150  0.08  0.9379\n## \n## Legend:\n##  comparison - Treatment comparison\n##  k          - Number of studies providing direct evidence\n##  prop       - Direct evidence proportion\n##  nma        - Estimated treatment effect (MD) in network meta-analysis\n##  direct     - Estimated treatment effect (MD) derived from direct evidence\n##  indir.     - Estimated treatment effect (MD) derived from indirect evidence\n##  Diff       - Difference between direct and indirect treatment estimates\n##  z          - z-value of test for disagreement (direct versus indirect)\n##  p-value    - p-value of test for disagreement (direct versus indirect)\nnm1 <- netmeasures(net_con)\n\nplot(\n   nm1$meanpath,\n   nm1$minpar,\n   pch = \"\",\n   xlab = \"Mean path length\",\n   ylab = \"Minimal parallelism\"\n)\ntext(nm1$meanpath, nm1$minpar, names(nm1$meanpath), cex = 0.8)\nsave(PM_dat_Y,\n     PM_mv,\n     contrast_Ssum,\n     file = here(\"cache/Meta-analysisData.Rdata\"))"},{"path":"powdery-mildew-severity-meta-analysis.html","id":"powdery-mildew-severity-meta-analysis","chapter":"5 Powdery mildew severity meta-analysis","heading":"5 Powdery mildew severity meta-analysis","text":"additional question main aim: spray schedule similar effect disease severity?model similar grain yield meta-analysis use main variables:Powdery mildew severity, response variable (1-9 scale)\nTrial, resolves combinations categorical random variables:\nyear\nlocation\nrow spacing\ncultivar\n\nspray_management, moderator evaluate difference effect size attributed fungicide application timing.\nid, random variable indicating treatment independent\nPowdery mildew severity, response variable (1-9 scale)Trial, resolves combinations categorical random variables:\nyear\nlocation\nrow spacing\ncultivar\nTrial, resolves combinations categorical random variables:yearlocationrow spacingcultivarspray_management, moderator evaluate difference effect size attributed fungicide application timing.spray_management, moderator evaluate difference effect size attributed fungicide application timing.id, random variable indicating treatment independentid, random variable indicating treatment independentLoad libraries data.","code":"\nif (!require(\"pacman\"))\n   install.packages(\"pacman\")\npacman::p_load(tidyverse,\n               kableExtra,\n               RColorBrewer,\n               metafor,\n               here,\n               netmeta,\n               multcomp,\n               dplyr,\n               flextable,\n               gam,\n               clubSandwich)## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## also installing the dependencies 'iterators', 'foreach'## \n## gam installed## Installing package into '/Users/runner/work/_temp/Library'\n## (as 'lib' is unspecified)## \n## clubSandwich installed\nsource(here(\"R/reportP.R\"))\n\n# Data\nPM_dat_D <-\n   read.csv(\"cache/PM_disease_clean_data.csv\", stringsAsFactors = FALSE)\n\n# functions\nlogit <- function(x){\n   log((x)/(1 - x))\n}\n\ninv_logit <- function(x){\n   exp(x)/(1 + exp(x))\n}"},{"path":"powdery-mildew-severity-meta-analysis.html","id":"define-trial-1","chapter":"5 Powdery mildew severity meta-analysis","heading":"5.0.1 Define Trial","text":"","code":"\nPM_dat_D <-\n   PM_dat_D %>%\n   mutate(trial = paste(trial_ref,\n                        year,\n                        location,\n                        host_genotype,\n                        row_spacing,\n                        sep = \"_\")) "},{"path":"powdery-mildew-severity-meta-analysis.html","id":"inspect-pm-severity-for-normality","chapter":"5 Powdery mildew severity meta-analysis","heading":"5.0.2 Inspect PM severity for normality","text":"Given meta-analysis assumes powdery mildew severity observations univariate normal distribution \\(Y_i = N(\\mu , \\sigma)\\), mean \\(\\mu\\) standard deviation \\(\\sigma\\). need inspect severity normality.can see powdery mildew severity observations skewed towards top scale, eight nine case.can improve normality transforming effect size, disease severity, squaring.Another transformation might suitable discrete response either log() logit() transformation.\nHowever, first convert scale 1 - 9 0 1.","code":"\nhist(PM_dat_D$PM_final_severity)\nsummary(PM_dat_D$PM_final_severity)##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##   1.000   6.367   7.667   6.933   8.000   9.000\nPM_dat_D$yi_square <- PM_dat_D$PM_final_severity ^2\nPM_dat_D$vi_square <- (PM_dat_D$vi +1)^2\n# Note: Here I added 1 to the variance before it was squared. This is because squaring numbers below one makes the number smaller or remain zero. This does not change the meta-analysis mean estimates but does increase heterogeneity and tao._  \n\nhist(PM_dat_D$yi_square)\nsummary(PM_dat_D$yi_square)##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##    1.00   40.54   58.78   51.62   64.00   81.00"},{"path":"powdery-mildew-severity-meta-analysis.html","id":"transform-severity-response","chapter":"5 Powdery mildew severity meta-analysis","heading":"5.0.3 Transform severity response","text":"Let us also transform severity onto percentage scale can compare results meta-analyses transformation, squared severity, percent severity.conversion ordinal scale severity rating described Table 2 paper.can fit GAM curve 1 - 9 scale new scale 0 1.","code":"\n# Percent severity conversion\n# define ordinal conversion from scale to proportion\ns1 <- 0\ns2 <- 0.33*0.5\ns3 <- 0.5*0.87\ns4 <- 0.66*0.75\ns5 <- 0.66*0.87\ns6 <- 0.66*1\ns7 <- 0.75*1\ns8 <- 1*0.87\ns9 <- 1*1\nx <- c(s1, s2, s3, s4, s5, s6, s7, s8, s9)\ny <- c(1:9)\na = data.frame(x,y)\nplot(a)\n# fit a curve using a gam with spline value 0.01\ng1 <- gam(x ~ s(y, spar = 0.1), family = gaussian)\n\n# View plot of gam\nplot(x = predict(g1,\n                 data.frame(y = seq(1, 9, by = 0.1))), y = seq(1, 9, by = 0.1))\npoints(x, y, col = \"red\", pch = 16)\n# predict values for dataset\nnew_sev <- predict(object =  g1, \n                   newdata = data.frame(y = PM_dat_D[,\"PM_final_severity\"])\n                   )\n# Check fit\nplot(x = new_sev, y = PM_dat_D[,\"PM_final_severity\"])\npoints(x,y,col = \"red\", pch = 16)\n# Allocate new variable percent severity\nPM_dat_D$yi_percent <- new_sev \n\n# Conversion of variance\n# Here I add the variance and mean severity and predict the conversion value\n# then subtract the mean severity to obtain the difference as the sample variance\nPM_dat_D$vi_percent  <- predict(object =  g1,\n                   newdata = data.frame(y = PM_dat_D[,\"vi\"] + PM_dat_D[,\"PM_final_severity\"])\n                   ) - PM_dat_D$yi_percent\n\n\n# create log transformed values\nPM_dat_D$yi_log <- log(PM_dat_D$yi_percent)## Warning in log(PM_dat_D$yi_percent): NaNs produced\nPM_dat_D$vi_log <- (PM_dat_D$vi_percent) / (PM_dat_D$replicates * PM_dat_D$yi_percent^2)\n\n# Correct Inf to 0\nPM_dat_D[is.na(PM_dat_D$yi_log),\"yi_log\"] <- 0\nPM_dat_D[PM_dat_D$vi_log == -Inf,\"vi_log\"] <- 0.001\n\n#logit transformed percentages\nPM_dat_D$yi_logit <- logit(PM_dat_D$yi_percent)## Warning in log((x)/(1 - x)): NaNs produced\n# logit transformed variance\nPM_dat_D$vi_logit <-\n   (PM_dat_D$vi_percent) /\n   (PM_dat_D$yi_percent * (1 - PM_dat_D$yi_percent)) ^ 2\n   \n# Correct -Inf to zeros\nPM_dat_D[is.na(PM_dat_D$yi_logit),\"yi_logit\"] <- 0"},{"path":"powdery-mildew-severity-meta-analysis.html","id":"disease-severity-spray-schedule-meta-analysis","chapter":"5 Powdery mildew severity meta-analysis","heading":"5.1 Disease severity spray schedule meta-analysis","text":"First let’s look results meta-analysis without transformationThis analysis shows residual slightly unbalanced perhaps effect time.\nsquaring response improve residuals?\nmeta-analysis -line estimates yield meta-analysis. Early sprays effective reducing powdery mildew severity two sprays higher efficacy single sprays. Recommended sprays effective spray timing reducing disease severity.However square severity common evaluating response obtained scale.\nLog transformed common method evaluating non-normal disease severity.Let’s assess log transformed percent severity\nplot residuals show model normally distributed.\naddition estimates don’t reflect can observed raw data.\nLog transformed percent severity therefore suitable transformationFinally let’s assess logit transformed percent severityWhile estimates P values remained mostly trial dropped analysis. Estimates changed Trial 1617/02 Missen Flats 2017 ommited analysis.Calculation ^2This indicates approximate amount total variance attributed trials/ clusters 99%, high.\nHowever given many means included model contained accompanying sample variance zero, might expected.estimates significance model better reflect distribution raw values.\naddition residuals model evenly distributed.\nLet’s back transform estimates.","code":"\nPMsev_mv <- rma.mv(\n   yi = PM_final_severity,\n   vi,\n   mods = ~ spray_management,\n   method = \"ML\",\n   random = list( ~ spray_management | trial, ~ 1 | id),\n   struct = \"UN\",\n   #control = list(optimizer = \"optim\"),\n   data = PM_dat_D\n)## Warning: There are outcomes with non-positive sampling variances.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\nsummary(PMsev_mv)## \n## Multivariate Meta-Analysis Model (k = 147; method: ML)\n## \n##    logLik   Deviance        AIC        BIC       AICc \n## -145.7909        Inf   345.5818   426.3235   358.2877   \n## \n## Variance Components:\n## \n##             estim    sqrt  nlvls  fixed  factor \n## sigma^2    0.0369  0.1922    147     no      id \n## \n## outer factor: trial            (nlvls = 22)\n## inner factor: spray_management (nlvls = 6)\n## \n##             estim    sqrt  k.lvl  fixed             level \n## tau^2.1    1.5788  1.2565     37     no           control \n## tau^2.2    2.9285  1.7113     13     no             Early \n## tau^2.3    0.6798  0.8245     15     no              Late \n## tau^2.4    0.0619  0.2488     13     no         Late_plus \n## tau^2.5    4.2455  2.0605     28     no       Recommended \n## tau^2.6    6.9310  2.6327     41     no  Recommended_plus \n## \n##                   rho.cntr  rho.Erly  rho.Late  rho.Lt_p  rho.Rcmm  rho.Rcm_ \n## control                  1    0.8287    0.9646    0.9977    0.9402    0.5966   \n## Early               0.8287         1    0.9341    0.0000    0.8077    0.9436   \n## Late                0.9646    0.9341         1    0.9720    0.8830    0.7691   \n## Late_plus           0.9977    0.0000    0.9720         1    0.9537    0.6407   \n## Recommended         0.9402    0.8077    0.8830    0.9537         1    0.6002   \n## Recommended_plus    0.5966    0.9436    0.7691    0.6407    0.6002         1   \n##                   cntr  Erly  Late  Lt_p  Rcmm  Rcm_ \n## control              -    no    no    no    no    no \n## Early                7     -    no   yes    no    no \n## Late                 9     6     -    no    no    no \n## Late_plus            4     0     1     -    no    no \n## Recommended         18     6     9     1     -    no \n## Recommended_plus    16     6     9     1    16     - \n## \n## Test of Moderators (coefficients 2:6):\n## QM(df = 5) = 163.0624, p-val < .0001\n## \n## Model Results:\n## \n##                                   estimate      se     zval    pval    ci.lb \n## intrcpt                             7.6729  0.2766  27.7415  <.0001   7.1308 \n## spray_managementEarly              -1.0439  0.2582  -4.0434  <.0001  -1.5500 \n## spray_managementLate               -0.7455  0.1360  -5.4832  <.0001  -1.0120 \n## spray_managementLate_plus          -1.3633  0.2383  -5.7207  <.0001  -1.8304 \n## spray_managementRecommended        -1.1069  0.2595  -4.2659  <.0001  -1.6155 \n## spray_managementRecommended_plus   -3.2476  0.5445  -5.9645  <.0001  -4.3148 \n##                                     ci.ub \n## intrcpt                            8.2150  *** \n## spray_managementEarly             -0.5379  *** \n## spray_managementLate              -0.4790  *** \n## spray_managementLate_plus         -0.8962  *** \n## spray_managementRecommended       -0.5983  *** \n## spray_managementRecommended_plus  -2.1804  *** \n## \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nplot(rstandard(PMsev_mv)$z, ylim=c(-3,3), pch=19)\nPMsev_mvSQ <- rma.mv(\n   yi = yi_square,\n   V = vi_square,\n   mods = ~ spray_management,\n   method = \"ML\",\n   random = list( ~ spray_management | trial, ~ 1 | id),\n   struct = \"UN\",\n   control = list(optimizer = \"optim\"),\n   data = PM_dat_D\n)## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\nsummary(PMsev_mvSQ)## \n## Multivariate Meta-Analysis Model (k = 147; method: ML)\n## \n##    logLik   Deviance        AIC        BIC       AICc \n## -532.3560   726.4536  1118.7120  1199.4537  1131.4179   \n## \n## Variance Components:\n## \n##              estim    sqrt  nlvls  fixed  factor \n## sigma^2    23.3194  4.8290    147     no      id \n## \n## outer factor: trial            (nlvls = 22)\n## inner factor: spray_management (nlvls = 6)\n## \n##               estim     sqrt  k.lvl  fixed             level \n## tau^2.1    306.0169  17.4933     37     no           control \n## tau^2.2    306.3846  17.5038     13     no             Early \n## tau^2.3    134.8188  11.6111     15     no              Late \n## tau^2.4     20.9591   4.5781     13     no         Late_plus \n## tau^2.5    575.9514  23.9990     28     no       Recommended \n## tau^2.6    891.6918  29.8612     41     no  Recommended_plus \n## \n##                   rho.cntr  rho.Erly  rho.Late  rho.Lt_p  rho.Rcmm  rho.Rcm_ \n## control                  1    0.9817    0.9321    1.0000    0.7906    0.8253   \n## Early               0.9817         1    0.9839    0.0000    0.7816    0.9024   \n## Late                0.9321    0.9839         1    0.9306    0.7456    0.9440   \n## Late_plus           1.0000    0.0000    0.9306         1    0.7904    0.8233   \n## Recommended         0.7906    0.7816    0.7456    0.7904         1    0.8436   \n## Recommended_plus    0.8253    0.9024    0.9440    0.8233    0.8436         1   \n##                   cntr  Erly  Late  Lt_p  Rcmm  Rcm_ \n## control              -    no    no    no    no    no \n## Early                7     -    no   yes    no    no \n## Late                 9     6     -    no    no    no \n## Late_plus            4     0     1     -    no    no \n## Recommended         18     6     9     1     -    no \n## Recommended_plus    16     6     9     1    16     - \n## \n## Test for Residual Heterogeneity:\n## QE(df = 141) = 30608.5216, p-val < .0001\n## \n## Test of Moderators (coefficients 2:6):\n## QM(df = 5) = 140.8577, p-val < .0001\n## \n## Model Results:\n## \n##                                   estimate      se     zval    pval     ci.lb \n## intrcpt                            60.0043  3.8371  15.6378  <.0001   52.4836 \n## spray_managementEarly              -4.0626  1.9081  -2.1292  0.0332   -7.8023 \n## spray_managementLate              -11.9164  2.3694  -5.0292  <.0001  -16.5604 \n## spray_managementLate_plus         -17.4846  3.2357  -5.4037  <.0001  -23.8264 \n## spray_managementRecommended       -17.3870  3.7880  -4.5900  <.0001  -24.8113 \n## spray_managementRecommended_plus  -38.1953  4.6263  -8.2561  <.0001  -47.2628 \n##                                      ci.ub \n## intrcpt                            67.5249  *** \n## spray_managementEarly              -0.3229    * \n## spray_managementLate               -7.2724  *** \n## spray_managementLate_plus         -11.1428  *** \n## spray_managementRecommended        -9.9626  *** \n## spray_managementRecommended_plus  -29.1278  *** \n## \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nplot(rstandard(PMsev_mvSQ)$z, ylim=c(-3,3), pch=19)\n# remove controls for response ratio meta-analysis\nPMsev_mv_log <- rma.mv(\n   yi = yi_log,\n   V = yi_log,\n   mods = ~ spray_management,\n   method = \"ML\",\n   random = list( ~ spray_management | trial, ~ 1 | id),\n   struct = \"UN\",\n   control = list(optimizer = \"optim\"),\n   data = PM_dat_D\n)## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\nsummary(PMsev_mv_log)## \n## Multivariate Meta-Analysis Model (k = 147; method: ML)\n## \n##   logLik  Deviance       AIC       BIC      AICc \n## -23.7322       Inf  101.4645  182.2061  114.1703   \n## \n## Variance Components:\n## \n##             estim    sqrt  nlvls  fixed  factor \n## sigma^2    0.0497  0.2230    147     no      id \n## \n## outer factor: trial            (nlvls = 22)\n## inner factor: spray_management (nlvls = 6)\n## \n##             estim    sqrt  k.lvl  fixed             level \n## tau^2.1    0.0207  0.1437     37     no           control \n## tau^2.2    0.0666  0.2580     13     no             Early \n## tau^2.3    0.0105  0.1026     15     no              Late \n## tau^2.4    0.0000  0.0067     13     no         Late_plus \n## tau^2.5    0.1564  0.3954     28     no       Recommended \n## tau^2.6    0.2733  0.5228     41     no  Recommended_plus \n## \n##                   rho.cntr  rho.Erly  rho.Late  rho.Lt_p  rho.Rcmm  rho.Rcm_ \n## control                  1    0.9272    0.9081    0.9951    0.9649    0.8100   \n## Early               0.9272         1    0.9988    0.0000    0.7963    0.9707   \n## Late                0.9081    0.9988         1    0.8622    0.7661    0.9812   \n## Late_plus           0.9951    0.0000    0.8622         1    0.9861    0.7481   \n## Recommended         0.9649    0.7963    0.7661    0.9861         1    0.6275   \n## Recommended_plus    0.8100    0.9707    0.9812    0.7481    0.6275         1   \n##                   cntr  Erly  Late  Lt_p  Rcmm  Rcm_ \n## control              -    no    no    no    no    no \n## Early                7     -    no   yes    no    no \n## Late                 9     6     -    no    no    no \n## Late_plus            4     0     1     -    no    no \n## Recommended         18     6     9     1     -    no \n## Recommended_plus    16     6     9     1    16     - \n## \n## Test of Moderators (coefficients 2:6):\n## QM(df = 5) = 32.1570, p-val < .0001\n## \n## Model Results:\n## \n##                                   estimate      se     zval    pval    ci.lb \n## intrcpt                            -0.1940  0.0481  -4.0354  <.0001  -0.2883 \n## spray_managementEarly              -0.1571  0.0822  -1.9111  0.0560  -0.3182 \n## spray_managementLate               -0.1017  0.0705  -1.4416  0.1494  -0.2400 \n## spray_managementLate_plus          -0.1391  0.0778  -1.7887  0.0737  -0.2915 \n## spray_managementRecommended        -0.2561  0.0853  -3.0036  0.0027  -0.4232 \n## spray_managementRecommended_plus   -0.5686  0.1165  -4.8810  <.0001  -0.7969 \n##                                     ci.ub \n## intrcpt                           -0.0998  *** \n## spray_managementEarly              0.0040    . \n## spray_managementLate               0.0366      \n## spray_managementLate_plus          0.0133    . \n## spray_managementRecommended       -0.0890   ** \n## spray_managementRecommended_plus  -0.3403  *** \n## \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nplot(rstandard(PMsev_mv_log)$z, ylim=c(-3.2,3), pch=19)\n# remove controls for response ratio meta-analysis\nPMsev_mvPer <- rma.mv(\n   yi = yi_logit,\n   V = yi_logit,\n   mods = ~ spray_management,\n   method = \"ML\",\n   random = list( ~ spray_management | trial, ~ 1 | id),\n   struct = \"UN\",\n   control = list(optimizer = \"optim\"),\n   data = PM_dat_D\n)## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\nsummary(PMsev_mvPer)## \n## Multivariate Meta-Analysis Model (k = 147; method: ML)\n## \n##    logLik   Deviance        AIC        BIC       AICc \n## -254.6073        Inf   563.2146   643.9563   575.9205   \n## \n## Variance Components:\n## \n##             estim    sqrt  nlvls  fixed  factor \n## sigma^2    0.2978  0.5457    147     no      id \n## \n## outer factor: trial            (nlvls = 22)\n## inner factor: spray_management (nlvls = 6)\n## \n##             estim    sqrt  k.lvl  fixed             level \n## tau^2.1    4.0250  2.0062     37     no           control \n## tau^2.2    2.9086  1.7054     13     no             Early \n## tau^2.3    0.0918  0.3030     15     no              Late \n## tau^2.4    0.0029  0.0538     13     no         Late_plus \n## tau^2.5    0.9843  0.9921     28     no       Recommended \n## tau^2.6    1.2059  1.0982     41     no  Recommended_plus \n## \n##                   rho.cntr  rho.Erly  rho.Late  rho.Lt_p  rho.Rcmm  rho.Rcm_ \n## control                  1    0.9992    0.9799    0.9995    0.8628    0.8191   \n## Early               0.9992         1    0.9869    0.0000    0.8818    0.8407   \n## Late                0.9799    0.9869         1    0.9733    0.9463    0.9170   \n## Late_plus           0.9995    0.0000    0.9733         1    0.8467    0.8009   \n## Recommended         0.8628    0.8818    0.9463    0.8467         1    0.9967   \n## Recommended_plus    0.8191    0.8407    0.9170    0.8009    0.9967         1   \n##                   cntr  Erly  Late  Lt_p  Rcmm  Rcm_ \n## control              -    no    no    no    no    no \n## Early                7     -    no   yes    no    no \n## Late                 9     6     -    no    no    no \n## Late_plus            4     0     1     -    no    no \n## Recommended         18     6     9     1     -    no \n## Recommended_plus    16     6     9     1    16     - \n## \n## Test of Moderators (coefficients 2:6):\n## QM(df = 5) = 45.9481, p-val < .0001\n## \n## Model Results:\n## \n##                                   estimate      se     zval    pval    ci.lb \n## intrcpt                             2.4499  0.5026   4.8748  <.0001   1.4649 \n## spray_managementEarly              -0.4833  0.4791  -1.0089  0.3130  -1.4223 \n## spray_managementLate               -1.2147  0.5648  -2.1509  0.0315  -2.3216 \n## spray_managementLate_plus          -1.5524  0.5787  -2.6825  0.0073  -2.6866 \n## spray_managementRecommended        -1.8393  0.4268  -4.3093  <.0001  -2.6759 \n## spray_managementRecommended_plus   -2.5308  0.4183  -6.0501  <.0001  -3.3506 \n##                                     ci.ub \n## intrcpt                            3.4349  *** \n## spray_managementEarly              0.4556      \n## spray_managementLate              -0.1078    * \n## spray_managementLate_plus         -0.4182   ** \n## spray_managementRecommended       -1.0028  *** \n## spray_managementRecommended_plus  -1.7109  *** \n## \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n# plot the model residuals\nplot(rstandard(PMsev_mvPer)$z, ylim=c(-3,3), pch=19)\ns_analysis <- \n   lapply(unique(PM_dat_D$trial_ref), function(Trial) {\n      \n      dat <- filter(PM_dat_D, trial_ref != Trial)\n      # remove controls for response ratio meta-analysis\n      rma.mv(\n         yi = yi_logit,\n         V = yi_logit,\n         mods = ~ spray_management,\n         method = \"ML\",\n         random = list(~ spray_management | trial, ~ 1 | id),\n         struct = \"UN\",\n         control = list(optimizer = \"optim\"),\n         data = dat\n      )\n      \n   })## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.## Warning: There are outcomes with non-positive sampling variances.## Warning: Negative sampling variances constrained to zero.## Warning: 'V' appears to be not positive definite.## Warning: Some combinations of the levels of the inner factor never occurred.\n## Corresponding rho value(s) fixed to 0.\nlength(s_analysis)## [1] 14\nest <- lapply(s_analysis, function(e1){\n   data.frame(treat = rownames(e1$b),\n              estimates = e1$b,\n              p = as.numeric(reportP(e1$pval, P_prefix = FALSE,AsNumeric = TRUE)))\n   })\n\nsensitiviy_df <- data.table::rbindlist(est)\nsensitiviy_df$Tnum <- rep(1:14, each = 6)\n\nsensitiviy_df %>%\n   ggplot(aes(Tnum, estimates, colour = treat))+\n   geom_line(size = 1)\nsensitiviy_df %>%\n   ggplot(aes(Tnum, p, colour = treat))+\n   geom_line(size = 1)+\n   scale_y_log10()\nunique(PM_dat_D$trial_ref)[7]## [1] \"mung1617/02\"\nsensitiviy_df %>%\n   group_by(treat) %>%\n   summarise(minEst = min(estimates),\n             medEst = median(estimates),\n             maxEst = max(estimates),\n             minP = min(p),\n             medP = median(p),\n             maxP= max(p))## # A tibble: 6 x 7\n##   treat                            minEst medEst maxEst   minP    medP   maxP\n##   <chr>                             <dbl>  <dbl>  <dbl>  <dbl>   <dbl>  <dbl>\n## 1 intrcpt                            1.39  2.51   2.73  0.0001 0.0001  0.0001\n## 2 spray_managementEarly             -1.08 -0.519 -0.412 0.0982 0.275   0.493 \n## 3 spray_managementLate              -1.54 -1.26  -0.224 0.0165 0.0302  0.653 \n## 4 spray_managementLate_plus         -1.83 -1.61  -0.500 0.0033 0.00745 0.231 \n## 5 spray_managementRecommended       -2.32 -1.89  -1.06  0.0001 0.0001  0.0012\n## 6 spray_managementRecommended_plus  -3.07 -2.58  -1.82  0.0001 0.0001  0.0001\nW <- diag(1/(PM_dat_D$vi_logit+0.0001))\nX <- model.matrix(PMsev_mvPer)\nP <- W - W %*% X %*% solve(t(X) %*% W %*% X) %*% t(X) %*% W\n100 * sum(PMsev_mvPer$sigma2) / (sum(PMsev_mvPer$sigma2) + (PMsev_mvPer$k-PMsev_mvPer$p)/sum(diag(P)))## [1] 99.93606\n100 * PMsev_mvPer$sigma2 / (sum(PMsev_mvPer$sigma2) + (PMsev_mvPer$k-PMsev_mvPer$p)/sum(diag(P)))## [1] 99.93606\nbacktransform <- function(m, input_only = FALSE, intercept) {\n   if (input_only == FALSE) {\n      intercept <- m$b[1]\n      \n      dat <- data.frame(\n         estimates = inv_logit(c(intercept, m$b[-1] + intercept)),\n         StdErr = inv_logit(m$se + intercept) - inv_logit(intercept),\n         Zval = c(inv_logit(m$z[1]),\n                  inv_logit(m$z[-1] + m$z[1]) - inv_logit(m$z[1])),\n         Pval = reportP(m$pval, P_prefix = FALSE),\n         CI_lb = c(inv_logit(m$ci.lb[1]), \n                       inv_logit(m$ci.lb[-1] + intercept)),\n         CI_ub = c(inv_logit(m$ci.ub[1]), \n                       inv_logit(m$ci.ub[-1] + intercept)), \n         row.names = colnames(m$G)\n      )\n   }\n   if (input_only == TRUE) {\n      if (missing(intercept))\n         stop(\"'intercept' argument is empty\")\n     return( inv_logit(m + intercept) - inv_logit(intercept))\n   }\n   return(dat)\n}\n\nbacktransform(PMsev_mvPer)##                  estimates     StdErr        Zval     Pval     CI_lb     CI_ub\n## control          0.9205527 0.02982578  0.99242160 < 0.0001 0.8122794 0.9687768\n## Early            0.8772409 0.02870660 -0.01293451    0.313 0.7364486 0.9481188\n## Late             0.7747212 0.03267812 -0.05399564   0.0315 0.5320236 0.9123010\n## Late_plus        0.7104378 0.03329573 -0.09286533   0.0073 0.4410980 0.8840885\n## Recommended      0.6480696 0.02613013 -0.35468527 < 0.0001 0.4437397 0.8095559\n## Recommended_plus 0.4797860 0.02569827 -0.75652003 < 0.0001 0.2888949 0.6767677"},{"path":"powdery-mildew-severity-meta-analysis.html","id":"disease-severity-moderator-contrasts","chapter":"5 Powdery mildew severity meta-analysis","heading":"5.1.1 Disease severity moderator contrasts","text":"Calculate treatment contrasts without back-transformation.contrastcoefficientsStdErrZvaluepvalssigLate - Early-0.73140.6346-1.15250.2491Late_plus - Early-1.06900.6475-1.65100.0987Recommended - Early-1.35600.5373-2.52360.0116*Recommended_plus - Early-2.04750.5263-3.8906< 0.0001***Late_plus - Late-0.33770.4608-0.73280.4637Recommended - Late-0.62460.4244-1.47180.1411Recommended_plus - Late-1.31610.4175-3.15240.0016**Recommended - Late_plus-0.28690.4171-0.68800.4914Recommended_plus - Late_plus-0.97840.4131-2.36820.0179*Recommended_plus - Recommended-0.69150.2400-2.88070.004**Recommended_plus limited disease severity significantly better spray treatment.\nEarly sprays effective decreasing disease severity.\nTwo spray treatments significantly better single application, timing fungicide application critical.","code":"\nsource(\"R/simple_summary.R\") #function to provide a table that includes the treatment names in the contrasts\n\nintercept <-PMsev_mvPer$b[1,1]\nz <- PMsev_mvPer$zval[1]\n\ncontrast_Ssum <-\n   simple_summary(summary(glht(PMsev_mvPer, linfct = cbind(\n      contrMat(rep(1, 6), type = \"Tukey\")\n   )), test = adjusted(\"none\")))\n\ncontrast_Ssum[6:15,] %>%\n   flextable()%>%\n   autofit()\npar(mar = c(5, 13, 4, 2) + 0.1)\nplot(glht(PMsev_mvPer, linfct = cbind(contrMat(rep(\n   1, 6\n), type = \"Tukey\"))), yaxt = 'n')\naxis(\n   2,\n   at = seq_along(contrast_Ssum$contrast),\n   labels = rev(contrast_Ssum$contrast),\n   las = 2,\n   cex.axis = 0.8\n)"},{"path":"powdery-mildew-severity-meta-analysis.html","id":"meta-analysis-summary-table","chapter":"5 Powdery mildew severity meta-analysis","heading":"5.1.2 Meta-analysis summary table","text":"\n(#tab:metafor_results)Table 3: Estimated powdery mildew severity mean difference spray schedule treatment unsprayed control treatments. Meta-analysis estimates back transformed using inverse logit. Data obtained grey literature reports (k) field trials undertaken Eastern Australia. P values indicate statistical significance comparison intercept.\nModeratorNakbmucsePdCI_{L}eCI_{U}fEarly133-0.04330.02870.313-0.1841-1.1047Recommended2812-0.27250.0261< 0.0001-0.4768-1.3974Recommended+4111-0.44080.0257< 0.0001-0.6317-1.5522Late155-0.14580.03270.0315-0.3885-1.3091Late+132-0.21010.03330.0073-0.4795-1.4000aNumber treatment means categorised spray schedule; bNumber trials respective spray schedule; cEstimated mean disease severity; dIndicates significance respective spray schedule spray control (intercept); eLower range 95% confidence interval; fUpper range 95% confidence intervalKelly, Lisa, Jo White, Murray Sharman, Hugh Brier, Liz Williams, Raechelle Grams, Duncan Weir, Alan Mckay, Adam H. Sparks. 2017. “Mungbean sorghum disease update - GRDC.” https://grdc.com.au/resources--publications/grdc-update-papers/tab-content/grdc-update-papers/2017/07/mungbean--sorghum-disease-update.Madden, L. V., H. P. Piepho, P. . Paul. 2016. “Statistical Models Methods Network Meta-Analysis.” Phytopathology 106 (8): 792–806. https://doi.org/10.1094/PHYTO-12-15-0342-RVW.Thompson, Sue. 2016. “Mungbeans Vs Fungus: Two Sprays Optimum Control - Grains Research Development Corporation.” Ground Cover, September. https://grdc.com.au/resources--publications/groundcover/ground-cover-issue-124-septemberoctober-2016/mungbeans-vs-fungus-two-sprays--optimum-control.Viechtbauer, Wolfgang. 2010. “Conducting Meta-Analyses R metafor Package.” Journal Statistical Software 36 (3): 1–48. https://doi.org/10.18637/jss.v036.i03.","code":"\n# obtain number of treatments included in each moderator variable\nk5 <-\n   as.data.frame(table(PM_dat_D$spray_management)) %>%\n   filter(Freq != 0) %>%\n   pull(Freq)\n\nk6 <-\n   as.data.frame(table(PM_dat_D$trial_ref, PM_dat_D$spray_management)) %>%\n   filter(Freq != 0) %>%\n   group_by(Var2) %>%\n   summarise(n()) %>%\n   pull()\n\n\n# create data.frame of percent disease severity estimates\nresults_mv <- cbind(\n   data.frame(\n      Moderator = c(\n         \"Intercept / No Spray control\",\n         \"Early\",\n         \"Late\",\n         \"Late+\",\n         \"Recommended\",\n         \"Recommended+\"\n      ),\n      N = k5,\n      k = k6\n   ),\n   backtransform(PMsev_mvPer))\n\n# Calculate mean differences\nIntcpt <- results_mv$estimates[1]\nresults_mv <- \n   results_mv %>%\n   mutate(estimates = estimates - Intcpt,\n          CI_lb = CI_lb - Intcpt,\n          CI_ub = CI_lb - Intcpt)\n\n# round the numbers\nresults_mv[,c(4:6,8:9)] <- round(results_mv[,c(4:6,8:9)], 4)\n\n# results_mv <- \n#    results_mv %>%\n#    mutate(\n#    eff_bar = round(\n#       1 - estimates, \n#       4) * 100,\n#    eff_CI_high = round(\n#       1 - CI_lb\n#    , 4) * 100,\n#    eff_CI_low = round(\n#       1 - CI_ub\n#    , 4) * 100\n#    \n# )\n\n# remove efficacy in control\n#results_mv[1,10:12] <- NA\n\n# rename colnames to give table headings\ncolnames(results_mv)[c(1:9 )] <-\n   c(\"Moderator\",\n     \"N\",\n     \"k\",\n     \"mu\",\n     \"se\",\n     \"Z\",\n     \"P\",\n     \"CI_{L}\",\n     \"CI_{U}\")\n\ndisease_estimates_table <-\n   results_mv[c(2,5,6,3,4), -6] %>%\n   flextable() %>%\n   align(j = 2:8, align = \"center\", part = \"all\") %>%\n   fontsize(size = 8, part = \"body\") %>%\n   fontsize(size = 10, part = \"header\") %>%\n   italic(italic = TRUE, part = \"header\") %>%\n   set_caption(\n      \"Table 3: Estimated powdery mildew severity mean difference for each spray schedule treatment to the unsprayed control treatments. Meta-analysis estimates were back transformed using an inverse logit. Data were obtained from the grey literature reports of (k) field trials undertaken in Eastern Australia. P values indicate statistical significance in comparison to the intercept.\"\n   ) %>%\n   footnote(\n      i = 1,\n      j = c(2:4,6:8),\n      value = as_paragraph(\n         c(\n            \"Number of treatment means categorised to each spray schedule\",\n            \"Number of trials with the respective spray schedule\",\n            \"Estimated mean disease severity\",\n            \"Indicates the significance between each respective spray schedule and the no spray control (intercept)\",\n            \"Lower range of the 95% confidence interval\",\n            \"Upper range of the 95% confidence interval\"\n         )\n      ),\n      ref_symbols = letters[c(1:6)],\n      part = \"header\",\n      inline = TRUE\n    )%>%\n   hline_top(part=\"all\", border = officer::fp_border(color = \"black\", width = 2))%>%\n   width(j = 1, width = 1) %>%\n   width(j = 2, width = 0.3) %>%\n   width(j = 3, width = 0.3) %>%\n   width(j = 4:8, width = 0.6) \n\ndisease_estimates_table"}]
