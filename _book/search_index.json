[
["meta-analysis.html", "5 Meta-analysis 5.1 Grain yield meta-analysis 5.2 Meta-analysis", " 5 Meta-analysis 5.1 Grain yield meta-analysis Let’s get started with the analysis by first finding the best model fit that answers our research question. Which spray management scenario provides the greatest yield protection from powdery mildew. To do this, in our model: Grain yield is our response variable and will be converted to kg / ha Trial, which resolves combinations of categorical variables: year, location, row spacing, fungicide dose and cultivar; is set as a random intercept We will test spray management (our treatment) as a fixed effect and random slope to trial First, how well the data is compared across the trial years and trials. kable( table(slimmer_PM_dat$spray_management, slimmer_PM_dat$year), align = rep(&#39;c&#39;, 8), caption = &quot;Which treatments and how many treatments are represented in each year&quot; ) %&gt;% kable_styling( &quot;striped&quot;, fixed_thead = TRUE, full_width = FALSE, position = &quot;center&quot; ) (#tab:table_of_nTreatments)Which treatments and how many treatments are represented in each year 2011 2012 2013 2015 2016 2017 2018 2019 control 4 2 4 1 3 18 6 2 Early 0 0 1 0 0 12 0 0 Late 0 0 0 1 2 12 0 2 Late_plus 0 0 0 1 7 0 12 0 Recommended 4 6 3 1 4 12 0 2 Recommended_plus 2 6 6 1 5 24 0 2 Before analysis let’s have a look at the trimmed down modified data. Treatments Late_plus and early don’t have very good comparison to other treatments. Let’s visualise the spread of data in each treatments with box-plots. # class spray_management as a factor and reorder them for the plot slimmer_PM_dat$spray_management &lt;- factor(slimmer_PM_dat$spray_management, levels(factor(slimmer_PM_dat$spray_management))[rev(c(1, 2, 5, 6, 3, 4))]) slimmer_PM_dat %&gt;% ggplot(aes(y = grain_yield.t.ha, x = spray_management)) + geom_boxplot() + #geom_point(position = &quot;jitter&quot;, alpha = 1/5)+ geom_jitter(width = 0.1, alpha = 1 / 5) + labs(x = &quot;Spray management variable&quot;, y = &quot;Grain yield (t/Ha)&quot;, title = &quot;Mean grain yield from each treatment \\n categorised by spray management scenario&quot;) + theme(plot.title = element_text(hjust = 0.5)) + geom_hline(yintercept = 0, linetype = 2) + coord_flip() There seems like little difference between the treatments, with exception to Late_plus. Let’s do this plot again, but let’s look at the proportional mean difference between the treatments and the no spray control for each study, this should reduce variation in yield due between trials. slimmer_PM_dat$spray_management &lt;- factor(slimmer_PM_dat$spray_management, rev( c( &quot;control&quot;, &quot;Early&quot;, &quot;Recommended&quot;, &quot;Recommended_plus&quot;, &quot;Late&quot;, &quot;Late_plus&quot; ) )) slimmer_PM_dat %&gt;% ggplot(aes(y = prop_yield_gain, x = spray_management)) + geom_boxplot() + geom_jitter(width = 0.1, alpha = 1 / 5) + labs(x = &quot;Spray management variable&quot;, y = &quot;Grain yield (t/Ha)&quot;, title = &quot;Mean grain yield difference to the control for each treatment \\n categorised by spray management scenario&quot;) + theme(plot.title = element_text(hjust = 0.5)) + geom_hline(yintercept = 0, linetype = 2) + coord_flip() ## Warning: Removed 40 rows containing non-finite values (stat_boxplot). ## Warning: Removed 40 rows containing missing values (geom_point). Using the mean difference in the treatment effect seems to show the effect of each treatment better than just raw yield and reduces the variability in the treatments. We know there is a good deal of variability in our studies and between them. Mungbean produces variable yields between seasons so we should use a response that highlights the difference in the treatment effects that we are interested in and reduce the variability. Let’s calculate the standardised mean difference for each treatment to reduce the variability in the meta-analysis. 5.1.1 Formatting Variance First lets remove any entries missing variance. any(is.na(slimmer_PM_dat$yield_error)) ## [1] TRUE slimmer_PM_dat &lt;- slimmer_PM_dat[!is.na(slimmer_PM_dat$yield_error),] slimmer_PM_dat$vi &lt;- slimmer_PM_dat$yield_error 5.1.1.1 Calculate sample variance from mean square errors Currently our data frame has the sample variance calculated earlier, however we can approximate it using the mean squared error. Let’s show the rational for our calculation and then add a secondary variance column (vi2). \\(MSE = Var + bias\\) However if our MSE was calculated from an unbiased sample we can assume \\(bias = 0\\) and therefore: \\(MSE = Var\\) To calculate the sample variance (for each treatment in the trial) from the mean square error (Trial variance) all we need to do is divide by the number of samples in each treatment. We can show this because: \\(MSE = \\frac{\\sum_{y_1}^{y_n}(y_i - \\overline{y})^2}{n - 1}\\) Where the sum of squares for the fungicide treatment estimator (\\(y\\)) is divided by the number of fungicide treatments (\\(n\\)). The sample variance is a similar formula except we use \\(x\\) instead of \\(y\\). \\(S_{Var} = \\frac{\\sum_{x_1}^{x_n}(x_i - \\overline{x})^2}{n - 1}\\) \\(x\\) being each observation within the experiment and \\(n\\) being the number of samples in the whole trial. Therefore: \\(S_{Var}\\approx\\frac{1}{n_{x}}\\frac{\\sum_{y_1}^{y_n}(y_i - \\overline{y})^2}{n_y - 1}\\) Where \\(n_x\\) is the number of samples within each treatment. #calculation when using log of response # slimmer_PM_dat$vi &lt;- # slimmer_PM_dat$Y_Msquare / (slimmer_PM_dat$n * slimmer_PM_dat$grain_yield.t.ha ^ # 2) # slimmer_PM_dat$vi2 &lt;- slimmer_PM_dat$Y_Msquare / slimmer_PM_dat$n We have removed the studies that don’t report any variance from the analysis. 5.1.2 Calculate standardised mean differences Let’s calculate standardised mean differences and add them to the data frame. slimmer_PM_dat$pooledSD &lt;- NA slimmer_PM_dat$vi_C &lt;- NA for (T_ref in slimmer_PM_dat$trial_ref) { # First we need to Calculate the pooled standard deviation slimmer_PM_dat[slimmer_PM_dat$trial_ref == T_ref, &quot;pooledSD&quot;] &lt;- sqrt(sum((slimmer_PM_dat[slimmer_PM_dat$trial_ref == T_ref, &quot;n&quot;] - 1) * slimmer_PM_dat[slimmer_PM_dat$trial_ref == T_ref, &quot;yield_error&quot;]) / (sum(slimmer_PM_dat[slimmer_PM_dat$trial_ref == T_ref, &quot;n&quot;]) - nrow(slimmer_PM_dat[slimmer_PM_dat$trial_ref == T_ref,]))) # Then Create a column with the value of the mean grain yield of the no spray control for comparisons to the treatments means slimmer_PM_dat[slimmer_PM_dat$trial_ref == T_ref, &quot;yi_C&quot;] &lt;- mean(slimmer_PM_dat[slimmer_PM_dat$trial_ref == T_ref &amp; slimmer_PM_dat$fungicide_ai == &quot;control&quot;, &quot;grain_yield.t.ha&quot;], na.rm = TRUE) } # Calculate standardised mean difference slimmer_PM_dat$grain_SMD &lt;- (slimmer_PM_dat$grain_yield.t.ha - slimmer_PM_dat$yi_C) / slimmer_PM_dat$pooledSD We can use the same sample variance with the standardised mean difference. This is because if you add or subtract from a random variable, the variance does not change. Let’s simplify our data. dat1 &lt;- slimmer_PM_dat %&gt;% filter(fungicide_ai != &quot;control&quot;) %&gt;% #remove controls from the data mutate(spray_management = factor( spray_management, c( &quot;Early&quot;, &quot;Recommended&quot;, &quot;Recommended_plus&quot;, &quot;Late&quot;, &quot;Late_plus&quot; ) ), D_pres = factor(D_pres, c(&quot;lowD&quot;, &quot;highD&quot;))) %&gt;% select( trial, trial_ref, location, year, row_spacing, host_genotype , spray_management, fungicide_ai, D_pres, grain_yield.t.ha, grain_SMD, dose, vi, vi2 ) 5.2 Meta-analysis 5.2.1 metafor package Let’s inspect the data to determine if we need to transform the response variable. hist_usq(dat1$grain_yield.t.ha) hist_usq(log(dat1$grain_yield.t.ha)) hist_usq(sqrt(dat1$grain_yield.t.ha)) hist_usq(dat1$grain_SMD) Standardised mean differences have a bit of a long tail however this is not bad and transformations with log or square root will not work on negative values. Let’s undertake the meta-analysis using the package metafor. We are using the spray_management variable as a moderator and an interactive term to the trial random variable. Because we want to know the difference between all treatments and we have no reference treatment, we will remove the intercept. PM_mv &lt;- rma.mv( yi = grain_SMD, vi, mods = ~ spray_management - 1, method = &quot;ML&quot;, random = ~ spray_management | trial, struct = &quot;UN&quot;, data = dat1 ) ## Warning: Some combinations of the levels of the inner factor never occurred. ## Corresponding rho value(s) fixed to 0. summary(PM_mv) ## ## Multivariate Meta-Analysis Model (k = 116; method: ML) ## ## logLik Deviance AIC BIC AICc ## -332.6369 913.7003 703.2738 755.5921 711.1905 ## ## Variance Components: ## ## outer factor: trial (nlvls = 33) ## inner factor: spray_management (nlvls = 5) ## ## estim sqrt k.lvl fixed level ## tau^2.1 0.8485 0.9212 13 no Early ## tau^2.2 1.2170 1.1032 27 no Recommended ## tau^2.3 2.8727 1.6949 40 no Recommended_plus ## tau^2.4 1.6346 1.2785 17 no Late ## tau^2.5 2.3998 1.5491 19 no Late_plus ## ## rho.Erly rho.Rcmm rho.Rcm_ rho.Late rho.Lt_p Erly ## Early 1 0.8139 0.6429 0.6456 0.0000 - ## Recommended 0.8139 1 0.8971 0.8959 0.9103 12 ## Recommended_plus 0.6429 0.8971 1 0.9372 0.9985 12 ## Late 0.6456 0.8959 0.9372 1 0.9538 12 ## Late_plus 0.0000 0.9103 0.9985 0.9538 1 0 ## Rcmm Rcm_ Late Lt_p ## Early no no no yes ## Recommended - no no no ## Recommended_plus 24 - no no ## Late 17 17 - no ## Late_plus 3 3 3 - ## ## Test for Residual Heterogeneity: ## QE(df = 111) = 47501.7646, p-val &lt; .0001 ## ## Test of Moderators (coefficients 1:5): ## QM(df = 5) = 24.4769, p-val = 0.0002 ## ## Model Results: ## ## estimate se zval pval ci.lb ## spray_managementEarly 0.3142 0.2093 1.5011 0.1333 -0.0960 ## spray_managementRecommended 0.7806 0.1998 3.9078 &lt;.0001 0.3891 ## spray_managementRecommended_plus 1.1970 0.3015 3.9695 &lt;.0001 0.6060 ## spray_managementLate 0.8181 0.2397 3.4136 0.0006 0.3484 ## spray_managementLate_plus 1.2155 0.2773 4.3825 &lt;.0001 0.6719 ## ci.ub ## spray_managementEarly 0.7244 ## spray_managementRecommended 1.1721 *** ## spray_managementRecommended_plus 1.7880 *** ## spray_managementLate 1.2879 *** ## spray_managementLate_plus 1.7591 *** ## ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 In this result we can see that the Early treatment is not significantly different to zero, which in this case is the mean of the no spray control. However the other treatments are significantly different to zero. The \\(Q_M\\) omnibus test of moderators, shows the moderators significantly influence the model (\\(Q_M = 24.4769, df = 5, p = 0.0002\\)) and we can reject the null hypothesis (\\(H_0 : \\beta_1 = \\beta_2 = \\beta_3 =\\beta_4 = 0\\)) that there is no difference between the moderators (Viechtbauer 2010). The analysis shows there is still a significant amount of residual heterogeneity (\\(Q_E = 47501.76, df = 111, p &lt; 0.0001\\)) not captured by the spray management moderator indicating other possible moderators which might influence grain yield. Let’s see if we can improve this model by including some other random effects and improving the random effect structure in the model. PM_mv_St &lt;- rma.mv( yi = grain_SMD, vi, mods = ~ spray_management, method = &quot;ML&quot;, random = list(~ 1|trial), data = dat1 ) PM_mv_St1 &lt;- rma.mv( yi = grain_SMD, vi, mods = ~ spray_management, method = &quot;ML&quot;, random = list(~ 1|location/year/trial_ref/dose/host_genotype/factor(row_spacing)/spray_management), data = dat1 ) AIC(PM_mv) # Printing the AIC of the model helps differentiate the models in the anova output ## [1] 703.2738 anova(PM_mv, PM_mv_St1) # PM_mv is the better model ## ## df AIC BIC AICc logLik LRT pval QE ## Full 19 703.2738 755.5921 711.1905 -332.6369 47501.7646 ## Reduced 12 719.8492 752.8923 722.8783 -347.9246 30.5753 &lt;.0001 47501.7646 The simpler PM_mv_St model explains significantly less variation as the more complicated model PM_mv. So we will keep the original model PM_mv. The first table in this output shows the tau^2 (variance) of each random effects and the number of occurrences for each treatment in the analysis. The second table is in two parts(left and right). The left part, rho, is the correlation of variation between the specified treatments. All comparisons were acceptable except for a comparison between Early and Late_plus, 0.000 rho. Early and Late_plus treatments never occurred within the same trial which is indicated by the right side of the table (hence the warning). The fixed effects, in the last table, showed that yields in single early spray treatments are not significantly different from zero, or the no spray control. 5.2.2 Profile plots Let’s inspect the profile plots to ensure the model is not over-fitted. We expect to see the estimate align with the peak of the curve. Also that the shape of the line is a curve. Caution! this will take some time to run. profile(PM_mv, tau2 = 1) profile(PM_mv, tau2 = 2) profile(PM_mv, tau2 = 3) profile(PM_mv, tau2 = 4) profile(PM_mv, tau2 = 5) 5.2.3 Metafor comparisons To make it easier to compare each of the treatments we can compute the meta-analysis contrasts. meta_cont &lt;- anova(PM_mv, L = rbind( c(-1, 1, 0, 0, 0), c(-1, 0, 1, 0, 0), c(-1, 0, 0, 1, 0), c(-1, 0, 0, 0, 1), c(0, -1, 1, 0, 0), c(0, -1, 0, 1, 0), c(0, -1, 0, 0, 1), c(0, 0, -1, 1, 0), c(0, 0, -1, 0, 1), c(0, 0, 0, -1, 1) )) change_labels &lt;- function(x1) { x1 &lt;- gsub(pattern = &quot;spray_management&quot;, replacement = &quot;&quot;, x = x1) x1 } source(&quot;R/p_star.R&quot;) data.frame( contrasts = change_labels(meta_cont$hyp[, 1]), estimates = meta_cont$Lb, se = meta_cont$se, z_val = meta_cont$zval, pval = meta_cont$pval, VisP = p_star(meta_cont$pval) ) ## contrasts estimates se z_val ## 1 -Early + Recommended = 0 0.46641849 0.17959360 2.5970774 ## 2 -Early + Recommended_plus = 0 0.88279371 0.27576460 3.2012583 ## 3 -Early + Late = 0 0.50396169 0.23848955 2.1131396 ## 4 -Early + Late_plus = 0 0.90130002 0.25716136 3.5048035 ## 5 -Recommended + Recommended_plus = 0 0.41637522 0.16828322 2.4742527 ## 6 -Recommended + Late = 0 0.03754321 0.13986869 0.2684175 ## 7 -Recommended + Late_plus = 0 0.43488153 0.14843610 2.9297558 ## 8 -Recommended_plus + Late = 0 -0.37883201 0.14933397 -2.5368108 ## 9 -Recommended_plus + Late_plus = 0 0.01850631 0.06458647 0.2865354 ## 10 -Late + Late_plus = 0 0.39733832 0.12526511 3.1719792 ## pval VisP ## 1 0.0094020739 ** ## 2 0.0013682882 ** ## 3 0.0345888245 * ## 4 0.0004569444 *** ## 5 0.0133515210 * ## 6 0.7883779546 ## 7 0.0033922844 ** ## 8 0.0111867408 * ## 9 0.7744680870 ## 10 0.0015140386 ** Results show with the exclusion of the no spray control, Early applications are significantly worse than all other treatments leading to lower yield estimates. Late_plus is estimated as saving the most yield compared and is significantly higher than all other treatments except recommended_plus. Let’s view these comparisons in a plot. First we will format the results into a data frame. results_AI &lt;- data.frame(cbind(PM_mv$b, PM_mv$ci.lb, PM_mv$ci.ub)) efficacy &lt;- tbl_df(results_AI) efficacy$Treatment &lt;- factor(c( &quot;Early&quot;, &quot;Recommended&quot;, &quot;Recommended_plus&quot;, &quot;Late&quot;, &quot;Late_plus&quot; )) efficacy$se &lt;- PM_mv$se colnames(efficacy) &lt;- c(&quot;Mean&quot;, &quot;CIs_lower&quot;, &quot;CI_upper&quot;, &quot;Treatment&quot;, &quot;SE&quot;) efficacy ## # A tibble: 5 x 5 ## Mean CIs_lower CI_upper Treatment SE ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; ## 1 0.314 -0.0960 0.724 Early 0.209 ## 2 0.781 0.389 1.17 Recommended 0.200 ## 3 1.20 0.606 1.79 Recommended_plus 0.302 ## 4 0.818 0.348 1.29 Late 0.240 ## 5 1.22 0.672 1.76 Late_plus 0.277 efficacy %&gt;% mutate(Treatment = factor(Treatment, levels = rev(c(&quot;Early&quot;, &quot;Recommended&quot;, &quot;Recommended_plus&quot;,&quot;Late&quot;,&quot;Late_plus&quot;))))%&gt;% ggplot(aes(Treatment, Mean)) + geom_hline( yintercept = seq(-0.4, 1.8, by = 0.2), color = usq_cols(&quot;usq charcoal&quot;), linetype = 3 ) + geom_hline(yintercept = 0)+ geom_point(aes(size = 1 / SE), shape = 15) + geom_linerange(aes(ymin = CIs_lower, ymax = CI_upper)) + coord_flip() Let’s look at how well each of the number treatments compare to each other. 5.2.4 Disease pressure effect We also want to know if disease pressure exerts an effect on the desicion for spray control. Above we can see spraying at the first sign of powdery mildew or with in 7 - 13 days after first sign is effective at mitigating yield loss. Does this change between years of low and high disease pressure. We will add the intercept back into this model for ease of interpretation. PM_mv_Dp &lt;- rma.mv( yi = grain_SMD, vi, mods = ~ spray_management *D_pres, method = &quot;ML&quot;, random = ~ spray_management | trial, struct = &quot;UN&quot;, data = dat1 ) ## Warning: Some combinations of the levels of the inner factor never occurred. ## Corresponding rho value(s) fixed to 0. summary(PM_mv_Dp) ## ## Multivariate Meta-Analysis Model (k = 116; method: ML) ## ## logLik Deviance AIC BIC AICc ## -329.2760 906.9785 706.5521 772.6382 719.7389 ## ## Variance Components: ## ## outer factor: trial (nlvls = 33) ## inner factor: spray_management (nlvls = 5) ## ## estim sqrt k.lvl fixed level ## tau^2.1 0.5243 0.7241 13 no Early ## tau^2.2 1.1356 1.0656 27 no Recommended ## tau^2.3 2.7768 1.6664 40 no Recommended_plus ## tau^2.4 1.5102 1.2289 17 no Late ## tau^2.5 1.9744 1.4052 19 no Late_plus ## ## rho.Erly rho.Rcmm rho.Rcm_ rho.Late rho.Lt_p Erly ## Early 1 0.6965 0.5020 0.4831 0.0000 - ## Recommended 0.6965 1 0.8951 0.8961 0.9419 12 ## Recommended_plus 0.5020 0.8951 1 0.9322 0.9768 12 ## Late 0.4831 0.8961 0.9322 1 0.9822 12 ## Late_plus 0.0000 0.9419 0.9768 0.9822 1 0 ## Rcmm Rcm_ Late Lt_p ## Early no no no yes ## Recommended - no no no ## Recommended_plus 24 - no no ## Late 17 17 - no ## Late_plus 3 3 3 - ## ## Test for Residual Heterogeneity: ## QE(df = 106) = 22163.7723, p-val &lt; .0001 ## ## Test of Moderators (coefficients 2:10): ## QM(df = 9) = 70.8016, p-val &lt; .0001 ## ## Model Results: ## ## estimate se zval pval ## intrcpt 1.8610 0.7305 2.5476 0.0108 ## spray_managementRecommended -1.0497 0.8363 -1.2553 0.2094 ## spray_managementRecommended_plus -0.4434 0.9840 -0.4505 0.6523 ## spray_managementLate -0.8317 0.8820 -0.9430 0.3457 ## spray_managementLate_plus -0.2667 0.9140 -0.2918 0.7704 ## D_preshighD -1.6463 0.7552 -2.1800 0.0293 ## spray_managementRecommended:D_preshighD 1.6013 0.8595 1.8630 0.0625 ## spray_managementRecommended_plus:D_preshighD 1.3903 1.0351 1.3431 0.1792 ## spray_managementLate:D_preshighD 1.3881 0.9229 1.5041 0.1326 ## spray_managementLate_plus:D_preshighD 0.8981 0.9588 0.9367 0.3489 ## ci.lb ci.ub ## intrcpt 0.4292 3.2927 * ## spray_managementRecommended -2.6888 0.5893 ## spray_managementRecommended_plus -2.3720 1.4853 ## spray_managementLate -2.5603 0.8970 ## spray_managementLate_plus -2.0582 1.5247 ## D_preshighD -3.1265 -0.1662 * ## spray_managementRecommended:D_preshighD -0.0833 3.2860 . ## spray_managementRecommended_plus:D_preshighD -0.6385 3.4192 ## spray_managementLate:D_preshighD -0.4207 3.1970 ## spray_managementLate_plus:D_preshighD -0.9810 2.7772 ## ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 These results show that the spray management variable we tested are not significantly better or worse between the two levels of disease pressure. It also shows that in trials with high disease pressure all treatments produced lower standardised mean differences. Indicating that fungicide treatments were less effective at mitigating yeild loss in seasons which developed heavier infestations. Finally lets compare the disease pressure model to the orignal model to see which one fits better. anova(PM_mv, PM_mv_Dp) ## ## df AIC BIC AICc logLik LRT pval QE ## Full 24 706.5521 772.6382 719.7389 -329.2760 22163.7723 ## Reduced 19 703.2738 755.5921 711.1905 -332.6369 6.7218 0.2422 47501.7646 No significant difference which informs us to use the origninal model PM_mv which is the simplest. We can use the netmeta package to give a graphical representation of the pairwise comparisons. 5.2.5 netmeta package Let’s analyse the data again using a different statistical approach to see if our outcome with the metafor package was robust. The netmeta package uses a frequentist approach to the analysis and focuses on the pairwise comparisons between treatments. datPM3 &lt;- slimmer_PM_dat %&gt;% group_by(trial, spray_management, n) %&gt;% summarize(yi_mean = mean(grain_SMD), vi_mean = mean(yield_error)) %&gt;% ungroup() PM_con &lt;- pairwise( treat = spray_management, n = n, mean = yi_mean, sd = sqrt(vi_mean), studlab = trial, data = datPM3, sm = &quot;MD&quot; ) net_con &lt;- netmeta(TE, seTE, treat1, treat2, studlab, data = PM_con, sm = &quot;MD&quot;) summary(net_con) ## Number of studies: k = 30 ## Number of treatments: n = 6 ## Number of pairwise comparisons: m = 163 ## Number of designs: d = 9 ## ## Fixed effects model ## ## Treatment estimate (sm = &#39;MD&#39;): ## control Early Late Late_plus Recommended Recommended_plus ## control . -0.0697 -0.3927 -1.3904 -0.5792 -1.0015 ## Early 0.0697 . -0.3230 -1.3208 -0.5095 -0.9318 ## Late 0.3927 0.3230 . -0.9977 -0.1865 -0.6088 ## Late_plus 1.3904 1.3208 0.9977 . 0.8113 0.3889 ## Recommended 0.5792 0.5095 0.1865 -0.8113 . -0.4223 ## Recommended_plus 1.0015 0.9318 0.6088 -0.3889 0.4223 . ## ## Lower 95%-confidence limit: ## control Early Late Late_plus Recommended Recommended_plus ## control . -0.1087 -0.4278 -1.4420 -0.6112 -1.0403 ## Early 0.0307 . -0.3611 -1.3775 -0.5358 -0.9737 ## Late 0.3576 0.2850 . -1.0489 -0.2173 -0.6458 ## Late_plus 1.3388 1.2640 0.9465 . 0.7593 0.3363 ## Recommended 0.5472 0.4832 0.1557 -0.8632 . -0.4575 ## Recommended_plus 0.9627 0.8900 0.5718 -0.4416 0.3872 . ## ## Upper 95%-confidence limit: ## control Early Late Late_plus Recommended Recommended_plus ## control . -0.0307 -0.3576 -1.3388 -0.5472 -0.9627 ## Early 0.1087 . -0.2850 -1.2640 -0.4832 -0.8900 ## Late 0.4278 0.3611 . -0.9465 -0.1557 -0.5718 ## Late_plus 1.4420 1.3775 1.0489 . 0.8632 0.4416 ## Recommended 0.6112 0.5358 0.2173 -0.7593 . -0.3872 ## Recommended_plus 1.0403 0.9737 0.6458 -0.3363 0.4575 . ## ## Random effects model ## ## Treatment estimate (sm = &#39;MD&#39;): ## control Early Late Late_plus Recommended Recommended_plus ## control . -0.3464 -0.7404 -1.2386 -0.6412 -1.0911 ## Early 0.3464 . -0.3940 -0.8922 -0.2948 -0.7446 ## Late 0.7404 0.3940 . -0.4982 0.0992 -0.3507 ## Late_plus 1.2386 0.8922 0.4982 . 0.5975 0.1476 ## Recommended 0.6412 0.2948 -0.0992 -0.5975 . -0.4499 ## Recommended_plus 1.0911 0.7446 0.3507 -0.1476 0.4499 . ## ## Lower 95%-confidence limit: ## control Early Late Late_plus Recommended Recommended_plus ## control . -0.9832 -1.3142 -2.0980 -1.1365 -1.6026 ## Early -0.2903 . -1.0184 -1.8897 -0.8917 -1.3448 ## Late 0.1666 -0.2304 . -1.4310 -0.4327 -0.8864 ## Late_plus 0.3793 -0.1053 -0.4345 . -0.3056 -0.7606 ## Recommended 0.1458 -0.3022 -0.6312 -1.5005 . -0.9181 ## Recommended_plus 0.5795 0.1444 -0.1851 -1.0557 -0.0184 . ## ## Upper 95%-confidence limit: ## control Early Late Late_plus Recommended Recommended_plus ## control . 0.2903 -0.1666 -0.3793 -0.1458 -0.5795 ## Early 0.9832 . 0.2304 0.1053 0.3022 -0.1444 ## Late 1.3142 1.0184 . 0.4345 0.6312 0.1851 ## Late_plus 2.0980 1.8897 1.4310 . 1.5005 1.0557 ## Recommended 1.1365 0.8917 0.4327 0.3056 . 0.0184 ## Recommended_plus 1.6026 1.3448 0.8864 0.7606 0.9181 . ## ## Quantifying heterogeneity / inconsistency: ## tau^2 = 1.3743; tau = 1.1723; I^2 = 99.5% [99.4%; 99.5%] ## ## Tests of heterogeneity (within designs) and inconsistency (between designs): ## Q d.f. p-value ## Total 13705.55 74 0 ## Within designs 7488.00 59 0 ## Between designs 6217.55 15 0 Now let’s visualise this as a forest plot. forest( net_con, reference.group = 5, rightcols = c(&quot;effect&quot;, &quot;ci&quot;, &quot;Pscore&quot;), rightlabs = &quot;P-Score&quot;, small.values = &quot;bad&quot; ) The netmeta analysis suggests the spray schedule commencing early are no different to any other treatment including the no spray control. It estimates the mean is very similar to the recommended treatments. The recommended plus and late_plus treatments show higher mean estimates, however are not significantly different from the early estimate. netgraph( net_con, plastic = FALSE, col = usq_cols(&quot;support orange&quot;), thickness = &quot;number.of.studies&quot;, points = FALSE, col.points = usq_cols(&quot;usq charcoal&quot;), cex.points = 1, number.of.studies = TRUE, cex.number.of.studies = 1, col.number.of.studies = &quot;black&quot;, bg.number.of.studies = usq_cols(&quot;support orange&quot;), multiarm = FALSE, col.multiarm = usq_cols(&quot;support turquiose&quot;), pos.number.of.studies = 0.5 ) netleague(net_con) ## League table (fixed effects model): ## ## control -0.8515 [-0.9261; -0.7770] ## -0.0697 [-0.1087; -0.0307] Early ## -0.3927 [-0.4278; -0.3576] -0.3230 [-0.3611; -0.2850] ## -1.3904 [-1.4420; -1.3388] -1.3208 [-1.3775; -1.2640] ## -0.5792 [-0.6112; -0.5472] -0.5095 [-0.5358; -0.4832] ## -1.0015 [-1.0403; -0.9627] -0.9318 [-0.9737; -0.8900] ## ## -0.4574 [-0.5014; -0.4134] -2.1195 [-2.1913; -2.0476] ## -0.5933 [-0.6661; -0.5206] . ## Late -0.7501 [-0.8209; -0.6793] ## -0.9977 [-1.0489; -0.9465] Late_plus ## -0.1865 [-0.2173; -0.1557] 0.8113 [ 0.7593; 0.8632] ## -0.6088 [-0.6458; -0.5718] 0.3889 [ 0.3363; 0.4416] ## ## -0.5350 [-0.5701; -0.4999] -1.0238 [-1.0669; -0.9806] ## -0.5656 [-0.5933; -0.5378] -0.5934 [-0.6844; -0.5025] ## -0.1021 [-0.1386; -0.0655] -0.5647 [-0.6089; -0.5205] ## 1.5746 [ 1.4787; 1.6705] -0.0375 [-0.1099; 0.0348] ## Recommended -0.4359 [-0.4737; -0.3981] ## -0.4223 [-0.4575; -0.3872] Recommended_plus ## ## League table (random effects model): ## ## control -0.4687 [-1.3454; 0.4080] ## -0.3464 [-0.9832; 0.2903] Early ## -0.7404 [-1.3142; -0.1666] -0.3940 [-1.0184; 0.2304] ## -1.2386 [-2.0980; -0.3793] -0.8922 [-1.8897; 0.1053] ## -0.6412 [-1.1365; -0.1458] -0.2948 [-0.8917; 0.3022] ## -1.0911 [-1.6026; -0.5795] -0.7446 [-1.3448; -0.1444] ## ## -0.8799 [-1.5781; -0.1817] -1.5881 [-2.5430; -0.6333] ## -0.3917 [-1.0633; 0.2798] . ## Late -0.4061 [-1.7354; 0.9232] ## -0.4982 [-1.4310; 0.4345] Late_plus ## 0.0992 [-0.4327; 0.6312] 0.5975 [-0.3056; 1.5005] ## -0.3507 [-0.8864; 0.1851] 0.1476 [-0.7606; 1.0557] ## ## -0.6354 [-1.1662; -0.1047] -0.9986 [-1.5597; -0.4375] ## -0.4255 [-1.0968; 0.2458] -0.7939 [-1.4650; -0.1229] ## 0.1053 [-0.4575; 0.6682] -0.3850 [-0.9478; 0.1777] ## 1.1656 [-0.1655; 2.4967] 0.0365 [-1.2950; 1.3681] ## Recommended -0.4652 [-0.9380; 0.0076] ## -0.4499 [-0.9181; 0.0184] Recommended_plus decomp.design(net_con) ## Q statistics to assess homogeneity / consistency ## ## Q df p-value ## Total 13705.55 74 0 ## Within designs 7488.00 59 0 ## Between designs 6217.55 15 0 ## ## Design-specific decomposition of within-designs Q statistic ## ## Design Q df p-value ## control:Late_plus 4.49 2 0.1058 ## control:Recommended 5.71 1 0.0169 ## control:Early:Late:Recommended:Recommended_plus 666.27 20 &lt; 0.0001 ## control:Late:Late_plus:Recommended:Recommended_plus 3178.16 8 0 ## control:Late:Recommended:Recommended_plus 108.58 3 &lt; 0.0001 ## control:Recommended:Recommended_plus 2689.87 10 0 ## Early:Late:Recommended:Recommended_plus 834.92 15 &lt; 0.0001 ## ## Between-designs Q statistic after detaching of single designs ## ## Detached design Q df p-value ## control:Early 5534.62 14 0 ## control:Late_plus 5627.52 14 0 ## control:Recommended 6176.40 14 0 ## Recommended:Recommended_plus 5511.16 14 0 ## control:Early:Late:Recommended:Recommended_plus 6074.27 11 0 ## control:Late:Late_plus:Recommended:Recommended_plus 2248.74 11 0 ## control:Late:Recommended:Recommended_plus 5233.10 12 0 ## control:Recommended:Recommended_plus 5873.97 13 0 ## Early:Late:Recommended:Recommended_plus 5911.40 12 0 ## ## Q statistic to assess consistency under the assumption of ## a full design-by-treatment interaction random effects model ## ## Q df p-value tau.within tau2.within ## Between designs 18.44 15 0.2403 1.1440 1.3087 netsplit(net_con) ## Separate indirect from direct evidence (SIDE) using back-calculation method ## ## Fixed effects model: ## ## comparison k prop nma direct indir. Diff z p-value ## control:Early 7 0.27 -0.0697 -0.8515 0.2247 -1.0763 -24.12 &lt; 0.0001 ## control:Late 11 0.64 -0.3927 -0.4574 -0.2793 -0.1782 -4.78 &lt; 0.0001 ## control:Late_plus 6 0.52 -1.3904 -2.1195 -0.6143 -1.5052 -28.58 &lt; 0.0001 ## control:Recommended 19 0.83 -0.5792 -0.5350 -0.7991 0.2641 6.04 &lt; 0.0001 ## control:Recommended_plus 17 0.81 -1.0015 -1.0238 -0.9059 -0.1179 -2.33 0.0198 ## Early:Late 12 0.27 -0.3230 -0.5933 -0.2212 -0.3721 -8.55 &lt; 0.0001 ## Early:Late_plus 0 0 -1.3208 . -1.3208 . . . ## Early:Recommended 12 0.90 -0.5095 -0.5656 -0.0158 -0.5497 -12.41 &lt; 0.0001 ## Early:Recommended_plus 12 0.21 -0.9318 -0.5934 -1.0226 0.4291 8.21 &lt; 0.0001 ## Late:Late_plus 3 0.52 -0.9977 -0.7501 -1.2685 0.5185 9.92 &lt; 0.0001 ## Late:Recommended 17 0.71 -0.1865 -0.1021 -0.3930 0.2910 8.40 &lt; 0.0001 ## Late:Recommended_plus 17 0.70 -0.6088 -0.5647 -0.7117 0.1470 3.57 0.0004 ## Late_plus:Recommended 3 0.29 0.8113 1.5746 0.4941 1.0805 18.56 &lt; 0.0001 ## Late_plus:Recommended_plus 3 0.53 0.3889 -0.0375 0.8671 -0.9047 -16.82 &lt; 0.0001 ## Recommended:Recommended_plus 24 0.87 -0.4223 -0.4359 -0.3342 -0.1017 -1.93 0.0539 ## ## Random effects model: ## ## comparison k prop nma direct indir. Diff z p-value ## control:Early 7 0.53 -0.3464 -0.4687 -0.2099 -0.2588 -0.40 0.6909 ## control:Late 11 0.68 -0.7404 -0.8799 -0.4502 -0.4297 -0.69 0.4919 ## control:Late_plus 6 0.81 -1.2386 -1.5881 0.2508 -1.8389 -1.65 0.0999 ## control:Recommended 19 0.87 -0.6412 -0.6354 -0.6801 0.0447 0.06 0.9528 ## control:Recommended_plus 17 0.83 -1.0911 -0.9986 -1.5460 0.5474 0.79 0.4320 ## Early:Late 12 0.86 -0.3940 -0.3917 -0.4082 0.0165 0.02 0.9859 ## Early:Late_plus 0 0 -0.8922 . -0.8922 . . . ## Early:Recommended 12 0.79 -0.2948 -0.4255 0.1990 -0.6245 -0.83 0.4042 ## Early:Recommended_plus 12 0.80 -0.7446 -0.7939 -0.5474 -0.2466 -0.32 0.7474 ## Late:Late_plus 3 0.49 -0.4982 -0.4061 -0.5876 0.1815 0.19 0.8488 ## Late:Recommended 17 0.89 0.0992 0.1053 0.0480 0.0573 0.07 0.9480 ## Late:Recommended_plus 17 0.91 -0.3507 -0.3850 -0.0183 -0.3668 -0.39 0.6957 ## Late_plus:Recommended 3 0.46 0.5975 1.1656 0.1130 1.0526 1.14 0.2548 ## Late_plus:Recommended_plus 3 0.47 0.1476 0.0365 0.2442 -0.2076 -0.22 0.8232 ## Recommended:Recommended_plus 24 0.98 -0.4499 -0.4652 0.3371 -0.8023 -0.46 0.6458 ## ## Legend: ## comparison - Treatment comparison ## k - Number of studies providing direct evidence ## prop - Direct evidence proportion ## nma - Estimated treatment effect (MD) in network meta-analysis ## direct - Estimated treatment effect (MD) derived from direct evidence ## indir. - Estimated treatment effect (MD) derived from indirect evidence ## Diff - Difference between direct and indirect treatment estimates ## z - z-value of test for disagreement (direct versus indirect) ## p-value - p-value of test for disagreement (direct versus indirect) nm1 &lt;- netmeasures(net_con) plot( nm1$meanpath, nm1$minpar, pch = &quot;&quot;, xlab = &quot;Mean path length&quot;, ylab = &quot;Minimal parallelism&quot; ) text(nm1$meanpath, nm1$minpar, names(nm1$meanpath), cex = 0.8) write.csv(slimmer_PM_dat, file = &quot;data/GYmeta_data.csv&quot;) References "]
]
