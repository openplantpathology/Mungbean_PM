<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Prepare data for meta-anlysis | Powdery mildew yield loss mitigation strategies in mungbean, a meta-analysis.</title>
  <meta name="description" content="A meta-analysis of fungicide use in mungbean to control for yield loss due to powdery mildew." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Prepare data for meta-anlysis | Powdery mildew yield loss mitigation strategies in mungbean, a meta-analysis." />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A meta-analysis of fungicide use in mungbean to control for yield loss due to powdery mildew." />
  <meta name="github-repo" content="OpenPlantPathology/Mungbean_PM" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Prepare data for meta-anlysis | Powdery mildew yield loss mitigation strategies in mungbean, a meta-analysis." />
  
  <meta name="twitter:description" content="A meta-analysis of fungicide use in mungbean to control for yield loss due to powdery mildew." />
  

<meta name="author" content="Paul Melloy, Emerson Del Ponte and Adam H. Sparks" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="preliminary-analysis.html"/>
<link rel="next" href="meta-analysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Research questions</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#parts-of-analysis-that-need-checking"><i class="fa fa-check"></i><b>1.1</b> Parts of analysis that need checking</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html"><i class="fa fa-check"></i><b>2</b> Studies considered in meta-analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html#summary-of-data"><i class="fa fa-check"></i><b>2.1</b> Summary of data</a></li>
<li class="chapter" data-level="2.2" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html#powdery-mildew-ratings"><i class="fa fa-check"></i><b>2.2</b> Powdery mildew ratings</a></li>
<li class="chapter" data-level="2.3" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html#experimental-locations"><i class="fa fa-check"></i><b>2.3</b> Experimental locations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="weather-data.html"><a href="weather-data.html"><i class="fa fa-check"></i><b>3</b> Weather data</a><ul>
<li class="chapter" data-level="3.0.1" data-path="weather-data.html"><a href="weather-data.html#kingaroy-historical-weather"><i class="fa fa-check"></i><b>3.0.1</b> Kingaroy historical weather</a></li>
<li class="chapter" data-level="3.0.2" data-path="weather-data.html"><a href="weather-data.html#hermitage-historical-weather"><i class="fa fa-check"></i><b>3.0.2</b> Hermitage historical weather</a></li>
<li class="chapter" data-level="3.0.3" data-path="weather-data.html"><a href="weather-data.html#gatton-historical-weather"><i class="fa fa-check"></i><b>3.0.3</b> Gatton historical weather</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html"><i class="fa fa-check"></i><b>4</b> Preliminary Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#explore-and-visualise-data"><i class="fa fa-check"></i><b>4.1</b> Explore and visualise Data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#fungicides"><i class="fa fa-check"></i><b>4.1.1</b> Fungicides</a></li>
<li class="chapter" data-level="4.1.2" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#mungbean-cultivars"><i class="fa fa-check"></i><b>4.1.2</b> Mungbean cultivars</a></li>
<li class="chapter" data-level="4.1.3" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#row-spacing"><i class="fa fa-check"></i><b>4.1.3</b> Row spacing</a></li>
<li class="chapter" data-level="4.1.4" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#yield-vs-in-season-rain"><i class="fa fa-check"></i><b>4.1.4</b> Yield vs in-season rain</a></li>
<li class="chapter" data-level="4.1.5" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#season-range-and-first-incidence"><i class="fa fa-check"></i><b>4.1.5</b> Season range and first incidence</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="prepare-data-for-meta-anlysis.html"><a href="prepare-data-for-meta-anlysis.html"><i class="fa fa-check"></i><b>5</b> Prepare data for meta-anlysis</a><ul>
<li class="chapter" data-level="5.1" data-path="prepare-data-for-meta-anlysis.html"><a href="prepare-data-for-meta-anlysis.html#set-environment-and-import-data"><i class="fa fa-check"></i><b>5.1</b> Set environment and import data</a></li>
<li class="chapter" data-level="5.2" data-path="prepare-data-for-meta-anlysis.html"><a href="prepare-data-for-meta-anlysis.html#standardising-sample-variance"><i class="fa fa-check"></i><b>5.2</b> Standardising sample variance</a><ul>
<li class="chapter" data-level="5.2.1" data-path="prepare-data-for-meta-anlysis.html"><a href="prepare-data-for-meta-anlysis.html#converting-least-squares-to-sample-variance"><i class="fa fa-check"></i><b>5.2.1</b> Converting least-squares to sample variance</a></li>
<li class="chapter" data-level="5.2.2" data-path="prepare-data-for-meta-anlysis.html"><a href="prepare-data-for-meta-anlysis.html#converting-standard-deviation-to-sample-variance"><i class="fa fa-check"></i><b>5.2.2</b> Converting standard deviation to sample variance</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="prepare-data-for-meta-anlysis.html"><a href="prepare-data-for-meta-anlysis.html#yield-saving"><i class="fa fa-check"></i><b>5.3</b> Yield saving</a></li>
<li class="chapter" data-level="5.4" data-path="prepare-data-for-meta-anlysis.html"><a href="prepare-data-for-meta-anlysis.html#reduce-data-set-to-required-variables"><i class="fa fa-check"></i><b>5.4</b> Reduce data set to required variables</a><ul>
<li class="chapter" data-level="5.4.1" data-path="prepare-data-for-meta-anlysis.html"><a href="prepare-data-for-meta-anlysis.html#cluster-fungicide-applications"><i class="fa fa-check"></i><b>5.4.1</b> Cluster fungicide applications</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="prepare-data-for-meta-anlysis.html"><a href="prepare-data-for-meta-anlysis.html#audpc-visualise-raw-data"><i class="fa fa-check"></i><b>5.5</b> AUDPC visualise raw data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="meta-analysis.html"><a href="meta-analysis.html"><i class="fa fa-check"></i><b>6</b> Meta-analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="meta-analysis.html"><a href="meta-analysis.html#grain-yield-meta-analysis"><i class="fa fa-check"></i><b>6.1</b> Grain yield meta-analysis</a><ul>
<li class="chapter" data-level="6.1.1" data-path="meta-analysis.html"><a href="meta-analysis.html#imputing-sample-variances"><i class="fa fa-check"></i><b>6.1.1</b> Imputing sample variances</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="meta-analysis.html"><a href="meta-analysis.html#meta-analysis-1"><i class="fa fa-check"></i><b>6.2</b> Meta-analysis</a><ul>
<li class="chapter" data-level="6.2.1" data-path="meta-analysis.html"><a href="meta-analysis.html#metafor-package"><i class="fa fa-check"></i><b>6.2.1</b> metafor package</a></li>
<li class="chapter" data-level="6.2.2" data-path="meta-analysis.html"><a href="meta-analysis.html#netmeta-package"><i class="fa fa-check"></i><b>6.2.2</b> netmeta package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="aupdc-meta-analysis.html"><a href="aupdc-meta-analysis.html"><i class="fa fa-check"></i><b>7</b> AUPDC meta-analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="aupdc-meta-analysis.html"><a href="aupdc-meta-analysis.html#aupdc-impact-on-grain-yield-meta-analysis"><i class="fa fa-check"></i><b>7.1</b> AUPDC impact on grain yield meta-analysis</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="manuscript-wireframe.html"><a href="manuscript-wireframe.html"><i class="fa fa-check"></i><b>8</b> Manuscript wireframe</a><ul>
<li class="chapter" data-level="8.1" data-path="manuscript-wireframe.html"><a href="manuscript-wireframe.html#who-are-the-intended-readers---list-3-to-5-of-them-by-name"><i class="fa fa-check"></i><b>8.1</b> Who are the intended readers? - list 3 to 5 of them by name</a></li>
<li class="chapter" data-level="8.2" data-path="manuscript-wireframe.html"><a href="manuscript-wireframe.html#what-did-you-do-limit---50-words"><i class="fa fa-check"></i><b>8.2</b> what did you do? (limit - 50 words)</a></li>
<li class="chapter" data-level="8.3" data-path="manuscript-wireframe.html"><a href="manuscript-wireframe.html#why-did-you-do-it-limit---50-words"><i class="fa fa-check"></i><b>8.3</b> Why did you do it? (limit - 50 words)</a></li>
<li class="chapter" data-level="8.4" data-path="manuscript-wireframe.html"><a href="manuscript-wireframe.html#what-happened-limit---50-words"><i class="fa fa-check"></i><b>8.4</b> what happened? (limit - 50 words)</a></li>
<li class="chapter" data-level="8.5" data-path="manuscript-wireframe.html"><a href="manuscript-wireframe.html#what-do-the-results-mean-in-theory-limit---50-words"><i class="fa fa-check"></i><b>8.5</b> What do the results mean in theory? (limit - 50 words)</a></li>
<li class="chapter" data-level="8.6" data-path="manuscript-wireframe.html"><a href="manuscript-wireframe.html#what-do-the-results-mean-in-practice-limit---50-words"><i class="fa fa-check"></i><b>8.6</b> What do the results mean in practice? (limit - 50 words)</a></li>
<li class="chapter" data-level="8.7" data-path="manuscript-wireframe.html"><a href="manuscript-wireframe.html#what-is-the-key-benefit-for-your-readers-limit---25-words."><i class="fa fa-check"></i><b>8.7</b> what is the key benefit for your readers? (limit - 25 words).</a></li>
<li class="chapter" data-level="8.8" data-path="manuscript-wireframe.html"><a href="manuscript-wireframe.html#what-remains-unresolved-no-word-limit."><i class="fa fa-check"></i><b>8.8</b> What remains unresolved? (no word limit).</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Powdery mildew yield loss mitigation strategies in mungbean, a meta-analysis.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="prepare-data-for-meta-anlysis" class="section level1">
<h1><span class="header-section-number">5</span> Prepare data for meta-anlysis</h1>
<div id="set-environment-and-import-data" class="section level2">
<h2><span class="header-section-number">5.1</span> Set environment and import data</h2>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb69-2" title="2"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb69-3" title="3"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb69-4" title="4"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb69-5" title="5"><span class="kw">library</span>(agricolae)</a></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">source</span>(<span class="st">&quot;R/import_data.R&quot;</span>)</a>
<a class="sourceLine" id="cb70-2" title="2">PM_MB_means &lt;-<span class="st"> </span><span class="kw">import_data</span>()</a>
<a class="sourceLine" id="cb70-3" title="3"></a>
<a class="sourceLine" id="cb70-4" title="4"><span class="co"># Calculate AUDPC using final severity and first sign of disease - 7 days</span></a>
<a class="sourceLine" id="cb70-5" title="5"><span class="kw">source</span>(<span class="st">&quot;R/AUDPC_for_single_obs.R&quot;</span>) </a></code></pre></div>
</div>
<div id="standardising-sample-variance" class="section level2">
<h2><span class="header-section-number">5.2</span> Standardising sample variance</h2>
<p>Meta-analyses use variance from the data to calculate the effect sizes. The type of variance needs to be the same across all the data incorporated in the meta-analysis.</p>
<p>We are narrowing the meta-analysis to only include demethylation inhibitors, tebuconazole and propiconazole. Within studies which have used these fungicides, what type of error was reported?</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1">PM_MB_means <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-2" title="2"><span class="st">   </span><span class="kw">filter</span>(fungicide_ai <span class="op">==</span><span class="st"> &quot;tebuconazole&quot;</span> <span class="op">|</span></a>
<a class="sourceLine" id="cb71-3" title="3"><span class="st">             </span>fungicide_ai <span class="op">==</span><span class="st"> &quot;propiconazole&quot;</span>,</a>
<a class="sourceLine" id="cb71-4" title="4">         row_spacing <span class="op">==</span><span class="st"> </span><span class="fl">0.75</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-5" title="5"><span class="st">   </span><span class="kw">group_by</span>(trial_ref, location, Y_error_type, fungicide_ai) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-6" title="6"><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">DMI_trts =</span> <span class="kw">length</span>(Y_error_type))<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-7" title="7"><span class="st">   </span><span class="kw">arrange</span>(Y_error_type)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-8" title="8"><span class="st">   </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&quot;Number of treatments for each trial and the error type reported&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-9" title="9"><span class="st">   </span><span class="kw">kable_styling</span>(<span class="dt">fixed_thead =</span> T) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-10" title="10"><span class="st">   </span><span class="kw">footnote</span>(<span class="dt">general =</span> <span class="st">&quot;DMI - demethylation inhibitors (tebuconazole and propiconazole).&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:variance_types)Number of treatments for each trial and the error type reported
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
trial_ref
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
location
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Y_error_type
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
fungicide_ai
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
DMI_trts
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
mung1112/02
</td>
<td style="text-align:left;">
Kingaroy
</td>
<td style="text-align:left;">
lsd (P=0.05)
</td>
<td style="text-align:left;">
propiconazole
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
mung1112/02
</td>
<td style="text-align:left;">
Kingaroy
</td>
<td style="text-align:left;">
lsd (P=0.05)
</td>
<td style="text-align:left;">
tebuconazole
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
mung1011/01
</td>
<td style="text-align:left;">
Hermitage
</td>
<td style="text-align:left;">
stdev
</td>
<td style="text-align:left;">
tebuconazole
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
mung1011/02
</td>
<td style="text-align:left;">
Kingaroy
</td>
<td style="text-align:left;">
stdev
</td>
<td style="text-align:left;">
tebuconazole
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
mung1415/01
</td>
<td style="text-align:left;">
Hermitage
</td>
<td style="text-align:left;">
stdev
</td>
<td style="text-align:left;">
tebuconazole
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
mung1516/01
</td>
<td style="text-align:left;">
Hermitage
</td>
<td style="text-align:left;">
stdev
</td>
<td style="text-align:left;">
tebuconazole
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
mung1516/02
</td>
<td style="text-align:left;">
Kingaroy
</td>
<td style="text-align:left;">
stdev
</td>
<td style="text-align:left;">
tebuconazole
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
mung1112/01
</td>
<td style="text-align:left;">
Gatton
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
propiconazole
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
mung1112/01
</td>
<td style="text-align:left;">
Gatton
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
tebuconazole
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
mung1516/03
</td>
<td style="text-align:left;">
Emerald
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
tebuconazole
</td>
<td style="text-align:right;">
6
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup></sup> DMI - demethylation inhibitors (tebuconazole and propiconazole).
</td>
</tr>
</tfoot>
</table>
<p>The experiment summaries report either standard deviation, least square differences or no error term (<code>NA</code>). Below we will convert LSD and standard deviation to sample variance. In addition, we need to impute variances for the trials which did not report any form of variance (<code>NA</code>).</p>
<div id="converting-least-squares-to-sample-variance" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Converting least-squares to sample variance</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">Trials &lt;-<span class="st"> </span>PM_MB_means <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="st">   </span><span class="kw">filter</span>(</a>
<a class="sourceLine" id="cb72-3" title="3">          Y_error_type <span class="op">==</span><span class="st"> &quot;lsd (P=0.05)&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-4" title="4"><span class="st">   </span><span class="kw">select</span>(trial_ref) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-5" title="5"><span class="st">   </span><span class="kw">distinct</span>()</a></code></pre></div>
<p>The following code attempts to convert ‘least square differences’ (LSD) to sampling variance as per the method in <a href="https://apsjournals.apsnet.org/doi/10.1094/PHYTO-08-10-0221">Nugugi et.al (2011)</a>.
Ideas for using a T-critical value of 1.697 came from reading a <a href="https://www.statisticshowto.datasciencecentral.com/how-to-calculate-the-least-significant-difference-lsd/">statisics-how-to website</a>.
A <a href="https://www.statisticshowto.datasciencecentral.com/tables/t-distribution-table/">table of T-critical values</a> was consulted where 30 degrees of freedom within experiment was used to find the ‘T-crit’ value of 1.697.</p>
<div class="figure">
<img src="Paul_etal_2008.PNG" alt="Calculating sampling variance from mean squared error Paul et al. (2008)" />
<p class="caption">Calculating sampling variance from mean squared error Paul et al. (2008)</p>
</div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="cf">for</span> (Trial2012 <span class="cf">in</span> Trials<span class="op">$</span>trial_ref) {</a>
<a class="sourceLine" id="cb73-2" title="2">   Tcrit &lt;-</a>
<a class="sourceLine" id="cb73-3" title="3"><span class="st">      </span><span class="fl">1.697</span>  <span class="co"># 0.05 and DFw = 30 # T critical value for which there is significant difference between two groups; This value is the same for both trials &quot;mung1112/01&quot; and &quot;mung1112/02&quot;</span></a>
<a class="sourceLine" id="cb73-4" title="4">   DFw &lt;-</a>
<a class="sourceLine" id="cb73-5" title="5"><span class="st">      </span><span class="kw">sum</span>(PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>Trial2012, ]<span class="op">$</span>replicates) <span class="op">-</span></a>
<a class="sourceLine" id="cb73-6" title="6"><span class="st">      </span><span class="kw">length</span>(PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>Trial2012, ]<span class="op">$</span>replicates) <span class="co"># degrees of freedom within groups</span></a>
<a class="sourceLine" id="cb73-7" title="7"></a>
<a class="sourceLine" id="cb73-8" title="8">   LSD &lt;-</a>
<a class="sourceLine" id="cb73-9" title="9"><span class="st">      </span>PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>Trial2012, ]<span class="op">$</span>yield_error[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb73-10" title="10">   </a>
<a class="sourceLine" id="cb73-11" title="11">   </a>
<a class="sourceLine" id="cb73-12" title="12">   V_yield &lt;-</a>
<a class="sourceLine" id="cb73-13" title="13"><span class="st">      </span>(PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>Trial2012, ]<span class="op">$</span>replicates[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>(LSD <span class="op">/</span></a>
<a class="sourceLine" id="cb73-14" title="14"><span class="st">                                                                            </span>Tcrit) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span> <span class="co"># method - Nugugi et.al (2011) DOI: 10.1094/phyto-08-10-0221</span></a>
<a class="sourceLine" id="cb73-15" title="15">   </a>
<a class="sourceLine" id="cb73-16" title="16">   </a>
<a class="sourceLine" id="cb73-17" title="17">   <span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">seq_along</span>(PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>Trial2012, ]<span class="op">$</span>replicates)) {</a>
<a class="sourceLine" id="cb73-18" title="18">      <span class="cf">if</span> (j <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb73-19" title="19">         Sv &lt;-</a>
<a class="sourceLine" id="cb73-20" title="20"><span class="st">            </span><span class="kw">vector</span>(<span class="dt">length =</span> <span class="kw">length</span>(PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>Trial2012, ]<span class="op">$</span>replicates))</a>
<a class="sourceLine" id="cb73-21" title="21">      } <span class="co"># reset Sv vector if this is the first loop</span></a>
<a class="sourceLine" id="cb73-22" title="22">      </a>
<a class="sourceLine" id="cb73-23" title="23">      </a>
<a class="sourceLine" id="cb73-24" title="24">      </a>
<a class="sourceLine" id="cb73-25" title="25">      </a>
<a class="sourceLine" id="cb73-26" title="26">      <span class="co">###############################################3</span></a>
<a class="sourceLine" id="cb73-27" title="27">      <span class="co"># ___ Adjusting formula to suit our data_______</span></a>
<a class="sourceLine" id="cb73-28" title="28">      <span class="co">#</span></a>
<a class="sourceLine" id="cb73-29" title="29">      <span class="co">#  Sv[j]^2 = MSE/(PM_MB_means[PM_MB_means$trial_ref == Trial2012,]$replicates[j] *</span></a>
<a class="sourceLine" id="cb73-30" title="30">      <span class="co">#                   PM_MB_means[PM_MB_means$trial_ref == Trial2012,]$grain_yield.t.ha[j])</span></a>
<a class="sourceLine" id="cb73-31" title="31">      <span class="co"># Balance equation</span></a>
<a class="sourceLine" id="cb73-32" title="32">      <span class="co"># Sv[j] = V_yield / </span></a>
<a class="sourceLine" id="cb73-33" title="33">      <span class="co">#    (PM_MB_means[PM_MB_means$trial_ref == Trial2012, ]$replicates[j] *</span></a>
<a class="sourceLine" id="cb73-34" title="34">      <span class="co">#       as.numeric(PM_MB_means[PM_MB_means$trial_ref == Trial2012, ]$grain_yield.t.ha[j])^2)</span></a>
<a class="sourceLine" id="cb73-35" title="35">      <span class="co"># #################################################################</span></a>
<a class="sourceLine" id="cb73-36" title="36">      </a>
<a class="sourceLine" id="cb73-37" title="37">      </a>
<a class="sourceLine" id="cb73-38" title="38">      </a>
<a class="sourceLine" id="cb73-39" title="39">      </a>
<a class="sourceLine" id="cb73-40" title="40">      Sv[j] =<span class="st"> </span>V_yield <span class="op">/</span><span class="st"> </span></a>
<a class="sourceLine" id="cb73-41" title="41"><span class="st">         </span>PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>Trial2012, ]<span class="op">$</span>replicates[j]</a>
<a class="sourceLine" id="cb73-42" title="42">      </a>
<a class="sourceLine" id="cb73-43" title="43">      <span class="co"># Sv[j] = MSE / </span></a>
<a class="sourceLine" id="cb73-44" title="44">      <span class="co">#    (PM_MB_means[PM_MB_means$trial_ref == Trial2012, ]$replicates[j] *</span></a>
<a class="sourceLine" id="cb73-45" title="45">      <span class="co">#       as.numeric(PM_MB_means[PM_MB_means$trial_ref == Trial2012, ]$grain_yield.t.ha[j])^2)</span></a>
<a class="sourceLine" id="cb73-46" title="46">      <span class="co"># </span></a>
<a class="sourceLine" id="cb73-47" title="47">      </a>
<a class="sourceLine" id="cb73-48" title="48">      <span class="co">### -&gt; This formula should be V = (n * (LSD/1.96)^2) / 2</span></a>
<a class="sourceLine" id="cb73-49" title="49">      </a>
<a class="sourceLine" id="cb73-50" title="50">   }</a>
<a class="sourceLine" id="cb73-51" title="51">   </a>
<a class="sourceLine" id="cb73-52" title="52">   <span class="co"># and replacing the values in the dataset</span></a>
<a class="sourceLine" id="cb73-53" title="53">   </a>
<a class="sourceLine" id="cb73-54" title="54">   PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>Trial2012, ]<span class="op">$</span>yield_error &lt;-</a>
<a class="sourceLine" id="cb73-55" title="55"><span class="st">      </span>Sv</a>
<a class="sourceLine" id="cb73-56" title="56">   PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>Trial2012, ]<span class="op">$</span>Y_error_type &lt;-</a>
<a class="sourceLine" id="cb73-57" title="57"><span class="st">      &quot;SamplingVariance&quot;</span></a>
<a class="sourceLine" id="cb73-58" title="58">   </a>
<a class="sourceLine" id="cb73-59" title="59">}</a></code></pre></div>
</div>
<div id="converting-standard-deviation-to-sample-variance" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Converting standard deviation to sample variance</h3>
<p>Now to estimate the variance from the standard deviation</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="co"># subset data by those which describe the Yield error with standard deviation</span></a>
<a class="sourceLine" id="cb74-2" title="2">Trials &lt;-<span class="st"> </span>PM_MB_means <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb74-3" title="3"><span class="st">   </span><span class="kw">filter</span>(Y_error_type <span class="op">==</span><span class="st"> &quot;stdev&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb74-4" title="4"><span class="st">   </span><span class="kw">select</span>(trial_ref) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb74-5" title="5"><span class="st">   </span><span class="kw">distinct</span>()</a>
<a class="sourceLine" id="cb74-6" title="6"></a>
<a class="sourceLine" id="cb74-7" title="7"></a>
<a class="sourceLine" id="cb74-8" title="8"><span class="co"># calculate the Sampling variance from the standard deviation</span></a>
<a class="sourceLine" id="cb74-9" title="9"><span class="co"># standard error of the mean equals the standard deviation divided by the square root of the number of samples</span></a>
<a class="sourceLine" id="cb74-10" title="10"><span class="co"># Sv &lt;- sem^2 &lt;- stdev/sqrt(n)</span></a>
<a class="sourceLine" id="cb74-11" title="11"><span class="co"># Sampling variance equals the square of the standard error.</span></a>
<a class="sourceLine" id="cb74-12" title="12"><span class="co"># Sv &lt;- (stdev/sqrt(n))^2</span></a>
<a class="sourceLine" id="cb74-13" title="13"></a>
<a class="sourceLine" id="cb74-14" title="14"><span class="co"># Therefore</span></a>
<a class="sourceLine" id="cb74-15" title="15"></a>
<a class="sourceLine" id="cb74-16" title="16"><span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">seq_along</span>(PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">%in%</span><span class="st"> </span>Trials<span class="op">$</span>trial_ref,]<span class="op">$</span>yield_error)) {</a>
<a class="sourceLine" id="cb74-17" title="17">   <span class="cf">if</span> (j <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb74-18" title="18">      Sv &lt;-</a>
<a class="sourceLine" id="cb74-19" title="19"><span class="st">         </span><span class="kw">vector</span>(<span class="dt">length =</span> <span class="kw">length</span>(PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">%in%</span><span class="st"> </span>Trials<span class="op">$</span>trial_ref,]<span class="op">$</span>yield_error))</a>
<a class="sourceLine" id="cb74-20" title="20">   }<span class="co"># create empty vector at first iteration with length of j</span></a>
<a class="sourceLine" id="cb74-21" title="21">   </a>
<a class="sourceLine" id="cb74-22" title="22">   Sv[j] =<span class="st"> </span>(PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">%in%</span><span class="st"> </span>Trials<span class="op">$</span>trial_ref,]<span class="op">$</span>yield_error[j]) <span class="op">^</span></a>
<a class="sourceLine" id="cb74-23" title="23"><span class="st">      </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb74-24" title="24">}</a>
<a class="sourceLine" id="cb74-25" title="25"></a>
<a class="sourceLine" id="cb74-26" title="26"><span class="co"># and replacing the values in the dataset</span></a>
<a class="sourceLine" id="cb74-27" title="27">PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">%in%</span><span class="st"> </span>Trials<span class="op">$</span>trial_ref,]<span class="op">$</span>yield_error &lt;-</a>
<a class="sourceLine" id="cb74-28" title="28"><span class="st">   </span>Sv</a>
<a class="sourceLine" id="cb74-29" title="29">PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">%in%</span><span class="st"> </span>Trials<span class="op">$</span>trial_ref,]<span class="op">$</span>Y_error_type &lt;-</a>
<a class="sourceLine" id="cb74-30" title="30"><span class="st">   &quot;SamplingVariance&quot;</span></a></code></pre></div>
</div>
</div>
<div id="yield-saving" class="section level2">
<h2><span class="header-section-number">5.3</span> Yield saving</h2>
<p>Yield saving and Yield saving proportional to the control.</p>
<p>Data from 355 trials were collected and the means of each treatment calculated (<code>R/Cleaning historical data.R</code>). These data were combined into one file <code>1902 powdery mildew-Mungbean - Collated means.csv</code>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">PM_MB_means<span class="op">$</span>grain_yield.t.ha. &lt;-</a>
<a class="sourceLine" id="cb75-2" title="2"><span class="st">   </span><span class="kw">as.numeric</span>(PM_MB_means<span class="op">$</span>grain_yield.t.ha.) <span class="co"># NAs produced due to some cells having text description to why there is no specific data</span></a>
<a class="sourceLine" id="cb75-3" title="3"></a>
<a class="sourceLine" id="cb75-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">unique</span>(PM_MB_means<span class="op">$</span>trial_ref)) {</a>
<a class="sourceLine" id="cb75-5" title="5">   dat1 &lt;-<span class="st"> </span>PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>i, ]</a>
<a class="sourceLine" id="cb75-6" title="6">   </a>
<a class="sourceLine" id="cb75-7" title="7">   <span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">is.na</span>(<span class="kw">unique</span>(dat1<span class="op">$</span>row_spacing)))) {</a>
<a class="sourceLine" id="cb75-8" title="8">      <span class="kw">warning</span>(</a>
<a class="sourceLine" id="cb75-9" title="9">         <span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb75-10" title="10">            <span class="kw">unique</span>(dat1<span class="op">$</span>trial_ref),</a>
<a class="sourceLine" id="cb75-11" title="11">            <span class="st">&quot;at&quot;</span>,</a>
<a class="sourceLine" id="cb75-12" title="12">            <span class="kw">unique</span>(dat1<span class="op">$</span>location),</a>
<a class="sourceLine" id="cb75-13" title="13">            <span class="st">&quot;in year&quot;</span>,</a>
<a class="sourceLine" id="cb75-14" title="14">            <span class="kw">unique</span>(dat1<span class="op">$</span>year),</a>
<a class="sourceLine" id="cb75-15" title="15">            <span class="st">&quot;has unknown row.spacing (NA)</span><span class="ch">\n</span><span class="st"> &#39;yield_gain&#39; and &#39;proportional yield gain&#39; not calculated</span><span class="ch">\n</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb75-16" title="16">         )</a>
<a class="sourceLine" id="cb75-17" title="17">      )</a>
<a class="sourceLine" id="cb75-18" title="18">      <span class="cf">next</span>()</a>
<a class="sourceLine" id="cb75-19" title="19">   }</a>
<a class="sourceLine" id="cb75-20" title="20">   </a>
<a class="sourceLine" id="cb75-21" title="21">   <span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">unique</span>(dat1<span class="op">$</span>row_spacing)) {</a>
<a class="sourceLine" id="cb75-22" title="22">      dat2 &lt;-<span class="st"> </span>dat1[dat1<span class="op">$</span>row_spacing <span class="op">==</span><span class="st"> </span>j, ]</a>
<a class="sourceLine" id="cb75-23" title="23">      controlY &lt;-</a>
<a class="sourceLine" id="cb75-24" title="24"><span class="st">         </span><span class="kw">mean</span>(dat2[dat2<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span>, <span class="st">&quot;grain_yield.t.ha.&quot;</span>])</a>
<a class="sourceLine" id="cb75-25" title="25">      </a>
<a class="sourceLine" id="cb75-26" title="26">      dat2<span class="op">$</span>yield_gain &lt;-<span class="st"> </span>dat2<span class="op">$</span>grain_yield.t.ha. <span class="op">-</span><span class="st"> </span>controlY</a>
<a class="sourceLine" id="cb75-27" title="27">      dat2<span class="op">$</span>prop_YG &lt;-<span class="st"> </span>dat2<span class="op">$</span>yield_gain  <span class="op">/</span><span class="st">  </span>controlY</a>
<a class="sourceLine" id="cb75-28" title="28">      </a>
<a class="sourceLine" id="cb75-29" title="29">      dat2[dat2<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;yield_gain&quot;</span>, <span class="st">&quot;prop_YG&quot;</span>)] &lt;-</a>
<a class="sourceLine" id="cb75-30" title="30"><span class="st">         </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb75-31" title="31">      </a>
<a class="sourceLine" id="cb75-32" title="32">      dat1[dat1<span class="op">$</span>row_spacing <span class="op">==</span><span class="st"> </span>j, ] &lt;-<span class="st"> </span>dat2</a>
<a class="sourceLine" id="cb75-33" title="33">   }</a>
<a class="sourceLine" id="cb75-34" title="34">   PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>i, ] &lt;-<span class="st"> </span>dat1</a>
<a class="sourceLine" id="cb75-35" title="35">}</a></code></pre></div>
<pre><code>## Warning: AM1303 at Premer in year 2013 has unknown row.spacing (NA)
##  &#39;yield_gain&#39; and &#39;proportional yield gain&#39; not calculated</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co"># ____________________________________________</span></a>
<a class="sourceLine" id="cb77-2" title="2"><span class="co"># calculate yield gain and prop_yield gain for experiments with no row spacing data</span></a>
<a class="sourceLine" id="cb77-3" title="3"></a>
<a class="sourceLine" id="cb77-4" title="4">dat1 &lt;-<span class="st"> </span>PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> &quot;AM1303&quot;</span>, ]</a>
<a class="sourceLine" id="cb77-5" title="5"></a>
<a class="sourceLine" id="cb77-6" title="6">controlY &lt;-</a>
<a class="sourceLine" id="cb77-7" title="7"><span class="st">   </span><span class="kw">mean</span>(dat1[dat1<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span>, <span class="st">&quot;grain_yield.t.ha.&quot;</span>])</a>
<a class="sourceLine" id="cb77-8" title="8"></a>
<a class="sourceLine" id="cb77-9" title="9">dat1<span class="op">$</span>yield_gain &lt;-<span class="st"> </span>dat1<span class="op">$</span>grain_yield.t.ha. <span class="op">-</span><span class="st"> </span>controlY</a>
<a class="sourceLine" id="cb77-10" title="10">dat1<span class="op">$</span>prop_YG &lt;-<span class="st"> </span>dat1<span class="op">$</span>yield_gain <span class="op">/</span><span class="st"> </span>controlY</a>
<a class="sourceLine" id="cb77-11" title="11">dat1[dat1<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;yield_gain&quot;</span>, <span class="st">&quot;prop_YG&quot;</span>)] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>,<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb77-12" title="12">PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> &quot;AM1303&quot;</span>, ] &lt;-<span class="st"> </span>dat1</a>
<a class="sourceLine" id="cb77-13" title="13"></a>
<a class="sourceLine" id="cb77-14" title="14"><span class="kw">write.csv</span>(PM_MB_means,</a>
<a class="sourceLine" id="cb77-15" title="15">          <span class="st">&quot;data/1911_PM_MB_means&amp;Ygains.csv&quot;</span>)</a></code></pre></div>
</div>
<div id="reduce-data-set-to-required-variables" class="section level2">
<h2><span class="header-section-number">5.4</span> Reduce data set to required variables</h2>
<p>Lets tidy up the data set into a data frame of only the variables which are required for the analysis.</p>
<p>First remove the irrelevant columns/variables. Then calculate fungicide application timing variables relative to the first sign of disease. Entries with NA in the grain yield or powdery mildew severity are also removed from the data.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">source</span>(<span class="st">&quot;R/slimming_PM_dat.R&quot;</span>) <span class="co"># see R script for the code which reduces the data.</span></a>
<a class="sourceLine" id="cb78-2" title="2"></a>
<a class="sourceLine" id="cb78-3" title="3">slim_PM_dat <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb78-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fungicide_timing_1 =</span> fungicide_application_<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>first_sign_disease) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb78-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fungicide_timing_2 =</span> fungicide_application_<span class="dv">2</span> <span class="op">-</span><span class="st"> </span>fungicide_application_<span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb78-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fungicide_timing_3 =</span> fungicide_application_<span class="dv">3</span> <span class="op">-</span><span class="st"> </span>fungicide_application_<span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb78-7" title="7"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(grain_yield.t.ha)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-8" title="8"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(PM_final_severity))</a></code></pre></div>
<div id="cluster-fungicide-applications" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Cluster fungicide applications</h3>
<p>We are going to define ‘fungicide application timing’ as a categorical variable, relative to the first sign of powdery mildew.</p>
<p>These categorical variables are named:<br />
- <strong>Early</strong>: First fungicide application was prior to first sign of disease.<br />
- <strong>Recommended</strong>: First fungicide application was applied on the day powdery mildew was observed, or within three days of first sign.<br />
- <strong>Late</strong>: First fungicide application was four or more days after first sign of disease being observed.</p>
<p>Follow up fungicide applications (cluster_2 and cluster_3) were also categorised as either, early, recommended or late.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">slim_PM_dat <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb79-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb79-3" title="3">    <span class="dt">cluster_1 =</span> <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb79-4" title="4">      fungicide_timing_<span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Early&quot;</span>,</a>
<a class="sourceLine" id="cb79-5" title="5">      fungicide_timing_<span class="dv">1</span> <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb79-6" title="6"><span class="st">        </span>fungicide_timing_<span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> &quot;Recommended&quot;</span>,</a>
<a class="sourceLine" id="cb79-7" title="7">      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Late&quot;</span></a>
<a class="sourceLine" id="cb79-8" title="8">    )</a>
<a class="sourceLine" id="cb79-9" title="9">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb79-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb79-11" title="11">    <span class="dt">cluster_2 =</span> <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb79-12" title="12">      <span class="kw">is.na</span>(fungicide_timing_<span class="dv">2</span>) <span class="op">~</span><span class="st"> </span><span class="ot">NA_character_</span>,</a>
<a class="sourceLine" id="cb79-13" title="13">      fungicide_timing_<span class="dv">2</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">13</span> <span class="op">~</span><span class="st"> &quot;Early&quot;</span>,</a>
<a class="sourceLine" id="cb79-14" title="14">      fungicide_timing_<span class="dv">2</span> <span class="op">&gt;=</span><span class="st"> </span><span class="dv">13</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb79-15" title="15"><span class="st">        </span>fungicide_timing_<span class="dv">2</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">17</span> <span class="op">~</span><span class="st"> &quot;Recommended&quot;</span>,</a>
<a class="sourceLine" id="cb79-16" title="16">      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Late&quot;</span></a>
<a class="sourceLine" id="cb79-17" title="17">    )</a>
<a class="sourceLine" id="cb79-18" title="18">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb79-19" title="19"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb79-20" title="20">    <span class="dt">cluster_3 =</span> <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb79-21" title="21">      fungicide_timing_<span class="dv">3</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">14</span> <span class="op">~</span><span class="st"> &quot;Early&quot;</span>,</a>
<a class="sourceLine" id="cb79-22" title="22">      <span class="kw">is.na</span>(fungicide_timing_<span class="dv">3</span>) <span class="op">~</span><span class="st"> </span><span class="ot">NA_character_</span>,</a>
<a class="sourceLine" id="cb79-23" title="23">      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Recommended&quot;</span></a>
<a class="sourceLine" id="cb79-24" title="24">    )</a>
<a class="sourceLine" id="cb79-25" title="25">  )</a></code></pre></div>
<p>Lets look at these clusters to see where we have the most degrees of freedom.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">clusters &lt;-<span class="st"> </span><span class="kw">unique</span>(slim_PM_dat[<span class="kw">c</span>(<span class="st">&quot;cluster_1&quot;</span>,<span class="st">&quot;cluster_2&quot;</span>,<span class="st">&quot;cluster_3&quot;</span>)])</a>
<a class="sourceLine" id="cb80-2" title="2"></a>
<a class="sourceLine" id="cb80-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(clusters)){</a>
<a class="sourceLine" id="cb80-4" title="4">   <span class="cf">if</span>(i <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){clusters<span class="op">$</span>n &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb80-5" title="5">   clusters<span class="op">$</span>n_x_trial &lt;-<span class="st"> </span><span class="ot">NA</span>}</a>
<a class="sourceLine" id="cb80-6" title="6">   </a>
<a class="sourceLine" id="cb80-7" title="7">   clusters[i,<span class="st">&quot;n&quot;</span>] &lt;-<span class="st"> </span><span class="kw">nrow</span>(slim_PM_dat[slim_PM_dat<span class="op">$</span>cluster_<span class="dv">1</span> <span class="op">==</span><span class="st"> </span>clusters[i,<span class="st">&quot;cluster_1&quot;</span>] <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb80-8" title="8"><span class="st">                                          </span>slim_PM_dat<span class="op">$</span>cluster_<span class="dv">2</span> <span class="op">==</span><span class="st"> </span>clusters[i,<span class="st">&quot;cluster_2&quot;</span>] <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb80-9" title="9"><span class="st">                                          </span>slim_PM_dat<span class="op">$</span>cluster_<span class="dv">3</span> <span class="op">==</span><span class="st"> </span>clusters[i,<span class="st">&quot;cluster_3&quot;</span>],</a>
<a class="sourceLine" id="cb80-10" title="10">                                       ])</a>
<a class="sourceLine" id="cb80-11" title="11">   </a>
<a class="sourceLine" id="cb80-12" title="12">   clusters[i,<span class="st">&quot;n_x_trial&quot;</span>] &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(slim_PM_dat[slim_PM_dat<span class="op">$</span>cluster_<span class="dv">1</span> <span class="op">==</span><span class="st"> </span>clusters[i,<span class="st">&quot;cluster_1&quot;</span>] <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb80-13" title="13"><span class="st">                                          </span>slim_PM_dat<span class="op">$</span>cluster_<span class="dv">2</span> <span class="op">==</span><span class="st"> </span>clusters[i,<span class="st">&quot;cluster_2&quot;</span>] <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb80-14" title="14"><span class="st">                                          </span>slim_PM_dat<span class="op">$</span>cluster_<span class="dv">3</span> <span class="op">==</span><span class="st"> </span>clusters[i,<span class="st">&quot;cluster_3&quot;</span>],</a>
<a class="sourceLine" id="cb80-15" title="15">                                       <span class="st">&quot;trial_ref&quot;</span>]))</a>
<a class="sourceLine" id="cb80-16" title="16">   </a>
<a class="sourceLine" id="cb80-17" title="17">}</a>
<a class="sourceLine" id="cb80-18" title="18"></a>
<a class="sourceLine" id="cb80-19" title="19">knitr<span class="op">::</span><span class="kw">kable</span>(clusters)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
cluster_1
</th>
<th style="text-align:left;">
cluster_2
</th>
<th style="text-align:left;">
cluster_3
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
n_x_trial
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Late
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:left;">
Late
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
Early
</td>
<td style="text-align:left;">
Late
</td>
<td style="text-align:left;">
Early
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
30
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:left;">
Late
</td>
<td style="text-align:left;">
Early
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
33
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:left;">
Early
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
34
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:left;">
Early
</td>
<td style="text-align:left;">
Early
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
36
</td>
<td style="text-align:left;">
Early
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
37
</td>
<td style="text-align:left;">
Early
</td>
<td style="text-align:left;">
Late
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
38
</td>
<td style="text-align:left;">
Early
</td>
<td style="text-align:left;">
Late
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
42
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
44
</td>
<td style="text-align:left;">
Early
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
48
</td>
<td style="text-align:left;">
Late
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
59
</td>
<td style="text-align:left;">
Late
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
148
</td>
<td style="text-align:left;">
Late
</td>
<td style="text-align:left;">
Late
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>From this we can see that there are 16 different cluster combinations, which would make the analysis too difficult. I will reduce this to 6 levels within one variable.</p>
<p>Single sprays either early, recommended timing or late.</p>
<p>Two sprays or more where the first spray was either early, recommended timing, or late.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">slim_PM_dat &lt;-<span class="st"> </span>slim_PM_dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb81-2" title="2"><span class="st">   </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb81-3" title="3">    <span class="dt">spray_management =</span> <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb81-4" title="4">       fungicide_timing_<span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb81-5" title="5"><span class="st">          </span><span class="kw">is.na</span>(fungicide_application_<span class="dv">2</span>) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb81-6" title="6"><span class="st">          </span><span class="kw">is.na</span>(fungicide_application_<span class="dv">3</span>) <span class="op">~</span><span class="st"> &quot;Early&quot;</span>,</a>
<a class="sourceLine" id="cb81-7" title="7">       fungicide_timing_<span class="dv">1</span> <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb81-8" title="8"><span class="st">          </span>fungicide_timing_<span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb81-9" title="9"><span class="st">          </span><span class="kw">is.na</span>(fungicide_application_<span class="dv">2</span>) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb81-10" title="10"><span class="st">          </span><span class="kw">is.na</span>(fungicide_application_<span class="dv">3</span>) <span class="op">~</span><span class="st"> &quot;Recommended&quot;</span>,</a>
<a class="sourceLine" id="cb81-11" title="11">      fungicide_timing_<span class="dv">1</span> <span class="op">&gt;=</span><span class="st"> </span><span class="dv">4</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb81-12" title="12"><span class="st">          </span><span class="kw">is.na</span>(fungicide_application_<span class="dv">2</span>) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb81-13" title="13"><span class="st">          </span><span class="kw">is.na</span>(fungicide_application_<span class="dv">3</span>) <span class="op">~</span><span class="st"> &quot;Late&quot;</span>,</a>
<a class="sourceLine" id="cb81-14" title="14">      fungicide_timing_<span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb81-15" title="15"><span class="st">          </span><span class="op">!</span><span class="kw">is.na</span>(fungicide_application_<span class="dv">2</span>) <span class="op">~</span><span class="st"> &quot;Early_plus&quot;</span>,</a>
<a class="sourceLine" id="cb81-16" title="16">       fungicide_timing_<span class="dv">1</span> <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb81-17" title="17"><span class="st">          </span>fungicide_timing_<span class="dv">1</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb81-18" title="18"><span class="st">          </span><span class="op">!</span><span class="kw">is.na</span>(fungicide_application_<span class="dv">2</span>) <span class="op">~</span><span class="st"> &quot;Recommended_plus&quot;</span>,</a>
<a class="sourceLine" id="cb81-19" title="19">      fungicide_timing_<span class="dv">1</span> <span class="op">&gt;=</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> &quot;Late_plus&quot;</span>,</a>
<a class="sourceLine" id="cb81-20" title="20">      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Other&quot;</span></a>
<a class="sourceLine" id="cb81-21" title="21">    )</a>
<a class="sourceLine" id="cb81-22" title="22">  ) </a>
<a class="sourceLine" id="cb81-23" title="23"></a>
<a class="sourceLine" id="cb81-24" title="24">slim_PM_dat[slim_PM_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span>,</a>
<a class="sourceLine" id="cb81-25" title="25">            <span class="kw">c</span>(<span class="st">&quot;fungicide_timing_1&quot;</span>, <span class="st">&quot;fungicide_timing_2&quot;</span>, <span class="st">&quot;fungicide_timing_3&quot;</span>,</a>
<a class="sourceLine" id="cb81-26" title="26">              <span class="st">&quot;spray_management&quot;</span></a>
<a class="sourceLine" id="cb81-27" title="27">              )] &lt;-<span class="st"> &quot;control&quot;</span></a></code></pre></div>
<p>Now to view the number break-down of the <code>spray_management</code> treatments</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">table</span>(slim_PM_dat<span class="op">$</span>spray_management)</a></code></pre></div>
<pre><code>## 
##          control            Early       Early_plus             Late 
##               40               13                5               17 
##        Late_plus      Recommended Recommended_plus 
##               20               32               46</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="co"># For each treatment, when were the first fungicide applications made </span></a>
<a class="sourceLine" id="cb84-2" title="2"><span class="co"># relative to the first sign of disease</span></a>
<a class="sourceLine" id="cb84-3" title="3"><span class="kw">table</span>(slim_PM_dat<span class="op">$</span>spray_management,slim_PM_dat<span class="op">$</span>fungicide_timing_<span class="dv">1</span>)</a></code></pre></div>
<pre><code>##                   
##                    -11 -13 -14 -16  0  1 11 12 13 19  3  7  8  9 control
##   control            0   0   0   0  0  0  0  0  0  0  0  0  0  0      40
##   Early              6   6   0   1  0  0  0  0  0  0  0  0  0  0       0
##   Early_plus         0   2   1   2  0  0  0  0  0  0  0  0  0  0       0
##   Late               0   0   0   0  0  0  2 12  1  0  0  0  1  1       0
##   Late_plus          0   0   0   0  0  0  0  0  3  1  0 13  0  3       0
##   Recommended        0   0   0   0 11 12  0  0  0  0  9  0  0  0       0
##   Recommended_plus   0   0   0   0 18 18  0  0  0  0 10  0  0  0       0</code></pre>
<p>There are few ‘Early_plus’ and ‘late’ treatments, these treatments therefore will have too few comparisons with other treatments in the meta-analysis to be provide accurate results. Therefore we will remove ‘Early_plus’ and ‘Late’ from the analysis.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">slimmer_PM_dat &lt;-<span class="st"> </span>slim_PM_dat[slim_PM_dat<span class="op">$</span>spray_management <span class="op">!=</span><span class="st"> &quot;Late&quot;</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-2" title="2"><span class="st">               </span>slim_PM_dat<span class="op">$</span>spray_management <span class="op">!=</span><span class="st"> &quot;Early_plus&quot;</span>,]</a>
<a class="sourceLine" id="cb86-3" title="3"></a>
<a class="sourceLine" id="cb86-4" title="4"><span class="kw">write.csv</span>(slimmer_PM_dat, <span class="dt">file =</span> <span class="st">&quot;data/slimmer_PM_clusterdat.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Our data currently uses sample variance to define the yield error. We should expect that when yield increases so does the variance. Lets quickly plot this to check.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co"># redefine sample variance calculated from mean square</span></a>
<a class="sourceLine" id="cb87-2" title="2">slimmer_PM_dat<span class="op">$</span>vi &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb87-3" title="3"><span class="st">   </span>slimmer_PM_dat<span class="op">$</span>Y_Msquare <span class="op">/</span><span class="st"> </span></a>
<a class="sourceLine" id="cb87-4" title="4"><span class="st">   </span>(slimmer_PM_dat<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>slimmer_PM_dat<span class="op">$</span>grain_yield.t.ha <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb87-5" title="5"></a>
<a class="sourceLine" id="cb87-6" title="6">slimmer_PM_dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb87-7" title="7"><span class="st">   </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span> grain_yield.t.ha, <span class="dt">y =</span> vi))<span class="op">+</span></a>
<a class="sourceLine" id="cb87-8" title="8"><span class="st">   </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 21 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/Var_mean_sqaures-1.png" width="672" /></p>
<p>We see here that the sample variance generally decreases or has no association with the grain yield. This might be due to the unpredictable nature of mungbeans, however going forward we will use mean squares which defines between trial variation and is a the more generic error term.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">slimmer_PM_dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-2" title="2"><span class="st">   </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span> grain_yield.t.ha, <span class="dt">y =</span> Y_Msquare))<span class="op">+</span></a>
<a class="sourceLine" id="cb89-3" title="3"><span class="st">   </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 21 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/Var_MeanSquarePlot-1.png" width="672" /></p>
<p> <br />
 <br />
 </p>
</div>
</div>
<div id="audpc-visualise-raw-data" class="section level2">
<h2><span class="header-section-number">5.5</span> AUDPC visualise raw data</h2>
<blockquote>
<p>How well does ‘area under the disease progress curve’ (AUDPC) predict grain yield?</p>
</blockquote>
<p>and <em>Does spray_management scenario mitigate yield loss through reducing AUDPC?</em></p>
<p>We would expect to see grain yield decline with increasing AUDPC. Lets just plot yield vs AUDPC.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="kw">plot</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span>AUDPC_m,<span class="dt">data =</span> PM_MB_means)</a>
<a class="sourceLine" id="cb91-2" title="2"><span class="kw">abline</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span>AUDPC_m, <span class="dt">data =</span> PM_MB_means))</a></code></pre></div>
<p><img src="_main_files/figure-html/Yield_vs_AUDPC-1.png" width="672" /></p>
<p>There appears to be no relationship between the two continuous variables.<br />
Does a linear model confirm this?</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">summary</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span>AUDPC_m, <span class="dt">data =</span> PM_MB_means))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = grain_yield.t.ha. ~ AUDPC_m, data = PM_MB_means)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.96197 -0.40775 -0.07828  0.38363  1.39537 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.0380816  0.0512487  20.256  &lt; 2e-16 ***
## AUDPC_m     0.0010316  0.0003951   2.611  0.00945 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5374 on 314 degrees of freedom
##   (39 observations deleted due to missingness)
## Multiple R-squared:  0.02125,    Adjusted R-squared:  0.01814 
## F-statistic: 6.819 on 1 and 314 DF,  p-value: 0.009453</code></pre>
<p>There is no relationship as per the linear model.</p>
<p>Perhaps the variation due to trial location, season, row spacing, and other seasonal variables are preventing us from seeing a relationship. Lets do the plot again for each trial where there are no missing values.<br />
Note: The plots are ordered by mean yield of the trial.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">sm2lg &lt;-<span class="st"> </span>PM_MB_means<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="st">   </span><span class="kw">group_by</span>(trial_ref)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-3" title="3"><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">TY =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-4" title="4"><span class="st">   </span><span class="kw">arrange</span>(TY)</a>
<a class="sourceLine" id="cb94-5" title="5"></a>
<a class="sourceLine" id="cb94-6" title="6"></a>
<a class="sourceLine" id="cb94-7" title="7"></a>
<a class="sourceLine" id="cb94-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> sm2lg<span class="op">$</span>trial_ref){</a>
<a class="sourceLine" id="cb94-9" title="9">   dat1 &lt;-<span class="st"> </span>PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>i, ]</a>
<a class="sourceLine" id="cb94-10" title="10">   <span class="cf">if</span>(<span class="kw">any</span>(<span class="kw">is.na</span>(dat1<span class="op">$</span>grain_yield.t.ha.))){<span class="cf">next</span>}</a>
<a class="sourceLine" id="cb94-11" title="11">   <span class="cf">if</span>(<span class="kw">any</span>(<span class="kw">is.na</span>(dat1<span class="op">$</span>AUDPC_m))){<span class="cf">next</span>}</a>
<a class="sourceLine" id="cb94-12" title="12">   </a>
<a class="sourceLine" id="cb94-13" title="13">   </a>
<a class="sourceLine" id="cb94-14" title="14"><span class="kw">plot</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span>AUDPC_m, </a>
<a class="sourceLine" id="cb94-15" title="15">     <span class="dt">data =</span> dat1, <span class="dt">main =</span> <span class="kw">paste</span>(dat1<span class="op">$</span>location[<span class="dv">1</span>],(dat1<span class="op">$</span>year[<span class="dv">1</span>])),</a>
<a class="sourceLine" id="cb94-16" title="16">     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(PM_MB_means<span class="op">$</span>grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)), </a>
<a class="sourceLine" id="cb94-17" title="17">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(PM_MB_means<span class="op">$</span>AUDPC_m, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)))</a>
<a class="sourceLine" id="cb94-18" title="18"><span class="kw">abline</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span>AUDPC_m, <span class="dt">data =</span> dat1))</a>
<a class="sourceLine" id="cb94-19" title="19"><span class="kw">points</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span>AUDPC_m, <span class="dt">data =</span> dat1[dat1<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span>,], <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb94-20" title="20">   </a>
<a class="sourceLine" id="cb94-21" title="21">}</a></code></pre></div>
<p><img src="_main_files/figure-html/AUDPCxTrial-1.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-2.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-3.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-4.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-5.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-6.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-7.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-8.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-9.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-10.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-11.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-12.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-13.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-14.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-15.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-16.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-17.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-18.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-19.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-20.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-21.png" width="672" /><img src="_main_files/figure-html/AUDPCxTrial-22.png" width="672" /></p>
<p>This sequence of graphs show that AUDPC and disease incidence does not impact on yields if the season is a low yielding, ie lower than 1 tonne per hectare.<br />
The higher the yield the greater greater the influence on the disease on the yield especially if the crop is high yielding with AUDPC also being large enough to reduce yield.</p>
<p>Lets have a look again at the same sequance of graphs and analyses for area under the disease progress <em>stairs</em>.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">plot</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span>AUDPS_m,<span class="dt">data =</span> PM_MB_means)</a>
<a class="sourceLine" id="cb95-2" title="2"><span class="kw">abline</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span>AUDPS_m, <span class="dt">data =</span> PM_MB_means))</a></code></pre></div>
<p><img src="_main_files/figure-html/Yield_vs_AUDPS-1.png" width="672" /></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">summary</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span>AUDPS_m, <span class="dt">data =</span> PM_MB_means))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = grain_yield.t.ha. ~ AUDPS_m, data = PM_MB_means)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.90200 -0.43768 -0.08853  0.38705  1.44491 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.0670810  0.0556434  19.177   &lt;2e-16 ***
## AUDPS_m     0.0005847  0.0003446   1.697   0.0907 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5408 on 314 degrees of freedom
##   (39 observations deleted due to missingness)
## Multiple R-squared:  0.009086,   Adjusted R-squared:  0.005931 
## F-statistic: 2.879 on 1 and 314 DF,  p-value: 0.09072</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">sm2lg &lt;-<span class="st"> </span>PM_MB_means<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-2" title="2"><span class="st">   </span><span class="kw">group_by</span>(trial_ref)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-3" title="3"><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">TY =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-4" title="4"><span class="st">   </span><span class="kw">arrange</span>(TY)</a>
<a class="sourceLine" id="cb98-5" title="5"></a>
<a class="sourceLine" id="cb98-6" title="6"></a>
<a class="sourceLine" id="cb98-7" title="7"></a>
<a class="sourceLine" id="cb98-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> sm2lg<span class="op">$</span>trial_ref){</a>
<a class="sourceLine" id="cb98-9" title="9">   dat1 &lt;-<span class="st"> </span>PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>i, ]</a>
<a class="sourceLine" id="cb98-10" title="10">   <span class="cf">if</span>(<span class="kw">any</span>(<span class="kw">is.na</span>(dat1<span class="op">$</span>grain_yield.t.ha.))){<span class="cf">next</span>}</a>
<a class="sourceLine" id="cb98-11" title="11">   <span class="cf">if</span>(<span class="kw">any</span>(<span class="kw">is.na</span>(dat1<span class="op">$</span>AUDPS_m))){<span class="cf">next</span>}</a>
<a class="sourceLine" id="cb98-12" title="12">   </a>
<a class="sourceLine" id="cb98-13" title="13">   </a>
<a class="sourceLine" id="cb98-14" title="14"><span class="kw">plot</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span>AUDPS_m, </a>
<a class="sourceLine" id="cb98-15" title="15">     <span class="dt">data =</span> dat1, <span class="dt">main =</span> <span class="kw">paste</span>(dat1<span class="op">$</span>location[<span class="dv">1</span>],(dat1<span class="op">$</span>year[<span class="dv">1</span>])),</a>
<a class="sourceLine" id="cb98-16" title="16">     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(PM_MB_means<span class="op">$</span>grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)), </a>
<a class="sourceLine" id="cb98-17" title="17">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(PM_MB_means<span class="op">$</span>AUDPS_m, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)))</a>
<a class="sourceLine" id="cb98-18" title="18"><span class="kw">abline</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span>AUDPS_m, <span class="dt">data =</span> dat1))</a>
<a class="sourceLine" id="cb98-19" title="19"><span class="kw">points</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span>AUDPS_m, <span class="dt">data =</span> dat1[dat1<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span>,], <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb98-20" title="20">   </a>
<a class="sourceLine" id="cb98-21" title="21">}</a></code></pre></div>
<p><img src="_main_files/figure-html/Yield_vs_AUDPS-2.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-3.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-4.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-5.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-6.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-7.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-8.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-9.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-10.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-11.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-12.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-13.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-14.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-15.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-16.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-17.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-18.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-19.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-20.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-21.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-22.png" width="672" /><img src="_main_files/figure-html/Yield_vs_AUDPS-23.png" width="672" /></p>

<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="co"># install.packages(&quot;tidyverse&quot;)</span></a>
<a class="sourceLine" id="cb99-2" title="2"><span class="co"># install.packages(&quot;devtools&quot;)</span></a>
<a class="sourceLine" id="cb99-3" title="3"><span class="co"># devtools::install_github(&quot;https://github.com/adamhsparks/theme.usq&quot;, dependencies = TRUE)</span></a>
<a class="sourceLine" id="cb99-4" title="4"><span class="co"># install.packages(&quot;lme4&quot;)</span></a>
<a class="sourceLine" id="cb99-5" title="5"></a>
<a class="sourceLine" id="cb99-6" title="6"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb99-7" title="7"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb99-8" title="8"><span class="kw">library</span>(theme.usq)</a>
<a class="sourceLine" id="cb99-9" title="9"><span class="kw">library</span>(bomrang)</a>
<a class="sourceLine" id="cb99-10" title="10"><span class="kw">library</span>(lme4)</a>
<a class="sourceLine" id="cb99-11" title="11"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb99-12" title="12"></a>
<a class="sourceLine" id="cb99-13" title="13"><span class="co"># Data</span></a>
<a class="sourceLine" id="cb99-14" title="14">slimmer_PM_dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/slimmer_PM_clusterdat.csv&quot;</span>)</a></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="preliminary-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="meta-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
