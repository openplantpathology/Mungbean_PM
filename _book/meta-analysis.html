<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Meta-analysis | Powdery mildew yield loss mitigation strategies in mungbean, a meta-analysis.</title>
  <meta name="description" content="A meta-analysis of fungicide use in mungbean to control for yield loss due to powdery mildew." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Meta-analysis | Powdery mildew yield loss mitigation strategies in mungbean, a meta-analysis." />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A meta-analysis of fungicide use in mungbean to control for yield loss due to powdery mildew." />
  <meta name="github-repo" content="OpenPlantPathology/Mungbean_PM" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Meta-analysis | Powdery mildew yield loss mitigation strategies in mungbean, a meta-analysis." />
  
  <meta name="twitter:description" content="A meta-analysis of fungicide use in mungbean to control for yield loss due to powdery mildew." />
  

<meta name="author" content="Paul Melloy, Emerson Del Ponte and Adam H. Sparks" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="prepare-data-for-meta-anlysys.html"/>
<link rel="next" href="aupdc-meta-analysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Research questions</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#parts-of-analysis-that-need-checking"><i class="fa fa-check"></i><b>1.1</b> Parts of analysis that need checking</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html"><i class="fa fa-check"></i><b>2</b> Studies considered in meta-analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html#summary-of-data"><i class="fa fa-check"></i><b>2.1</b> Summary of data</a></li>
<li class="chapter" data-level="2.2" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html#powdery-mildew-ratings"><i class="fa fa-check"></i><b>2.2</b> Powdery mildew ratings</a></li>
<li class="chapter" data-level="2.3" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html#experimental-locations"><i class="fa fa-check"></i><b>2.3</b> Experimental locations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="weather-data.html"><a href="weather-data.html"><i class="fa fa-check"></i><b>3</b> Weather data</a><ul>
<li class="chapter" data-level="3.0.1" data-path="weather-data.html"><a href="weather-data.html#kingaroy-historical-weather"><i class="fa fa-check"></i><b>3.0.1</b> Kingaroy historical weather</a></li>
<li class="chapter" data-level="3.0.2" data-path="weather-data.html"><a href="weather-data.html#hermitage-historical-weather"><i class="fa fa-check"></i><b>3.0.2</b> Hermitage historical weather</a></li>
<li class="chapter" data-level="3.0.3" data-path="weather-data.html"><a href="weather-data.html#gatton-historical-weather"><i class="fa fa-check"></i><b>3.0.3</b> Gatton historical weather</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html"><i class="fa fa-check"></i><b>4</b> Preliminary Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#explore-and-visualise-data"><i class="fa fa-check"></i><b>4.1</b> Explore and visualise Data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#fungicides"><i class="fa fa-check"></i><b>4.1.1</b> Fungicides</a></li>
<li class="chapter" data-level="4.1.2" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#mungbean-cultivars"><i class="fa fa-check"></i><b>4.1.2</b> Mungbean cultivars</a></li>
<li class="chapter" data-level="4.1.3" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#row-spacing"><i class="fa fa-check"></i><b>4.1.3</b> Row spacing</a></li>
<li class="chapter" data-level="4.1.4" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#yield-vs-in-season-rain"><i class="fa fa-check"></i><b>4.1.4</b> Yield vs in-season rain</a></li>
<li class="chapter" data-level="4.1.5" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#season-range-and-first-incidence"><i class="fa fa-check"></i><b>4.1.5</b> Season range and first incidence</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="prepare-data-for-meta-anlysys.html"><a href="prepare-data-for-meta-anlysys.html"><i class="fa fa-check"></i><b>5</b> Prepare data for meta-anlysys</a><ul>
<li class="chapter" data-level="5.1" data-path="prepare-data-for-meta-anlysys.html"><a href="prepare-data-for-meta-anlysys.html#set-environment-and-import-data"><i class="fa fa-check"></i><b>5.1</b> Set environment and import data</a></li>
<li class="chapter" data-level="5.2" data-path="prepare-data-for-meta-anlysys.html"><a href="prepare-data-for-meta-anlysys.html#standardising-sample-variance"><i class="fa fa-check"></i><b>5.2</b> Standardising sample variance</a><ul>
<li class="chapter" data-level="5.2.1" data-path="prepare-data-for-meta-anlysys.html"><a href="prepare-data-for-meta-anlysys.html#converting-least-squares-to-sample-variance"><i class="fa fa-check"></i><b>5.2.1</b> Converting least-squares to sample variance</a></li>
<li class="chapter" data-level="5.2.2" data-path="prepare-data-for-meta-anlysys.html"><a href="prepare-data-for-meta-anlysys.html#converting-standard-deviation-to-sample-variance"><i class="fa fa-check"></i><b>5.2.2</b> Converting standard deviation to sample variance</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="prepare-data-for-meta-anlysys.html"><a href="prepare-data-for-meta-anlysys.html#yield-saving"><i class="fa fa-check"></i><b>5.3</b> Yield saving</a></li>
<li class="chapter" data-level="5.4" data-path="prepare-data-for-meta-anlysys.html"><a href="prepare-data-for-meta-anlysys.html#reduce-data-set-to-required-variables"><i class="fa fa-check"></i><b>5.4</b> Reduce data set to required variables</a><ul>
<li class="chapter" data-level="5.4.1" data-path="prepare-data-for-meta-anlysys.html"><a href="prepare-data-for-meta-anlysys.html#cluster-fungicide-applications"><i class="fa fa-check"></i><b>5.4.1</b> Cluster fungicide applications</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="meta-analysis.html"><a href="meta-analysis.html"><i class="fa fa-check"></i><b>6</b> Meta-analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="meta-analysis.html"><a href="meta-analysis.html#grain-yield-meta-analysis"><i class="fa fa-check"></i><b>6.1</b> Grain yield meta-analysis</a><ul>
<li class="chapter" data-level="6.1.1" data-path="meta-analysis.html"><a href="meta-analysis.html#imputing-sample-variances"><i class="fa fa-check"></i><b>6.1.1</b> Imputing sample variances</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="meta-analysis.html"><a href="meta-analysis.html#meta-analysis-1"><i class="fa fa-check"></i><b>6.2</b> Meta-analysis</a><ul>
<li class="chapter" data-level="6.2.1" data-path="meta-analysis.html"><a href="meta-analysis.html#metafor-package"><i class="fa fa-check"></i><b>6.2.1</b> metafor package</a></li>
<li class="chapter" data-level="6.2.2" data-path="meta-analysis.html"><a href="meta-analysis.html#netmeta-package"><i class="fa fa-check"></i><b>6.2.2</b> netmeta package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="aupdc-meta-analysis.html"><a href="aupdc-meta-analysis.html"><i class="fa fa-check"></i><b>7</b> AUPDC meta-analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="aupdc-meta-analysis.html"><a href="aupdc-meta-analysis.html#aupdc-impact-on-grain-yield-meta-analysis"><i class="fa fa-check"></i><b>7.1</b> AUPDC impact on grain yield meta-analysis</a></li>
<li class="chapter" data-level="7.2" data-path="aupdc-meta-analysis.html"><a href="aupdc-meta-analysis.html#who-are-the-intended-readers---list-3-to-5-of-them-by-name"><i class="fa fa-check"></i><b>7.2</b> Who are the intended readers? - list 3 to 5 of them by name</a></li>
<li class="chapter" data-level="7.3" data-path="aupdc-meta-analysis.html"><a href="aupdc-meta-analysis.html#what-did-you-do-limit---50-words"><i class="fa fa-check"></i><b>7.3</b> what did you do? (limit - 50 words)</a></li>
<li class="chapter" data-level="7.4" data-path="aupdc-meta-analysis.html"><a href="aupdc-meta-analysis.html#why-did-you-do-it-limit---50-words"><i class="fa fa-check"></i><b>7.4</b> Why did you do it? (limit - 50 words)</a></li>
<li class="chapter" data-level="7.5" data-path="aupdc-meta-analysis.html"><a href="aupdc-meta-analysis.html#what-happened-limit---50-words"><i class="fa fa-check"></i><b>7.5</b> what happened? (limit - 50 words)</a></li>
<li class="chapter" data-level="7.6" data-path="aupdc-meta-analysis.html"><a href="aupdc-meta-analysis.html#what-do-the-results-mean-in-theory-limit---50-words"><i class="fa fa-check"></i><b>7.6</b> What do the results mean in theory? (limit - 50 words)</a></li>
<li class="chapter" data-level="7.7" data-path="aupdc-meta-analysis.html"><a href="aupdc-meta-analysis.html#what-do-the-results-mean-in-practice-limit---50-words"><i class="fa fa-check"></i><b>7.7</b> What do the results mean in practice? (limit - 50 words)</a></li>
<li class="chapter" data-level="7.8" data-path="aupdc-meta-analysis.html"><a href="aupdc-meta-analysis.html#what-is-the-key-benefit-for-your-readers-limit---25-words."><i class="fa fa-check"></i><b>7.8</b> what is the key benefit for your readers? (limit - 25 words).</a></li>
<li class="chapter" data-level="7.9" data-path="aupdc-meta-analysis.html"><a href="aupdc-meta-analysis.html#what-remains-unresolved-no-word-limit."><i class="fa fa-check"></i><b>7.9</b> What remains unresolved? (no word limit).</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Powdery mildew yield loss mitigation strategies in mungbean, a meta-analysis.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="meta-analysis" class="section level1">
<h1><span class="header-section-number">6</span> Meta-analysis</h1>
<div id="grain-yield-meta-analysis" class="section level2">
<h2><span class="header-section-number">6.1</span> Grain yield meta-analysis</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1">m8 &lt;-<span class="st"> </span><span class="kw">lmer</span>(grain_yield.t.ha<span class="op">*</span><span class="dv">1000</span> <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(spray_management) <span class="op">+</span></a>
<a class="sourceLine" id="cb108-2" title="2"><span class="st">              </span>(<span class="kw">factor</span>(spray_management) <span class="op">|</span><span class="st"> </span>trial_ref), </a>
<a class="sourceLine" id="cb108-3" title="3">           <span class="dt">data =</span> slimmer_PM_dat)</a></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1">m9 &lt;-<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(grain_yield.t.ha<span class="op">*</span><span class="dv">1000</span>) <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(spray_management) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb110-2" title="2"><span class="st">              </span>(<span class="kw">factor</span>(spray_management) <span class="op">|</span><span class="st"> </span>trial_ref), </a>
<a class="sourceLine" id="cb110-3" title="3">           <span class="dt">data =</span> slimmer_PM_dat)</a></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1">m10 &lt;-<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(grain_yield.t.ha<span class="op">*</span><span class="dv">1000</span>) <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb112-2" title="2"><span class="st">               </span>(<span class="kw">factor</span>(spray_management) <span class="op">|</span><span class="st"> </span>trial_ref), </a>
<a class="sourceLine" id="cb112-3" title="3">           <span class="dt">data =</span> slimmer_PM_dat)</a></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">m11 &lt;-<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(grain_yield.t.ha<span class="op">*</span><span class="dv">1000</span>) <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(spray_management) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb114-2" title="2"><span class="st">              </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>trial_ref), </a>
<a class="sourceLine" id="cb114-3" title="3">           <span class="dt">data =</span> slimmer_PM_dat)</a>
<a class="sourceLine" id="cb114-4" title="4"></a>
<a class="sourceLine" id="cb114-5" title="5"><span class="kw">anova</span>(m8,m9) <span class="co"># m9 is significantly better model</span></a></code></pre></div>
<pre><code>## refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>## Data: slimmer_PM_dat
## Models:
## m8: grain_yield.t.ha * 1000 ~ factor(spray_management) + (factor(spray_management) | 
## m8:     trial_ref)
## m9: log(grain_yield.t.ha * 1000) ~ factor(spray_management) + (factor(spray_management) | 
## m9:     trial_ref)
##    Df     AIC     BIC   logLik deviance  Chisq Chi Df Pr(&gt;Chisq)    
## m8 21 2096.44 2159.80 -1027.22  2054.44                             
## m9 21  -29.36   34.01    35.68   -71.36 2125.8      0  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">anova</span>(m9,m10) <span class="co"># m9 is significantly better model</span></a></code></pre></div>
<pre><code>## refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>## Data: slimmer_PM_dat
## Models:
## m10: log(grain_yield.t.ha * 1000) ~ (factor(spray_management) | trial_ref)
## m9: log(grain_yield.t.ha * 1000) ~ factor(spray_management) + (factor(spray_management) | 
## m9:     trial_ref)
##     Df     AIC    BIC logLik deviance  Chisq Chi Df Pr(&gt;Chisq)  
## m10 17 -25.584 25.710 29.792  -59.584                           
## m9  21 -29.357 34.006 35.678  -71.357 11.773      4    0.01912 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">anova</span>(m9,m11) <span class="co"># m11 is a simpler model which is no different to m9</span></a></code></pre></div>
<pre><code>## refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>## Data: slimmer_PM_dat
## Models:
## m11: log(grain_yield.t.ha * 1000) ~ factor(spray_management) + (1 | 
## m11:     trial_ref)
## m9: log(grain_yield.t.ha * 1000) ~ factor(spray_management) + (factor(spray_management) | 
## m9:     trial_ref)
##     Df     AIC     BIC logLik deviance  Chisq Chi Df Pr(&gt;Chisq)
## m11  7 -48.130 -27.009 31.065  -62.130                         
## m9  21 -29.357  34.006 35.678  -71.357 9.2264     14     0.8163</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">summary</span>(m9)</a></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: 
## log(grain_yield.t.ha * 1000) ~ factor(spray_management) + (factor(spray_management) |  
##     trial_ref)
##    Data: slimmer_PM_dat
## 
## REML criterion at convergence: -50.8
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -2.58718 -0.51727  0.04068  0.58676  1.96151 
## 
## Random effects:
##  Groups    Name                                     Variance  Std.Dev. Corr 
##  trial_ref (Intercept)                              2.442e-01 0.494173      
##            factor(spray_management)Early            9.264e-04 0.030436 -1.00
##            factor(spray_management)Late_plus        4.281e-03 0.065426  1.00
##            factor(spray_management)Recommended      6.291e-05 0.007931  1.00
##            factor(spray_management)Recommended_plus 5.864e-03 0.076575  1.00
##  Residual                                           2.323e-02 0.152403      
##                   
##                   
##                   
##  -1.00            
##  -1.00  1.00      
##  -1.00  1.00  1.00
##                   
## Number of obs: 151, groups:  trial_ref, 17
## 
## Fixed effects:
##                                          Estimate Std. Error t value
## (Intercept)                               6.80091    0.12274  55.411
## factor(spray_management)Early             0.04659    0.05136   0.907
## factor(spray_management)Late_plus         0.13618    0.05726   2.378
## factor(spray_management)Recommended       0.10907    0.03753   2.906
## factor(spray_management)Recommended_plus  0.14151    0.03954   3.579
## 
## Correlation of Fixed Effects:
##             (Intr) fc(_)E f(_)L_ fc(_)R
## fctr(spr_)E -0.224                     
## fctr(sp_)L_  0.194  0.044              
## fctr(spr_)R -0.086  0.297  0.185       
## fctr(sp_)R_  0.338  0.256  0.269  0.472
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<p>This linear mixed effect model shows indicates:<br />
- A single early spray before first sign of powdery mildew is not likely to increase yields.<br />
- A single or single spray with one or more follow sprays starting at the <code>recommended</code> first spray , within 3 days of powdery mildew first sign are likely to produce significantly higher grain yields compared to the no spray control.<br />
- The <code>recommended_plus</code> spray which has one or more follow-up sprays after first sign are likley to increase the mean grain yield.<br />
- <code>Late_plus</code> spray treatments showed the highest mean grain yield, and was significantly higher than the no spray control. However showed no difference to either of the <code>recommended</code> treatments.</p>
<div id="imputing-sample-variances" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Imputing sample variances</h3>
<p>We need to impute the variances which are missing for a few of the trials. These trials mung1112/01, mung1516/03 were analysed and reported that there was no significant difference between the treatments in each trial. So therefore we need the imputed variances not to show a significant difference.</p>
<p>There are 14 treatments without yield error in our data, and 137 where yield error was recorded.</p>
<p>Plotting a histogram of the variances show that the yield is not normally distributed. A log transformation, however, shows a normal disrtubution. We can use the mean and standard deviation of the log(V) to sample variances for the treatments where V is missing.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="kw">hist</span>(slimmer_PM_dat<span class="op">$</span>yield_error) <span class="co"># yield error is not normally distributed</span></a></code></pre></div>
<p><img src="_main_files/figure-html/variance_histograms-1.png" width="672" /></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">hist</span>(<span class="kw">log</span>(slimmer_PM_dat<span class="op">$</span>yield_error)) <span class="co"># a log transformation shows it is normally distributed </span></a></code></pre></div>
<p><img src="_main_files/figure-html/variance_histograms-2.png" width="672" /></p>
<p>We will evaluate wheather the imputed variances confer a significant difference to the recorded means. I created a distance matrix of two standard errors above the mean against two standard errors below the mean. If any errors don’t overlap, infering signicifant difference, the imputed variances are discarded and resampled until all treatment variances show no significant differences.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="co"># generate yield error values</span></a>
<a class="sourceLine" id="cb127-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">500</span>){</a>
<a class="sourceLine" id="cb127-3" title="3"></a>
<a class="sourceLine" id="cb127-4" title="4">   <span class="co"># Imputing missing log variances</span></a>
<a class="sourceLine" id="cb127-5" title="5">   log_Yerror &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(slimmer_PM_dat<span class="op">$</span>yield_error)),</a>
<a class="sourceLine" id="cb127-6" title="6">               <span class="dt">mean =</span> <span class="kw">mean</span>(<span class="kw">log</span>(slimmer_PM_dat<span class="op">$</span>yield_error), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb127-7" title="7">               <span class="dt">sd =</span> <span class="kw">sd</span>(<span class="kw">log</span>(slimmer_PM_dat<span class="op">$</span>yield_error), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) </a>
<a class="sourceLine" id="cb127-8" title="8">   </a>
<a class="sourceLine" id="cb127-9" title="9">   </a>
<a class="sourceLine" id="cb127-10" title="10">   <span class="co"># First lets convert Variance to standard error for all the variables that have variance recorded</span></a>
<a class="sourceLine" id="cb127-11" title="11">   slimmer_PM_dat<span class="op">$</span>yield_SE &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb127-12" title="12"><span class="st">      </span><span class="kw">sqrt</span>(slimmer_PM_dat<span class="op">$</span>yield_error)<span class="op">/</span><span class="kw">sqrt</span>(slimmer_PM_dat<span class="op">$</span>n)</a>
<a class="sourceLine" id="cb127-13" title="13">   </a>
<a class="sourceLine" id="cb127-14" title="14">   </a>
<a class="sourceLine" id="cb127-15" title="15">   <span class="co"># Second; adding the imputed standard errors</span></a>
<a class="sourceLine" id="cb127-16" title="16">   slimmer_PM_dat[<span class="kw">is.na</span>(slimmer_PM_dat<span class="op">$</span>yield_error), <span class="st">&quot;yield_SE&quot;</span>] &lt;-</a>
<a class="sourceLine" id="cb127-17" title="17"><span class="st">      </span><span class="kw">sqrt</span>(<span class="kw">exp</span>(log_Yerror))<span class="op">/</span><span class="kw">sqrt</span>(slimmer_PM_dat[<span class="kw">is.na</span>(slimmer_PM_dat<span class="op">$</span>yield_error),<span class="st">&quot;n&quot;</span>]) </a>
<a class="sourceLine" id="cb127-18" title="18"></a>
<a class="sourceLine" id="cb127-19" title="19"></a>
<a class="sourceLine" id="cb127-20" title="20"><span class="co"># all errorbars should overlap so they are consistant with the meta-data describing no significant difference bettween treatments</span></a>
<a class="sourceLine" id="cb127-21" title="21"><span class="co"># lets test to make sure</span></a>
<a class="sourceLine" id="cb127-22" title="22"><span class="cf">if</span>(</a>
<a class="sourceLine" id="cb127-23" title="23">   <span class="kw">max</span>(<span class="kw">outer</span>(<span class="dt">X =</span> slimmer_PM_dat[<span class="kw">is.na</span>(slimmer_PM_dat<span class="op">$</span>yield_error),<span class="st">&quot;grain_yield.t.ha&quot;</span>] <span class="op">-</span></a>
<a class="sourceLine" id="cb127-24" title="24"><span class="st">               </span>(<span class="dv">2</span><span class="op">*</span>slimmer_PM_dat[<span class="kw">is.na</span>(slimmer_PM_dat<span class="op">$</span>yield_error),<span class="st">&quot;yield_SE&quot;</span>]),</a>
<a class="sourceLine" id="cb127-25" title="25">             <span class="dt">Y =</span> slimmer_PM_dat[<span class="kw">is.na</span>(slimmer_PM_dat<span class="op">$</span>yield_error),<span class="st">&quot;grain_yield.t.ha&quot;</span>] <span class="op">+</span></a>
<a class="sourceLine" id="cb127-26" title="26"><span class="st">               </span>(<span class="dv">2</span><span class="op">*</span>slimmer_PM_dat[<span class="kw">is.na</span>(slimmer_PM_dat<span class="op">$</span>yield_error),<span class="st">&quot;yield_SE&quot;</span>]),</a>
<a class="sourceLine" id="cb127-27" title="27">             <span class="dt">FUN =</span> <span class="st">&quot;-&quot;</span>)</a>
<a class="sourceLine" id="cb127-28" title="28">       ) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb127-29" title="29">   </a>
<a class="sourceLine" id="cb127-30" title="30">   <span class="kw">message</span>(<span class="kw">paste</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Warning!!: Imputed yield errors show significant differences when they should not, imputation will automatically rerun - iteration&quot;</span>, <span class="st">&quot;i =&quot;</span>,i))</a>
<a class="sourceLine" id="cb127-31" title="31">   <span class="cf">next</span>()</a>
<a class="sourceLine" id="cb127-32" title="32">   }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb127-33" title="33">      <span class="kw">message</span>(<span class="kw">paste</span>(i,<span class="st">&quot;iterations: &quot;</span>, <span class="st">&quot;imputed variances now show no significant distances :)</span><span class="ch">\n</span><span class="st"> Now adding variances to data &quot;</span>))</a>
<a class="sourceLine" id="cb127-34" title="34">      </a>
<a class="sourceLine" id="cb127-35" title="35">      <span class="co"># Plot the imputed errors for each trial</span></a>
<a class="sourceLine" id="cb127-36" title="36">      Vplot &lt;-<span class="st"> </span>slimmer_PM_dat[<span class="kw">is.na</span>(slimmer_PM_dat<span class="op">$</span>yield_error),] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb127-37" title="37"><span class="st">         </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> grain_yield.t.ha, trial))<span class="op">+</span></a>
<a class="sourceLine" id="cb127-38" title="38"><span class="st">         </span><span class="co">#geom_point()+</span></a>
<a class="sourceLine" id="cb127-39" title="39"><span class="st">         </span><span class="kw">geom_pointrange</span>(<span class="dt">ymin =</span> slimmer_PM_dat[<span class="kw">is.na</span>(slimmer_PM_dat<span class="op">$</span>yield_error),<span class="st">&quot;grain_yield.t.ha&quot;</span>] <span class="op">-</span></a>
<a class="sourceLine" id="cb127-40" title="40"><span class="st">                            </span>(<span class="fl">1.95</span><span class="op">*</span>slimmer_PM_dat[<span class="kw">is.na</span>(slimmer_PM_dat<span class="op">$</span>yield_error),<span class="st">&quot;yield_SE&quot;</span>]),</a>
<a class="sourceLine" id="cb127-41" title="41">                         <span class="dt">ymax =</span> slimmer_PM_dat[<span class="kw">is.na</span>(slimmer_PM_dat<span class="op">$</span>yield_error),<span class="st">&quot;grain_yield.t.ha&quot;</span>] <span class="op">+</span></a>
<a class="sourceLine" id="cb127-42" title="42"><span class="st">                            </span>(<span class="fl">1.95</span><span class="op">*</span>slimmer_PM_dat[<span class="kw">is.na</span>(slimmer_PM_dat<span class="op">$</span>yield_error),<span class="st">&quot;yield_SE&quot;</span>]),</a>
<a class="sourceLine" id="cb127-43" title="43">                         <span class="dt">position =</span> <span class="st">&quot;jitter&quot;</span></a>
<a class="sourceLine" id="cb127-44" title="44">                         )<span class="op">+</span></a>
<a class="sourceLine" id="cb127-45" title="45"><span class="st">         </span><span class="kw">ylim</span>(<span class="fl">0.2</span>,<span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb127-46" title="46">      </a>
<a class="sourceLine" id="cb127-47" title="47">      slimmer_PM_dat[<span class="kw">is.na</span>(slimmer_PM_dat<span class="op">$</span>yield_error), <span class="st">&quot;yield_error&quot;</span>] &lt;-<span class="st"> </span><span class="kw">exp</span>(log_Yerror)</a>
<a class="sourceLine" id="cb127-48" title="48">      <span class="kw">print</span>(Vplot)</a>
<a class="sourceLine" id="cb127-49" title="49">      <span class="cf">break</span>()}</a>
<a class="sourceLine" id="cb127-50" title="50">}</a></code></pre></div>
<pre><code>## 
## Warning!!: Imputed yield errors show significant differences when they should not, imputation will automatically rerun - iteration i = 0</code></pre>
<pre><code>## 
## Warning!!: Imputed yield errors show significant differences when they should not, imputation will automatically rerun - iteration i = 1</code></pre>
<pre><code>## 2 iterations:  imputed variances now show no significant distances :)
##  Now adding variances to data</code></pre>
<p><img src="_main_files/figure-html/imputing_variances-1.png" width="672" /></p>
<p>The imputed variances calculated above don’t show the expected positive correlation between grain yield and variance. This is unexpected and reflects the inherent variability of the data. Therefore we will calculate the trial mean squares and use this to calculate the variance for each sample.</p>
<div id="imputing-sample-variances-from-mean-squares" class="section level4">
<h4><span class="header-section-number">6.1.1.1</span> Imputing sample variances from Mean squares</h4>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1">slimmer_PM_dat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/slimmer_PM_clusterdat.csv&quot;</span>)</a>
<a class="sourceLine" id="cb131-2" title="2"><span class="kw">hist</span>(<span class="kw">unique</span>(slimmer_PM_dat<span class="op">$</span>Y_Msquare))</a></code></pre></div>
<p><img src="_main_files/figure-html/imputing_MSE_dataSpread-1.png" width="672" /></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="kw">hist</span>(<span class="kw">log</span>(<span class="kw">unique</span>(slimmer_PM_dat<span class="op">$</span>Y_Msquare))) <span class="co"># log mean square has a more normal distribution</span></a></code></pre></div>
<p><img src="_main_files/figure-html/imputing_MSE_dataSpread-2.png" width="672" /></p>
<p>Imputing using a log transformation of the data is required. Which trials need variance imputation?</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1">TrialMSQ &lt;-<span class="st"> </span>slimmer_PM_dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb133-2" title="2"><span class="st">   </span><span class="kw">group_by</span>(trial_ref)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb133-3" title="3"><span class="st">   </span><span class="kw">summarise</span>(<span class="kw">unique</span>(Y_Msquare))</a>
<a class="sourceLine" id="cb133-4" title="4"></a>
<a class="sourceLine" id="cb133-5" title="5">TrialMSQ[<span class="kw">is.na</span>(TrialMSQ<span class="op">$</span><span class="st">`</span><span class="dt">unique(Y_Msquare)</span><span class="st">`</span>), <span class="st">&quot;trial_ref&quot;</span>]</a></code></pre></div>
<pre><code>## # A tibble: 3 x 1
##   trial_ref  
##   &lt;fct&gt;      
## 1 mung1112/01
## 2 mung1112/02
## 3 mung1516/03</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="cf">for</span>(i <span class="cf">in</span> TrialMSQ[<span class="kw">is.na</span>(TrialMSQ<span class="op">$</span><span class="st">`</span><span class="dt">unique(Y_Msquare)</span><span class="st">`</span>),]<span class="op">$</span>trial_ref){</a>
<a class="sourceLine" id="cb135-2" title="2">   slimmer_PM_dat[slimmer_PM_dat<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> </span>i,<span class="st">&quot;Y_Msquare&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb135-3" title="3"><span class="st">      </span><span class="kw">exp</span>(</a>
<a class="sourceLine" id="cb135-4" title="4">         <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb135-5" title="5">               <span class="dt">mean =</span> <span class="kw">mean</span>(<span class="kw">log</span>(TrialMSQ<span class="op">$</span><span class="st">`</span><span class="dt">unique(Y_Msquare)</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb135-6" title="6">               <span class="kw">sd</span>(<span class="kw">log</span>(TrialMSQ<span class="op">$</span><span class="st">`</span><span class="dt">unique(Y_Msquare)</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb135-7" title="7">         )</a>
<a class="sourceLine" id="cb135-8" title="8">      )</a>
<a class="sourceLine" id="cb135-9" title="9">   }</a></code></pre></div>
<p>Before analysis lets have a look at the trimmed down modified data.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1">slimmer_PM_dat<span class="op">$</span>spray_management &lt;-<span class="st"> </span><span class="kw">factor</span>(slimmer_PM_dat<span class="op">$</span>spray_management, <span class="kw">levels</span>(slimmer_PM_dat<span class="op">$</span>spray_management)[<span class="kw">rev</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">3</span>))])</a>
<a class="sourceLine" id="cb136-2" title="2"></a>
<a class="sourceLine" id="cb136-3" title="3">slimmer_PM_dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb136-4" title="4"><span class="st">   </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> grain_yield.t.ha, <span class="dt">x =</span> spray_management))<span class="op">+</span></a>
<a class="sourceLine" id="cb136-5" title="5"><span class="st">   </span><span class="kw">geom_boxplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb136-6" title="6"><span class="st">   </span><span class="co">#geom_point(position = &quot;jitter&quot;, alpha = 1/5)+</span></a>
<a class="sourceLine" id="cb136-7" title="7"><span class="st">   </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.1</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb136-8" title="8"><span class="st">   </span><span class="kw">theme_usq</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb136-9" title="9"><span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Spray management variable&quot;</span>, </a>
<a class="sourceLine" id="cb136-10" title="10">        <span class="dt">y =</span> <span class="st">&quot;Grain yield (t/Ha)&quot;</span>,</a>
<a class="sourceLine" id="cb136-11" title="11">        <span class="dt">title =</span> <span class="st">&quot;Mean grain yield from each treatment </span><span class="ch">\n</span><span class="st"> categorised by spray management scenario&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb136-12" title="12"><span class="st">   </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb136-13" title="13"><span class="st">   </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb136-14" title="14"><span class="st">   </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/treatment_means_plot-1.png" width="672" /></p>
<p>There seems like no difference between the treatments, with exception to Late_plus. Lets do this plot again, but use the proportion of yield increase compared to the no spray control as the response variable.</p>
<p>It is also important to visualise how well the data is compared across the trial years and trials.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1">kableExtra<span class="op">::</span><span class="kw">kable</span>(<span class="kw">table</span>(slimmer_PM_dat<span class="op">$</span>spray_management, slimmer_PM_dat<span class="op">$</span>year), <span class="dt">align=</span><span class="kw">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">8</span>))<span class="op">%&gt;%</span><span class="st">  </span><span class="co">#commented as was redering empty, needs a look in</span></a>
<a class="sourceLine" id="cb137-2" title="2"><span class="st">   </span><span class="kw">kable_styling</span>(<span class="st">&quot;striped&quot;</span>, <span class="dt">fixed_thead =</span> <span class="ot">TRUE</span>, <span class="dt">full_width =</span> <span class="ot">FALSE</span>, <span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
2011
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
2012
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
2013
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
2015
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
2016
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
2017
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
2018
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
2019
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Late_plus
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Recommended_plus
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
24
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Recommended
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Early
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
control
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
2
</td>
</tr>
</tbody>
</table>
<p>Treatments Late_plus and early don’t have very good comparison to other treatments.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1">slimmer_PM_dat<span class="op">$</span>spray_management &lt;-</a>
<a class="sourceLine" id="cb138-2" title="2"><span class="st">   </span><span class="kw">factor</span>(slimmer_PM_dat<span class="op">$</span>spray_management,<span class="kw">rev</span>(<span class="kw">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;Early&quot;</span>, <span class="st">&quot;Recommended&quot;</span>, <span class="st">&quot;Recommended_plus&quot;</span>,<span class="st">&quot;Late_plus&quot;</span>)))</a>
<a class="sourceLine" id="cb138-3" title="3"></a>
<a class="sourceLine" id="cb138-4" title="4">slimmer_PM_dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb138-5" title="5"><span class="st">   </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> prop_yield_gain, <span class="dt">x =</span> spray_management))<span class="op">+</span></a>
<a class="sourceLine" id="cb138-6" title="6"><span class="st">   </span><span class="kw">geom_boxplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb138-7" title="7"><span class="st">   </span><span class="co">#geom_point(position = &quot;jitter&quot;, alpha = 1/5)+</span></a>
<a class="sourceLine" id="cb138-8" title="8"><span class="st">   </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.1</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb138-9" title="9"><span class="st">   </span><span class="kw">theme_usq</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb138-10" title="10"><span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Spray management variable&quot;</span>, </a>
<a class="sourceLine" id="cb138-11" title="11">        <span class="dt">y =</span> <span class="st">&quot;Grain yield (t/Ha)&quot;</span>,</a>
<a class="sourceLine" id="cb138-12" title="12">        <span class="dt">title =</span> <span class="st">&quot;Mean grain yield from each treatment </span><span class="ch">\n</span><span class="st"> categorised by spray management scenario&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb138-13" title="13"><span class="st">   </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb138-14" title="14"><span class="st">   </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb138-15" title="15"><span class="st">   </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 40 rows containing non-finite values (stat_boxplot).</code></pre>
<pre><code>## Warning: Removed 40 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/plot_yieldProportion-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="meta-analysis-1" class="section level2">
<h2><span class="header-section-number">6.2</span> Meta-analysis</h2>
<div id="metafor-package" class="section level3">
<h3><span class="header-section-number">6.2.1</span> metafor package</h3>
<p>Let’s load the metafor package we are using to analyse the data, then rearrange the factors we want to examine by placing the control treatment first. This way all treatments will be compared to the no spray controls.<br />
Next we are log transforming the grain yield and calculating the variance from the trial mean squares.<br />
Finally we will assign factor classes to the main variables in the meta-analysis. Note that variable trial is a combination of:<br />
- Trial identifier<br />
- Trial year<br />
- Trial location<br />
- Host genotype<br />
- Trial row spacing</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1"><span class="kw">library</span>(metafor)</a></code></pre></div>
<pre><code>## Loading &#39;metafor&#39; package (version 2.1-0). For an overview 
## and introduction to the package please type: help(metafor).</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1">slimmer_PM_dat<span class="op">$</span>spray_management &lt;-</a>
<a class="sourceLine" id="cb143-2" title="2"><span class="st">   </span><span class="kw">factor</span>(slimmer_PM_dat<span class="op">$</span>spray_management,<span class="kw">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;Early&quot;</span>, <span class="st">&quot;Recommended&quot;</span>, <span class="st">&quot;Recommended_plus&quot;</span>,<span class="st">&quot;Late_plus&quot;</span>))</a>
<a class="sourceLine" id="cb143-3" title="3"></a>
<a class="sourceLine" id="cb143-4" title="4">slimmer_PM_dat<span class="op">$</span>yi &lt;-<span class="st"> </span><span class="kw">log</span>(slimmer_PM_dat<span class="op">$</span>grain_yield.t.ha)</a>
<a class="sourceLine" id="cb143-5" title="5">slimmer_PM_dat<span class="op">$</span>vi &lt;-<span class="st"> </span>slimmer_PM_dat<span class="op">$</span>Y_Msquare<span class="op">/</span>(slimmer_PM_dat<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>slimmer_PM_dat<span class="op">$</span>grain_yield.t.ha<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb143-6" title="6"></a>
<a class="sourceLine" id="cb143-7" title="7">slimmer_PM_dat<span class="op">$</span>spray_management &lt;-<span class="st"> </span><span class="kw">factor</span>(slimmer_PM_dat<span class="op">$</span>spray_management)</a>
<a class="sourceLine" id="cb143-8" title="8">slimmer_PM_dat<span class="op">$</span>trial_ref &lt;-<span class="st"> </span><span class="kw">factor</span>(slimmer_PM_dat<span class="op">$</span>trial_ref)</a>
<a class="sourceLine" id="cb143-9" title="9">slimmer_PM_dat<span class="op">$</span>trial &lt;-<span class="st"> </span><span class="kw">factor</span>(slimmer_PM_dat<span class="op">$</span>trial)</a></code></pre></div>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1">PM_mv_AI &lt;-<span class="st"> </span><span class="kw">rma.mv</span>(yi,vi,</a>
<a class="sourceLine" id="cb144-2" title="2">                   <span class="dt">mods =</span> <span class="op">~</span><span class="st"> </span>spray_management,</a>
<a class="sourceLine" id="cb144-3" title="3">                   <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>,</a>
<a class="sourceLine" id="cb144-4" title="4">                   <span class="dt">random =</span> <span class="kw">list</span>(<span class="op">~</span><span class="st"> </span>spray_management <span class="op">|</span><span class="st"> </span>trial),</a>
<a class="sourceLine" id="cb144-5" title="5">                   <span class="dt">struct =</span> <span class="st">&quot;UN&quot;</span>,</a>
<a class="sourceLine" id="cb144-6" title="6">                   <span class="dt">data =</span> slimmer_PM_dat)</a></code></pre></div>
<pre><code>## Warning: Some combinations of the levels of the inner factor never occurred.
## Corresponding rho value(s) fixed to 0.</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1"><span class="kw">summary</span>(PM_mv_AI)</a></code></pre></div>
<pre><code>## 
## Multivariate Meta-Analysis Model (k = 151; method: ML)
## 
##   logLik  Deviance       AIC       BIC      AICc 
##  25.9921  331.1871  -13.9843   43.3440   -8.1828   
## 
## Variance Components:
## 
## outer factor: trial            (nlvls = 25)
## inner factor: spray_management (nlvls = 5)
## 
##             estim    sqrt  k.lvl  fixed             level 
## tau^2.1    0.2381  0.4879     40     no           control 
## tau^2.2    0.2241  0.4734     13     no             Early 
## tau^2.3    0.2630  0.5128     32     no       Recommended 
## tau^2.4    0.2826  0.5316     46     no  Recommended_plus 
## tau^2.5    0.3035  0.5509     20     no         Late_plus 
## 
##                   rho.cntr  rho.Erly  rho.Rcmm  rho.Rcm_  rho.Lt_p    cntr 
## control                  1    0.9863    0.9825    0.9657    0.9752       - 
## Early               0.9863         1    0.9982    0.9952    0.0000       7 
## Recommended         0.9825    0.9982         1    0.9936    0.9939      21 
## Recommended_plus    0.9657    0.9952    0.9936         1    0.9987      19 
## Late_plus           0.9752    0.0000    0.9939    0.9987         1       7 
##                   Erly  Rcmm  Rcm_  Lt_p 
## control             no    no    no    no 
## Early                -    no    no   yes 
## Recommended          6     -    no    no 
## Recommended_plus     6    19     -    no 
## Late_plus            0     4     4     - 
## 
## Test for Residual Heterogeneity:
## QE(df = 146) = 6747.5175, p-val &lt; .0001
## 
## Test of Moderators (coefficients 2:5):
## QM(df = 4) = 11.9559, p-val = 0.0177
## 
## Model Results:
## 
##                                   estimate      se     zval    pval    ci.lb 
## intrcpt                            -0.0490  0.0992  -0.4933  0.6218  -0.2435 
## spray_managementEarly               0.0590  0.0568   1.0378  0.2994  -0.0524 
## spray_managementRecommended         0.0981  0.0289   3.3954  0.0007   0.0415 
## spray_managementRecommended_plus    0.1178  0.0373   3.1573  0.0016   0.0447 
## spray_managementLate_plus           0.0909  0.0372   2.4416  0.0146   0.0179 
##                                    ci.ub 
## intrcpt                           0.1456      
## spray_managementEarly             0.1703      
## spray_managementRecommended       0.1547  *** 
## spray_managementRecommended_plus  0.1909   ** 
## spray_managementLate_plus         0.1639    * 
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Results show that yields in single early spray treatments are not significantly different to the no spray control. Commencing spray manangement schedules at first sign of disease (Recommended), or between 7 - 19 days after first sign (late) produced significantly higher yields compared to the no spray control. On average a spray scheduale with two or more applications stating late (7-19 days after first sign of powdery mildew) produced the highest yields.</p>
<p>When we compare these results to those of the linear mixed effect model there is little difference in the outcome. The most noteable difference is the linear mixed-effect model is somewhat less certain about the <code>Late_plus</code> treatment, and the mean yield lower than the <code>recommended_plus</code> treatment.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1">lme_PM &lt;-<span class="st"> </span><span class="kw">lmer</span>(yi <span class="op">~</span><span class="st"> </span>spray_management <span class="op">+</span><span class="st"> </span>(spray_management <span class="op">|</span><span class="st"> </span>trial), <span class="dt">data =</span> slimmer_PM_dat)</a></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1"><span class="kw">summary</span>(lme_PM)</a></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: yi ~ spray_management + (spray_management | trial)
##    Data: slimmer_PM_dat
## 
## REML criterion at convergence: -52.4
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -2.78691 -0.42731  0.07418  0.50607  2.54104 
## 
## Random effects:
##  Groups   Name                             Variance  Std.Dev. Corr             
##  trial    (Intercept)                      0.2455105 0.49549                   
##           spray_managementEarly            0.0008238 0.02870  -1.00            
##           spray_managementRecommended      0.0003764 0.01940   0.35 -0.35      
##           spray_managementRecommended_plus 0.0062560 0.07909   0.89 -0.89  0.73
##           spray_managementLate_plus        0.0046530 0.06821   0.96 -0.96  0.59
##  Residual                                  0.0176841 0.13298                   
##       
##       
##       
##       
##       
##   0.98
##       
## Number of obs: 151, groups:  trial, 25
## 
## Fixed effects:
##                                  Estimate Std. Error t value
## (Intercept)                      -0.07775    0.10147  -0.766
## spray_managementEarly             0.04476    0.04489   0.997
## spray_managementRecommended       0.10931    0.03303   3.309
## spray_managementRecommended_plus  0.14382    0.03472   4.143
## spray_managementLate_plus         0.13891    0.05000   2.778
## 
## Correlation of Fixed Effects:
##             (Intr) spry_E spry_R spr_R_
## spry_mngmnE -0.212                     
## spry_mngmnR -0.098  0.289              
## spry_mngmR_  0.272  0.258  0.493       
## spry_mngmL_  0.168  0.049  0.191  0.260
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<p>To make it easier to compare each of the treatments we can compute the meta-analysis contrasts.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1"><span class="kw">anova</span>(PM_mv_AI, <span class="dt">L=</span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),  <span class="co"># early vs Recomended</span></a>
<a class="sourceLine" id="cb152-2" title="2">                        <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>),  <span class="co"># early vs recommended plus</span></a>
<a class="sourceLine" id="cb152-3" title="3">                        <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>),  <span class="co"># early vs Late plus</span></a>
<a class="sourceLine" id="cb152-4" title="4">                        <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),  <span class="co"># Recommended vs recommended_plus</span></a>
<a class="sourceLine" id="cb152-5" title="5">                        <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),  <span class="co"># Recommended vs Late_Plus</span></a>
<a class="sourceLine" id="cb152-6" title="6">                        <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))) <span class="co"># recommended_plus vs Late_plus</span></a></code></pre></div>
<pre><code>## 
## Hypotheses:                                                                       
## 1:             spray_managementEarly - spray_managementRecommended = 0 
## 2:        spray_managementEarly - spray_managementRecommended_plus = 0 
## 3:               spray_managementEarly - spray_managementLate_plus = 0 
## 4: -spray_managementRecommended + spray_managementRecommended_plus = 0 
## 5:        -spray_managementRecommended + spray_managementLate_plus = 0 
## 6:   -spray_managementRecommended_plus + spray_managementLate_plus = 0 
## 
## Results:
##    estimate     se    zval   pval 
## 1:  -0.0391 0.0563 -0.6947 0.4872 
## 2:  -0.0588 0.0582 -1.0106 0.3122 
## 3:  -0.0319 0.0607 -0.5262 0.5987 
## 4:   0.0197 0.0212  0.9286 0.3531 
## 5:  -0.0072 0.0292 -0.2468 0.8050 
## 6:  -0.0269 0.0205 -1.3117 0.1896</code></pre>
<p>Results show with the exclusion of the no spray control, none of the treatments are significantly different, however, early applications treatments on average produced lower yields. Lets view this on a plot.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1">results_AI &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cbind</span>(<span class="kw">exp</span>(PM_mv_AI<span class="op">$</span>b), </a>
<a class="sourceLine" id="cb154-2" title="2">                              <span class="kw">exp</span>((PM_mv_AI<span class="op">$</span>ci.lb)),</a>
<a class="sourceLine" id="cb154-3" title="3">                              <span class="kw">exp</span>(PM_mv_AI<span class="op">$</span>ci.ub)))</a>
<a class="sourceLine" id="cb154-4" title="4"></a>
<a class="sourceLine" id="cb154-5" title="5"><span class="co"># results_AI &lt;- data.frame(cbind(PM_mv_AI$b, </span></a>
<a class="sourceLine" id="cb154-6" title="6"><span class="co">#                               (PM_mv_AI$ci.lb),</span></a>
<a class="sourceLine" id="cb154-7" title="7"><span class="co">#                               PM_mv_AI$ci.ub))</span></a>
<a class="sourceLine" id="cb154-8" title="8"></a>
<a class="sourceLine" id="cb154-9" title="9">treat &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;Early&quot;</span>, <span class="st">&quot;Recommended&quot;</span>, <span class="st">&quot;Recommended_plus&quot;</span>,<span class="st">&quot;Late_plus&quot;</span>)</a>
<a class="sourceLine" id="cb154-10" title="10">efficacy &lt;-<span class="st"> </span><span class="kw">tbl_df</span>(results_AI)</a>
<a class="sourceLine" id="cb154-11" title="11">efficacy<span class="op">$</span>treat &lt;-<span class="st"> </span>treat</a>
<a class="sourceLine" id="cb154-12" title="12">efficacy<span class="op">$</span>se &lt;-<span class="st"> </span>PM_mv_AI<span class="op">$</span>se</a>
<a class="sourceLine" id="cb154-13" title="13"><span class="kw">colnames</span>(efficacy) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;CIs_lower&quot;</span>, <span class="st">&quot;CI_upper&quot;</span>, <span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;SE&quot;</span>)</a>
<a class="sourceLine" id="cb154-14" title="14">efficacy</a></code></pre></div>
<pre><code>## # A tibble: 5 x 5
##    Mean CIs_lower CI_upper Treatment            SE
##   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;
## 1 0.952     0.784     1.16 control          0.0992
## 2 1.06      0.949     1.19 Early            0.0568
## 3 1.10      1.04      1.17 Recommended      0.0289
## 4 1.12      1.05      1.21 Recommended_plus 0.0373
## 5 1.10      1.02      1.18 Late_plus        0.0372</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1">efficacy<span class="op">$</span>Treatment &lt;-</a>
<a class="sourceLine" id="cb156-2" title="2"><span class="st">   </span><span class="kw">factor</span>(efficacy<span class="op">$</span>Treatment,<span class="kw">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;Early&quot;</span>, <span class="st">&quot;Recommended&quot;</span>, <span class="st">&quot;Recommended_plus&quot;</span>,<span class="st">&quot;Late_plus&quot;</span>))</a>
<a class="sourceLine" id="cb156-3" title="3"></a>
<a class="sourceLine" id="cb156-4" title="4">efficacy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb156-5" title="5"><span class="st">   </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Treatment, Mean))<span class="op">+</span></a>
<a class="sourceLine" id="cb156-6" title="6"><span class="st">   </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">c</span>(<span class="fl">0.8</span>,<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">1.4</span>), <span class="dt">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb156-7" title="7"><span class="st">   </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size=</span><span class="dv">1</span><span class="op">/</span>SE), <span class="dt">shape=</span><span class="dv">15</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb156-8" title="8"><span class="st">   </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> CIs_lower, <span class="dt">ymax =</span> CI_upper))<span class="op">+</span></a>
<a class="sourceLine" id="cb156-9" title="9"><span class="st">   </span><span class="kw">coord_flip</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb156-10" title="10"><span class="st">   </span><span class="kw">theme_usq</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/metafor_plot-1.png" width="672" /></p>
<p>What is interesting here is that the variance in the control has increased while the treatments have decreased. This is despite the control being the best represented across all experiments. However it could also be because it also has a low number of pooled reps per trial. Lets look at how well each of the treatments compare to each other. We can use the netmeta package to give a graphical representation of this.</p>
</div>
<div id="netmeta-package" class="section level3">
<h3><span class="header-section-number">6.2.2</span> netmeta package</h3>
<p>Lets analyse the data again using a different statistical approach to see if our outcome with the <code>metafor</code> package was robust. The <code>netmeta</code> package uses a frequentist approach to the analysis, and focuses on the pairwise comparisons between treatments.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1"><span class="kw">library</span>(netmeta)</a></code></pre></div>
<pre><code>## Loading required package: meta</code></pre>
<pre><code>## Loading &#39;meta&#39; package (version 4.9-9).
## Type &#39;help(meta)&#39; for a brief overview.</code></pre>
<pre><code>## 
## Attaching package: &#39;meta&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:metafor&#39;:
## 
##     baujat, forest, funnel, funnel.default, labbe, radial, trimfill</code></pre>
<pre><code>## Loading &#39;netmeta&#39; package (version 1.2-0).
## Type &#39;help(&quot;netmeta-package&quot;)&#39; for a brief overview.</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1">datPM3 &lt;-<span class="st"> </span>slimmer_PM_dat <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb163-2" title="2"><span class="st">   </span><span class="kw">group_by</span>(trial, spray_management, n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb163-3" title="3"><span class="st">      </span><span class="kw">summarize</span>(<span class="dt">yi_mean =</span> <span class="kw">mean</span>(yi), </a>
<a class="sourceLine" id="cb163-4" title="4">             <span class="dt">vi_mean =</span> <span class="kw">mean</span>(vi)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb163-5" title="5"><span class="st">   </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb163-6" title="6"></a>
<a class="sourceLine" id="cb163-7" title="7">PM_con &lt;-<span class="st"> </span><span class="kw">pairwise</span>(<span class="dt">treat =</span> spray_management,</a>
<a class="sourceLine" id="cb163-8" title="8">                  <span class="dt">n =</span> n,</a>
<a class="sourceLine" id="cb163-9" title="9">                  <span class="dt">mean =</span> yi_mean,</a>
<a class="sourceLine" id="cb163-10" title="10">                  <span class="dt">sd =</span> <span class="kw">sqrt</span>(vi_mean),</a>
<a class="sourceLine" id="cb163-11" title="11">                  <span class="dt">studlab=</span> trial,</a>
<a class="sourceLine" id="cb163-12" title="12">                  <span class="dt">data =</span> datPM3, </a>
<a class="sourceLine" id="cb163-13" title="13">                  <span class="dt">sm=</span><span class="st">&quot;MD&quot;</span>)</a>
<a class="sourceLine" id="cb163-14" title="14"></a>
<a class="sourceLine" id="cb163-15" title="15">net_con &lt;-<span class="st"> </span><span class="kw">netmeta</span>(TE, </a>
<a class="sourceLine" id="cb163-16" title="16">                seTE, </a>
<a class="sourceLine" id="cb163-17" title="17">                treat1, </a>
<a class="sourceLine" id="cb163-18" title="18">                treat2, </a>
<a class="sourceLine" id="cb163-19" title="19">                studlab, </a>
<a class="sourceLine" id="cb163-20" title="20">                <span class="dt">data=</span>PM_con, </a>
<a class="sourceLine" id="cb163-21" title="21">                <span class="dt">sm=</span><span class="st">&quot;MD&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Note, treatments within a comparison have been re-sorted in increasing
## order.</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1"><span class="kw">summary</span>(net_con)</a></code></pre></div>
<pre><code>## Number of studies: k = 25
## Number of treatments: n = 5
## Number of pairwise comparisons: m = 93
## Number of designs: d = 6
## 
## Fixed effects model
## 
## Treatment estimate (sm = &#39;MD&#39;):
##                  control   Early Late_plus Recommended Recommended_plus
## control                . -0.0990   -0.0023     -0.0731          -0.0685
## Early             0.0990       .    0.0967      0.0259           0.0306
## Late_plus         0.0023 -0.0967         .     -0.0708          -0.0662
## Recommended       0.0731 -0.0259    0.0708           .           0.0046
## Recommended_plus  0.0685 -0.0306    0.0662     -0.0046                .
## 
## Lower 95%-confidence limit:
##                  control   Early Late_plus Recommended Recommended_plus
## control                . -0.1701   -0.0209     -0.0869          -0.0825
## Early             0.0279       .    0.0237     -0.0458          -0.0413
## Late_plus        -0.0163 -0.1698         .     -0.0890          -0.0845
## Recommended       0.0593 -0.0977    0.0526           .          -0.0088
## Recommended_plus  0.0545 -0.1024    0.0478     -0.0181                .
## 
## Upper 95%-confidence limit:
##                  control   Early Late_plus Recommended Recommended_plus
## control                . -0.0279    0.0163     -0.0593          -0.0545
## Early             0.1701       .    0.1698      0.0977           0.1024
## Late_plus         0.0209 -0.0237         .     -0.0526          -0.0478
## Recommended       0.0869  0.0458    0.0890           .           0.0181
## Recommended_plus  0.0825  0.0413    0.0845      0.0088                .
## 
## Random effects model
## 
## Treatment estimate (sm = &#39;MD&#39;):
##                  control   Early Late_plus Recommended Recommended_plus
## control                . -0.0712   -0.1128     -0.0865          -0.1065
## Early             0.0712       .   -0.0416     -0.0154          -0.0353
## Late_plus         0.1128  0.0416         .      0.0262           0.0063
## Recommended       0.0865  0.0154   -0.0262           .          -0.0200
## Recommended_plus  0.1065  0.0353   -0.0063      0.0200                .
## 
## Lower 95%-confidence limit:
##                  control   Early Late_plus Recommended Recommended_plus
## control                . -0.1988   -0.2147     -0.1496          -0.1718
## Early            -0.0565       .   -0.1991     -0.1457          -0.1663
## Late_plus         0.0109 -0.1159         .     -0.0789          -0.0994
## Recommended       0.0235 -0.1149   -0.1314           .          -0.0856
## Recommended_plus  0.0411 -0.0957   -0.1120     -0.0457                .
## 
## Upper 95%-confidence limit:
##                  control  Early Late_plus Recommended Recommended_plus
## control                . 0.0565   -0.0109     -0.0235          -0.0411
## Early             0.1988      .    0.1159      0.1149           0.0957
## Late_plus         0.2147 0.1991         .      0.1314           0.1120
## Recommended       0.1496 0.1457    0.0789           .           0.0457
## Recommended_plus  0.1718 0.1663    0.0994      0.0856                .
## 
## Quantifying heterogeneity / inconsistency:
## tau^2 = 0.0159; tau = 0.1259; I^2 = 91.9% [90.1%; 93.3%]
## 
## Tests of heterogeneity (within designs) and inconsistency (between designs):
##                      Q d.f.  p-value
## Total           617.16   50 &lt; 0.0001
## Within designs  556.26   43 &lt; 0.0001
## Between designs  60.89    7 &lt; 0.0001</code></pre>
<p>Now lets visualise this as a forest plot</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1"><span class="kw">forest</span>(net_con, <span class="dt">reference.group =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb167-2" title="2">       <span class="dt">rightcols=</span><span class="kw">c</span>(<span class="st">&quot;effect&quot;</span>, <span class="st">&quot;ci&quot;</span>, <span class="st">&quot;Pscore&quot;</span>),</a>
<a class="sourceLine" id="cb167-3" title="3">       <span class="dt">rightlabs=</span><span class="st">&quot;P-Score&quot;</span>, <span class="dt">small.values =</span> <span class="st">&quot;bad&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/netmeta-forest-1.png" width="672" /></p>
<p>The <code>netmeta</code> analysis suggests the spray scheduale commencing early are no different to any other treatment including the no spray control. It estimates the mean is very similar to the recommended treatments. The recommended plus and late_plus treatments show higher mean estimates, however not significantly different from the early estimate.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1"><span class="kw">netgraph</span>(net_con, </a>
<a class="sourceLine" id="cb168-2" title="2">         <span class="dt">plastic =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb168-3" title="3">         <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>,</a>
<a class="sourceLine" id="cb168-4" title="4">         <span class="dt">thickness =</span>  <span class="st">&quot;number.of.studies&quot;</span>,</a>
<a class="sourceLine" id="cb168-5" title="5">         <span class="dt">points =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb168-6" title="6">         <span class="dt">col.points =</span> <span class="st">&quot;black&quot;</span>, </a>
<a class="sourceLine" id="cb168-7" title="7">         <span class="dt">cex.points =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb168-8" title="8">         <span class="dt">number.of.studies =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb168-9" title="9">         <span class="dt">cex.number.of.studies =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb168-10" title="10">         <span class="dt">col.number.of.studies =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb168-11" title="11">         <span class="dt">bg.number.of.studies =</span> <span class="st">&quot;orange&quot;</span>,</a>
<a class="sourceLine" id="cb168-12" title="12">         <span class="dt">multiarm =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb168-13" title="13">         <span class="dt">col.multiarm =</span> <span class="st">&quot;lightblue&quot;</span>,</a>
<a class="sourceLine" id="cb168-14" title="14">         <span class="dt">pos.number.of.studies =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/netgraphGW-1.png" width="672" /></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" title="1"><span class="kw">netleague</span>(net_con)</a></code></pre></div>
<pre><code>## League table (fixed effect model):
##                                                       
##                     control -0.1195 [-0.1977; -0.0412]
##  -0.0990 [-0.1701; -0.0279]                      Early
##  -0.0023 [-0.0209;  0.0163]  0.0967 [ 0.0237;  0.1698]
##  -0.0731 [-0.0869; -0.0593]  0.0259 [-0.0458;  0.0977]
##  -0.0685 [-0.0825; -0.0545]  0.0306 [-0.0413;  0.1024]
##                                                       
##  -0.0005 [-0.0210;  0.0199] -0.0778 [-0.0917; -0.0639]
##                           . -0.0587 [-0.1842;  0.0669]
##                   Late_plus -0.0955 [-0.1152; -0.0758]
##  -0.0708 [-0.0890; -0.0526]                Recommended
##  -0.0662 [-0.0845; -0.0478]  0.0046 [-0.0088;  0.0181]
##                            
##  -0.0681 [-0.0822; -0.0539]
##  -0.0116 [-0.1421;  0.1190]
##  -0.0417 [-0.0619; -0.0215]
##   0.0060 [-0.0075;  0.0195]
##            Recommended_plus
## 
## League table (random effects model):
##                                                       
##                     control -0.0917 [-0.2386;  0.0553]
##  -0.0712 [-0.1988;  0.0565]                      Early
##  -0.1128 [-0.2147; -0.0109] -0.0416 [-0.1991;  0.1159]
##  -0.0865 [-0.1496; -0.0235] -0.0154 [-0.1457;  0.1149]
##  -0.1065 [-0.1718; -0.0411] -0.0353 [-0.1663;  0.0957]
##                                                       
##  -0.1204 [-0.2353; -0.0055] -0.0822 [-0.1461; -0.0182]
##                           . -0.0678 [-0.2362;  0.1006]
##                   Late_plus  0.0137 [-0.1173;  0.1446]
##   0.0262 [-0.0789;  0.1314]                Recommended
##   0.0063 [-0.0994;  0.1120] -0.0200 [-0.0856;  0.0457]
##                            
##  -0.1014 [-0.1686; -0.0343]
##  -0.0366 [-0.2072;  0.1340]
##  -0.0120 [-0.1425;  0.1185]
##  -0.0193 [-0.0857;  0.0471]
##            Recommended_plus</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1"><span class="kw">decomp.design</span>(net_con)</a></code></pre></div>
<pre><code>## Q statistics to assess homogeneity / consistency
## 
##                      Q df  p-value
## Total           617.16 50 &lt; 0.0001
## Within designs  556.26 43 &lt; 0.0001
## Between designs  60.89  7 &lt; 0.0001
## 
## Design-specific decomposition of within-designs Q statistic
## 
##                                          Design      Q df  p-value
##                               control:Late_plus   0.82  2   0.6643
##                             control:Recommended   0.15  1   0.7012
##      control:Early:Recommended:Recommended_plus  10.99 15   0.7536
##  control:Late_plus:Recommended:Recommended_plus  83.01  9 &lt; 0.0001
##            control:Recommended:Recommended_plus 461.30 16 &lt; 0.0001
## 
## Between-designs Q statistic after detaching of single designs
## 
##                                 Detached design     Q df  p-value
##                                   control:Early 58.86  6 &lt; 0.0001
##                               control:Late_plus 57.12  6 &lt; 0.0001
##                             control:Recommended 60.87  6 &lt; 0.0001
##      control:Early:Recommended:Recommended_plus 58.20  4 &lt; 0.0001
##  control:Late_plus:Recommended:Recommended_plus  4.65  4   0.3257
##            control:Recommended:Recommended_plus  6.25  5   0.2828
## 
## Q statistic to assess consistency under the assumption of
## a full design-by-treatment interaction random effects model
## 
##                    Q df p-value tau.within tau2.within
## Between designs 1.22  7  0.9904     0.1400      0.0196</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1"><span class="kw">netsplit</span>(net_con)</a></code></pre></div>
<pre><code>## Back-calculation method to split direct and indirect evidence
## 
## Fixed effect model: 
## 
##                    comparison  k prop     nma  direct  indir.    Diff     z  p-value
##                 control:Early  7 0.83 -0.0990 -0.1195 -0.0021 -0.1174 -1.23   0.2200
##             control:Late_plus  7 0.82 -0.0023 -0.0005 -0.0106  0.0100  0.40   0.6863
##           control:Recommended 21 0.99 -0.0731 -0.0778  0.3437 -0.4215 -6.28 &lt; 0.0001
##      control:Recommended_plus 19 0.98 -0.0685 -0.0681 -0.0915  0.0234  0.43   0.6642
##               Early:Late_plus  0    0  0.0967       .  0.0967       .     .        .
##             Early:Recommended  6 0.33  0.0259 -0.0587  0.0670 -0.1256 -1.61   0.1075
##        Early:Recommended_plus  6 0.30  0.0306 -0.0116  0.0488 -0.0604 -0.76   0.4489
##         Late_plus:Recommended  4 0.85 -0.0708 -0.0955  0.0665 -0.1620 -6.29 &lt; 0.0001
##    Late_plus:Recommended_plus  4 0.83 -0.0662 -0.0417 -0.1855  0.1438  5.77 &lt; 0.0001
##  Recommended:Recommended_plus 19 0.99  0.0046  0.0060 -0.2470  0.2530  2.74   0.0062
## 
## Random effects model: 
## 
##                    comparison  k prop     nma  direct  indir.    Diff     z p-value
##                 control:Early  7 0.75 -0.0712 -0.0917 -0.0082 -0.0834 -0.55  0.5811
##             control:Late_plus  7 0.79 -0.1128 -0.1204 -0.0847 -0.0357 -0.28  0.7783
##           control:Recommended 21 0.97 -0.0865 -0.0822 -0.2338  0.1516  0.79  0.4310
##      control:Recommended_plus 19 0.95 -0.1065 -0.1014 -0.1956  0.0942  0.64  0.5250
##               Early:Late_plus  0    0 -0.0416       . -0.0416       .     .       .
##             Early:Recommended  6 0.60 -0.0154 -0.0678  0.0628 -0.1307 -0.96  0.3352
##        Early:Recommended_plus  6 0.59 -0.0353 -0.0366 -0.0335 -0.0031 -0.02  0.9816
##         Late_plus:Recommended  4 0.64  0.0262  0.0137  0.0490 -0.0353 -0.32  0.7524
##    Late_plus:Recommended_plus  4 0.66  0.0063 -0.0120  0.0411 -0.0531 -0.47  0.6398
##  Recommended:Recommended_plus 19 0.98 -0.0200 -0.0193 -0.0469  0.0276  0.13  0.8999
## 
## Legend:
##  comparison - Treatment comparison
##  k          - Number of studies providing direct evidence
##  prop       - Direct evidence proportion
##  nma        - Estimated treatment effect (MD) in network meta-analysis
##  direct     - Estimated treatment effect (MD) derived from direct evidence
##  indir.     - Estimated treatment effect (MD) derived from indirect evidence
##  Diff       - Difference between direct and indirect treatment estimates
##  z          - z-value of test for disagreement (direct versus indirect)
##  p-value    - p-value of test for disagreement (direct versus indirect)</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1">nm1 &lt;-<span class="st"> </span><span class="kw">netmeasures</span>(net_con)</a>
<a class="sourceLine" id="cb175-2" title="2"></a>
<a class="sourceLine" id="cb175-3" title="3"><span class="kw">plot</span>(nm1<span class="op">$</span>meanpath, nm1<span class="op">$</span>minpar, <span class="dt">pch=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb175-4" title="4">     <span class="dt">xlab=</span><span class="st">&quot;Mean path length&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Minimal parallelism&quot;</span>)</a>
<a class="sourceLine" id="cb175-5" title="5"><span class="kw">text</span>(nm1<span class="op">$</span>meanpath, nm1<span class="op">$</span>minpar, <span class="kw">names</span>(nm1<span class="op">$</span>meanpath), <span class="dt">cex=</span><span class="fl">0.8</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1"><span class="kw">write.csv</span>(slimmer_PM_dat, <span class="dt">file =</span> <span class="st">&quot;data/GYmeta_data.csv&quot;</span>)</a></code></pre></div>

<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1"><span class="co"># install.packages(&quot;tidyverse&quot;)</span></a>
<a class="sourceLine" id="cb177-2" title="2"><span class="co"># install.packages(&quot;devtools&quot;)</span></a>
<a class="sourceLine" id="cb177-3" title="3"><span class="co"># devtools::install_github(&quot;https://github.com/PaulMelloy/bomrang&quot;)</span></a>
<a class="sourceLine" id="cb177-4" title="4"><span class="co"># devtools::install_github(&quot;https://github.com/adamhsparks/theme.usq&quot;, dependencies = TRUE)</span></a>
<a class="sourceLine" id="cb177-5" title="5"><span class="co"># install.packages(&quot;lme4&quot;)</span></a>
<a class="sourceLine" id="cb177-6" title="6"></a>
<a class="sourceLine" id="cb177-7" title="7"></a>
<a class="sourceLine" id="cb177-8" title="8"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb177-9" title="9"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb177-10" title="10"><span class="kw">library</span>(theme.usq)</a>
<a class="sourceLine" id="cb177-11" title="11"><span class="kw">library</span>(bomrang)</a>
<a class="sourceLine" id="cb177-12" title="12"><span class="kw">library</span>(lme4)</a>
<a class="sourceLine" id="cb177-13" title="13"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb177-14" title="14"></a>
<a class="sourceLine" id="cb177-15" title="15"><span class="co"># Data</span></a>
<a class="sourceLine" id="cb177-16" title="16">PM_Mdat &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/GYmeta_data.csv&quot;</span>)</a></code></pre></div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="prepare-data-for-meta-anlysys.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aupdc-meta-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
