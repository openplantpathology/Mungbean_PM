<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Import and Format Data | A meta-analysis of powdery mildew yield loss mitigation strategies in Australian mungbean</title>
  <meta name="description" content="A meta-analysis of fungicide use in mungbean to control for yield loss due to powdery mildew." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Import and Format Data | A meta-analysis of powdery mildew yield loss mitigation strategies in Australian mungbean" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A meta-analysis of fungicide use in mungbean to control for yield loss due to powdery mildew." />
  <meta name="github-repo" content="OpenPlantPathology/Mungbean_PM" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Import and Format Data | A meta-analysis of powdery mildew yield loss mitigation strategies in Australian mungbean" />
  
  <meta name="twitter:description" content="A meta-analysis of fungicide use in mungbean to control for yield loss due to powdery mildew." />
  

<meta name="author" content="Paul Melloy, Emerson Del Ponte and Adam H. Sparks" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="studies-considered-in-meta-analysis.html"/>
<link rel="next" href="preliminary-analysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Home</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#contents"><i class="fa fa-check"></i><b>1.1</b> Contents</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#other-research-questions-which-are-not-the-focus-of-this-study"><i class="fa fa-check"></i><b>1.2</b> Other research questions, which are not the focus of this study</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#possible-sources-of-variation-in-this-analysis."><i class="fa fa-check"></i><b>1.3</b> Possible sources of variation in this analysis.</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html"><i class="fa fa-check"></i><b>2</b> Studies considered in meta-analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html#summary-of-trials"><i class="fa fa-check"></i><b>2.1</b> Summary of trials</a></li>
<li class="chapter" data-level="2.2" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html#powdery-mildew-rating-scales"><i class="fa fa-check"></i><b>2.2</b> Powdery mildew rating scales</a><ul>
<li class="chapter" data-level="2.2.1" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html#powdery-mildew-rating-scale"><i class="fa fa-check"></i><b>2.2.1</b> 1 - 5 powdery mildew rating scale</a></li>
<li class="chapter" data-level="2.2.2" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html#powdery-mildew-rating-scale-1"><i class="fa fa-check"></i><b>2.2.2</b> 1 - 9 powdery mildew rating scale</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="studies-considered-in-meta-analysis.html"><a href="studies-considered-in-meta-analysis.html#experiment-locations"><i class="fa fa-check"></i><b>2.3</b> Experiment locations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="import-and-format-data.html"><a href="import-and-format-data.html"><i class="fa fa-check"></i><b>3</b> Import and Format Data</a><ul>
<li class="chapter" data-level="3.1" data-path="import-and-format-data.html"><a href="import-and-format-data.html#non-wrangled-trials"><i class="fa fa-check"></i><b>3.1</b> Non-wrangled trials</a></li>
<li class="chapter" data-level="3.2" data-path="import-and-format-data.html"><a href="import-and-format-data.html#import-libraries"><i class="fa fa-check"></i><b>3.2</b> Import Libraries</a></li>
<li class="chapter" data-level="3.3" data-path="import-and-format-data.html"><a href="import-and-format-data.html#functions"><i class="fa fa-check"></i><b>3.3</b> Functions</a></li>
<li class="chapter" data-level="3.4" data-path="import-and-format-data.html"><a href="import-and-format-data.html#data-wrangling-for-each-trial"><i class="fa fa-check"></i><b>3.4</b> Data wrangling for each trial</a><ul>
<li class="chapter" data-level="3.4.1" data-path="import-and-format-data.html"><a href="import-and-format-data.html#hermitage-2010"><i class="fa fa-check"></i><b>3.4.1</b> Hermitage 2010</a></li>
<li class="chapter" data-level="3.4.2" data-path="import-and-format-data.html"><a href="import-and-format-data.html#hermitage-2011"><i class="fa fa-check"></i><b>3.4.2</b> Hermitage 2011</a></li>
<li class="chapter" data-level="3.4.3" data-path="import-and-format-data.html"><a href="import-and-format-data.html#kingaroy-2011"><i class="fa fa-check"></i><b>3.4.3</b> Kingaroy 2011</a></li>
<li class="chapter" data-level="3.4.4" data-path="import-and-format-data.html"><a href="import-and-format-data.html#goolhi-2013"><i class="fa fa-check"></i><b>3.4.4</b> Goolhi 2013</a></li>
<li class="chapter" data-level="3.4.5" data-path="import-and-format-data.html"><a href="import-and-format-data.html#marys-mount-2013"><i class="fa fa-check"></i><b>3.4.5</b> Mary’s Mount 2013</a></li>
<li class="chapter" data-level="3.4.6" data-path="import-and-format-data.html"><a href="import-and-format-data.html#premer-2013"><i class="fa fa-check"></i><b>3.4.6</b> Premer 2013</a></li>
<li class="chapter" data-level="3.4.7" data-path="import-and-format-data.html"><a href="import-and-format-data.html#millmerran-2013"><i class="fa fa-check"></i><b>3.4.7</b> Millmerran 2013</a></li>
<li class="chapter" data-level="3.4.8" data-path="import-and-format-data.html"><a href="import-and-format-data.html#hermitage-2015"><i class="fa fa-check"></i><b>3.4.8</b> Hermitage 2015</a></li>
<li class="chapter" data-level="3.4.9" data-path="import-and-format-data.html"><a href="import-and-format-data.html#hermitage-2016"><i class="fa fa-check"></i><b>3.4.9</b> Hermitage 2016</a></li>
<li class="chapter" data-level="3.4.10" data-path="import-and-format-data.html"><a href="import-and-format-data.html#kingaroy-2016"><i class="fa fa-check"></i><b>3.4.10</b> Kingaroy 2016</a></li>
<li class="chapter" data-level="3.4.11" data-path="import-and-format-data.html"><a href="import-and-format-data.html#missen-flats-2017"><i class="fa fa-check"></i><b>3.4.11</b> Missen Flats 2017</a></li>
<li class="chapter" data-level="3.4.12" data-path="import-and-format-data.html"><a href="import-and-format-data.html#hermitage-2017"><i class="fa fa-check"></i><b>3.4.12</b> Hermitage 2017</a></li>
<li class="chapter" data-level="3.4.13" data-path="import-and-format-data.html"><a href="import-and-format-data.html#wellcamp-2018"><i class="fa fa-check"></i><b>3.4.13</b> Wellcamp 2018</a></li>
<li class="chapter" data-level="3.4.14" data-path="import-and-format-data.html"><a href="import-and-format-data.html#hermitage-2019"><i class="fa fa-check"></i><b>3.4.14</b> Hermitage 2019</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html"><i class="fa fa-check"></i><b>4</b> Preliminary Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#explore-and-visualise-data"><i class="fa fa-check"></i><b>4.1</b> Explore and Visualise Data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#fungicides"><i class="fa fa-check"></i><b>4.1.1</b> Fungicides</a></li>
<li class="chapter" data-level="4.1.2" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#mungbean-cultivars"><i class="fa fa-check"></i><b>4.1.2</b> Mungbean cultivars</a></li>
<li class="chapter" data-level="4.1.3" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#row-spacing"><i class="fa fa-check"></i><b>4.1.3</b> Row spacing</a></li>
<li class="chapter" data-level="4.1.4" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#yield-vs-in-season-rain"><i class="fa fa-check"></i><b>4.1.4</b> Yield vs in-season rain</a></li>
<li class="chapter" data-level="4.1.5" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#season-range-and-first-incidence"><i class="fa fa-check"></i><b>4.1.5</b> Season range and first incidence</a></li>
<li class="chapter" data-level="4.1.6" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#audpc-visualise-raw-data"><i class="fa fa-check"></i><b>4.1.6</b> AUDPC visualise raw data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="prepare-data-for-meta-analysis.html"><a href="prepare-data-for-meta-analysis.html"><i class="fa fa-check"></i><b>5</b> Prepare data for meta-analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="prepare-data-for-meta-analysis.html"><a href="prepare-data-for-meta-analysis.html#set-environment-and-import-data"><i class="fa fa-check"></i><b>5.1</b> Set environment and import data</a></li>
<li class="chapter" data-level="5.2" data-path="prepare-data-for-meta-analysis.html"><a href="prepare-data-for-meta-analysis.html#standardising-sample-variance"><i class="fa fa-check"></i><b>5.2</b> Standardising sample variance</a><ul>
<li class="chapter" data-level="5.2.1" data-path="prepare-data-for-meta-analysis.html"><a href="prepare-data-for-meta-analysis.html#converting-least-squares-to-sample-variance"><i class="fa fa-check"></i><b>5.2.1</b> Converting least-squares to sample variance</a></li>
<li class="chapter" data-level="5.2.2" data-path="prepare-data-for-meta-analysis.html"><a href="prepare-data-for-meta-analysis.html#converting-standard-deviation-to-sample-variance"><i class="fa fa-check"></i><b>5.2.2</b> Converting standard deviation to sample variance</a></li>
<li class="chapter" data-level="5.2.3" data-path="prepare-data-for-meta-analysis.html"><a href="prepare-data-for-meta-analysis.html#check-variance-of-data-set"><i class="fa fa-check"></i><b>5.2.3</b> Check variance of data-set</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="prepare-data-for-meta-analysis.html"><a href="prepare-data-for-meta-analysis.html#reduce-data-set-to-required-variables"><i class="fa fa-check"></i><b>5.3</b> Reduce data set to required variables</a><ul>
<li class="chapter" data-level="5.3.1" data-path="prepare-data-for-meta-analysis.html"><a href="prepare-data-for-meta-analysis.html#cluster-fungicide-applications"><i class="fa fa-check"></i><b>5.3.1</b> Cluster fungicide applications</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="prepare-data-for-meta-analysis.html"><a href="prepare-data-for-meta-analysis.html#test-dose-effect"><i class="fa fa-check"></i><b>5.4</b> Test dose effect</a></li>
<li class="chapter" data-level="5.5" data-path="prepare-data-for-meta-analysis.html"><a href="prepare-data-for-meta-analysis.html#disease-pressure-factor"><i class="fa fa-check"></i><b>5.5</b> Disease pressure factor</a></li>
<li class="chapter" data-level="5.6" data-path="preliminary-analysis.html"><a href="preliminary-analysis.html#row-spacing"><i class="fa fa-check"></i><b>5.6</b> Row spacing</a><ul>
<li class="chapter" data-level="5.6.1" data-path="prepare-data-for-meta-analysis.html"><a href="prepare-data-for-meta-analysis.html#mungbeans-age-and-yield-saved"><i class="fa fa-check"></i><b>5.6.1</b> Mungbeans age and yield saved</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="grain-yield-meta-analysis.html"><a href="grain-yield-meta-analysis.html"><i class="fa fa-check"></i><b>6</b> Grain yield meta-analysis</a><ul>
<li class="chapter" data-level="6.0.1" data-path="grain-yield-meta-analysis.html"><a href="grain-yield-meta-analysis.html#formating-the-response-variable"><i class="fa fa-check"></i><b>6.0.1</b> Formating the response variable</a></li>
<li class="chapter" data-level="6.0.2" data-path="grain-yield-meta-analysis.html"><a href="grain-yield-meta-analysis.html#formatting-variance"><i class="fa fa-check"></i><b>6.0.2</b> Formatting Variance</a></li>
<li class="chapter" data-level="6.1" data-path="grain-yield-meta-analysis.html"><a href="grain-yield-meta-analysis.html#metafor-analysis"><i class="fa fa-check"></i><b>6.1</b> metafor analysis</a><ul>
<li class="chapter" data-level="6.1.1" data-path="grain-yield-meta-analysis.html"><a href="grain-yield-meta-analysis.html#profile-plots"><i class="fa fa-check"></i><b>6.1.1</b> Profile plots</a></li>
<li class="chapter" data-level="6.1.2" data-path="grain-yield-meta-analysis.html"><a href="grain-yield-meta-analysis.html#forest-plot-of-trial-treatment-effect-per-trial"><i class="fa fa-check"></i><b>6.1.2</b> Forest plot of trial treatment effect per trial</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="grain-yield-meta-analysis.html"><a href="grain-yield-meta-analysis.html#netmeta-analysis"><i class="fa fa-check"></i><b>6.2</b> netmeta analysis</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A meta-analysis of powdery mildew yield loss mitigation strategies in Australian mungbean</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="import-and-format-data" class="section level1">
<h1><span class="header-section-number">3</span> Import and Format Data</h1>
<div id="non-wrangled-trials" class="section level2">
<h2><span class="header-section-number">3.1</span> Non-wrangled trials</h2>
<p>Data from the three follow trials were input manually from either PDF or word files.<br />
- Gatton 2012<br />
- Kingaroy 2012<br />
- Emerald 2016</p>
</div>
<div id="import-libraries" class="section level2">
<h2><span class="header-section-number">3.2</span> Import Libraries</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="import-and-format-data.html#cb1-1"></a><span class="kw">library</span>(openxlsx)</span>
<span id="cb1-2"><a href="import-and-format-data.html#cb1-2"></a><span class="kw">library</span>(readxl)</span>
<span id="cb1-3"><a href="import-and-format-data.html#cb1-3"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb1-4"><a href="import-and-format-data.html#cb1-4"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb1-5"><a href="import-and-format-data.html#cb1-5"></a><span class="kw">library</span>(data.table)</span>
<span id="cb1-6"><a href="import-and-format-data.html#cb1-6"></a><span class="kw">library</span>(agricolae)</span>
<span id="cb1-7"><a href="import-and-format-data.html#cb1-7"></a><span class="kw">library</span>(here)</span>
<span id="cb1-8"><a href="import-and-format-data.html#cb1-8"></a></span>
<span id="cb1-9"><a href="import-and-format-data.html#cb1-9"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/import_data.R&quot;</span>))</span>
<span id="cb1-10"><a href="import-and-format-data.html#cb1-10"></a>PM_MB_means &lt;-<span class="st"> </span><span class="kw">import_data</span>()</span></code></pre></div>
</div>
<div id="functions" class="section level2">
<h2><span class="header-section-number">3.3</span> Functions</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="import-and-format-data.html#cb2-1"></a>fold_data &lt;-<span class="st"> </span><span class="cf">function</span>(new_DataFrame, template_DataFrame) {</span>
<span id="cb2-2"><a href="import-and-format-data.html#cb2-2"></a>   <span class="co"># This function formats a dataframe to have the same column order as a template data.frame</span></span>
<span id="cb2-3"><a href="import-and-format-data.html#cb2-3"></a>   <span class="co"># If columns are missing from the new_DataFrame that are in the template_DataFrame, it creates them </span></span>
<span id="cb2-4"><a href="import-and-format-data.html#cb2-4"></a>   <span class="co"># with NA values. </span></span>
<span id="cb2-5"><a href="import-and-format-data.html#cb2-5"></a>   <span class="co"># Columns in the new_DataFrame, which are not in the template_DataFrame are appended to the right-hand-side</span></span>
<span id="cb2-6"><a href="import-and-format-data.html#cb2-6"></a>   <span class="co"># of the new_DataFrame</span></span>
<span id="cb2-7"><a href="import-and-format-data.html#cb2-7"></a>   <span class="co"># Using this function assists in joining the two data.frames together so columns are in the same order</span></span>
<span id="cb2-8"><a href="import-and-format-data.html#cb2-8"></a>   </span>
<span id="cb2-9"><a href="import-and-format-data.html#cb2-9"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">colnames</span>(new_DataFrame)) {</span>
<span id="cb2-10"><a href="import-and-format-data.html#cb2-10"></a>      <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="kw">colnames</span>(new_DataFrame)[<span class="dv">1</span>]) {</span>
<span id="cb2-11"><a href="import-and-format-data.html#cb2-11"></a>         x1 &lt;-<span class="st"> </span><span class="kw">vector</span>()</span>
<span id="cb2-12"><a href="import-and-format-data.html#cb2-12"></a>      }</span>
<span id="cb2-13"><a href="import-and-format-data.html#cb2-13"></a>      </span>
<span id="cb2-14"><a href="import-and-format-data.html#cb2-14"></a>      cnames1 &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">colnames</span>(new_DataFrame))</span>
<span id="cb2-15"><a href="import-and-format-data.html#cb2-15"></a>      cnames2 &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">colnames</span>(template_DataFrame))</span>
<span id="cb2-16"><a href="import-and-format-data.html#cb2-16"></a>      </span>
<span id="cb2-17"><a href="import-and-format-data.html#cb2-17"></a>      x1 &lt;-</span>
<span id="cb2-18"><a href="import-and-format-data.html#cb2-18"></a><span class="st">         </span><span class="kw">c</span>(x1, <span class="kw">match</span>(i, cnames2, <span class="dt">nomatch =</span> <span class="ot">NA</span>)) <span class="co"># MAke a index vector for the location of new_DataFrame col names in template_DataFrame</span></span>
<span id="cb2-19"><a href="import-and-format-data.html#cb2-19"></a>   }</span>
<span id="cb2-20"><a href="import-and-format-data.html#cb2-20"></a>   </span>
<span id="cb2-21"><a href="import-and-format-data.html#cb2-21"></a>   new_DataFrame &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(new_DataFrame)</span>
<span id="cb2-22"><a href="import-and-format-data.html#cb2-22"></a></span>
<span id="cb2-23"><a href="import-and-format-data.html#cb2-23"></a>   new_DataFrame[,cnames2[<span class="op">!</span>(cnames2 <span class="op">%in%</span><span class="st"> </span>cnames1)]] &lt;-</span>
<span id="cb2-24"><a href="import-and-format-data.html#cb2-24"></a><span class="st">      </span><span class="ot">NA</span> <span class="co"># adding column names to new_DataFrame which are in the template_DataFrame</span></span>
<span id="cb2-25"><a href="import-and-format-data.html#cb2-25"></a>   new_DataFrame &lt;-</span>
<span id="cb2-26"><a href="import-and-format-data.html#cb2-26"></a><span class="st">      </span>new_DataFrame[, <span class="kw">c</span>(cnames2, cnames1[<span class="kw">is.na</span>(x1)])]  <span class="co"># adding columns to new_DataFrame not in template_DataFrame  # arranges column names to new_DataFrame not in template_DataFrame</span></span>
<span id="cb2-27"><a href="import-and-format-data.html#cb2-27"></a>   </span>
<span id="cb2-28"><a href="import-and-format-data.html#cb2-28"></a>   <span class="kw">return</span>(new_DataFrame)</span>
<span id="cb2-29"><a href="import-and-format-data.html#cb2-29"></a>}</span>
<span id="cb2-30"><a href="import-and-format-data.html#cb2-30"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/copy_class.R&quot;</span>))</span>
<span id="cb2-31"><a href="import-and-format-data.html#cb2-31"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/replace_data.R&quot;</span>))</span></code></pre></div>
</div>
<div id="data-wrangling-for-each-trial" class="section level2">
<h2><span class="header-section-number">3.4</span> Data wrangling for each trial</h2>
<div id="hermitage-2010" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Hermitage 2010</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="import-and-format-data.html#cb3-1"></a>Herm_<span class="dv">10</span> &lt;-</span>
<span id="cb3-2"><a href="import-and-format-data.html#cb3-2"></a><span class="st">   </span><span class="kw">as.data.frame</span>(<span class="kw">read_xls</span>(<span class="kw">here</span>(</span>
<span id="cb3-3"><a href="import-and-format-data.html#cb3-3"></a>      <span class="st">&quot;data/2010 PMmung hermitage RAW field book.xls&quot;</span></span>
<span id="cb3-4"><a href="import-and-format-data.html#cb3-4"></a>   ),</span>
<span id="cb3-5"><a href="import-and-format-data.html#cb3-5"></a>   <span class="dt">sheet =</span> <span class="st">&quot;For analysis&quot;</span>),</span>
<span id="cb3-6"><a href="import-and-format-data.html#cb3-6"></a>   stringsAsFactors <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
<span id="cb3-7"><a href="import-and-format-data.html#cb3-7"></a></span>
<span id="cb3-8"><a href="import-and-format-data.html#cb3-8"></a></span>
<span id="cb3-9"><a href="import-and-format-data.html#cb3-9"></a>Herm_<span class="dv">10</span> &lt;-<span class="st"> </span>Herm_<span class="dv">10</span> <span class="op">%&gt;%</span></span>
<span id="cb3-10"><a href="import-and-format-data.html#cb3-10"></a><span class="st">   </span><span class="kw">mutate</span>(</span>
<span id="cb3-11"><a href="import-and-format-data.html#cb3-11"></a>      <span class="dt">trade_name =</span> <span class="kw">case_when</span>(</span>
<span id="cb3-12"><a href="import-and-format-data.html#cb3-12"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;U/S&quot;</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA_character_</span>,</span>
<span id="cb3-13"><a href="import-and-format-data.html#cb3-13"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;FirstsignC&quot;</span> <span class="op">~</span><span class="st"> &quot; &quot;</span>,</span>
<span id="cb3-14"><a href="import-and-format-data.html#cb3-14"></a>         <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Kendon&quot;</span></span>
<span id="cb3-15"><a href="import-and-format-data.html#cb3-15"></a>      )</span>
<span id="cb3-16"><a href="import-and-format-data.html#cb3-16"></a>   ) <span class="op">%&gt;%</span></span>
<span id="cb3-17"><a href="import-and-format-data.html#cb3-17"></a><span class="st">   </span><span class="kw">mutate</span>(</span>
<span id="cb3-18"><a href="import-and-format-data.html#cb3-18"></a>      <span class="dt">fungicide =</span> <span class="kw">case_when</span>(</span>
<span id="cb3-19"><a href="import-and-format-data.html#cb3-19"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;U/S&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb3-20"><a href="import-and-format-data.html#cb3-20"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;FirstsignC&quot;</span> <span class="op">~</span><span class="st"> &quot;carbendazim&quot;</span>,</span>
<span id="cb3-21"><a href="import-and-format-data.html#cb3-21"></a>         <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;sulphur&quot;</span></span>
<span id="cb3-22"><a href="import-and-format-data.html#cb3-22"></a>      )</span>
<span id="cb3-23"><a href="import-and-format-data.html#cb3-23"></a>   ) <span class="op">%&gt;%</span></span>
<span id="cb3-24"><a href="import-and-format-data.html#cb3-24"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> <span class="kw">case_when</span>(</span>
<span id="cb3-25"><a href="import-and-format-data.html#cb3-25"></a>      <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;U/S&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb3-26"><a href="import-and-format-data.html#cb3-26"></a>      <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;FirstsignC&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">250</span>,</span>
<span id="cb3-27"><a href="import-and-format-data.html#cb3-27"></a>      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">2400</span></span>
<span id="cb3-28"><a href="import-and-format-data.html#cb3-28"></a>   )) <span class="op">%&gt;%</span></span>
<span id="cb3-29"><a href="import-and-format-data.html#cb3-29"></a><span class="st">   </span><span class="kw">mutate</span>(</span>
<span id="cb3-30"><a href="import-and-format-data.html#cb3-30"></a>      <span class="dt">fungicide_application_1 =</span> <span class="kw">case_when</span>(</span>
<span id="cb3-31"><a href="import-and-format-data.html#cb3-31"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;Full Sp&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2010-02-19&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb3-32"><a href="import-and-format-data.html#cb3-32"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;Early Sp&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2010-02-19&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb3-33"><a href="import-and-format-data.html#cb3-33"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;FirstsignC&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2010-03-18&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb3-34"><a href="import-and-format-data.html#cb3-34"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;FirstsignS&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2010-03-18&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb3-35"><a href="import-and-format-data.html#cb3-35"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;U/S&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb3-36"><a href="import-and-format-data.html#cb3-36"></a>         <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)</span>
<span id="cb3-37"><a href="import-and-format-data.html#cb3-37"></a>      )</span>
<span id="cb3-38"><a href="import-and-format-data.html#cb3-38"></a>   ) <span class="op">%&gt;%</span></span>
<span id="cb3-39"><a href="import-and-format-data.html#cb3-39"></a><span class="st">   </span><span class="kw">mutate</span>(</span>
<span id="cb3-40"><a href="import-and-format-data.html#cb3-40"></a>      <span class="dt">fungicide_application_2 =</span> <span class="kw">case_when</span>(</span>
<span id="cb3-41"><a href="import-and-format-data.html#cb3-41"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;Full Sp&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2010-02-26&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb3-42"><a href="import-and-format-data.html#cb3-42"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;Early Sp&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2010-02-26&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb3-43"><a href="import-and-format-data.html#cb3-43"></a>         <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)</span>
<span id="cb3-44"><a href="import-and-format-data.html#cb3-44"></a>      )</span>
<span id="cb3-45"><a href="import-and-format-data.html#cb3-45"></a>   ) <span class="op">%&gt;%</span></span>
<span id="cb3-46"><a href="import-and-format-data.html#cb3-46"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_3 =</span> <span class="kw">case_when</span>(</span>
<span id="cb3-47"><a href="import-and-format-data.html#cb3-47"></a>      <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;Full Sp&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2010-03-05&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb3-48"><a href="import-and-format-data.html#cb3-48"></a>      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)</span>
<span id="cb3-49"><a href="import-and-format-data.html#cb3-49"></a>   )) <span class="op">%&gt;%</span></span>
<span id="cb3-50"><a href="import-and-format-data.html#cb3-50"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_4 =</span> <span class="kw">case_when</span>(</span>
<span id="cb3-51"><a href="import-and-format-data.html#cb3-51"></a>      <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;Full Sp&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2010-03-11&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb3-52"><a href="import-and-format-data.html#cb3-52"></a>      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)</span>
<span id="cb3-53"><a href="import-and-format-data.html#cb3-53"></a>   )) <span class="op">%&gt;%</span></span>
<span id="cb3-54"><a href="import-and-format-data.html#cb3-54"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_5 =</span> <span class="kw">case_when</span>(</span>
<span id="cb3-55"><a href="import-and-format-data.html#cb3-55"></a>      <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;Full Sp&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2010-03-18&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb3-56"><a href="import-and-format-data.html#cb3-56"></a>      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)</span>
<span id="cb3-57"><a href="import-and-format-data.html#cb3-57"></a>   )) <span class="op">%&gt;%</span></span>
<span id="cb3-58"><a href="import-and-format-data.html#cb3-58"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_6 =</span> <span class="kw">case_when</span>(</span>
<span id="cb3-59"><a href="import-and-format-data.html#cb3-59"></a>      <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;Full Sp&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2010-03-25&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb3-60"><a href="import-and-format-data.html#cb3-60"></a>      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)</span>
<span id="cb3-61"><a href="import-and-format-data.html#cb3-61"></a>   )) <span class="op">%&gt;%</span></span>
<span id="cb3-62"><a href="import-and-format-data.html#cb3-62"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_7 =</span> <span class="kw">case_when</span>(</span>
<span id="cb3-63"><a href="import-and-format-data.html#cb3-63"></a>      <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;Full Sp&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2010-03-07&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb3-64"><a href="import-and-format-data.html#cb3-64"></a>      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)</span>
<span id="cb3-65"><a href="import-and-format-data.html#cb3-65"></a>   )) <span class="op">%&gt;%</span></span>
<span id="cb3-66"><a href="import-and-format-data.html#cb3-66"></a><span class="st">   </span><span class="kw">mutate</span>(</span>
<span id="cb3-67"><a href="import-and-format-data.html#cb3-67"></a>      <span class="dt">total_fungicide =</span> <span class="kw">case_when</span>(</span>
<span id="cb3-68"><a href="import-and-format-data.html#cb3-68"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;Full Sp&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">7</span>,</span>
<span id="cb3-69"><a href="import-and-format-data.html#cb3-69"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;Early Sp&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb3-70"><a href="import-and-format-data.html#cb3-70"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;FirstsignC&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb3-71"><a href="import-and-format-data.html#cb3-71"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;FirstsignS&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb3-72"><a href="import-and-format-data.html#cb3-72"></a>         <span class="st">`</span><span class="dt">Schedule!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;U/S&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb3-73"><a href="import-and-format-data.html#cb3-73"></a>         <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">9999</span></span>
<span id="cb3-74"><a href="import-and-format-data.html#cb3-74"></a>      )</span>
<span id="cb3-75"><a href="import-and-format-data.html#cb3-75"></a>   )</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="import-and-format-data.html#cb4-1"></a>Herm_<span class="dv">10</span>_dat &lt;-</span>
<span id="cb4-2"><a href="import-and-format-data.html#cb4-2"></a><span class="st">   </span><span class="kw">data.frame</span>(</span>
<span id="cb4-3"><a href="import-and-format-data.html#cb4-3"></a>      <span class="dt">trial_ref =</span> <span class="st">&quot;mung0910/01&quot;</span>,</span>
<span id="cb4-4"><a href="import-and-format-data.html#cb4-4"></a>      <span class="dt">year =</span> <span class="st">&quot;2010&quot;</span>,</span>
<span id="cb4-5"><a href="import-and-format-data.html#cb4-5"></a>      <span class="dt">location =</span> <span class="st">&quot;Hermitage&quot;</span>,</span>
<span id="cb4-6"><a href="import-and-format-data.html#cb4-6"></a>      <span class="dt">host_genotype =</span> Herm_<span class="dv">10</span><span class="op">$</span><span class="st">`</span><span class="dt">Cultivar!</span><span class="st">`</span>,</span>
<span id="cb4-7"><a href="import-and-format-data.html#cb4-7"></a>      <span class="dt">trial_design =</span> <span class="st">&quot;RB&quot;</span>,</span>
<span id="cb4-8"><a href="import-and-format-data.html#cb4-8"></a>      <span class="dt">plot_length =</span> Herm_<span class="dv">10</span><span class="op">$</span><span class="st">`</span><span class="dt">Length (m)</span><span class="st">`</span>,</span>
<span id="cb4-9"><a href="import-and-format-data.html#cb4-9"></a>      <span class="dt">plot_width =</span> <span class="dv">4</span>,</span>
<span id="cb4-10"><a href="import-and-format-data.html#cb4-10"></a>      <span class="dt">plant_density =</span> <span class="ot">NA</span>,</span>
<span id="cb4-11"><a href="import-and-format-data.html#cb4-11"></a>      <span class="dt">row_spacing =</span> <span class="fl">0.25</span>,</span>
<span id="cb4-12"><a href="import-and-format-data.html#cb4-12"></a>      <span class="dt">replicate =</span> Herm_<span class="dv">10</span><span class="op">$</span><span class="st">`</span><span class="dt">Rep!</span><span class="st">`</span>,</span>
<span id="cb4-13"><a href="import-and-format-data.html#cb4-13"></a>      <span class="dt">planting_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2010-01-22&quot;</span>),</span>
<span id="cb4-14"><a href="import-and-format-data.html#cb4-14"></a>      <span class="dt">emergence_date =</span> <span class="ot">NA</span>,</span>
<span id="cb4-15"><a href="import-and-format-data.html#cb4-15"></a>      <span class="dt">flowering_date =</span> <span class="ot">NA</span>,</span>
<span id="cb4-16"><a href="import-and-format-data.html#cb4-16"></a>      <span class="dt">pod_fill_date =</span> <span class="ot">NA</span>,</span>
<span id="cb4-17"><a href="import-and-format-data.html#cb4-17"></a>      <span class="dt">mid_late_pod_fill =</span> <span class="ot">NA</span>,</span>
<span id="cb4-18"><a href="import-and-format-data.html#cb4-18"></a>      <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2010-03-18&quot;</span>),</span>
<span id="cb4-19"><a href="import-and-format-data.html#cb4-19"></a>      <span class="dt">trade_name =</span> Herm_<span class="dv">10</span><span class="op">$</span>trade_name,</span>
<span id="cb4-20"><a href="import-and-format-data.html#cb4-20"></a>      <span class="dt">fungicide_ai =</span> Herm_<span class="dv">10</span><span class="op">$</span>fungicide,</span>
<span id="cb4-21"><a href="import-and-format-data.html#cb4-21"></a>      <span class="dt">dose_ai.ha =</span> Herm_<span class="dv">10</span><span class="op">$</span>dose_ai.ha,</span>
<span id="cb4-22"><a href="import-and-format-data.html#cb4-22"></a>      <span class="dt">n_treatment =</span> Herm_<span class="dv">10</span><span class="op">$</span><span class="st">`</span><span class="dt">Treat!</span><span class="st">`</span>,</span>
<span id="cb4-23"><a href="import-and-format-data.html#cb4-23"></a>      <span class="dt">fungicide_application_1 =</span> Herm_<span class="dv">10</span><span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb4-24"><a href="import-and-format-data.html#cb4-24"></a>      <span class="dt">fungicide_application_2 =</span> Herm_<span class="dv">10</span><span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb4-25"><a href="import-and-format-data.html#cb4-25"></a>      <span class="dt">fungicide_application_3 =</span> Herm_<span class="dv">10</span><span class="op">$</span>fungicide_application_<span class="dv">3</span>,</span>
<span id="cb4-26"><a href="import-and-format-data.html#cb4-26"></a>      <span class="dt">fungicide_application_4 =</span> Herm_<span class="dv">10</span><span class="op">$</span>fungicide_application_<span class="dv">4</span>,</span>
<span id="cb4-27"><a href="import-and-format-data.html#cb4-27"></a>      <span class="dt">fungicide_application_5 =</span> Herm_<span class="dv">10</span><span class="op">$</span>fungicide_application_<span class="dv">5</span>,</span>
<span id="cb4-28"><a href="import-and-format-data.html#cb4-28"></a>      <span class="dt">fungicide_application_6 =</span> Herm_<span class="dv">10</span><span class="op">$</span>fungicide_application_<span class="dv">6</span>,</span>
<span id="cb4-29"><a href="import-and-format-data.html#cb4-29"></a>      <span class="dt">fungicide_application_7 =</span> Herm_<span class="dv">10</span><span class="op">$</span>fungicide_application_<span class="dv">7</span>,</span>
<span id="cb4-30"><a href="import-and-format-data.html#cb4-30"></a>      <span class="dt">total_fungicide =</span> Herm_<span class="dv">10</span><span class="op">$</span>total_fungicide,</span>
<span id="cb4-31"><a href="import-and-format-data.html#cb4-31"></a>      <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2010-05-14&quot;</span>),</span>
<span id="cb4-32"><a href="import-and-format-data.html#cb4-32"></a>      <span class="dt">final_assessment =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2010-04-20&quot;</span>),</span>
<span id="cb4-33"><a href="import-and-format-data.html#cb4-33"></a>      <span class="dt">PM_final_severity =</span> Herm_<span class="dv">10</span><span class="op">$</span>P.M<span class="fl">.13</span>wap,</span>
<span id="cb4-34"><a href="import-and-format-data.html#cb4-34"></a>      <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb4-35"><a href="import-and-format-data.html#cb4-35"></a>      <span class="dt">grain_yield.t.ha. =</span> Herm_<span class="dv">10</span><span class="op">$</span><span class="st">`</span><span class="dt">Kg/ha</span><span class="st">`</span> <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>,</span>
<span id="cb4-36"><a href="import-and-format-data.html#cb4-36"></a>      <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span></span>
<span id="cb4-37"><a href="import-and-format-data.html#cb4-37"></a>   )</span></code></pre></div>
<div id="audpc-curve" class="section level4">
<h4><span class="header-section-number">3.4.1.1</span> AUDPC curve</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="import-and-format-data.html#cb5-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="import-and-format-data.html#cb5-2"></a></span>
<span id="cb5-3"><a href="import-and-format-data.html#cb5-3"></a>Herm_<span class="dv">10</span>_dat &lt;-<span class="st"> </span><span class="kw">cbind</span>(</span>
<span id="cb5-4"><a href="import-and-format-data.html#cb5-4"></a>   Herm_<span class="dv">10</span>_dat,</span>
<span id="cb5-5"><a href="import-and-format-data.html#cb5-5"></a>   <span class="dt">AUDPC =</span> <span class="kw">apply</span>(</span>
<span id="cb5-6"><a href="import-and-format-data.html#cb5-6"></a>      <span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb5-7"><a href="import-and-format-data.html#cb5-7"></a>                 Herm_<span class="dv">10</span>[, <span class="kw">c</span>(<span class="st">&quot;P.M.9wap&quot;</span>, <span class="st">&quot;P.M.11wap&quot;</span>, <span class="st">&quot;P.M.13wap&quot;</span>)] <span class="op">-</span></span>
<span id="cb5-8"><a href="import-and-format-data.html#cb5-8"></a><span class="st">                    </span><span class="dv">1</span>),</span>
<span id="cb5-9"><a href="import-and-format-data.html#cb5-9"></a>      <span class="dv">1</span>,</span>
<span id="cb5-10"><a href="import-and-format-data.html#cb5-10"></a>      <span class="dt">FUN =</span> audpc,</span>
<span id="cb5-11"><a href="import-and-format-data.html#cb5-11"></a>      <span class="dt">dates =</span> <span class="kw">c</span>((Herm_<span class="dv">10</span>_dat<span class="op">$</span>first_sign_disease[<span class="dv">1</span>] <span class="op">-</span></span>
<span id="cb5-12"><a href="import-and-format-data.html#cb5-12"></a><span class="st">                    </span><span class="dv">7</span>) <span class="op">-</span></span>
<span id="cb5-13"><a href="import-and-format-data.html#cb5-13"></a><span class="st">                   </span>Herm_<span class="dv">10</span>_dat<span class="op">$</span>planting_date[<span class="dv">1</span>],</span>
<span id="cb5-14"><a href="import-and-format-data.html#cb5-14"></a>                <span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>,</span>
<span id="cb5-15"><a href="import-and-format-data.html#cb5-15"></a>                <span class="dv">11</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>,</span>
<span id="cb5-16"><a href="import-and-format-data.html#cb5-16"></a>                <span class="dv">13</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span></span>
<span id="cb5-17"><a href="import-and-format-data.html#cb5-17"></a>      )</span>
<span id="cb5-18"><a href="import-and-format-data.html#cb5-18"></a>   ),</span>
<span id="cb5-19"><a href="import-and-format-data.html#cb5-19"></a>   <span class="dt">AUDPS =</span> <span class="kw">apply</span>(</span>
<span id="cb5-20"><a href="import-and-format-data.html#cb5-20"></a>      <span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb5-21"><a href="import-and-format-data.html#cb5-21"></a>                 Herm_<span class="dv">10</span>[, <span class="kw">c</span>(<span class="st">&quot;P.M.9wap&quot;</span>, <span class="st">&quot;P.M.11wap&quot;</span>, <span class="st">&quot;P.M.13wap&quot;</span>)] <span class="op">-</span></span>
<span id="cb5-22"><a href="import-and-format-data.html#cb5-22"></a><span class="st">                    </span><span class="dv">1</span>),</span>
<span id="cb5-23"><a href="import-and-format-data.html#cb5-23"></a>      <span class="dv">1</span>,</span>
<span id="cb5-24"><a href="import-and-format-data.html#cb5-24"></a>      <span class="dt">FUN =</span> audps,</span>
<span id="cb5-25"><a href="import-and-format-data.html#cb5-25"></a>      <span class="dt">dates =</span> <span class="kw">c</span>((Herm_<span class="dv">10</span>_dat<span class="op">$</span>first_sign_disease[<span class="dv">1</span>] <span class="op">-</span></span>
<span id="cb5-26"><a href="import-and-format-data.html#cb5-26"></a><span class="st">                    </span><span class="dv">7</span>) <span class="op">-</span></span>
<span id="cb5-27"><a href="import-and-format-data.html#cb5-27"></a><span class="st">                   </span>Herm_<span class="dv">10</span>_dat<span class="op">$</span>planting_date[<span class="dv">1</span>],</span>
<span id="cb5-28"><a href="import-and-format-data.html#cb5-28"></a>                <span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>,</span>
<span id="cb5-29"><a href="import-and-format-data.html#cb5-29"></a>                <span class="dv">11</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>,</span>
<span id="cb5-30"><a href="import-and-format-data.html#cb5-30"></a>                <span class="dv">13</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span></span>
<span id="cb5-31"><a href="import-and-format-data.html#cb5-31"></a>      )</span>
<span id="cb5-32"><a href="import-and-format-data.html#cb5-32"></a>   )</span>
<span id="cb5-33"><a href="import-and-format-data.html#cb5-33"></a>)</span>
<span id="cb5-34"><a href="import-and-format-data.html#cb5-34"></a></span>
<span id="cb5-35"><a href="import-and-format-data.html#cb5-35"></a>Herm_<span class="dv">10</span><span class="op">$</span>PM_zero &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb5-36"><a href="import-and-format-data.html#cb5-36"></a>Herm_plot &lt;-</span>
<span id="cb5-37"><a href="import-and-format-data.html#cb5-37"></a><span class="st">   </span><span class="kw">melt</span>(</span>
<span id="cb5-38"><a href="import-and-format-data.html#cb5-38"></a>      Herm_<span class="dv">10</span>,</span>
<span id="cb5-39"><a href="import-and-format-data.html#cb5-39"></a>      <span class="dt">id.vars =</span> <span class="kw">c</span>(</span>
<span id="cb5-40"><a href="import-and-format-data.html#cb5-40"></a>         <span class="st">&quot;Description!&quot;</span>,</span>
<span id="cb5-41"><a href="import-and-format-data.html#cb5-41"></a>         <span class="st">&quot;Treat!&quot;</span>,</span>
<span id="cb5-42"><a href="import-and-format-data.html#cb5-42"></a>         <span class="st">&quot;Rep!&quot;</span>,</span>
<span id="cb5-43"><a href="import-and-format-data.html#cb5-43"></a>         <span class="st">&quot;Cultivar!&quot;</span>,</span>
<span id="cb5-44"><a href="import-and-format-data.html#cb5-44"></a>         <span class="st">&quot;fungicide&quot;</span>,</span>
<span id="cb5-45"><a href="import-and-format-data.html#cb5-45"></a>         <span class="st">&quot;total_fungicide&quot;</span></span>
<span id="cb5-46"><a href="import-and-format-data.html#cb5-46"></a>      ),</span>
<span id="cb5-47"><a href="import-and-format-data.html#cb5-47"></a>      <span class="dt">measure.vars =</span> <span class="kw">c</span>(<span class="st">&quot;PM_zero&quot;</span>, <span class="st">&quot;P.M.9wap&quot;</span>, <span class="st">&quot;P.M.11wap&quot;</span>, <span class="st">&quot;P.M.13wap&quot;</span>)</span>
<span id="cb5-48"><a href="import-and-format-data.html#cb5-48"></a>   )</span></code></pre></div>
<pre><code>## Warning in melt(Herm_10, id.vars = c(&quot;Description!&quot;, &quot;Treat!&quot;, &quot;Rep!&quot;,
## &quot;Cultivar!&quot;, : The melt generic in data.table has been passed a data.frame
## and will attempt to redirect to the relevant reshape2 method; please note that
## reshape2 is deprecated, and this redirection is now deprecated as well. To
## continue using melt methods from reshape2 while both libraries are attached,
## e.g. melt.list, you can prepend the namespace like reshape2::melt(Herm_10). In
## the next version, this warning will become an error.</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="import-and-format-data.html#cb7-1"></a>Herm_plot &lt;-<span class="st"> </span>Herm_plot <span class="op">%&gt;%</span></span>
<span id="cb7-2"><a href="import-and-format-data.html#cb7-2"></a><span class="st">   </span><span class="kw">mutate</span>(</span>
<span id="cb7-3"><a href="import-and-format-data.html#cb7-3"></a>      <span class="dt">T_var =</span> <span class="kw">case_when</span>(</span>
<span id="cb7-4"><a href="import-and-format-data.html#cb7-4"></a>         variable <span class="op">==</span><span class="st"> &quot;PM_zero&quot;</span> <span class="op">~</span></span>
<span id="cb7-5"><a href="import-and-format-data.html#cb7-5"></a><span class="st">            </span><span class="kw">as.numeric</span>((Herm_<span class="dv">10</span>_dat<span class="op">$</span>first_sign_disease[<span class="dv">1</span>] <span class="op">-</span></span>
<span id="cb7-6"><a href="import-and-format-data.html#cb7-6"></a><span class="st">                           </span><span class="dv">7</span>) <span class="op">-</span><span class="st"> </span>Herm_<span class="dv">10</span>_dat<span class="op">$</span>planting_date[<span class="dv">1</span>]</span>
<span id="cb7-7"><a href="import-and-format-data.html#cb7-7"></a>            ),</span>
<span id="cb7-8"><a href="import-and-format-data.html#cb7-8"></a>         variable <span class="op">==</span><span class="st"> &quot;P.M.9wap&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>,</span>
<span id="cb7-9"><a href="import-and-format-data.html#cb7-9"></a>         variable <span class="op">==</span><span class="st"> &quot;P.M.11wap&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">11</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span>,</span>
<span id="cb7-10"><a href="import-and-format-data.html#cb7-10"></a>         variable <span class="op">==</span><span class="st"> &quot;P.M.13wap&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">13</span> <span class="op">*</span><span class="st"> </span><span class="dv">7</span></span>
<span id="cb7-11"><a href="import-and-format-data.html#cb7-11"></a>      )</span>
<span id="cb7-12"><a href="import-and-format-data.html#cb7-12"></a>   )</span>
<span id="cb7-13"><a href="import-and-format-data.html#cb7-13"></a>Herm_plot<span class="op">$</span><span class="st">`</span><span class="dt">Treat!</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Herm_plot<span class="op">$</span><span class="st">`</span><span class="dt">Treat!</span><span class="st">`</span>)</span>
<span id="cb7-14"><a href="import-and-format-data.html#cb7-14"></a>Herm_plot <span class="op">%&gt;%</span></span>
<span id="cb7-15"><a href="import-and-format-data.html#cb7-15"></a><span class="st">   </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(</span>
<span id="cb7-16"><a href="import-and-format-data.html#cb7-16"></a>      <span class="dt">x =</span> T_var,</span>
<span id="cb7-17"><a href="import-and-format-data.html#cb7-17"></a>      <span class="dt">y =</span> value,</span>
<span id="cb7-18"><a href="import-and-format-data.html#cb7-18"></a>      <span class="dt">color =</span> <span class="st">`</span><span class="dt">Treat!</span><span class="st">`</span>,</span>
<span id="cb7-19"><a href="import-and-format-data.html#cb7-19"></a>      <span class="dt">shape =</span> <span class="st">`</span><span class="dt">Treat!</span><span class="st">`</span></span>
<span id="cb7-20"><a href="import-and-format-data.html#cb7-20"></a>   )) <span class="op">+</span></span>
<span id="cb7-21"><a href="import-and-format-data.html#cb7-21"></a><span class="st">   </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb7-22"><a href="import-and-format-data.html#cb7-22"></a><span class="st">   </span><span class="kw">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : pseudoinverse used at 47.785</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : neighborhood radius 29.215</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : reciprocal condition number 7.3625e-017</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : There are other near singularities as well. 796.09</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : pseudoinverse used at
## 47.785</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : neighborhood radius
## 29.215</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : reciprocal condition
## number 7.3625e-017</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : There are other near
## singularities as well. 796.09</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : pseudoinverse used at 47.785</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : neighborhood radius 29.215</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : reciprocal condition number 7.3625e-017</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : There are other near singularities as well. 796.09</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : pseudoinverse used at
## 47.785</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : neighborhood radius
## 29.215</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : reciprocal condition
## number 7.3625e-017</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : There are other near
## singularities as well. 796.09</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : pseudoinverse used at 47.785</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : neighborhood radius 29.215</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : reciprocal condition number 7.3625e-017</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : There are other near singularities as well. 796.09</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : pseudoinverse used at
## 47.785</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : neighborhood radius
## 29.215</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : reciprocal condition
## number 7.3625e-017</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : There are other near
## singularities as well. 796.09</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : pseudoinverse used at 47.785</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : neighborhood radius 29.215</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : reciprocal condition number 7.3625e-017</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : There are other near singularities as well. 796.09</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : pseudoinverse used at
## 47.785</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : neighborhood radius
## 29.215</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : reciprocal condition
## number 7.3625e-017</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : There are other near
## singularities as well. 796.09</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : pseudoinverse used at 47.785</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : neighborhood radius 29.215</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : reciprocal condition number 7.3625e-017</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric =
## parametric, : There are other near singularities as well. 796.09</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : pseudoinverse used at
## 47.785</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : neighborhood radius
## 29.215</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : reciprocal condition
## number 7.3625e-017</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if
## (is.null(newdata)) object$x else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : There are other near
## singularities as well. 796.09</code></pre>
<p><img src="_main_files/figure-html/Herm10_audpc-1.png" width="672" /></p>
</div>
<div id="treatment-means" class="section level4">
<h4><span class="header-section-number">3.4.1.2</span> Treatment means</h4>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="import-and-format-data.html#cb49-1"></a>Herm_<span class="dv">10</span>_m &lt;-<span class="st"> </span>Herm_<span class="dv">10</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb49-2"><a href="import-and-format-data.html#cb49-2"></a><span class="st">   </span><span class="kw">group_by</span>(trial_ref, year, location, host_genotype, trial_design, trade_name,fungicide_ai,dose_ai.ha,n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb49-3"><a href="import-and-format-data.html#cb49-3"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb49-4"><a href="import-and-format-data.html#cb49-4"></a>              <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb49-5"><a href="import-and-format-data.html#cb49-5"></a>              <span class="dt">plant_density =</span> <span class="kw">unique</span>(plant_density),</span>
<span id="cb49-6"><a href="import-and-format-data.html#cb49-6"></a>              <span class="dt">row_spacing =</span> <span class="kw">unique</span>(row_spacing),</span>
<span id="cb49-7"><a href="import-and-format-data.html#cb49-7"></a>              <span class="dt">replicates =</span> <span class="kw">length</span>(replicate),</span>
<span id="cb49-8"><a href="import-and-format-data.html#cb49-8"></a>              <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb49-9"><a href="import-and-format-data.html#cb49-9"></a>              <span class="dt">emergence_date =</span> <span class="ot">NA</span>,</span>
<span id="cb49-10"><a href="import-and-format-data.html#cb49-10"></a>              <span class="dt">flowering_date =</span> <span class="ot">NA</span>,</span>
<span id="cb49-11"><a href="import-and-format-data.html#cb49-11"></a>              <span class="dt">pod_fill_date =</span> <span class="ot">NA</span>,</span>
<span id="cb49-12"><a href="import-and-format-data.html#cb49-12"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="ot">NA</span>,</span>
<span id="cb49-13"><a href="import-and-format-data.html#cb49-13"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb49-14"><a href="import-and-format-data.html#cb49-14"></a>              <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb49-15"><a href="import-and-format-data.html#cb49-15"></a>              <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb49-16"><a href="import-and-format-data.html#cb49-16"></a>              <span class="dt">fungicide_application_3 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">3</span>),</span>
<span id="cb49-17"><a href="import-and-format-data.html#cb49-17"></a>              <span class="dt">fungicide_application_4 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">4</span>),</span>
<span id="cb49-18"><a href="import-and-format-data.html#cb49-18"></a>              <span class="dt">fungicide_application_5 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">5</span>),</span>
<span id="cb49-19"><a href="import-and-format-data.html#cb49-19"></a>             <span class="dt">fungicide_application_6 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">6</span>),</span>
<span id="cb49-20"><a href="import-and-format-data.html#cb49-20"></a>             <span class="dt">fungicide_application_6 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">7</span>),</span>
<span id="cb49-21"><a href="import-and-format-data.html#cb49-21"></a>              <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb49-22"><a href="import-and-format-data.html#cb49-22"></a>              <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb49-23"><a href="import-and-format-data.html#cb49-23"></a>              <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb49-24"><a href="import-and-format-data.html#cb49-24"></a>              <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb49-25"><a href="import-and-format-data.html#cb49-25"></a>              <span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb49-26"><a href="import-and-format-data.html#cb49-26"></a>              <span class="dt">PM_final_severity =</span> <span class="kw">mean</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb49-27"><a href="import-and-format-data.html#cb49-27"></a>              <span class="dt">D_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb49-28"><a href="import-and-format-data.html#cb49-28"></a>              <span class="dt">raw_graded =</span> <span class="ot">NA</span>,</span>
<span id="cb49-29"><a href="import-and-format-data.html#cb49-29"></a>              <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb49-30"><a href="import-and-format-data.html#cb49-30"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb49-31"><a href="import-and-format-data.html#cb49-31"></a>              <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb49-32"><a href="import-and-format-data.html#cb49-32"></a>              <span class="dt">AUDPC_m =</span> <span class="kw">mean</span>(AUDPC),</span>
<span id="cb49-33"><a href="import-and-format-data.html#cb49-33"></a>             <span class="dt">AUDPC_sd =</span> <span class="kw">sd</span>(AUDPC),</span>
<span id="cb49-34"><a href="import-and-format-data.html#cb49-34"></a>             <span class="dt">AUDPS_m =</span> <span class="kw">mean</span>(AUDPS),</span>
<span id="cb49-35"><a href="import-and-format-data.html#cb49-35"></a>             <span class="dt">AUDPS_sd =</span> <span class="kw">sd</span>(AUDPS),</span>
<span id="cb49-36"><a href="import-and-format-data.html#cb49-36"></a>             <span class="dt">Inc_Ms =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC <span class="op">~</span><span class="st"> </span>host_genotype <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), <span class="dt">data =</span> Herm_<span class="dv">10</span>_dat))[<span class="dv">2</span>,<span class="dv">3</span>],</span>
<span id="cb49-37"><a href="import-and-format-data.html#cb49-37"></a>             <span class="dt">Y_Msquare =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span>host_genotype <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), <span class="dt">data =</span> Herm_<span class="dv">10</span>_dat))[<span class="dv">2</span>,<span class="dv">3</span>]</span>
<span id="cb49-38"><a href="import-and-format-data.html#cb49-38"></a>             </span>
<span id="cb49-39"><a href="import-and-format-data.html#cb49-39"></a>   )</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;trial_ref&#39;, &#39;year&#39;, &#39;location&#39;, &#39;host_genotype&#39;, &#39;trial_design&#39;, &#39;trade_name&#39;, &#39;fungicide_ai&#39;, &#39;dose_ai.ha&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="import-and-format-data.html#cb51-1"></a>Herm_tentmp &lt;-<span class="st"> </span>Herm_<span class="dv">10</span>_dat <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb51-2"><a href="import-and-format-data.html#cb51-2"></a><span class="st">   </span><span class="kw">group_by</span>(host_genotype,n_treatment)<span class="op">%&gt;%</span></span>
<span id="cb51-3"><a href="import-and-format-data.html#cb51-3"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb51-4"><a href="import-and-format-data.html#cb51-4"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;host_genotype&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="import-and-format-data.html#cb53-1"></a>Herm_<span class="dv">10</span>_m[<span class="kw">order</span>(Herm_<span class="dv">10</span>_m<span class="op">$</span>n_treatment),<span class="st">&quot;disease_error&quot;</span>] &lt;-<span class="st"> </span>Herm_tentmp[<span class="kw">order</span>(Herm_tentmp<span class="op">$</span>n_treatment),<span class="st">&quot;disease_error&quot;</span>]</span>
<span id="cb53-2"><a href="import-and-format-data.html#cb53-2"></a>Herm_<span class="dv">10</span>_m[<span class="kw">order</span>(Herm_<span class="dv">10</span>_m<span class="op">$</span>n_treatment),<span class="st">&quot;yield_error&quot;</span>] &lt;-<span class="st"> </span>Herm_tentmp[<span class="kw">order</span>(Herm_tentmp<span class="op">$</span>n_treatment),<span class="st">&quot;yield_error&quot;</span>]</span>
<span id="cb53-3"><a href="import-and-format-data.html#cb53-3"></a></span>
<span id="cb53-4"><a href="import-and-format-data.html#cb53-4"></a></span>
<span id="cb53-5"><a href="import-and-format-data.html#cb53-5"></a>Herm_<span class="dv">10</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(Herm_<span class="dv">10</span>_m, PM_MB_means)</span>
<span id="cb53-6"><a href="import-and-format-data.html#cb53-6"></a></span>
<span id="cb53-7"><a href="import-and-format-data.html#cb53-7"></a></span>
<span id="cb53-8"><a href="import-and-format-data.html#cb53-8"></a><span class="co"># insert new calculations into data</span></span>
<span id="cb53-9"><a href="import-and-format-data.html#cb53-9"></a>PM_MB_means &lt;-<span class="st"> </span><span class="kw">replace_data</span>(<span class="dt">template_data =</span> PM_MB_means, </span>
<span id="cb53-10"><a href="import-and-format-data.html#cb53-10"></a>                            <span class="dt">new_data =</span> Herm_<span class="dv">10</span>_m, </span>
<span id="cb53-11"><a href="import-and-format-data.html#cb53-11"></a>                            <span class="dt">new_data_column =</span> <span class="kw">c</span>(<span class="st">&quot;AUDPC_m&quot;</span>, <span class="st">&quot;AUDPC_sd&quot;</span>, <span class="st">&quot;AUDPS_m&quot;</span>,<span class="st">&quot;AUDPS_sd&quot;</span>,<span class="st">&quot;Y_Msquare&quot;</span>, <span class="st">&quot;Inc_Ms&quot;</span>),</span>
<span id="cb53-12"><a href="import-and-format-data.html#cb53-12"></a>                            <span class="dt">filter_cols =</span> <span class="kw">c</span>(<span class="st">&quot;trial_ref&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;location&quot;</span>, <span class="st">&quot;host_genotype&quot;</span>, </span>
<span id="cb53-13"><a href="import-and-format-data.html#cb53-13"></a>                                           <span class="st">&quot;fungicide_ai&quot;</span>, <span class="st">&quot;dose_ai.ha&quot;</span>,<span class="st">&quot;n_treatment&quot;</span>))</span></code></pre></div>
<pre><code>## 
## Row number/s from template data replaced: c(52, 59, 61, 65, 66)
## total replacements = 5/15</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="import-and-format-data.html#cb55-1"></a>                            <span class="co">#ignore_columns = c(6,17,30:ncol(Herm_10_m))</span></span>
<span id="cb55-2"><a href="import-and-format-data.html#cb55-2"></a></span>
<span id="cb55-3"><a href="import-and-format-data.html#cb55-3"></a></span>
<span id="cb55-4"><a href="import-and-format-data.html#cb55-4"></a><span class="kw">write.csv</span>(</span>
<span id="cb55-5"><a href="import-and-format-data.html#cb55-5"></a>   <span class="kw">as.data.frame</span>(Herm_<span class="dv">10</span>_m),</span>
<span id="cb55-6"><a href="import-and-format-data.html#cb55-6"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/2010 PMmung Hermitage means.csv&quot;</span>), <span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb55-7"><a href="import-and-format-data.html#cb55-7"></a>)</span></code></pre></div>
</div>
</div>
<div id="hermitage-2011" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Hermitage 2011</h3>
<div id="define-treatments" class="section level4">
<h4><span class="header-section-number">3.4.2.1</span> Define treatments</h4>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="import-and-format-data.html#cb56-1"></a>Herm_<span class="dv">11</span> &lt;-</span>
<span id="cb56-2"><a href="import-and-format-data.html#cb56-2"></a><span class="st">   </span><span class="kw">as.data.frame</span>(<span class="kw">read_xls</span>(</span>
<span id="cb56-3"><a href="import-and-format-data.html#cb56-3"></a>      <span class="kw">here</span>(<span class="st">&quot;data/pmhermratings2011.xls&quot;</span>),</span>
<span id="cb56-4"><a href="import-and-format-data.html#cb56-4"></a>      <span class="dt">sheet =</span> <span class="st">&quot;Analyses factor&quot;</span></span>
<span id="cb56-5"><a href="import-and-format-data.html#cb56-5"></a>   ), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb56-6"><a href="import-and-format-data.html#cb56-6"></a></span>
<span id="cb56-7"><a href="import-and-format-data.html#cb56-7"></a>Herm_<span class="dv">11</span> &lt;-<span class="st"> </span>Herm_<span class="dv">11</span> <span class="op">%&gt;%</span></span>
<span id="cb56-8"><a href="import-and-format-data.html#cb56-8"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trade_name =</span> </span>
<span id="cb56-9"><a href="import-and-format-data.html#cb56-9"></a>             <span class="kw">case_when</span>(<span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray AMI-X&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra&quot;</span>,</span>
<span id="cb56-10"><a href="import-and-format-data.html#cb56-10"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray AMI-X&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra&quot;</span>,</span>
<span id="cb56-11"><a href="import-and-format-data.html#cb56-11"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray SULPHUR&quot;</span> <span class="op">~</span><span class="st"> &quot;Kendon&quot;</span>,</span>
<span id="cb56-12"><a href="import-and-format-data.html#cb56-12"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray SULPHUR&quot;</span> <span class="op">~</span><span class="st"> &quot;Kendon&quot;</span>,</span>
<span id="cb56-13"><a href="import-and-format-data.html#cb56-13"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray FOLICUR&quot;</span> <span class="op">~</span><span class="st"> &quot;Folicur&quot;</span>,</span>
<span id="cb56-14"><a href="import-and-format-data.html#cb56-14"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb56-15"><a href="import-and-format-data.html#cb56-15"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_ai =</span> </span>
<span id="cb56-16"><a href="import-and-format-data.html#cb56-16"></a>             <span class="kw">case_when</span>(<span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray AMI-X&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb56-17"><a href="import-and-format-data.html#cb56-17"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray AMI-X&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb56-18"><a href="import-and-format-data.html#cb56-18"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray SULPHUR&quot;</span> <span class="op">~</span><span class="st"> &quot;sulphur&quot;</span>,</span>
<span id="cb56-19"><a href="import-and-format-data.html#cb56-19"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray SULPHUR&quot;</span> <span class="op">~</span><span class="st"> &quot;sulphur&quot;</span>,</span>
<span id="cb56-20"><a href="import-and-format-data.html#cb56-20"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray FOLICUR&quot;</span> <span class="op">~</span><span class="st"> &quot;tebuconazole&quot;</span>,</span>
<span id="cb56-21"><a href="import-and-format-data.html#cb56-21"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb56-22"><a href="import-and-format-data.html#cb56-22"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> </span>
<span id="cb56-23"><a href="import-and-format-data.html#cb56-23"></a>             <span class="kw">case_when</span>(<span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray AMI-X&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">120</span>,</span>
<span id="cb56-24"><a href="import-and-format-data.html#cb56-24"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray AMI-X&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">120</span>,</span>
<span id="cb56-25"><a href="import-and-format-data.html#cb56-25"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray SULPHUR&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3000</span>,</span>
<span id="cb56-26"><a href="import-and-format-data.html#cb56-26"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray SULPHUR&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3000</span>,</span>
<span id="cb56-27"><a href="import-and-format-data.html#cb56-27"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray FOLICUR&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.35</span>,</span>
<span id="cb56-28"><a href="import-and-format-data.html#cb56-28"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>))<span class="op">%&gt;%</span></span>
<span id="cb56-29"><a href="import-and-format-data.html#cb56-29"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_1 =</span> </span>
<span id="cb56-30"><a href="import-and-format-data.html#cb56-30"></a>             <span class="kw">case_when</span>(<span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray AMI-X&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb56-31"><a href="import-and-format-data.html#cb56-31"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray AMI-X&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb56-32"><a href="import-and-format-data.html#cb56-32"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray SULPHUR&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb56-33"><a href="import-and-format-data.html#cb56-33"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray SULPHUR&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb56-34"><a href="import-and-format-data.html#cb56-34"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray FOLICUR&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb56-35"><a href="import-and-format-data.html#cb56-35"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb56-36"><a href="import-and-format-data.html#cb56-36"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_2 =</span> </span>
<span id="cb56-37"><a href="import-and-format-data.html#cb56-37"></a>             <span class="kw">case_when</span>(<span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray AMI-X&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-03-14&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb56-38"><a href="import-and-format-data.html#cb56-38"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray SULPHUR&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-03-14&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb56-39"><a href="import-and-format-data.html#cb56-39"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb56-40"><a href="import-and-format-data.html#cb56-40"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_3 =</span> </span>
<span id="cb56-41"><a href="import-and-format-data.html#cb56-41"></a>             <span class="kw">case_when</span>(<span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray AMI-X&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-03-14&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb56-42"><a href="import-and-format-data.html#cb56-42"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray SULPHUR&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-03-14&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb56-43"><a href="import-and-format-data.html#cb56-43"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb56-44"><a href="import-and-format-data.html#cb56-44"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">total_fungicide =</span> </span>
<span id="cb56-45"><a href="import-and-format-data.html#cb56-45"></a>             <span class="kw">case_when</span>(<span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray AMI-X&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb56-46"><a href="import-and-format-data.html#cb56-46"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray AMI-X&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,</span>
<span id="cb56-47"><a href="import-and-format-data.html#cb56-47"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray SULPHUR&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb56-48"><a href="import-and-format-data.html#cb56-48"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;3 spray SULPHUR&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,</span>
<span id="cb56-49"><a href="import-and-format-data.html#cb56-49"></a>                       <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> <span class="op">==</span><span class="st"> &quot;1 spray FOLICUR&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb56-50"><a href="import-and-format-data.html#cb56-50"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>))</span></code></pre></div>
</div>
<div id="input-trial-data" class="section level4">
<h4><span class="header-section-number">3.4.2.2</span> Input trial data</h4>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="import-and-format-data.html#cb57-1"></a>Herm_<span class="dv">11</span>_dat &lt;-<span class="st"> </span></span>
<span id="cb57-2"><a href="import-and-format-data.html#cb57-2"></a><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">trial_ref =</span> <span class="st">&quot;mung1011/01&quot;</span>,</span>
<span id="cb57-3"><a href="import-and-format-data.html#cb57-3"></a>              <span class="dt">year =</span> <span class="st">&quot;2011&quot;</span>,</span>
<span id="cb57-4"><a href="import-and-format-data.html#cb57-4"></a>              <span class="dt">location =</span> <span class="st">&quot;Hermitage&quot;</span>,</span>
<span id="cb57-5"><a href="import-and-format-data.html#cb57-5"></a>              <span class="dt">host_genotype =</span> Herm_<span class="dv">11</span><span class="op">$</span><span class="st">`</span><span class="dt">Cultivar!</span><span class="st">`</span>,</span>
<span id="cb57-6"><a href="import-and-format-data.html#cb57-6"></a>              <span class="dt">trial_design =</span> <span class="st">&quot;RCB&quot;</span>,</span>
<span id="cb57-7"><a href="import-and-format-data.html#cb57-7"></a>              <span class="dt">plot_length =</span> <span class="dv">11</span>,</span>
<span id="cb57-8"><a href="import-and-format-data.html#cb57-8"></a>              <span class="dt">plot_width =</span> <span class="dv">4</span>,</span>
<span id="cb57-9"><a href="import-and-format-data.html#cb57-9"></a>              <span class="dt">plant_density =</span> <span class="ot">NA</span>,</span>
<span id="cb57-10"><a href="import-and-format-data.html#cb57-10"></a>              <span class="dt">row_spacing =</span> <span class="fl">0.75</span>,</span>
<span id="cb57-11"><a href="import-and-format-data.html#cb57-11"></a>              <span class="dt">replicate =</span> Herm_<span class="dv">11</span><span class="op">$</span><span class="st">`</span><span class="dt">Rep!</span><span class="st">`</span>,</span>
<span id="cb57-12"><a href="import-and-format-data.html#cb57-12"></a>              <span class="dt">planting_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2011-01-24&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb57-13"><a href="import-and-format-data.html#cb57-13"></a>              <span class="dt">emergence_date =</span> <span class="ot">NA</span>,</span>
<span id="cb57-14"><a href="import-and-format-data.html#cb57-14"></a>              <span class="dt">flowering_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2011-03-22&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb57-15"><a href="import-and-format-data.html#cb57-15"></a>              <span class="dt">pod_fill_date =</span> <span class="ot">NA</span>,</span>
<span id="cb57-16"><a href="import-and-format-data.html#cb57-16"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="ot">NA</span>,</span>
<span id="cb57-17"><a href="import-and-format-data.html#cb57-17"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2011-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb57-18"><a href="import-and-format-data.html#cb57-18"></a>              <span class="dt">trade_name =</span> <span class="kw">as.factor</span>(Herm_<span class="dv">11</span><span class="op">$</span>trade_name),</span>
<span id="cb57-19"><a href="import-and-format-data.html#cb57-19"></a>              <span class="dt">fungicide_ai =</span> Herm_<span class="dv">11</span><span class="op">$</span>fungicide_ai,</span>
<span id="cb57-20"><a href="import-and-format-data.html#cb57-20"></a>              <span class="dt">dose_ai.ha =</span> Herm_<span class="dv">11</span><span class="op">$</span>dose_ai.ha,</span>
<span id="cb57-21"><a href="import-and-format-data.html#cb57-21"></a>              <span class="dt">n_treatment =</span> Herm_<span class="dv">11</span><span class="op">$</span>Tr,</span>
<span id="cb57-22"><a href="import-and-format-data.html#cb57-22"></a>              <span class="dt">fungicide_application_1 =</span> Herm_<span class="dv">11</span><span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb57-23"><a href="import-and-format-data.html#cb57-23"></a>              <span class="dt">fungicide_application_2 =</span> Herm_<span class="dv">11</span><span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb57-24"><a href="import-and-format-data.html#cb57-24"></a>              <span class="dt">fungicide_application_3 =</span> Herm_<span class="dv">11</span><span class="op">$</span>fungicide_application_<span class="dv">3</span>,</span>
<span id="cb57-25"><a href="import-and-format-data.html#cb57-25"></a>              <span class="dt">total_fungicide =</span> Herm_<span class="dv">11</span><span class="op">$</span>total_fungicide,</span>
<span id="cb57-26"><a href="import-and-format-data.html#cb57-26"></a>              <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2011-04-25&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb57-27"><a href="import-and-format-data.html#cb57-27"></a>              <span class="dt">final_assessment =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2011-04-11&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb57-28"><a href="import-and-format-data.html#cb57-28"></a>              <span class="dt">PM_final_severity =</span> Herm_<span class="dv">11</span><span class="op">$</span><span class="st">`</span><span class="dt">P.M. 11  w.a.p.</span><span class="st">`</span>,</span>
<span id="cb57-29"><a href="import-and-format-data.html#cb57-29"></a>              <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb57-30"><a href="import-and-format-data.html#cb57-30"></a>              <span class="dt">grain_yield.t.ha. =</span> Herm_<span class="dv">11</span><span class="op">$</span><span class="st">`</span><span class="dt">Yld Kg/ha</span><span class="st">`</span>,</span>
<span id="cb57-31"><a href="import-and-format-data.html#cb57-31"></a>              <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="audpc-curve-1" class="section level4">
<h4><span class="header-section-number">3.4.2.3</span> AUDPC curve</h4>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="import-and-format-data.html#cb58-1"></a>Herm_<span class="dv">11</span>_dat &lt;-<span class="st"> </span><span class="kw">cbind</span>(Herm_<span class="dv">11</span>_dat,</span>
<span id="cb58-2"><a href="import-and-format-data.html#cb58-2"></a>                     <span class="dt">AUDPC =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">42</span>),</span>
<span id="cb58-3"><a href="import-and-format-data.html#cb58-3"></a>                                       <span class="dt">wap11 =</span> Herm_<span class="dv">11</span>[,<span class="kw">c</span>(<span class="st">&quot;P.M. 11  w.a.p.&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),<span class="dv">1</span>, </span>
<span id="cb58-4"><a href="import-and-format-data.html#cb58-4"></a>                            <span class="dt">FUN =</span> audpc, <span class="dt">dates =</span> <span class="kw">c</span>((<span class="kw">as.Date</span>(<span class="st">&quot;2011-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)<span class="op">-</span><span class="dv">7</span>)<span class="op">-</span><span class="st"> </span></span>
<span id="cb58-5"><a href="import-and-format-data.html#cb58-5"></a><span class="st">                                                      </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-01-24&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb58-6"><a href="import-and-format-data.html#cb58-6"></a>                                                   <span class="dv">77</span>)</span>
<span id="cb58-7"><a href="import-and-format-data.html#cb58-7"></a>                     ),</span>
<span id="cb58-8"><a href="import-and-format-data.html#cb58-8"></a>                     <span class="dt">AUDPS =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">42</span>),</span>
<span id="cb58-9"><a href="import-and-format-data.html#cb58-9"></a>                                       <span class="dt">wap11 =</span> Herm_<span class="dv">11</span>[,<span class="kw">c</span>(<span class="st">&quot;P.M. 11  w.a.p.&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb58-10"><a href="import-and-format-data.html#cb58-10"></a>                                        <span class="dv">1</span>, </span>
<span id="cb58-11"><a href="import-and-format-data.html#cb58-11"></a>                                   <span class="dt">FUN =</span> audps, </span>
<span id="cb58-12"><a href="import-and-format-data.html#cb58-12"></a>                                        <span class="dt">dates =</span> <span class="kw">c</span>((<span class="kw">as.Date</span>(<span class="st">&quot;2011-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)<span class="op">-</span><span class="dv">7</span>)<span class="op">-</span><span class="st"> </span></span>
<span id="cb58-13"><a href="import-and-format-data.html#cb58-13"></a><span class="st">                                                      </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-01-24&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb58-14"><a href="import-and-format-data.html#cb58-14"></a>                                                  <span class="dv">77</span>)</span>
<span id="cb58-15"><a href="import-and-format-data.html#cb58-15"></a>                                        )</span>
<span id="cb58-16"><a href="import-and-format-data.html#cb58-16"></a>                          )</span>
<span id="cb58-17"><a href="import-and-format-data.html#cb58-17"></a></span>
<span id="cb58-18"><a href="import-and-format-data.html#cb58-18"></a></span>
<span id="cb58-19"><a href="import-and-format-data.html#cb58-19"></a>Herm_<span class="dv">11</span><span class="op">$</span>PM_zero &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb58-20"><a href="import-and-format-data.html#cb58-20"></a>Herm11_plot &lt;-<span class="st"> </span><span class="kw">melt</span>(Herm_<span class="dv">11</span>, <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&quot;Treatment!&quot;</span>, <span class="st">&quot;Cultivar!&quot;</span>,<span class="st">&quot;Tr&quot;</span>,<span class="st">&quot;Rep!&quot;</span>,<span class="st">&quot;fungicide_ai&quot;</span>,<span class="st">&quot;total_fungicide&quot;</span>),</span>
<span id="cb58-21"><a href="import-and-format-data.html#cb58-21"></a>                  <span class="dt">measure.vars =</span> <span class="kw">c</span>(<span class="st">&quot;PM_zero&quot;</span>,<span class="st">&quot;P.M. 11  w.a.p.&quot;</span>))</span>
<span id="cb58-22"><a href="import-and-format-data.html#cb58-22"></a></span>
<span id="cb58-23"><a href="import-and-format-data.html#cb58-23"></a>Herm11_plot &lt;-<span class="st"> </span>Herm11_plot <span class="op">%&gt;%</span></span>
<span id="cb58-24"><a href="import-and-format-data.html#cb58-24"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">T_var =</span> <span class="kw">case_when</span>(variable <span class="op">==</span><span class="st"> &quot;PM_zero&quot;</span> <span class="op">~</span><span class="st"> </span></span>
<span id="cb58-25"><a href="import-and-format-data.html#cb58-25"></a><span class="st">                               </span><span class="kw">as.numeric</span>((Herm_<span class="dv">11</span>_dat<span class="op">$</span>first_sign_disease[<span class="dv">1</span>]<span class="op">-</span><span class="dv">7</span>) <span class="op">-</span><span class="st"> </span>Herm_<span class="dv">11</span>_dat<span class="op">$</span>planting_date[<span class="dv">1</span>]),</span>
<span id="cb58-26"><a href="import-and-format-data.html#cb58-26"></a>                            variable <span class="op">==</span><span class="st"> &quot;P.M. 11  w.a.p.&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">11</span><span class="op">*</span><span class="dv">7</span>))</span>
<span id="cb58-27"><a href="import-and-format-data.html#cb58-27"></a></span>
<span id="cb58-28"><a href="import-and-format-data.html#cb58-28"></a>Herm11_plot<span class="op">$</span><span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Herm11_plot<span class="op">$</span><span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span>)</span>
<span id="cb58-29"><a href="import-and-format-data.html#cb58-29"></a>Herm11_plot <span class="op">%&gt;%</span></span>
<span id="cb58-30"><a href="import-and-format-data.html#cb58-30"></a><span class="st">   </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> T_var, <span class="dt">y =</span> value, <span class="dt">color =</span> <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span>, <span class="dt">shape =</span> <span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span>))<span class="op">+</span></span>
<span id="cb58-31"><a href="import-and-format-data.html#cb58-31"></a><span class="st">   </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.5</span>, <span class="dt">height =</span> <span class="fl">0.05</span>)<span class="op">+</span></span>
<span id="cb58-32"><a href="import-and-format-data.html#cb58-32"></a><span class="st">   </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/Herm_audpc-1.png" width="672" /></p>
</div>
<div id="treatment-means-1" class="section level4">
<h4><span class="header-section-number">3.4.2.4</span> Treatment means</h4>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="import-and-format-data.html#cb60-1"></a>Herm_<span class="dv">11</span>_dat[Herm_<span class="dv">11</span>_dat<span class="op">$</span>n_treatment <span class="op">==</span><span class="st"> </span><span class="dv">5</span>, <span class="st">&quot;n_treatment&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb60-2"><a href="import-and-format-data.html#cb60-2"></a>Herm_<span class="dv">11</span>_dat[Herm_<span class="dv">11</span>_dat<span class="op">$</span>n_treatment <span class="op">==</span><span class="st"> </span><span class="dv">12</span>, <span class="st">&quot;n_treatment&quot;</span>] &lt;-<span class="st"> </span><span class="dv">8</span></span>
<span id="cb60-3"><a href="import-and-format-data.html#cb60-3"></a></span>
<span id="cb60-4"><a href="import-and-format-data.html#cb60-4"></a>Herm_<span class="dv">11</span>_m &lt;-<span class="st"> </span>Herm_<span class="dv">11</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb60-5"><a href="import-and-format-data.html#cb60-5"></a><span class="st">   </span><span class="kw">group_by</span>(trial_ref, year, location, host_genotype, trial_design, trade_name,fungicide_ai,dose_ai.ha,n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb60-6"><a href="import-and-format-data.html#cb60-6"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb60-7"><a href="import-and-format-data.html#cb60-7"></a>              <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb60-8"><a href="import-and-format-data.html#cb60-8"></a>              <span class="dt">plant_density =</span> <span class="kw">unique</span>(plant_density),</span>
<span id="cb60-9"><a href="import-and-format-data.html#cb60-9"></a>              <span class="dt">row_spacing =</span> <span class="kw">unique</span>(row_spacing),</span>
<span id="cb60-10"><a href="import-and-format-data.html#cb60-10"></a>              <span class="dt">replicates =</span> <span class="kw">length</span>(replicate),</span>
<span id="cb60-11"><a href="import-and-format-data.html#cb60-11"></a>              <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb60-12"><a href="import-and-format-data.html#cb60-12"></a>              <span class="dt">emergence_date =</span> <span class="ot">NA</span>,</span>
<span id="cb60-13"><a href="import-and-format-data.html#cb60-13"></a>              <span class="dt">flowering_date =</span> <span class="kw">unique</span>(flowering_date),</span>
<span id="cb60-14"><a href="import-and-format-data.html#cb60-14"></a>              <span class="dt">pod_fill_date =</span> <span class="ot">NA</span>,</span>
<span id="cb60-15"><a href="import-and-format-data.html#cb60-15"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="ot">NA</span>,</span>
<span id="cb60-16"><a href="import-and-format-data.html#cb60-16"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb60-17"><a href="import-and-format-data.html#cb60-17"></a>              <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb60-18"><a href="import-and-format-data.html#cb60-18"></a>              <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb60-19"><a href="import-and-format-data.html#cb60-19"></a>              <span class="dt">fungicide_application_3 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">3</span>),</span>
<span id="cb60-20"><a href="import-and-format-data.html#cb60-20"></a>              <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb60-21"><a href="import-and-format-data.html#cb60-21"></a>              <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb60-22"><a href="import-and-format-data.html#cb60-22"></a>              <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb60-23"><a href="import-and-format-data.html#cb60-23"></a>              <span class="dt">PM_final_severity =</span> <span class="kw">mean</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb60-24"><a href="import-and-format-data.html#cb60-24"></a>              <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb60-25"><a href="import-and-format-data.html#cb60-25"></a>              <span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb60-26"><a href="import-and-format-data.html#cb60-26"></a>              <span class="dt">D_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb60-27"><a href="import-and-format-data.html#cb60-27"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha.<span class="op">/</span><span class="dv">1000</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb60-28"><a href="import-and-format-data.html#cb60-28"></a>              <span class="dt">raw_graded =</span> <span class="ot">NA</span>,</span>
<span id="cb60-29"><a href="import-and-format-data.html#cb60-29"></a>              <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha.<span class="op">/</span><span class="dv">1000</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb60-30"><a href="import-and-format-data.html#cb60-30"></a>              <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb60-31"><a href="import-and-format-data.html#cb60-31"></a>             <span class="dt">AUDPC_m =</span> <span class="kw">mean</span>(AUDPC),</span>
<span id="cb60-32"><a href="import-and-format-data.html#cb60-32"></a>             <span class="dt">AUDPC_sd =</span> <span class="kw">sd</span>(AUDPC),</span>
<span id="cb60-33"><a href="import-and-format-data.html#cb60-33"></a>             <span class="dt">AUDPS_m =</span> <span class="kw">mean</span>(AUDPS),</span>
<span id="cb60-34"><a href="import-and-format-data.html#cb60-34"></a>             <span class="dt">AUDPS_sd =</span> <span class="kw">sd</span>(AUDPS),</span>
<span id="cb60-35"><a href="import-and-format-data.html#cb60-35"></a>             <span class="dt">Inc_Ms =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC <span class="op">~</span><span class="st"> </span>host_genotype <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), </span>
<span id="cb60-36"><a href="import-and-format-data.html#cb60-36"></a>                               <span class="dt">data =</span> Herm_<span class="dv">11</span>_dat[Herm_<span class="dv">11</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;tebuconazole&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb60-37"><a href="import-and-format-data.html#cb60-37"></a><span class="st">                                                        </span>Herm_<span class="dv">11</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span> ,]))[<span class="dv">2</span>,<span class="dv">3</span>],</span>
<span id="cb60-38"><a href="import-and-format-data.html#cb60-38"></a>              <span class="dt">Y_Msquare =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(grain_yield.t.ha.<span class="op">/</span><span class="dv">1000</span> <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment) <span class="op">+</span><span class="st"> </span>host_genotype, </span>
<span id="cb60-39"><a href="import-and-format-data.html#cb60-39"></a>                                <span class="dt">data =</span> Herm_<span class="dv">11</span>_dat[Herm_<span class="dv">11</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;tebuconazole&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb60-40"><a href="import-and-format-data.html#cb60-40"></a><span class="st">                                                        </span>Herm_<span class="dv">11</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span> ,]))[<span class="dv">1</span>,<span class="dv">3</span>]</span>
<span id="cb60-41"><a href="import-and-format-data.html#cb60-41"></a>   )</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;trial_ref&#39;, &#39;year&#39;, &#39;location&#39;, &#39;host_genotype&#39;, &#39;trial_design&#39;, &#39;trade_name&#39;, &#39;fungicide_ai&#39;, &#39;dose_ai.ha&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="import-and-format-data.html#cb62-1"></a>Herm_tmp &lt;-<span class="st"> </span>Herm_<span class="dv">11</span>_dat <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb62-2"><a href="import-and-format-data.html#cb62-2"></a><span class="st">   </span><span class="kw">group_by</span>(host_genotype,n_treatment)<span class="op">%&gt;%</span></span>
<span id="cb62-3"><a href="import-and-format-data.html#cb62-3"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb62-4"><a href="import-and-format-data.html#cb62-4"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha.<span class="op">/</span><span class="dv">1000</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;host_genotype&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="import-and-format-data.html#cb64-1"></a>Herm_<span class="dv">11</span>_m[<span class="kw">order</span>(Herm_<span class="dv">11</span>_m<span class="op">$</span>n_treatment),<span class="st">&quot;disease_error&quot;</span>] &lt;-<span class="st"> </span>Herm_tmp[<span class="kw">order</span>(Herm_tmp<span class="op">$</span>n_treatment),<span class="st">&quot;disease_error&quot;</span>]</span>
<span id="cb64-2"><a href="import-and-format-data.html#cb64-2"></a>Herm_<span class="dv">11</span>_m[<span class="kw">order</span>(Herm_<span class="dv">11</span>_m<span class="op">$</span>n_treatment),<span class="st">&quot;yield_error&quot;</span>] &lt;-<span class="st"> </span>Herm_tmp[<span class="kw">order</span>(Herm_tmp<span class="op">$</span>n_treatment),<span class="st">&quot;yield_error&quot;</span>]</span>
<span id="cb64-3"><a href="import-and-format-data.html#cb64-3"></a></span>
<span id="cb64-4"><a href="import-and-format-data.html#cb64-4"></a>Herm_<span class="dv">11</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(Herm_<span class="dv">11</span>_m, PM_MB_means)</span>
<span id="cb64-5"><a href="import-and-format-data.html#cb64-5"></a></span>
<span id="cb64-6"><a href="import-and-format-data.html#cb64-6"></a></span>
<span id="cb64-7"><a href="import-and-format-data.html#cb64-7"></a><span class="co"># insert new calculations into data</span></span>
<span id="cb64-8"><a href="import-and-format-data.html#cb64-8"></a>PM_MB_means &lt;-<span class="st"> </span><span class="kw">replace_data</span>(<span class="dt">template_data =</span> PM_MB_means, </span>
<span id="cb64-9"><a href="import-and-format-data.html#cb64-9"></a>                            <span class="dt">new_data =</span> Herm_<span class="dv">11</span>_m, </span>
<span id="cb64-10"><a href="import-and-format-data.html#cb64-10"></a>                            <span class="dt">new_data_column =</span> <span class="kw">c</span>(<span class="st">&quot;AUDPC_m&quot;</span>, <span class="st">&quot;AUDPC_sd&quot;</span>, <span class="st">&quot;AUDPS_m&quot;</span>,<span class="st">&quot;AUDPS_sd&quot;</span>,<span class="st">&quot;Y_Msquare&quot;</span>, <span class="st">&quot;Inc_Ms&quot;</span>),</span>
<span id="cb64-11"><a href="import-and-format-data.html#cb64-11"></a>                            <span class="dt">filter_cols =</span> <span class="kw">c</span>(<span class="st">&quot;trial_ref&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;location&quot;</span>, <span class="st">&quot;host_genotype&quot;</span>, </span>
<span id="cb64-12"><a href="import-and-format-data.html#cb64-12"></a>                                           <span class="st">&quot;fungicide_ai&quot;</span>, <span class="st">&quot;dose_ai.ha&quot;</span>,<span class="st">&quot;n_treatment&quot;</span>))</span></code></pre></div>
<pre><code>## No data changed 0/12</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="import-and-format-data.html#cb66-1"></a><span class="kw">write.csv</span>(</span>
<span id="cb66-2"><a href="import-and-format-data.html#cb66-2"></a>   <span class="kw">as.data.frame</span>(Herm_<span class="dv">11</span>_m),</span>
<span id="cb66-3"><a href="import-and-format-data.html#cb66-3"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/2011 PMmung Herm means.csv&quot;</span>), <span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb66-4"><a href="import-and-format-data.html#cb66-4"></a>)</span></code></pre></div>
</div>
</div>
<div id="kingaroy-2011" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Kingaroy 2011</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="import-and-format-data.html#cb67-1"></a>King_<span class="dv">11</span> &lt;-</span>
<span id="cb67-2"><a href="import-and-format-data.html#cb67-2"></a><span class="st">   </span><span class="kw">as.data.frame</span>(<span class="kw">read_xls</span>(</span>
<span id="cb67-3"><a href="import-and-format-data.html#cb67-3"></a>      <span class="kw">here</span>(<span class="st">&quot;data/pmKing ratings2011.xls&quot;</span>),</span>
<span id="cb67-4"><a href="import-and-format-data.html#cb67-4"></a>      <span class="dt">sheet =</span> <span class="st">&quot;analyses&quot;</span></span>
<span id="cb67-5"><a href="import-and-format-data.html#cb67-5"></a>   ), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## New names:
## * `` -&gt; ...11</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="import-and-format-data.html#cb69-1"></a>tmp1 &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind.data.frame, <span class="kw">strsplit</span>(King_<span class="dv">11</span><span class="op">$</span><span class="st">`</span><span class="dt">Treatment!</span><span class="st">`</span>, <span class="st">&quot; &quot;</span>))</span>
<span id="cb69-2"><a href="import-and-format-data.html#cb69-2"></a><span class="kw">colnames</span>(tmp1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cultivar&quot;</span> , <span class="st">&quot;spray_n&quot;</span>, <span class="st">&quot;spray&quot;</span>, <span class="st">&quot;fungicide&quot;</span>)</span>
<span id="cb69-3"><a href="import-and-format-data.html#cb69-3"></a>King_<span class="dv">11</span> &lt;-<span class="st"> </span><span class="kw">cbind</span>(tmp1, King_<span class="dv">11</span>)</span>
<span id="cb69-4"><a href="import-and-format-data.html#cb69-4"></a>King_<span class="dv">11</span><span class="op">$</span>spray_n &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(King_<span class="dv">11</span><span class="op">$</span>spray_n))</span></code></pre></div>
<div id="define-treatment-data" class="section level4">
<h4><span class="header-section-number">3.4.3.1</span> Define treatment data</h4>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="import-and-format-data.html#cb70-1"></a>King_<span class="dv">11</span> &lt;-<span class="st"> </span>King_<span class="dv">11</span> <span class="op">%&gt;%</span></span>
<span id="cb70-2"><a href="import-and-format-data.html#cb70-2"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trade_name =</span> </span>
<span id="cb70-3"><a href="import-and-format-data.html#cb70-3"></a>             <span class="kw">case_when</span>(fungicide <span class="op">==</span><span class="st"> &quot;AMIS-X&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra&quot;</span>,</span>
<span id="cb70-4"><a href="import-and-format-data.html#cb70-4"></a>                       fungicide <span class="op">==</span><span class="st"> &quot;SULPHUR&quot;</span> <span class="op">~</span><span class="st"> &quot;Kendon&quot;</span>,</span>
<span id="cb70-5"><a href="import-and-format-data.html#cb70-5"></a>                       fungicide <span class="op">==</span><span class="st"> &quot;FOLICUR&quot;</span> <span class="op">~</span><span class="st"> &quot;Folicur&quot;</span>,</span>
<span id="cb70-6"><a href="import-and-format-data.html#cb70-6"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb70-7"><a href="import-and-format-data.html#cb70-7"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_ai =</span> </span>
<span id="cb70-8"><a href="import-and-format-data.html#cb70-8"></a>             <span class="kw">case_when</span>(fungicide <span class="op">==</span><span class="st"> &quot;AMIS-X&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb70-9"><a href="import-and-format-data.html#cb70-9"></a>                       fungicide <span class="op">==</span><span class="st"> &quot;SULPHUR&quot;</span> <span class="op">~</span><span class="st"> &quot;sulphur&quot;</span>,</span>
<span id="cb70-10"><a href="import-and-format-data.html#cb70-10"></a>                       fungicide <span class="op">==</span><span class="st"> &quot;FOLICUR&quot;</span> <span class="op">~</span><span class="st"> &quot;tebuconazole&quot;</span>,</span>
<span id="cb70-11"><a href="import-and-format-data.html#cb70-11"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb70-12"><a href="import-and-format-data.html#cb70-12"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> </span>
<span id="cb70-13"><a href="import-and-format-data.html#cb70-13"></a>             <span class="kw">case_when</span>(fungicide <span class="op">==</span><span class="st"> &quot;AMIS-X&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">120</span>,</span>
<span id="cb70-14"><a href="import-and-format-data.html#cb70-14"></a>                       fungicide <span class="op">==</span><span class="st"> &quot;SULPHUR&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3000</span>,</span>
<span id="cb70-15"><a href="import-and-format-data.html#cb70-15"></a>                       fungicide <span class="op">==</span><span class="st"> &quot;FOLICUR&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.35</span>,</span>
<span id="cb70-16"><a href="import-and-format-data.html#cb70-16"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>))<span class="op">%&gt;%</span></span>
<span id="cb70-17"><a href="import-and-format-data.html#cb70-17"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_1 =</span> </span>
<span id="cb70-18"><a href="import-and-format-data.html#cb70-18"></a>             <span class="kw">case_when</span>(spray_n <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-03-23&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb70-19"><a href="import-and-format-data.html#cb70-19"></a>                       spray_n <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-03-23&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb70-20"><a href="import-and-format-data.html#cb70-20"></a>                       spray_n <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-03-09&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb70-21"><a href="import-and-format-data.html#cb70-21"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb70-22"><a href="import-and-format-data.html#cb70-22"></a><span class="st">   </span></span>
<span id="cb70-23"><a href="import-and-format-data.html#cb70-23"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_2 =</span> </span>
<span id="cb70-24"><a href="import-and-format-data.html#cb70-24"></a>             <span class="kw">case_when</span>(spray_n <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-04-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb70-25"><a href="import-and-format-data.html#cb70-25"></a>                       spray_n <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-03-30&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb70-26"><a href="import-and-format-data.html#cb70-26"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb70-27"><a href="import-and-format-data.html#cb70-27"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_3 =</span> </span>
<span id="cb70-28"><a href="import-and-format-data.html#cb70-28"></a>             <span class="kw">case_when</span>(spray_n <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2011-04-12&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb70-29"><a href="import-and-format-data.html#cb70-29"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))</span></code></pre></div>
</div>
<div id="input-trial-data-1" class="section level4">
<h4><span class="header-section-number">3.4.3.2</span> Input trial data</h4>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="import-and-format-data.html#cb71-1"></a>King_<span class="dv">11</span>_dat &lt;-<span class="st"> </span></span>
<span id="cb71-2"><a href="import-and-format-data.html#cb71-2"></a><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">trial_ref =</span> <span class="st">&quot;mung1011/02&quot;</span>,</span>
<span id="cb71-3"><a href="import-and-format-data.html#cb71-3"></a>              <span class="dt">year =</span> <span class="st">&quot;2011&quot;</span>,</span>
<span id="cb71-4"><a href="import-and-format-data.html#cb71-4"></a>              <span class="dt">location =</span> <span class="st">&quot;Kingaroy&quot;</span>,</span>
<span id="cb71-5"><a href="import-and-format-data.html#cb71-5"></a>              <span class="dt">host_genotype =</span> King_<span class="dv">11</span><span class="op">$</span>cultivar,</span>
<span id="cb71-6"><a href="import-and-format-data.html#cb71-6"></a>              <span class="dt">trial_design =</span> <span class="st">&quot;RCB&quot;</span>,</span>
<span id="cb71-7"><a href="import-and-format-data.html#cb71-7"></a>              <span class="dt">plot_length =</span> <span class="dv">11</span>,</span>
<span id="cb71-8"><a href="import-and-format-data.html#cb71-8"></a>              <span class="dt">plot_width =</span> <span class="dv">4</span>,</span>
<span id="cb71-9"><a href="import-and-format-data.html#cb71-9"></a>              <span class="dt">plant_density =</span> <span class="ot">NA</span>,</span>
<span id="cb71-10"><a href="import-and-format-data.html#cb71-10"></a>              <span class="dt">row_spacing =</span> <span class="fl">0.75</span>,</span>
<span id="cb71-11"><a href="import-and-format-data.html#cb71-11"></a>              <span class="dt">replicate =</span> King_<span class="dv">11</span><span class="op">$</span><span class="st">`</span><span class="dt">rep!</span><span class="st">`</span>,</span>
<span id="cb71-12"><a href="import-and-format-data.html#cb71-12"></a>              <span class="dt">planting_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2011-02-02&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb71-13"><a href="import-and-format-data.html#cb71-13"></a>              <span class="dt">emergence_date =</span> <span class="ot">NA</span>,</span>
<span id="cb71-14"><a href="import-and-format-data.html#cb71-14"></a>              <span class="dt">flowering_date =</span> <span class="ot">NA</span>,</span>
<span id="cb71-15"><a href="import-and-format-data.html#cb71-15"></a>              <span class="dt">pod_fill_date =</span> <span class="ot">NA</span>,</span>
<span id="cb71-16"><a href="import-and-format-data.html#cb71-16"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="ot">NA</span>,</span>
<span id="cb71-17"><a href="import-and-format-data.html#cb71-17"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2011-03-22&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb71-18"><a href="import-and-format-data.html#cb71-18"></a>              <span class="dt">trade_name =</span> <span class="kw">as.factor</span>(King_<span class="dv">11</span><span class="op">$</span>trade_name),</span>
<span id="cb71-19"><a href="import-and-format-data.html#cb71-19"></a>              <span class="dt">fungicide_ai =</span> King_<span class="dv">11</span><span class="op">$</span>fungicide_ai,</span>
<span id="cb71-20"><a href="import-and-format-data.html#cb71-20"></a>              <span class="dt">dose_ai.ha =</span> King_<span class="dv">11</span><span class="op">$</span>dose_ai.ha,</span>
<span id="cb71-21"><a href="import-and-format-data.html#cb71-21"></a>              <span class="dt">n_treatment =</span> King_<span class="dv">11</span><span class="op">$</span><span class="st">`</span><span class="dt">trt!</span><span class="st">`</span>,</span>
<span id="cb71-22"><a href="import-and-format-data.html#cb71-22"></a>              <span class="dt">fungicide_application_1 =</span> King_<span class="dv">11</span><span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb71-23"><a href="import-and-format-data.html#cb71-23"></a>              <span class="dt">fungicide_application_2 =</span> King_<span class="dv">11</span><span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb71-24"><a href="import-and-format-data.html#cb71-24"></a>              <span class="dt">fungicide_application_3 =</span> King_<span class="dv">11</span><span class="op">$</span>fungicide_application_<span class="dv">3</span>,</span>
<span id="cb71-25"><a href="import-and-format-data.html#cb71-25"></a>              <span class="dt">total_fungicide =</span> King_<span class="dv">11</span><span class="op">$</span>spray_n,</span>
<span id="cb71-26"><a href="import-and-format-data.html#cb71-26"></a>              <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb71-27"><a href="import-and-format-data.html#cb71-27"></a>              <span class="dt">final_assessment =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2011-05-11&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb71-28"><a href="import-and-format-data.html#cb71-28"></a>              <span class="dt">PM_final_severity =</span> King_<span class="dv">11</span><span class="op">$</span><span class="st">`</span><span class="dt">14 w.a.p.</span><span class="st">`</span>,</span>
<span id="cb71-29"><a href="import-and-format-data.html#cb71-29"></a>              <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb71-30"><a href="import-and-format-data.html#cb71-30"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">as.numeric</span>(King_<span class="dv">11</span><span class="op">$</span><span class="st">`</span><span class="dt">Yld kg ha</span><span class="st">`</span>),</span>
<span id="cb71-31"><a href="import-and-format-data.html#cb71-31"></a>              <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning in data.frame(trial_ref = &quot;mung1011/02&quot;, year = &quot;2011&quot;, location =
## &quot;Kingaroy&quot;, : NAs introduced by coercion</code></pre>
</div>
<div id="audpc-curve-2" class="section level4">
<h4><span class="header-section-number">3.4.3.3</span> AUDPC curve</h4>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="import-and-format-data.html#cb73-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb73-2"><a href="import-and-format-data.html#cb73-2"></a></span>
<span id="cb73-3"><a href="import-and-format-data.html#cb73-3"></a>King_<span class="dv">11</span>_dat &lt;-<span class="st"> </span><span class="kw">cbind</span>(King_<span class="dv">11</span>_dat,</span>
<span id="cb73-4"><a href="import-and-format-data.html#cb73-4"></a>                     <span class="dt">AUDPC =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb73-5"><a href="import-and-format-data.html#cb73-5"></a>                                              King_<span class="dv">11</span>[,<span class="kw">c</span>(<span class="st">&quot;9 w.a.p.&quot;</span>,<span class="st">&quot;11 w.a.p.&quot;</span>,<span class="st">&quot;12 w.a.p.&quot;</span>,<span class="st">&quot;14 w.a.p.&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb73-6"><a href="import-and-format-data.html#cb73-6"></a>                                   <span class="dv">1</span>, </span>
<span id="cb73-7"><a href="import-and-format-data.html#cb73-7"></a>                                   <span class="dt">FUN =</span> audpc,</span>
<span id="cb73-8"><a href="import-and-format-data.html#cb73-8"></a>                                   <span class="dt">dates =</span> <span class="kw">c</span>((King_<span class="dv">11</span>_dat<span class="op">$</span>first_sign_disease[<span class="dv">1</span>]<span class="op">-</span><span class="dv">7</span>)<span class="op">-</span></span>
<span id="cb73-9"><a href="import-and-format-data.html#cb73-9"></a><span class="st">                                                </span>King_<span class="dv">11</span>_dat<span class="op">$</span>planting_date[<span class="dv">1</span>],</span>
<span id="cb73-10"><a href="import-and-format-data.html#cb73-10"></a>                                             <span class="dv">9</span><span class="op">*</span><span class="dv">7</span>,<span class="dv">11</span><span class="op">*</span><span class="dv">7</span>,<span class="dv">12</span><span class="op">*</span><span class="dv">7</span>,<span class="dv">14</span><span class="op">*</span><span class="dv">7</span>)</span>
<span id="cb73-11"><a href="import-and-format-data.html#cb73-11"></a>                                   ),</span>
<span id="cb73-12"><a href="import-and-format-data.html#cb73-12"></a>                     <span class="dt">AUDPS =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb73-13"><a href="import-and-format-data.html#cb73-13"></a>                                                   King_<span class="dv">11</span>[,<span class="kw">c</span>(<span class="st">&quot;9 w.a.p.&quot;</span>,<span class="st">&quot;11 w.a.p.&quot;</span>,<span class="st">&quot;12 w.a.p.&quot;</span>,<span class="st">&quot;14 w.a.p.&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb73-14"><a href="import-and-format-data.html#cb73-14"></a>                                        <span class="dv">1</span>, </span>
<span id="cb73-15"><a href="import-and-format-data.html#cb73-15"></a>                                        <span class="dt">FUN =</span> audps, </span>
<span id="cb73-16"><a href="import-and-format-data.html#cb73-16"></a>                                        <span class="dt">dates =</span> <span class="kw">c</span>((King_<span class="dv">11</span>_dat<span class="op">$</span>first_sign_disease[<span class="dv">1</span>]<span class="op">-</span><span class="dv">7</span>)<span class="op">-</span></span>
<span id="cb73-17"><a href="import-and-format-data.html#cb73-17"></a><span class="st">                                                     </span>King_<span class="dv">11</span>_dat<span class="op">$</span>planting_date[<span class="dv">1</span>],</span>
<span id="cb73-18"><a href="import-and-format-data.html#cb73-18"></a>                                                  <span class="dv">9</span><span class="op">*</span><span class="dv">7</span>,<span class="dv">11</span><span class="op">*</span><span class="dv">7</span>,<span class="dv">12</span><span class="op">*</span><span class="dv">7</span>,<span class="dv">14</span><span class="op">*</span><span class="dv">7</span>)</span>
<span id="cb73-19"><a href="import-and-format-data.html#cb73-19"></a>                                        )</span>
<span id="cb73-20"><a href="import-and-format-data.html#cb73-20"></a>                          )</span>
<span id="cb73-21"><a href="import-and-format-data.html#cb73-21"></a></span>
<span id="cb73-22"><a href="import-and-format-data.html#cb73-22"></a>King_<span class="dv">11</span><span class="op">$</span>PM_zero &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb73-23"><a href="import-and-format-data.html#cb73-23"></a>King11_plot &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw">melt</span>(King_<span class="dv">11</span>, <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&quot;Treatment!&quot;</span>,<span class="st">&quot;cultivar&quot;</span>,<span class="st">&quot;rep!&quot;</span>,<span class="st">&quot;spray_n&quot;</span>,<span class="st">&quot;fungicide&quot;</span>),</span>
<span id="cb73-24"><a href="import-and-format-data.html#cb73-24"></a>                  <span class="dt">measure.vars =</span> <span class="kw">c</span>(<span class="st">&quot;PM_zero&quot;</span>,<span class="st">&quot;9 w.a.p.&quot;</span>,<span class="st">&quot;11 w.a.p.&quot;</span>,<span class="st">&quot;12 w.a.p.&quot;</span>,<span class="st">&quot;14 w.a.p.&quot;</span>))</span>
<span id="cb73-25"><a href="import-and-format-data.html#cb73-25"></a></span>
<span id="cb73-26"><a href="import-and-format-data.html#cb73-26"></a>King11_plot &lt;-<span class="st"> </span>King11_plot <span class="op">%&gt;%</span></span>
<span id="cb73-27"><a href="import-and-format-data.html#cb73-27"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">T_var =</span> <span class="kw">case_when</span>(variable <span class="op">==</span><span class="st"> &quot;PM_zero&quot;</span> <span class="op">~</span><span class="st"> </span></span>
<span id="cb73-28"><a href="import-and-format-data.html#cb73-28"></a><span class="st">                               </span><span class="kw">as.numeric</span>((King_<span class="dv">11</span>_dat<span class="op">$</span>first_sign_disease[<span class="dv">1</span>]<span class="op">-</span><span class="dv">7</span>) <span class="op">-</span><span class="st"> </span>King_<span class="dv">11</span>_dat<span class="op">$</span>planting_date[<span class="dv">1</span>]),</span>
<span id="cb73-29"><a href="import-and-format-data.html#cb73-29"></a>                            variable <span class="op">==</span><span class="st"> &quot;9 w.a.p.&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">9</span><span class="op">*</span><span class="dv">7</span>,</span>
<span id="cb73-30"><a href="import-and-format-data.html#cb73-30"></a>                            variable <span class="op">==</span><span class="st"> &quot;11 w.a.p.&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">11</span><span class="op">*</span><span class="dv">7</span>,</span>
<span id="cb73-31"><a href="import-and-format-data.html#cb73-31"></a>                            variable <span class="op">==</span><span class="st"> &quot;12 w.a.p.&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">12</span><span class="op">*</span><span class="dv">7</span>,</span>
<span id="cb73-32"><a href="import-and-format-data.html#cb73-32"></a>                            variable <span class="op">==</span><span class="st"> &quot;14 w.a.p.&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">14</span> <span class="op">*</span><span class="dv">7</span>)</span>
<span id="cb73-33"><a href="import-and-format-data.html#cb73-33"></a>   )</span>
<span id="cb73-34"><a href="import-and-format-data.html#cb73-34"></a></span>
<span id="cb73-35"><a href="import-and-format-data.html#cb73-35"></a>King11_plot<span class="op">$</span>Treat &lt;-<span class="st"> </span><span class="kw">paste0</span>(King11_plot<span class="op">$</span>fungicide,King11_plot<span class="op">$</span>spray_n)</span>
<span id="cb73-36"><a href="import-and-format-data.html#cb73-36"></a></span>
<span id="cb73-37"><a href="import-and-format-data.html#cb73-37"></a>King11_plot <span class="op">%&gt;%</span></span>
<span id="cb73-38"><a href="import-and-format-data.html#cb73-38"></a><span class="st">   </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> T_var, <span class="dt">y =</span> value, <span class="dt">color =</span> Treat, <span class="dt">shape =</span> Treat))<span class="op">+</span></span>
<span id="cb73-39"><a href="import-and-format-data.html#cb73-39"></a><span class="st">   </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.7</span>, <span class="dt">height =</span> <span class="fl">0.07</span>)<span class="op">+</span></span>
<span id="cb73-40"><a href="import-and-format-data.html#cb73-40"></a><span class="st">   </span><span class="kw">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/King11_AUDPC-1.png" width="672" /></p>
</div>
<div id="treatment-means-2" class="section level4">
<h4><span class="header-section-number">3.4.3.4</span> Treatment means</h4>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="import-and-format-data.html#cb75-1"></a>King_<span class="dv">11</span>_m &lt;-<span class="st"> </span>King_<span class="dv">11</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb75-2"><a href="import-and-format-data.html#cb75-2"></a><span class="st">   </span><span class="kw">group_by</span>(host_genotype, fungicide_ai,n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb75-3"><a href="import-and-format-data.html#cb75-3"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb75-4"><a href="import-and-format-data.html#cb75-4"></a>             <span class="dt">year =</span> <span class="kw">unique</span>(year),</span>
<span id="cb75-5"><a href="import-and-format-data.html#cb75-5"></a>             <span class="dt">trade_name =</span> <span class="kw">unique</span>(trade_name),</span>
<span id="cb75-6"><a href="import-and-format-data.html#cb75-6"></a>             <span class="dt">location =</span> <span class="kw">unique</span>(location),</span>
<span id="cb75-7"><a href="import-and-format-data.html#cb75-7"></a>             <span class="dt">trial_design =</span> <span class="kw">unique</span>(trial_design),</span>
<span id="cb75-8"><a href="import-and-format-data.html#cb75-8"></a>             <span class="dt">dose_ai.ha =</span> <span class="kw">unique</span>(dose_ai.ha),</span>
<span id="cb75-9"><a href="import-and-format-data.html#cb75-9"></a>             <span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb75-10"><a href="import-and-format-data.html#cb75-10"></a>              <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb75-11"><a href="import-and-format-data.html#cb75-11"></a>              <span class="dt">plant_density =</span> <span class="kw">unique</span>(plant_density),</span>
<span id="cb75-12"><a href="import-and-format-data.html#cb75-12"></a>              <span class="dt">row_spacing =</span> <span class="kw">unique</span>(row_spacing),</span>
<span id="cb75-13"><a href="import-and-format-data.html#cb75-13"></a>              <span class="dt">replicates =</span> <span class="kw">length</span>(replicate),</span>
<span id="cb75-14"><a href="import-and-format-data.html#cb75-14"></a>              <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb75-15"><a href="import-and-format-data.html#cb75-15"></a>              <span class="dt">emergence_date =</span> <span class="ot">NA</span>,</span>
<span id="cb75-16"><a href="import-and-format-data.html#cb75-16"></a>              <span class="dt">flowering_date =</span> <span class="kw">unique</span>(flowering_date),</span>
<span id="cb75-17"><a href="import-and-format-data.html#cb75-17"></a>              <span class="dt">pod_fill_date =</span> <span class="ot">NA</span>,</span>
<span id="cb75-18"><a href="import-and-format-data.html#cb75-18"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="ot">NA</span>,</span>
<span id="cb75-19"><a href="import-and-format-data.html#cb75-19"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb75-20"><a href="import-and-format-data.html#cb75-20"></a>              <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb75-21"><a href="import-and-format-data.html#cb75-21"></a>              <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb75-22"><a href="import-and-format-data.html#cb75-22"></a>              <span class="dt">fungicide_application_3 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">3</span>),</span>
<span id="cb75-23"><a href="import-and-format-data.html#cb75-23"></a>              <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb75-24"><a href="import-and-format-data.html#cb75-24"></a>              <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb75-25"><a href="import-and-format-data.html#cb75-25"></a>              <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb75-26"><a href="import-and-format-data.html#cb75-26"></a>              <span class="dt">PM_final_severity =</span> <span class="kw">mean</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb75-27"><a href="import-and-format-data.html#cb75-27"></a>              <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb75-28"><a href="import-and-format-data.html#cb75-28"></a>              <span class="co">#disease_error = sd(PM_final_severity, na.rm = TRUE),  # this is commented because it never worked for some reason. </span></span>
<span id="cb75-29"><a href="import-and-format-data.html#cb75-29"></a>              <span class="dt">D_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb75-30"><a href="import-and-format-data.html#cb75-30"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)<span class="op">/</span><span class="dv">1000</span>,</span>
<span id="cb75-31"><a href="import-and-format-data.html#cb75-31"></a>              <span class="dt">raw_graded =</span> <span class="ot">NA</span>,</span>
<span id="cb75-32"><a href="import-and-format-data.html#cb75-32"></a>              <span class="co">#yield_error = sd(grain_yield.t.ha./1000, na.rm = TRUE),  # this is commented because it never worked for some reason. </span></span>
<span id="cb75-33"><a href="import-and-format-data.html#cb75-33"></a>              <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb75-34"><a href="import-and-format-data.html#cb75-34"></a>             <span class="dt">AUDPC_m =</span> <span class="kw">mean</span>(AUDPC),</span>
<span id="cb75-35"><a href="import-and-format-data.html#cb75-35"></a>             <span class="dt">AUDPC_sd =</span> <span class="kw">sd</span>(AUDPC),</span>
<span id="cb75-36"><a href="import-and-format-data.html#cb75-36"></a>             <span class="dt">AUDPS_m =</span> <span class="kw">mean</span>(AUDPS),</span>
<span id="cb75-37"><a href="import-and-format-data.html#cb75-37"></a>             <span class="dt">AUDPS_sd =</span> <span class="kw">sd</span>(AUDPS),</span>
<span id="cb75-38"><a href="import-and-format-data.html#cb75-38"></a>             <span class="dt">Inc_Ms =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC <span class="op">~</span><span class="st"> </span>host_genotype <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), </span>
<span id="cb75-39"><a href="import-and-format-data.html#cb75-39"></a>                               <span class="dt">data =</span> King_<span class="dv">11</span>_dat[King_<span class="dv">11</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;tebuconazole&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb75-40"><a href="import-and-format-data.html#cb75-40"></a><span class="st">                                                        </span>King_<span class="dv">11</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span> ,]))[<span class="dv">2</span>,<span class="dv">3</span>],</span>
<span id="cb75-41"><a href="import-and-format-data.html#cb75-41"></a>              <span class="dt">Y_Msquare =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(grain_yield.t.ha.<span class="op">/</span><span class="dv">1000</span> <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment) <span class="op">+</span><span class="st"> </span>host_genotype, </span>
<span id="cb75-42"><a href="import-and-format-data.html#cb75-42"></a>                                <span class="dt">data =</span> King_<span class="dv">11</span>_dat[King_<span class="dv">11</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;tebuconazole&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb75-43"><a href="import-and-format-data.html#cb75-43"></a><span class="st">                                                        </span>King_<span class="dv">11</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span> ,]))[<span class="dv">1</span>,<span class="dv">3</span>])</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;host_genotype&#39;, &#39;fungicide_ai&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="import-and-format-data.html#cb77-1"></a><span class="co"># For some wierd reason standard deviations are comming back NA in the code above</span></span>
<span id="cb77-2"><a href="import-and-format-data.html#cb77-2"></a><span class="co"># Because of n_treatment being converted to a factor I need to wrangle carefully here</span></span>
<span id="cb77-3"><a href="import-and-format-data.html#cb77-3"></a>King_tmp &lt;-<span class="st"> </span>King_<span class="dv">11</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb77-4"><a href="import-and-format-data.html#cb77-4"></a><span class="st">   </span><span class="kw">group_by</span>(host_genotype, fungicide_ai,n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb77-5"><a href="import-and-format-data.html#cb77-5"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb77-6"><a href="import-and-format-data.html#cb77-6"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha.<span class="op">/</span><span class="dv">1000</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;host_genotype&#39;, &#39;fungicide_ai&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="import-and-format-data.html#cb79-1"></a>King_<span class="dv">11</span>_m &lt;-<span class="st"> </span><span class="kw">left_join</span>(King_<span class="dv">11</span>_m,King_tmp)</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;host_genotype&quot;, &quot;fungicide_ai&quot;, &quot;n_treatment&quot;)</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="import-and-format-data.html#cb81-1"></a>King_<span class="dv">11</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(King_<span class="dv">11</span>_m, PM_MB_means)</span>
<span id="cb81-2"><a href="import-and-format-data.html#cb81-2"></a>King_<span class="dv">11</span>_m &lt;-<span class="st"> </span><span class="kw">copy_class</span>(PM_MB_means,King_<span class="dv">11</span>_m)</span>
<span id="cb81-3"><a href="import-and-format-data.html#cb81-3"></a></span>
<span id="cb81-4"><a href="import-and-format-data.html#cb81-4"></a><span class="co"># insert new calculations into data</span></span>
<span id="cb81-5"><a href="import-and-format-data.html#cb81-5"></a>PM_MB_means &lt;-<span class="st"> </span><span class="kw">replace_data</span>(<span class="dt">template_data =</span> PM_MB_means, </span>
<span id="cb81-6"><a href="import-and-format-data.html#cb81-6"></a>                            <span class="dt">new_data =</span> King_<span class="dv">11</span>_m, </span>
<span id="cb81-7"><a href="import-and-format-data.html#cb81-7"></a>                            <span class="dt">new_data_column =</span> <span class="kw">c</span>(<span class="st">&quot;AUDPC_m&quot;</span>, <span class="st">&quot;AUDPC_sd&quot;</span>, <span class="st">&quot;AUDPS_m&quot;</span>,<span class="st">&quot;AUDPS_sd&quot;</span>,<span class="st">&quot;Y_Msquare&quot;</span>, <span class="st">&quot;Inc_Ms&quot;</span>),</span>
<span id="cb81-8"><a href="import-and-format-data.html#cb81-8"></a>                            <span class="dt">filter_cols =</span> <span class="kw">c</span>(<span class="st">&quot;trial_ref&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;location&quot;</span>, <span class="st">&quot;host_genotype&quot;</span>, </span>
<span id="cb81-9"><a href="import-and-format-data.html#cb81-9"></a>                                           <span class="st">&quot;fungicide_ai&quot;</span>, <span class="st">&quot;dose_ai.ha&quot;</span>,<span class="st">&quot;n_treatment&quot;</span>))</span></code></pre></div>
<pre><code>## 
## Row number/s from template data replaced: c(96, 101, 102, 104, 106, 108, 109, 112, 113)
## total replacements = 9/20</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="import-and-format-data.html#cb83-1"></a><span class="kw">write.csv</span>(</span>
<span id="cb83-2"><a href="import-and-format-data.html#cb83-2"></a>   King_<span class="dv">11</span>_m,</span>
<span id="cb83-3"><a href="import-and-format-data.html#cb83-3"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/2011 PMmung Kingaroy means.csv&quot;</span>),<span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb83-4"><a href="import-and-format-data.html#cb83-4"></a>)</span></code></pre></div>
</div>
</div>
<div id="goolhi-2013" class="section level3">
<h3><span class="header-section-number">3.4.4</span> Goolhi 2013</h3>
<div id="convert-disease-scores" class="section level4">
<h4><span class="header-section-number">3.4.4.1</span> Convert disease scores</h4>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="import-and-format-data.html#cb84-1"></a><span class="cf">for</span>(D_assessment <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;16 DAT1&quot;</span>, <span class="st">&quot;33DAT1&quot;</span>)){</span>
<span id="cb84-2"><a href="import-and-format-data.html#cb84-2"></a></span>
<span id="cb84-3"><a href="import-and-format-data.html#cb84-3"></a><span class="co"># Import final disease survey</span></span>
<span id="cb84-4"><a href="import-and-format-data.html#cb84-4"></a>Goolhi<span class="fl">.13</span> &lt;-</span>
<span id="cb84-5"><a href="import-and-format-data.html#cb84-5"></a><span class="st">   </span><span class="kw">as.data.frame</span>(</span>
<span id="cb84-6"><a href="import-and-format-data.html#cb84-6"></a>      <span class="kw">read_xlsx</span>(</span>
<span id="cb84-7"><a href="import-and-format-data.html#cb84-7"></a>         <span class="dt">path =</span> <span class="kw">here</span>(<span class="st">&quot;data/AM1305 Fungicides for powdery mildew in mungbean - Goolhi.xlsx&quot;</span>),</span>
<span id="cb84-8"><a href="import-and-format-data.html#cb84-8"></a>         <span class="dt">sheet =</span> D_assessment,</span>
<span id="cb84-9"><a href="import-and-format-data.html#cb84-9"></a>         <span class="dt">range =</span> <span class="st">&quot;A15:AG75&quot;</span>,</span>
<span id="cb84-10"><a href="import-and-format-data.html#cb84-10"></a>         <span class="dt">col_names =</span> <span class="ot">TRUE</span></span>
<span id="cb84-11"><a href="import-and-format-data.html#cb84-11"></a>      )</span>
<span id="cb84-12"><a href="import-and-format-data.html#cb84-12"></a>   )</span>
<span id="cb84-13"><a href="import-and-format-data.html#cb84-13"></a></span>
<span id="cb84-14"><a href="import-and-format-data.html#cb84-14"></a>Goolhi<span class="fl">.13</span> &lt;-<span class="st"> </span>Goolhi<span class="fl">.13</span>[<span class="kw">order</span>(Goolhi<span class="fl">.13</span>[,<span class="dv">1</span>],Goolhi<span class="fl">.13</span>[,<span class="dv">2</span>],Goolhi<span class="fl">.13</span>[,<span class="dv">3</span>],Goolhi<span class="fl">.13</span>[,<span class="dv">4</span>]),]</span>
<span id="cb84-15"><a href="import-and-format-data.html#cb84-15"></a></span>
<span id="cb84-16"><a href="import-and-format-data.html#cb84-16"></a></span>
<span id="cb84-17"><a href="import-and-format-data.html#cb84-17"></a><span class="co"># Replace empty cells / NAs with zeros</span></span>
<span id="cb84-18"><a href="import-and-format-data.html#cb84-18"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>) {</span>
<span id="cb84-19"><a href="import-and-format-data.html#cb84-19"></a>   Goolhi<span class="fl">.13</span>[<span class="kw">is.na</span>(Goolhi<span class="fl">.13</span>[, i]), i] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb84-20"><a href="import-and-format-data.html#cb84-20"></a>}</span>
<span id="cb84-21"><a href="import-and-format-data.html#cb84-21"></a></span>
<span id="cb84-22"><a href="import-and-format-data.html#cb84-22"></a><span class="co"># This table gives the column references for each respective </span></span>
<span id="cb84-23"><a href="import-and-format-data.html#cb84-23"></a><span class="co"># location in the canopy</span></span>
<span id="cb84-24"><a href="import-and-format-data.html#cb84-24"></a><span class="co"># Calculate incidence</span></span>
<span id="cb84-25"><a href="import-and-format-data.html#cb84-25"></a><span class="co">#     Sites      1     2     3</span></span>
<span id="cb84-26"><a href="import-and-format-data.html#cb84-26"></a><span class="co"># low canopy  c(7:9, 16:18, 25:27)</span></span>
<span id="cb84-27"><a href="import-and-format-data.html#cb84-27"></a><span class="co"># mid canopy c(10:12, 19:21, 28:30)</span></span>
<span id="cb84-28"><a href="import-and-format-data.html#cb84-28"></a><span class="co"># upp canopy c(13:15, 22:24, 31:33)</span></span>
<span id="cb84-29"><a href="import-and-format-data.html#cb84-29"></a></span>
<span id="cb84-30"><a href="import-and-format-data.html#cb84-30"></a>incidence1 &lt;-</span>
<span id="cb84-31"><a href="import-and-format-data.html#cb84-31"></a><span class="st">   </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;numeric&quot;</span>, <span class="dt">length =</span> <span class="kw">length</span>(Goolhi<span class="fl">.13</span>[, <span class="dv">1</span>]))</span>
<span id="cb84-32"><a href="import-and-format-data.html#cb84-32"></a></span>
<span id="cb84-33"><a href="import-and-format-data.html#cb84-33"></a><span class="co"># Convert disease survey data to 1-9 Incidence rating scale</span></span>
<span id="cb84-34"><a href="import-and-format-data.html#cb84-34"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(incidence1)) {</span>
<span id="cb84-35"><a href="import-and-format-data.html#cb84-35"></a>   <span class="co"># when incidence = 1</span></span>
<span id="cb84-36"><a href="import-and-format-data.html#cb84-36"></a>   <span class="cf">if</span> (<span class="kw">all</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)) {</span>
<span id="cb84-37"><a href="import-and-format-data.html#cb84-37"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb84-38"><a href="import-and-format-data.html#cb84-38"></a>      <span class="cf">next</span>()</span>
<span id="cb84-39"><a href="import-and-format-data.html#cb84-39"></a>   }</span>
<span id="cb84-40"><a href="import-and-format-data.html#cb84-40"></a>   </span>
<span id="cb84-41"><a href="import-and-format-data.html#cb84-41"></a>   <span class="co"># when incidence = 2</span></span>
<span id="cb84-42"><a href="import-and-format-data.html#cb84-42"></a>   <span class="cf">if</span> (<span class="kw">all</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">10</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">19</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">28</span>, <span class="dv">33</span>)] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-43"><a href="import-and-format-data.html#cb84-43"></a><span class="st">       </span>(<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">18</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">27</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb84-44"><a href="import-and-format-data.html#cb84-44"></a><span class="st">        </span><span class="kw">length</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">18</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">27</span>)])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb84-45"><a href="import-and-format-data.html#cb84-45"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb84-46"><a href="import-and-format-data.html#cb84-46"></a>      <span class="cf">next</span>()</span>
<span id="cb84-47"><a href="import-and-format-data.html#cb84-47"></a>   }</span>
<span id="cb84-48"><a href="import-and-format-data.html#cb84-48"></a>   </span>
<span id="cb84-49"><a href="import-and-format-data.html#cb84-49"></a>   </span>
<span id="cb84-50"><a href="import-and-format-data.html#cb84-50"></a>   <span class="co"># when incidence = 3</span></span>
<span id="cb84-51"><a href="import-and-format-data.html#cb84-51"></a>   <span class="cf">if</span> (<span class="kw">all</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">22</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">31</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-52"><a href="import-and-format-data.html#cb84-52"></a><span class="st">       </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">10</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">19</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">28</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-53"><a href="import-and-format-data.html#cb84-53"></a><span class="st">       </span>(<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb84-54"><a href="import-and-format-data.html#cb84-54"></a><span class="st">        </span><span class="kw">length</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb84-55"><a href="import-and-format-data.html#cb84-55"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb84-56"><a href="import-and-format-data.html#cb84-56"></a>   } <span class="cf">else</span>{</span>
<span id="cb84-57"><a href="import-and-format-data.html#cb84-57"></a>      <span class="co"># if it is in the lower half of the canopy and in less than 75% of plants then incidence = 2.5</span></span>
<span id="cb84-58"><a href="import-and-format-data.html#cb84-58"></a>      <span class="cf">if</span> (<span class="kw">all</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">22</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">31</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-59"><a href="import-and-format-data.html#cb84-59"></a><span class="st">          </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">10</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">19</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">28</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-60"><a href="import-and-format-data.html#cb84-60"></a><span class="st">          </span>(<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb84-61"><a href="import-and-format-data.html#cb84-61"></a><span class="st">           </span><span class="kw">length</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb84-62"><a href="import-and-format-data.html#cb84-62"></a>         incidence1[i] &lt;-<span class="st"> </span><span class="fl">2.5</span></span>
<span id="cb84-63"><a href="import-and-format-data.html#cb84-63"></a>         <span class="cf">next</span>()</span>
<span id="cb84-64"><a href="import-and-format-data.html#cb84-64"></a>      }</span>
<span id="cb84-65"><a href="import-and-format-data.html#cb84-65"></a>   }</span>
<span id="cb84-66"><a href="import-and-format-data.html#cb84-66"></a>   </span>
<span id="cb84-67"><a href="import-and-format-data.html#cb84-67"></a>   </span>
<span id="cb84-68"><a href="import-and-format-data.html#cb84-68"></a>   <span class="co"># when incidence = 4</span></span>
<span id="cb84-69"><a href="import-and-format-data.html#cb84-69"></a>   <span class="cf">if</span> (<span class="kw">all</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">22</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">31</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-70"><a href="import-and-format-data.html#cb84-70"></a><span class="st">       </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">10</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">19</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">28</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-71"><a href="import-and-format-data.html#cb84-71"></a><span class="st">       </span>(<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb84-72"><a href="import-and-format-data.html#cb84-72"></a><span class="st">        </span><span class="kw">length</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb84-73"><a href="import-and-format-data.html#cb84-73"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb84-74"><a href="import-and-format-data.html#cb84-74"></a>      <span class="cf">next</span>()</span>
<span id="cb84-75"><a href="import-and-format-data.html#cb84-75"></a>   }</span>
<span id="cb84-76"><a href="import-and-format-data.html#cb84-76"></a>   </span>
<span id="cb84-77"><a href="import-and-format-data.html#cb84-77"></a>   </span>
<span id="cb84-78"><a href="import-and-format-data.html#cb84-78"></a>   <span class="co"># when incidence = 5</span></span>
<span id="cb84-79"><a href="import-and-format-data.html#cb84-79"></a>   <span class="cf">if</span> (<span class="kw">all</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">22</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">31</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-80"><a href="import-and-format-data.html#cb84-80"></a><span class="st">       </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">10</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">19</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">28</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-81"><a href="import-and-format-data.html#cb84-81"></a><span class="st">       </span>(<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb84-82"><a href="import-and-format-data.html#cb84-82"></a><span class="st">        </span><span class="kw">length</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-83"><a href="import-and-format-data.html#cb84-83"></a><span class="st">       </span><span class="kw">any</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)) {</span>
<span id="cb84-84"><a href="import-and-format-data.html#cb84-84"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb84-85"><a href="import-and-format-data.html#cb84-85"></a>      <span class="cf">next</span>()</span>
<span id="cb84-86"><a href="import-and-format-data.html#cb84-86"></a>   }</span>
<span id="cb84-87"><a href="import-and-format-data.html#cb84-87"></a>   </span>
<span id="cb84-88"><a href="import-and-format-data.html#cb84-88"></a>   </span>
<span id="cb84-89"><a href="import-and-format-data.html#cb84-89"></a>   <span class="co"># when incidence = 6</span></span>
<span id="cb84-90"><a href="import-and-format-data.html#cb84-90"></a>   <span class="cf">if</span> (<span class="kw">all</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">22</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">31</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-91"><a href="import-and-format-data.html#cb84-91"></a><span class="st">       </span><span class="kw">all</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)) {</span>
<span id="cb84-92"><a href="import-and-format-data.html#cb84-92"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="dv">6</span></span>
<span id="cb84-93"><a href="import-and-format-data.html#cb84-93"></a>      <span class="cf">next</span>()</span>
<span id="cb84-94"><a href="import-and-format-data.html#cb84-94"></a>   }</span>
<span id="cb84-95"><a href="import-and-format-data.html#cb84-95"></a>   </span>
<span id="cb84-96"><a href="import-and-format-data.html#cb84-96"></a>   </span>
<span id="cb84-97"><a href="import-and-format-data.html#cb84-97"></a>   <span class="co"># when incidence = 7</span></span>
<span id="cb84-98"><a href="import-and-format-data.html#cb84-98"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">22</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">31</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-99"><a href="import-and-format-data.html#cb84-99"></a><span class="st">       </span><span class="kw">all</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)) {</span>
<span id="cb84-100"><a href="import-and-format-data.html#cb84-100"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="dv">7</span></span>
<span id="cb84-101"><a href="import-and-format-data.html#cb84-101"></a>      <span class="cf">next</span>()</span>
<span id="cb84-102"><a href="import-and-format-data.html#cb84-102"></a>   }</span>
<span id="cb84-103"><a href="import-and-format-data.html#cb84-103"></a>   </span>
<span id="cb84-104"><a href="import-and-format-data.html#cb84-104"></a>   </span>
<span id="cb84-105"><a href="import-and-format-data.html#cb84-105"></a>   <span class="co"># when incidence = 8</span></span>
<span id="cb84-106"><a href="import-and-format-data.html#cb84-106"></a>   <span class="cf">if</span> ((<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">22</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">31</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="op">|</span></span>
<span id="cb84-107"><a href="import-and-format-data.html#cb84-107"></a><span class="st">        </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">22</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">31</span><span class="op">:</span><span class="dv">33</span>)]) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">200</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-108"><a href="import-and-format-data.html#cb84-108"></a><span class="st">       </span><span class="kw">all</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-109"><a href="import-and-format-data.html#cb84-109"></a><span class="st">       </span>(<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb84-110"><a href="import-and-format-data.html#cb84-110"></a><span class="st">        </span><span class="kw">length</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>]) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-111"><a href="import-and-format-data.html#cb84-111"></a><span class="st">       </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>]) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2000</span>) {</span>
<span id="cb84-112"><a href="import-and-format-data.html#cb84-112"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="dv">8</span></span>
<span id="cb84-113"><a href="import-and-format-data.html#cb84-113"></a>      <span class="cf">next</span>()</span>
<span id="cb84-114"><a href="import-and-format-data.html#cb84-114"></a>   }</span>
<span id="cb84-115"><a href="import-and-format-data.html#cb84-115"></a>   </span>
<span id="cb84-116"><a href="import-and-format-data.html#cb84-116"></a>   </span>
<span id="cb84-117"><a href="import-and-format-data.html#cb84-117"></a>   <span class="co"># when incidence = 9</span></span>
<span id="cb84-118"><a href="import-and-format-data.html#cb84-118"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">22</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">31</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-119"><a href="import-and-format-data.html#cb84-119"></a><span class="st">       </span><span class="kw">all</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-120"><a href="import-and-format-data.html#cb84-120"></a><span class="st">       </span>(<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb84-121"><a href="import-and-format-data.html#cb84-121"></a><span class="st">        </span><span class="kw">length</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>]) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-122"><a href="import-and-format-data.html#cb84-122"></a><span class="st">       </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>]) <span class="op">&gt;</span><span class="st"> </span><span class="dv">2000</span>) {</span>
<span id="cb84-123"><a href="import-and-format-data.html#cb84-123"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="dv">9</span></span>
<span id="cb84-124"><a href="import-and-format-data.html#cb84-124"></a>      <span class="cf">next</span>()</span>
<span id="cb84-125"><a href="import-and-format-data.html#cb84-125"></a>   }</span>
<span id="cb84-126"><a href="import-and-format-data.html#cb84-126"></a>   </span>
<span id="cb84-127"><a href="import-and-format-data.html#cb84-127"></a>   <span class="co"># if not in the lower canopy but small colonies in mid and upper canopy</span></span>
<span id="cb84-128"><a href="import-and-format-data.html#cb84-128"></a>   <span class="cf">if</span> (<span class="kw">all</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">18</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">27</span>)] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-129"><a href="import-and-format-data.html#cb84-129"></a><span class="st">       </span>(<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">10</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">19</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">28</span>, <span class="dv">33</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb84-130"><a href="import-and-format-data.html#cb84-130"></a><span class="st">        </span><span class="kw">length</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>]) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.5</span>)) {</span>
<span id="cb84-131"><a href="import-and-format-data.html#cb84-131"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="fl">2.5</span></span>
<span id="cb84-132"><a href="import-and-format-data.html#cb84-132"></a>      <span class="cf">next</span>()</span>
<span id="cb84-133"><a href="import-and-format-data.html#cb84-133"></a>   }</span>
<span id="cb84-134"><a href="import-and-format-data.html#cb84-134"></a>   </span>
<span id="cb84-135"><a href="import-and-format-data.html#cb84-135"></a>   </span>
<span id="cb84-136"><a href="import-and-format-data.html#cb84-136"></a>   <span class="co"># incidence = 7.5</span></span>
<span id="cb84-137"><a href="import-and-format-data.html#cb84-137"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">22</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">31</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-138"><a href="import-and-format-data.html#cb84-138"></a><span class="st">       </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-139"><a href="import-and-format-data.html#cb84-139"></a><span class="st">       </span><span class="kw">any</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-140"><a href="import-and-format-data.html#cb84-140"></a><span class="st">       </span>(<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb84-141"><a href="import-and-format-data.html#cb84-141"></a><span class="st">        </span><span class="kw">length</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>]) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.7</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-142"><a href="import-and-format-data.html#cb84-142"></a><span class="st">       </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>]) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2000</span>) {</span>
<span id="cb84-143"><a href="import-and-format-data.html#cb84-143"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="fl">7.5</span></span>
<span id="cb84-144"><a href="import-and-format-data.html#cb84-144"></a>      <span class="cf">next</span>()</span>
<span id="cb84-145"><a href="import-and-format-data.html#cb84-145"></a>   }</span>
<span id="cb84-146"><a href="import-and-format-data.html#cb84-146"></a>   </span>
<span id="cb84-147"><a href="import-and-format-data.html#cb84-147"></a>   <span class="co"># incidence = 6.5</span></span>
<span id="cb84-148"><a href="import-and-format-data.html#cb84-148"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">22</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">31</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-149"><a href="import-and-format-data.html#cb84-149"></a><span class="st">       </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">12</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-150"><a href="import-and-format-data.html#cb84-150"></a><span class="st">       </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-151"><a href="import-and-format-data.html#cb84-151"></a><span class="st">       </span>(<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb84-152"><a href="import-and-format-data.html#cb84-152"></a><span class="st">        </span><span class="kw">length</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>]) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-153"><a href="import-and-format-data.html#cb84-153"></a><span class="st">       </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>]) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2000</span>) {</span>
<span id="cb84-154"><a href="import-and-format-data.html#cb84-154"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="fl">6.5</span></span>
<span id="cb84-155"><a href="import-and-format-data.html#cb84-155"></a>      <span class="cf">next</span>()</span>
<span id="cb84-156"><a href="import-and-format-data.html#cb84-156"></a>   }</span>
<span id="cb84-157"><a href="import-and-format-data.html#cb84-157"></a>   </span>
<span id="cb84-158"><a href="import-and-format-data.html#cb84-158"></a>   </span>
<span id="cb84-159"><a href="import-and-format-data.html#cb84-159"></a>   <span class="co"># incidence = 4.5</span></span>
<span id="cb84-160"><a href="import-and-format-data.html#cb84-160"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">22</span><span class="op">:</span><span class="dv">24</span>, <span class="dv">31</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-161"><a href="import-and-format-data.html#cb84-161"></a><span class="st">       </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-162"><a href="import-and-format-data.html#cb84-162"></a><span class="st">       </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">21</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">30</span>)] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> <span class="op">&amp;&amp;</span></span>
<span id="cb84-163"><a href="import-and-format-data.html#cb84-163"></a><span class="st">       </span>(<span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb84-164"><a href="import-and-format-data.html#cb84-164"></a><span class="st">        </span><span class="kw">length</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>]) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb84-165"><a href="import-and-format-data.html#cb84-165"></a><span class="st">       </span><span class="kw">sum</span>(Goolhi<span class="fl">.13</span>[i, <span class="dv">7</span><span class="op">:</span><span class="dv">33</span>]) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2000</span>) {</span>
<span id="cb84-166"><a href="import-and-format-data.html#cb84-166"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="fl">4.5</span></span>
<span id="cb84-167"><a href="import-and-format-data.html#cb84-167"></a>      <span class="cf">next</span>()</span>
<span id="cb84-168"><a href="import-and-format-data.html#cb84-168"></a>   } <span class="cf">else</span>{</span>
<span id="cb84-169"><a href="import-and-format-data.html#cb84-169"></a>      <span class="co"># If none of the conditions are met give the incidence zero</span></span>
<span id="cb84-170"><a href="import-and-format-data.html#cb84-170"></a>      incidence1[i] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb84-171"><a href="import-and-format-data.html#cb84-171"></a>   }</span>
<span id="cb84-172"><a href="import-and-format-data.html#cb84-172"></a>   </span>
<span id="cb84-173"><a href="import-and-format-data.html#cb84-173"></a>}</span>
<span id="cb84-174"><a href="import-and-format-data.html#cb84-174"></a></span>
<span id="cb84-175"><a href="import-and-format-data.html#cb84-175"></a><span class="co"># check data to make sure there are no zeros</span></span>
<span id="cb84-176"><a href="import-and-format-data.html#cb84-176"></a>incidence1</span>
<span id="cb84-177"><a href="import-and-format-data.html#cb84-177"></a><span class="kw">length</span>(Goolhi<span class="fl">.13</span>[incidence1 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb84-178"><a href="import-and-format-data.html#cb84-178"></a>Goolhi<span class="fl">.13</span>[incidence1 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, ]</span>
<span id="cb84-179"><a href="import-and-format-data.html#cb84-179"></a><span class="kw">hist</span>(incidence1)</span>
<span id="cb84-180"><a href="import-and-format-data.html#cb84-180"></a></span>
<span id="cb84-181"><a href="import-and-format-data.html#cb84-181"></a><span class="co"># Re-format data-frame</span></span>
<span id="cb84-182"><a href="import-and-format-data.html#cb84-182"></a><span class="cf">if</span>(D_assessment <span class="op">==</span><span class="st"> &quot;16 DAT1&quot;</span>){</span>
<span id="cb84-183"><a href="import-and-format-data.html#cb84-183"></a>Goolhi<span class="fl">.13</span>D &lt;-<span class="st"> </span>Goolhi<span class="fl">.13</span>[,<span class="kw">c</span>(<span class="st">&quot;Treat&quot;</span>, <span class="st">&quot;Rep&quot;</span>, <span class="st">&quot;Run&quot;</span>, <span class="st">&quot;Plot&quot;</span>)]</span>
<span id="cb84-184"><a href="import-and-format-data.html#cb84-184"></a>Goolhi<span class="fl">.13</span>D<span class="op">$</span>Inc_16D &lt;-<span class="st">  </span>incidence1</span>
<span id="cb84-185"><a href="import-and-format-data.html#cb84-185"></a></span>
<span id="cb84-186"><a href="import-and-format-data.html#cb84-186"></a>} </span>
<span id="cb84-187"><a href="import-and-format-data.html#cb84-187"></a></span>
<span id="cb84-188"><a href="import-and-format-data.html#cb84-188"></a><span class="cf">if</span>(D_assessment <span class="op">==</span><span class="st"> &quot;33DAT1&quot;</span>){</span>
<span id="cb84-189"><a href="import-and-format-data.html#cb84-189"></a>Goolhi<span class="fl">.13</span>D<span class="op">$</span>Inc_33D &lt;-<span class="st">  </span>incidence1</span>
<span id="cb84-190"><a href="import-and-format-data.html#cb84-190"></a>}</span>
<span id="cb84-191"><a href="import-and-format-data.html#cb84-191"></a>}</span></code></pre></div>
<pre><code>## New names:
## * `` -&gt; ...6
## * `1` -&gt; `1...7`
## * `2` -&gt; `2...8`
## * `3` -&gt; `3...9`
## * `1` -&gt; `1...10`
## * ...
## New names:
## * `` -&gt; ...6
## * `1` -&gt; `1...7`
## * `2` -&gt; `2...8`
## * `3` -&gt; `3...9`
## * `1` -&gt; `1...10`
## * ...</code></pre>
<p><img src="_main_files/figure-html/Goolhi_2013-1.png" width="672" /><img src="_main_files/figure-html/Goolhi_2013-2.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="import-and-format-data.html#cb86-1"></a><span class="co">#_____________________</span></span>
<span id="cb86-2"><a href="import-and-format-data.html#cb86-2"></a><span class="co"># Read in Harvest data</span></span>
<span id="cb86-3"><a href="import-and-format-data.html#cb86-3"></a>Goolhi<span class="fl">.13</span>Y &lt;-</span>
<span id="cb86-4"><a href="import-and-format-data.html#cb86-4"></a><span class="st">   </span><span class="kw">as.data.frame</span>(</span>
<span id="cb86-5"><a href="import-and-format-data.html#cb86-5"></a>      <span class="kw">read_xlsx</span>(</span>
<span id="cb86-6"><a href="import-and-format-data.html#cb86-6"></a>         <span class="dt">path =</span> <span class="kw">here</span>(<span class="st">&quot;data/AM1305 Fungicides for powdery mildew in mungbean - Goolhi.xlsx&quot;</span>),</span>
<span id="cb86-7"><a href="import-and-format-data.html#cb86-7"></a>         <span class="dt">sheet =</span> <span class="st">&quot;Yield&quot;</span>,</span>
<span id="cb86-8"><a href="import-and-format-data.html#cb86-8"></a>         <span class="dt">range =</span> <span class="st">&quot;A15:F75&quot;</span>,</span>
<span id="cb86-9"><a href="import-and-format-data.html#cb86-9"></a>         <span class="dt">col_names =</span> <span class="ot">TRUE</span></span>
<span id="cb86-10"><a href="import-and-format-data.html#cb86-10"></a>      )</span>
<span id="cb86-11"><a href="import-and-format-data.html#cb86-11"></a>   )</span>
<span id="cb86-12"><a href="import-and-format-data.html#cb86-12"></a>Goolhi<span class="fl">.13</span>Y &lt;-<span class="st"> </span>Goolhi<span class="fl">.13</span>Y[<span class="kw">order</span>(Goolhi<span class="fl">.13</span>Y[,<span class="dv">1</span>],Goolhi<span class="fl">.13</span>Y[,<span class="dv">2</span>],Goolhi<span class="fl">.13</span>Y[,<span class="dv">3</span>],Goolhi<span class="fl">.13</span>Y[,<span class="dv">4</span>]),]</span>
<span id="cb86-13"><a href="import-and-format-data.html#cb86-13"></a></span>
<span id="cb86-14"><a href="import-and-format-data.html#cb86-14"></a></span>
<span id="cb86-15"><a href="import-and-format-data.html#cb86-15"></a><span class="co"># Join disease and Yield data</span></span>
<span id="cb86-16"><a href="import-and-format-data.html#cb86-16"></a>Goolhi_<span class="dv">13</span> &lt;-<span class="st"> </span><span class="kw">left_join</span>(Goolhi<span class="fl">.13</span>D, Goolhi<span class="fl">.13</span>Y)</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;Treat&quot;, &quot;Rep&quot;, &quot;Run&quot;, &quot;Plot&quot;)</code></pre>
</div>
<div id="define-treatment-data-1" class="section level4">
<h4><span class="header-section-number">3.4.4.2</span> Define treatment data</h4>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="import-and-format-data.html#cb88-1"></a>Goolhi_<span class="dv">13</span> &lt;-<span class="st"> </span>Goolhi_<span class="dv">13</span> <span class="op">%&gt;%</span></span>
<span id="cb88-2"><a href="import-and-format-data.html#cb88-2"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trade_name =</span> </span>
<span id="cb88-3"><a href="import-and-format-data.html#cb88-3"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb88-4"><a href="import-and-format-data.html#cb88-4"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> &quot;Spin-flo&quot;</span>,</span>
<span id="cb88-5"><a href="import-and-format-data.html#cb88-5"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> &quot;Tilt&quot;</span>,</span>
<span id="cb88-6"><a href="import-and-format-data.html#cb88-6"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra&quot;</span>,</span>
<span id="cb88-7"><a href="import-and-format-data.html#cb88-7"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra + adj&quot;</span>,</span>
<span id="cb88-8"><a href="import-and-format-data.html#cb88-8"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> &quot;Cabrio&quot;</span>,</span>
<span id="cb88-9"><a href="import-and-format-data.html#cb88-9"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> &quot;Spin-flo&quot;</span>,</span>
<span id="cb88-10"><a href="import-and-format-data.html#cb88-10"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> &quot;Tilt&quot;</span>,</span>
<span id="cb88-11"><a href="import-and-format-data.html#cb88-11"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra + adj&quot;</span>,</span>
<span id="cb88-12"><a href="import-and-format-data.html#cb88-12"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> &quot;Cabrio&quot;</span>,</span>
<span id="cb88-13"><a href="import-and-format-data.html#cb88-13"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> &quot;Tilt&quot;</span>,</span>
<span id="cb88-14"><a href="import-and-format-data.html#cb88-14"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb88-15"><a href="import-and-format-data.html#cb88-15"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_ai =</span> </span>
<span id="cb88-16"><a href="import-and-format-data.html#cb88-16"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb88-17"><a href="import-and-format-data.html#cb88-17"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> &quot;carbendazim&quot;</span>,</span>
<span id="cb88-18"><a href="import-and-format-data.html#cb88-18"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb88-19"><a href="import-and-format-data.html#cb88-19"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb88-20"><a href="import-and-format-data.html#cb88-20"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb88-21"><a href="import-and-format-data.html#cb88-21"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> &quot;pyraclostrobin&quot;</span>,</span>
<span id="cb88-22"><a href="import-and-format-data.html#cb88-22"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> &quot;carbendazim&quot;</span>,</span>
<span id="cb88-23"><a href="import-and-format-data.html#cb88-23"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb88-24"><a href="import-and-format-data.html#cb88-24"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb88-25"><a href="import-and-format-data.html#cb88-25"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> &quot;pyraclostrobin&quot;</span>,</span>
<span id="cb88-26"><a href="import-and-format-data.html#cb88-26"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb88-27"><a href="import-and-format-data.html#cb88-27"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb88-28"><a href="import-and-format-data.html#cb88-28"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> </span>
<span id="cb88-29"><a href="import-and-format-data.html#cb88-29"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb88-30"><a href="import-and-format-data.html#cb88-30"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">250</span>,</span>
<span id="cb88-31"><a href="import-and-format-data.html#cb88-31"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.5</span>,</span>
<span id="cb88-32"><a href="import-and-format-data.html#cb88-32"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">40</span>,</span>
<span id="cb88-33"><a href="import-and-format-data.html#cb88-33"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">40</span>,</span>
<span id="cb88-34"><a href="import-and-format-data.html#cb88-34"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">125</span>,</span>
<span id="cb88-35"><a href="import-and-format-data.html#cb88-35"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">250</span>,</span>
<span id="cb88-36"><a href="import-and-format-data.html#cb88-36"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.5</span>,</span>
<span id="cb88-37"><a href="import-and-format-data.html#cb88-37"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">40</span>,</span>
<span id="cb88-38"><a href="import-and-format-data.html#cb88-38"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">125</span>,</span>
<span id="cb88-39"><a href="import-and-format-data.html#cb88-39"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.5</span>,</span>
<span id="cb88-40"><a href="import-and-format-data.html#cb88-40"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>))<span class="op">%&gt;%</span></span>
<span id="cb88-41"><a href="import-and-format-data.html#cb88-41"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_1 =</span> </span>
<span id="cb88-42"><a href="import-and-format-data.html#cb88-42"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb88-43"><a href="import-and-format-data.html#cb88-43"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-44"><a href="import-and-format-data.html#cb88-44"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-45"><a href="import-and-format-data.html#cb88-45"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-46"><a href="import-and-format-data.html#cb88-46"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-47"><a href="import-and-format-data.html#cb88-47"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-48"><a href="import-and-format-data.html#cb88-48"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-49"><a href="import-and-format-data.html#cb88-49"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-50"><a href="import-and-format-data.html#cb88-50"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-51"><a href="import-and-format-data.html#cb88-51"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-52"><a href="import-and-format-data.html#cb88-52"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-53"><a href="import-and-format-data.html#cb88-53"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb88-54"><a href="import-and-format-data.html#cb88-54"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_2 =</span> </span>
<span id="cb88-55"><a href="import-and-format-data.html#cb88-55"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-04-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-56"><a href="import-and-format-data.html#cb88-56"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-04-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-57"><a href="import-and-format-data.html#cb88-57"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-04-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-58"><a href="import-and-format-data.html#cb88-58"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-04-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-59"><a href="import-and-format-data.html#cb88-59"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-04-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-60"><a href="import-and-format-data.html#cb88-60"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb88-61"><a href="import-and-format-data.html#cb88-61"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_3 =</span> </span>
<span id="cb88-62"><a href="import-and-format-data.html#cb88-62"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-04-27&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb88-63"><a href="import-and-format-data.html#cb88-63"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb88-64"><a href="import-and-format-data.html#cb88-64"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">spray_n =</span> </span>
<span id="cb88-65"><a href="import-and-format-data.html#cb88-65"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb88-66"><a href="import-and-format-data.html#cb88-66"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb88-67"><a href="import-and-format-data.html#cb88-67"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb88-68"><a href="import-and-format-data.html#cb88-68"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb88-69"><a href="import-and-format-data.html#cb88-69"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb88-70"><a href="import-and-format-data.html#cb88-70"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,</span>
<span id="cb88-71"><a href="import-and-format-data.html#cb88-71"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="input-trial-data-2" class="section level4">
<h4><span class="header-section-number">3.4.4.3</span> Input trial data</h4>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="import-and-format-data.html#cb89-1"></a>Goolhi_<span class="dv">13</span>_dat &lt;-<span class="st"> </span></span>
<span id="cb89-2"><a href="import-and-format-data.html#cb89-2"></a><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">trial_ref =</span> <span class="st">&quot;AM1305&quot;</span>,</span>
<span id="cb89-3"><a href="import-and-format-data.html#cb89-3"></a>              <span class="dt">year =</span> <span class="st">&quot;2013&quot;</span>,</span>
<span id="cb89-4"><a href="import-and-format-data.html#cb89-4"></a>              <span class="dt">location =</span> <span class="st">&quot;Goolhi&quot;</span>,</span>
<span id="cb89-5"><a href="import-and-format-data.html#cb89-5"></a>              <span class="dt">host_genotype =</span> <span class="st">&quot;Crystal&quot;</span>,</span>
<span id="cb89-6"><a href="import-and-format-data.html#cb89-6"></a>              <span class="dt">trial_design =</span> <span class="st">&quot;RB&quot;</span>,</span>
<span id="cb89-7"><a href="import-and-format-data.html#cb89-7"></a>              <span class="dt">plot_length =</span> <span class="dv">12</span>,</span>
<span id="cb89-8"><a href="import-and-format-data.html#cb89-8"></a>              <span class="dt">plot_width =</span> <span class="dv">4</span>,</span>
<span id="cb89-9"><a href="import-and-format-data.html#cb89-9"></a>              <span class="dt">plant_density =</span> <span class="ot">NA</span>,</span>
<span id="cb89-10"><a href="import-and-format-data.html#cb89-10"></a>              <span class="dt">row_spacing =</span> <span class="fl">0.33</span>,</span>
<span id="cb89-11"><a href="import-and-format-data.html#cb89-11"></a>              <span class="dt">replicate =</span> Goolhi_<span class="dv">13</span><span class="op">$</span>Rep,</span>
<span id="cb89-12"><a href="import-and-format-data.html#cb89-12"></a>              <span class="dt">planting_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-01-23&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb89-13"><a href="import-and-format-data.html#cb89-13"></a>              <span class="dt">emergence_date =</span> <span class="ot">NA</span>,</span>
<span id="cb89-14"><a href="import-and-format-data.html#cb89-14"></a>              <span class="dt">flowering_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-04-04&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb89-15"><a href="import-and-format-data.html#cb89-15"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-04-18&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb89-16"><a href="import-and-format-data.html#cb89-16"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="ot">NA</span>,</span>
<span id="cb89-17"><a href="import-and-format-data.html#cb89-17"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-03-25&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb89-18"><a href="import-and-format-data.html#cb89-18"></a>              <span class="dt">trade_name =</span> <span class="kw">as.factor</span>(Goolhi_<span class="dv">13</span><span class="op">$</span>trade_name),</span>
<span id="cb89-19"><a href="import-and-format-data.html#cb89-19"></a>              <span class="dt">fungicide_ai =</span> Goolhi_<span class="dv">13</span><span class="op">$</span>fungicide_ai,</span>
<span id="cb89-20"><a href="import-and-format-data.html#cb89-20"></a>              <span class="dt">dose_ai.ha =</span> Goolhi_<span class="dv">13</span><span class="op">$</span>dose_ai.ha,</span>
<span id="cb89-21"><a href="import-and-format-data.html#cb89-21"></a>              <span class="dt">n_treatment =</span> Goolhi_<span class="dv">13</span><span class="op">$</span>Treat,</span>
<span id="cb89-22"><a href="import-and-format-data.html#cb89-22"></a>              <span class="dt">fungicide_application_1 =</span> Goolhi_<span class="dv">13</span><span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb89-23"><a href="import-and-format-data.html#cb89-23"></a>              <span class="dt">fungicide_application_2 =</span> Goolhi_<span class="dv">13</span><span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb89-24"><a href="import-and-format-data.html#cb89-24"></a>              <span class="dt">fungicide_application_3 =</span> Goolhi_<span class="dv">13</span><span class="op">$</span>fungicide_application_<span class="dv">3</span>,</span>
<span id="cb89-25"><a href="import-and-format-data.html#cb89-25"></a>              <span class="dt">total_fungicide =</span> Goolhi_<span class="dv">13</span><span class="op">$</span>spray_n,</span>
<span id="cb89-26"><a href="import-and-format-data.html#cb89-26"></a>              <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-06-20&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb89-27"><a href="import-and-format-data.html#cb89-27"></a>              <span class="dt">final_assessment =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-04-30&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb89-28"><a href="import-and-format-data.html#cb89-28"></a>              <span class="dt">PM_final_severity =</span> Goolhi_<span class="dv">13</span><span class="op">$</span>Inc_33D,</span>
<span id="cb89-29"><a href="import-and-format-data.html#cb89-29"></a>              <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb89-30"><a href="import-and-format-data.html#cb89-30"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">as.numeric</span>(Goolhi_<span class="dv">13</span><span class="op">$</span><span class="st">`</span><span class="dt">Yield Kg/ha</span><span class="st">`</span>)<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb89-31"><a href="import-and-format-data.html#cb89-31"></a>              )</span></code></pre></div>
</div>
<div id="audpc-curve-3" class="section level4">
<h4><span class="header-section-number">3.4.4.4</span> AUDPC curve</h4>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="import-and-format-data.html#cb90-1"></a>Goolhi_<span class="dv">13</span>_dat &lt;-<span class="st"> </span><span class="kw">cbind</span>(Goolhi_<span class="dv">13</span>_dat,</span>
<span id="cb90-2"><a href="import-and-format-data.html#cb90-2"></a>                          <span class="dt">AUDPC =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb90-3"><a href="import-and-format-data.html#cb90-3"></a>                                                   Goolhi_<span class="dv">13</span>[,<span class="kw">c</span>(<span class="st">&quot;Inc_16D&quot;</span>,<span class="st">&quot;Inc_33D&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb90-4"><a href="import-and-format-data.html#cb90-4"></a>                                        <span class="dv">1</span>, </span>
<span id="cb90-5"><a href="import-and-format-data.html#cb90-5"></a>                                        <span class="dt">FUN =</span> audpc, </span>
<span id="cb90-6"><a href="import-and-format-data.html#cb90-6"></a>                                        <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">16</span>,<span class="dv">33</span>)</span>
<span id="cb90-7"><a href="import-and-format-data.html#cb90-7"></a>                                        ),</span>
<span id="cb90-8"><a href="import-and-format-data.html#cb90-8"></a>                     <span class="dt">AUDPS =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb90-9"><a href="import-and-format-data.html#cb90-9"></a>                                                   Goolhi_<span class="dv">13</span>[,<span class="kw">c</span>(<span class="st">&quot;Inc_16D&quot;</span>,<span class="st">&quot;Inc_33D&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb90-10"><a href="import-and-format-data.html#cb90-10"></a>                                        <span class="dv">1</span>, </span>
<span id="cb90-11"><a href="import-and-format-data.html#cb90-11"></a>                                        <span class="dt">FUN =</span> audps, </span>
<span id="cb90-12"><a href="import-and-format-data.html#cb90-12"></a>                                        <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">16</span>,<span class="dv">33</span>)</span>
<span id="cb90-13"><a href="import-and-format-data.html#cb90-13"></a>                                        )</span>
<span id="cb90-14"><a href="import-and-format-data.html#cb90-14"></a>                          )</span></code></pre></div>
</div>
<div id="calculating-the-treatment-means" class="section level4">
<h4><span class="header-section-number">3.4.4.5</span> Calculating the treatment means</h4>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="import-and-format-data.html#cb91-1"></a>Goolhi_<span class="dv">13</span>_m &lt;-<span class="st"> </span>Goolhi_<span class="dv">13</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb91-2"><a href="import-and-format-data.html#cb91-2"></a><span class="st">   </span><span class="kw">group_by</span>(trial_ref, year, location, host_genotype, trial_design, </span>
<span id="cb91-3"><a href="import-and-format-data.html#cb91-3"></a>            trade_name,fungicide_ai,dose_ai.ha,n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb91-4"><a href="import-and-format-data.html#cb91-4"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb91-5"><a href="import-and-format-data.html#cb91-5"></a>              <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb91-6"><a href="import-and-format-data.html#cb91-6"></a>              <span class="dt">plant_density =</span> <span class="kw">unique</span>(plant_density),</span>
<span id="cb91-7"><a href="import-and-format-data.html#cb91-7"></a>              <span class="dt">row_spacing =</span> <span class="kw">unique</span>(row_spacing),</span>
<span id="cb91-8"><a href="import-and-format-data.html#cb91-8"></a>              <span class="dt">replicates =</span> <span class="kw">length</span>(replicate),</span>
<span id="cb91-9"><a href="import-and-format-data.html#cb91-9"></a>              <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb91-10"><a href="import-and-format-data.html#cb91-10"></a>              <span class="dt">emergence_date =</span> <span class="ot">NA</span>,</span>
<span id="cb91-11"><a href="import-and-format-data.html#cb91-11"></a>              <span class="dt">flowering_date =</span> <span class="kw">unique</span>(flowering_date),</span>
<span id="cb91-12"><a href="import-and-format-data.html#cb91-12"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">unique</span>(pod_fill_date),</span>
<span id="cb91-13"><a href="import-and-format-data.html#cb91-13"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="kw">unique</span>(mid_late_pod_fill),</span>
<span id="cb91-14"><a href="import-and-format-data.html#cb91-14"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb91-15"><a href="import-and-format-data.html#cb91-15"></a>              <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb91-16"><a href="import-and-format-data.html#cb91-16"></a>              <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb91-17"><a href="import-and-format-data.html#cb91-17"></a>              <span class="dt">fungicide_application_3 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">3</span>),</span>
<span id="cb91-18"><a href="import-and-format-data.html#cb91-18"></a>              <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb91-19"><a href="import-and-format-data.html#cb91-19"></a>              <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb91-20"><a href="import-and-format-data.html#cb91-20"></a>              <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb91-21"><a href="import-and-format-data.html#cb91-21"></a>              <span class="dt">PM_final_severity =</span> <span class="kw">mean</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb91-22"><a href="import-and-format-data.html#cb91-22"></a>              <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb91-23"><a href="import-and-format-data.html#cb91-23"></a>              <span class="co">#disease_error = sd(PM_final_severity, na.rm = TRUE), # Commented because were not being calculated and included in the summary function</span></span>
<span id="cb91-24"><a href="import-and-format-data.html#cb91-24"></a>              <span class="dt">D_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb91-25"><a href="import-and-format-data.html#cb91-25"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb91-26"><a href="import-and-format-data.html#cb91-26"></a>              <span class="dt">raw_graded =</span> <span class="ot">NA</span>,</span>
<span id="cb91-27"><a href="import-and-format-data.html#cb91-27"></a>              <span class="co">#yield_error = sd(grain_yield.t.ha., na.rm = TRUE), # Commented because were not being calculated and included in the summary function</span></span>
<span id="cb91-28"><a href="import-and-format-data.html#cb91-28"></a>              <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb91-29"><a href="import-and-format-data.html#cb91-29"></a>             <span class="dt">AUDPC_m =</span> <span class="kw">mean</span>(AUDPC),</span>
<span id="cb91-30"><a href="import-and-format-data.html#cb91-30"></a>             <span class="dt">AUDPC_sd =</span> <span class="kw">sd</span>(AUDPC),</span>
<span id="cb91-31"><a href="import-and-format-data.html#cb91-31"></a>             <span class="dt">AUDPS_m =</span> <span class="kw">mean</span>(AUDPS),</span>
<span id="cb91-32"><a href="import-and-format-data.html#cb91-32"></a>             <span class="dt">AUDPS_sd =</span> <span class="kw">sd</span>(AUDPS),</span>
<span id="cb91-33"><a href="import-and-format-data.html#cb91-33"></a>             <span class="dt">Inc_Ms =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), </span>
<span id="cb91-34"><a href="import-and-format-data.html#cb91-34"></a>                               <span class="dt">data =</span> Goolhi_<span class="dv">13</span>_dat[Goolhi_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;propiconazole&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb91-35"><a href="import-and-format-data.html#cb91-35"></a><span class="st">                                                        </span>Goolhi_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span> ,]))[<span class="dv">1</span>,<span class="dv">3</span>],</span>
<span id="cb91-36"><a href="import-and-format-data.html#cb91-36"></a>              <span class="dt">Y_Msquare =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), </span>
<span id="cb91-37"><a href="import-and-format-data.html#cb91-37"></a>                                <span class="dt">data =</span> Goolhi_<span class="dv">13</span>_dat[Goolhi_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;propiconazole&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb91-38"><a href="import-and-format-data.html#cb91-38"></a><span class="st">                                                        </span>Goolhi_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span> ,]))[<span class="dv">1</span>,<span class="dv">3</span>]</span>
<span id="cb91-39"><a href="import-and-format-data.html#cb91-39"></a>   )</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;trial_ref&#39;, &#39;year&#39;, &#39;location&#39;, &#39;host_genotype&#39;, &#39;trial_design&#39;, &#39;trade_name&#39;, &#39;fungicide_ai&#39;, &#39;dose_ai.ha&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="import-and-format-data.html#cb93-1"></a><span class="co"># For some wierd reason standard deviations are comming back NA in the code above</span></span>
<span id="cb93-2"><a href="import-and-format-data.html#cb93-2"></a><span class="co"># Because of n_treatment being converted to a factor I need to wrangle carefully here</span></span>
<span id="cb93-3"><a href="import-and-format-data.html#cb93-3"></a>Goolhi_tmp &lt;-<span class="st"> </span>Goolhi_<span class="dv">13</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb93-4"><a href="import-and-format-data.html#cb93-4"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb93-5"><a href="import-and-format-data.html#cb93-5"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb93-6"><a href="import-and-format-data.html#cb93-6"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="import-and-format-data.html#cb95-1"></a>Goolhi_<span class="dv">13</span>_m &lt;-<span class="st"> </span><span class="kw">left_join</span>(Goolhi_<span class="dv">13</span>_m, Goolhi_tmp)</span></code></pre></div>
<pre><code>## Joining, by = &quot;n_treatment&quot;</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="import-and-format-data.html#cb97-1"></a>Goolhi_<span class="dv">13</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(Goolhi_<span class="dv">13</span>_m, PM_MB_means)</span>
<span id="cb97-2"><a href="import-and-format-data.html#cb97-2"></a>Goolhi_<span class="dv">13</span>_m &lt;-<span class="st"> </span>Goolhi_<span class="dv">13</span>_m[Goolhi_<span class="dv">13</span>_m<span class="op">$</span>trade_name <span class="op">!=</span><span class="st"> &quot;other&quot;</span>,]</span>
<span id="cb97-3"><a href="import-and-format-data.html#cb97-3"></a></span>
<span id="cb97-4"><a href="import-and-format-data.html#cb97-4"></a><span class="co"># insert new calculations into data</span></span>
<span id="cb97-5"><a href="import-and-format-data.html#cb97-5"></a>PM_MB_means &lt;-<span class="st"> </span><span class="kw">replace_data</span>(<span class="dt">template_data =</span> PM_MB_means, </span>
<span id="cb97-6"><a href="import-and-format-data.html#cb97-6"></a>                            <span class="dt">new_data =</span> Goolhi_<span class="dv">13</span>_m, </span>
<span id="cb97-7"><a href="import-and-format-data.html#cb97-7"></a>                            <span class="dt">new_data_column =</span> <span class="kw">c</span>(<span class="st">&quot;planting_date&quot;</span>,<span class="st">&quot;AUDPC_m&quot;</span>, <span class="st">&quot;AUDPC_sd&quot;</span>, <span class="st">&quot;AUDPS_m&quot;</span>,<span class="st">&quot;AUDPS_sd&quot;</span>,<span class="st">&quot;Y_Msquare&quot;</span>, <span class="st">&quot;Inc_Ms&quot;</span>),</span>
<span id="cb97-8"><a href="import-and-format-data.html#cb97-8"></a>                            <span class="dt">filter_cols =</span> <span class="kw">c</span>(<span class="st">&quot;trial_ref&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;location&quot;</span>, <span class="st">&quot;host_genotype&quot;</span>, </span>
<span id="cb97-9"><a href="import-and-format-data.html#cb97-9"></a>                                           <span class="st">&quot;fungicide_ai&quot;</span>, <span class="st">&quot;dose_ai.ha&quot;</span>,<span class="st">&quot;n_treatment&quot;</span>))</span></code></pre></div>
<pre><code>## No data changed 0/11</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="import-and-format-data.html#cb99-1"></a><span class="kw">write.csv</span>(</span>
<span id="cb99-2"><a href="import-and-format-data.html#cb99-2"></a>   Goolhi_<span class="dv">13</span>_m,</span>
<span id="cb99-3"><a href="import-and-format-data.html#cb99-3"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/AM1305_Goolhi_means.csv&quot;</span>),<span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb99-4"><a href="import-and-format-data.html#cb99-4"></a>)</span></code></pre></div>
</div>
</div>
<div id="marys-mount-2013" class="section level3">
<h3><span class="header-section-number">3.4.5</span> Mary’s Mount 2013</h3>
<div id="convert-disease-scores-1" class="section level4">
<h4><span class="header-section-number">3.4.5.1</span> Convert disease scores</h4>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="import-and-format-data.html#cb100-1"></a><span class="cf">for</span>(D_assess <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;18 DAT1 18-3-2013&quot;</span>,<span class="st">&quot;19 DAT1 19-3-2013&quot;</span>)){</span>
<span id="cb100-2"><a href="import-and-format-data.html#cb100-2"></a></span>
<span id="cb100-3"><a href="import-and-format-data.html#cb100-3"></a><span class="co"># Import  disease survey</span></span>
<span id="cb100-4"><a href="import-and-format-data.html#cb100-4"></a>MarysM<span class="fl">.13</span>D &lt;-</span>
<span id="cb100-5"><a href="import-and-format-data.html#cb100-5"></a><span class="st">   </span><span class="kw">as.data.frame</span>(</span>
<span id="cb100-6"><a href="import-and-format-data.html#cb100-6"></a>      <span class="kw">read_xlsx</span>(</span>
<span id="cb100-7"><a href="import-and-format-data.html#cb100-7"></a>         <span class="dt">path =</span> <span class="kw">here</span>(<span class="st">&quot;data/AM1304 Fungicides for powdery mildew in mungbean - Marys Mount.xlsx&quot;</span>),</span>
<span id="cb100-8"><a href="import-and-format-data.html#cb100-8"></a>         <span class="dt">sheet =</span> D_assess,</span>
<span id="cb100-9"><a href="import-and-format-data.html#cb100-9"></a>         <span class="dt">range =</span> <span class="st">&quot;A14:DC72&quot;</span>,</span>
<span id="cb100-10"><a href="import-and-format-data.html#cb100-10"></a>         <span class="dt">col_names =</span> <span class="ot">TRUE</span></span>
<span id="cb100-11"><a href="import-and-format-data.html#cb100-11"></a>      )</span>
<span id="cb100-12"><a href="import-and-format-data.html#cb100-12"></a>   )</span>
<span id="cb100-13"><a href="import-and-format-data.html#cb100-13"></a></span>
<span id="cb100-14"><a href="import-and-format-data.html#cb100-14"></a><span class="kw">colnames</span>(MarysM<span class="fl">.13</span>D)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Treat&quot;</span>, <span class="st">&quot;Rep&quot;</span>, <span class="st">&quot;Run&quot;</span>, <span class="st">&quot;Plot&quot;</span>)</span>
<span id="cb100-15"><a href="import-and-format-data.html#cb100-15"></a>MarysM<span class="fl">.13</span>D &lt;-<span class="st"> </span>MarysM<span class="fl">.13</span>D[<span class="kw">order</span>(MarysM<span class="fl">.13</span>D[,<span class="dv">1</span>],MarysM<span class="fl">.13</span>D[,<span class="dv">2</span>],MarysM<span class="fl">.13</span>D[,<span class="dv">3</span>],MarysM<span class="fl">.13</span>D[,<span class="dv">4</span>]),]</span>
<span id="cb100-16"><a href="import-and-format-data.html#cb100-16"></a></span>
<span id="cb100-17"><a href="import-and-format-data.html#cb100-17"></a><span class="cf">if</span>(D_assess <span class="op">==</span><span class="st"> &quot;18 DAT1 18-3-2013&quot;</span>){</span>
<span id="cb100-18"><a href="import-and-format-data.html#cb100-18"></a>   col_ref &lt;-<span class="st"> </span><span class="dv">33</span><span class="op">:</span><span class="dv">57</span></span>
<span id="cb100-19"><a href="import-and-format-data.html#cb100-19"></a>   col_ref2 &lt;-<span class="st"> </span><span class="dv">7</span><span class="op">:</span><span class="dv">31</span></span>
<span id="cb100-20"><a href="import-and-format-data.html#cb100-20"></a>}</span>
<span id="cb100-21"><a href="import-and-format-data.html#cb100-21"></a><span class="cf">if</span>(D_assess <span class="op">==</span><span class="st"> &quot;19 DAT1 19-3-2013&quot;</span>){</span>
<span id="cb100-22"><a href="import-and-format-data.html#cb100-22"></a>   col_ref &lt;-<span class="st"> </span><span class="dv">58</span><span class="op">:</span><span class="dv">107</span></span>
<span id="cb100-23"><a href="import-and-format-data.html#cb100-23"></a>   col_ref2 &lt;-<span class="st"> </span><span class="dv">7</span><span class="op">:</span><span class="dv">56</span></span>
<span id="cb100-24"><a href="import-and-format-data.html#cb100-24"></a>}</span>
<span id="cb100-25"><a href="import-and-format-data.html#cb100-25"></a></span>
<span id="cb100-26"><a href="import-and-format-data.html#cb100-26"></a><span class="co"># Replace empty cells / NAs with zeros</span></span>
<span id="cb100-27"><a href="import-and-format-data.html#cb100-27"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">c</span>(col_ref2,col_ref)) {</span>
<span id="cb100-28"><a href="import-and-format-data.html#cb100-28"></a>   MarysM<span class="fl">.13</span>D[<span class="kw">is.na</span>(MarysM<span class="fl">.13</span>D[, i]), i] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb100-29"><a href="import-and-format-data.html#cb100-29"></a>}</span>
<span id="cb100-30"><a href="import-and-format-data.html#cb100-30"></a></span>
<span id="cb100-31"><a href="import-and-format-data.html#cb100-31"></a></span>
<span id="cb100-32"><a href="import-and-format-data.html#cb100-32"></a>incidence2 &lt;-</span>
<span id="cb100-33"><a href="import-and-format-data.html#cb100-33"></a><span class="st">   </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;numeric&quot;</span>, <span class="dt">length =</span> <span class="kw">length</span>(MarysM<span class="fl">.13</span>D[, <span class="dv">1</span>]))</span>
<span id="cb100-34"><a href="import-and-format-data.html#cb100-34"></a></span>
<span id="cb100-35"><a href="import-and-format-data.html#cb100-35"></a></span>
<span id="cb100-36"><a href="import-and-format-data.html#cb100-36"></a><span class="co"># Convert disease survey data to 1-9 Incidence rating scale</span></span>
<span id="cb100-37"><a href="import-and-format-data.html#cb100-37"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(incidence2)) {</span>
<span id="cb100-38"><a href="import-and-format-data.html#cb100-38"></a>   <span class="co"># incidence = 1</span></span>
<span id="cb100-39"><a href="import-and-format-data.html#cb100-39"></a>   <span class="cf">if</span> (<span class="kw">all</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)) {</span>
<span id="cb100-40"><a href="import-and-format-data.html#cb100-40"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb100-41"><a href="import-and-format-data.html#cb100-41"></a>      <span class="cf">next</span>()</span>
<span id="cb100-42"><a href="import-and-format-data.html#cb100-42"></a>   }</span>
<span id="cb100-43"><a href="import-and-format-data.html#cb100-43"></a>   </span>
<span id="cb100-44"><a href="import-and-format-data.html#cb100-44"></a>   <span class="co"># incidence = 2</span></span>
<span id="cb100-45"><a href="import-and-format-data.html#cb100-45"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-46"><a href="import-and-format-data.html#cb100-46"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-47"><a href="import-and-format-data.html#cb100-47"></a><span class="st">       </span>(<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="op">/</span></span>
<span id="cb100-48"><a href="import-and-format-data.html#cb100-48"></a><span class="st">        </span><span class="kw">length</span>(MarysM<span class="fl">.13</span>D[i, col_ref])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb100-49"><a href="import-and-format-data.html#cb100-49"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb100-50"><a href="import-and-format-data.html#cb100-50"></a>      <span class="cf">next</span>()</span>
<span id="cb100-51"><a href="import-and-format-data.html#cb100-51"></a>   }</span>
<span id="cb100-52"><a href="import-and-format-data.html#cb100-52"></a>   </span>
<span id="cb100-53"><a href="import-and-format-data.html#cb100-53"></a>   </span>
<span id="cb100-54"><a href="import-and-format-data.html#cb100-54"></a>   <span class="co"># incidence = 3</span></span>
<span id="cb100-55"><a href="import-and-format-data.html#cb100-55"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-56"><a href="import-and-format-data.html#cb100-56"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-57"><a href="import-and-format-data.html#cb100-57"></a><span class="st">       </span>(<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb100-58"><a href="import-and-format-data.html#cb100-58"></a><span class="st">        </span><span class="kw">length</span>(MarysM<span class="fl">.13</span>D[i, col_ref])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb100-59"><a href="import-and-format-data.html#cb100-59"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb100-60"><a href="import-and-format-data.html#cb100-60"></a>   } <span class="cf">else</span>{</span>
<span id="cb100-61"><a href="import-and-format-data.html#cb100-61"></a>      <span class="co"># if it is in the lower half of the canopy and in less than 75% of plants then incidence = 2.5</span></span>
<span id="cb100-62"><a href="import-and-format-data.html#cb100-62"></a>      <span class="cf">if</span> (<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-63"><a href="import-and-format-data.html#cb100-63"></a><span class="st">          </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-64"><a href="import-and-format-data.html#cb100-64"></a><span class="st">          </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-65"><a href="import-and-format-data.html#cb100-65"></a><span class="st">          </span>(<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb100-66"><a href="import-and-format-data.html#cb100-66"></a><span class="st">           </span><span class="kw">length</span>(MarysM<span class="fl">.13</span>D[i, col_ref])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb100-67"><a href="import-and-format-data.html#cb100-67"></a>         incidence2[i] &lt;-<span class="st"> </span><span class="fl">2.5</span></span>
<span id="cb100-68"><a href="import-and-format-data.html#cb100-68"></a>         <span class="cf">next</span>()</span>
<span id="cb100-69"><a href="import-and-format-data.html#cb100-69"></a>      }</span>
<span id="cb100-70"><a href="import-and-format-data.html#cb100-70"></a>   }</span>
<span id="cb100-71"><a href="import-and-format-data.html#cb100-71"></a>   </span>
<span id="cb100-72"><a href="import-and-format-data.html#cb100-72"></a>   </span>
<span id="cb100-73"><a href="import-and-format-data.html#cb100-73"></a>   <span class="co"># incidence = 4</span></span>
<span id="cb100-74"><a href="import-and-format-data.html#cb100-74"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-75"><a href="import-and-format-data.html#cb100-75"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-76"><a href="import-and-format-data.html#cb100-76"></a><span class="st">       </span>(<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb100-77"><a href="import-and-format-data.html#cb100-77"></a><span class="st">        </span><span class="kw">length</span>(MarysM<span class="fl">.13</span>D[i, col_ref])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb100-78"><a href="import-and-format-data.html#cb100-78"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb100-79"><a href="import-and-format-data.html#cb100-79"></a>      <span class="cf">next</span>()</span>
<span id="cb100-80"><a href="import-and-format-data.html#cb100-80"></a>   }</span>
<span id="cb100-81"><a href="import-and-format-data.html#cb100-81"></a>   </span>
<span id="cb100-82"><a href="import-and-format-data.html#cb100-82"></a>   </span>
<span id="cb100-83"><a href="import-and-format-data.html#cb100-83"></a>   <span class="co"># incidence = 5</span></span>
<span id="cb100-84"><a href="import-and-format-data.html#cb100-84"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-85"><a href="import-and-format-data.html#cb100-85"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-86"><a href="import-and-format-data.html#cb100-86"></a><span class="st">       </span>(<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb100-87"><a href="import-and-format-data.html#cb100-87"></a><span class="st">        </span><span class="kw">length</span>(MarysM<span class="fl">.13</span>D[i, col_ref])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb100-88"><a href="import-and-format-data.html#cb100-88"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb100-89"><a href="import-and-format-data.html#cb100-89"></a>      <span class="cf">next</span>()</span>
<span id="cb100-90"><a href="import-and-format-data.html#cb100-90"></a>   }</span>
<span id="cb100-91"><a href="import-and-format-data.html#cb100-91"></a>   </span>
<span id="cb100-92"><a href="import-and-format-data.html#cb100-92"></a>   </span>
<span id="cb100-93"><a href="import-and-format-data.html#cb100-93"></a>   <span class="co"># incidence = 6</span></span>
<span id="cb100-94"><a href="import-and-format-data.html#cb100-94"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-95"><a href="import-and-format-data.html#cb100-95"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-96"><a href="import-and-format-data.html#cb100-96"></a><span class="st">       </span>(<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb100-97"><a href="import-and-format-data.html#cb100-97"></a><span class="st">        </span><span class="kw">length</span>(MarysM<span class="fl">.13</span>D[i, col_ref])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.95</span>) {</span>
<span id="cb100-98"><a href="import-and-format-data.html#cb100-98"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="dv">6</span></span>
<span id="cb100-99"><a href="import-and-format-data.html#cb100-99"></a>      <span class="cf">next</span>()</span>
<span id="cb100-100"><a href="import-and-format-data.html#cb100-100"></a>   }</span>
<span id="cb100-101"><a href="import-and-format-data.html#cb100-101"></a>   </span>
<span id="cb100-102"><a href="import-and-format-data.html#cb100-102"></a>   </span>
<span id="cb100-103"><a href="import-and-format-data.html#cb100-103"></a>   <span class="co"># incidence = 7</span></span>
<span id="cb100-104"><a href="import-and-format-data.html#cb100-104"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-105"><a href="import-and-format-data.html#cb100-105"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-106"><a href="import-and-format-data.html#cb100-106"></a><span class="st">       </span>(<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb100-107"><a href="import-and-format-data.html#cb100-107"></a><span class="st">        </span><span class="kw">length</span>(MarysM<span class="fl">.13</span>D[i, col_ref])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.95</span>) {</span>
<span id="cb100-108"><a href="import-and-format-data.html#cb100-108"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="dv">7</span></span>
<span id="cb100-109"><a href="import-and-format-data.html#cb100-109"></a>      <span class="cf">next</span>()</span>
<span id="cb100-110"><a href="import-and-format-data.html#cb100-110"></a>   }</span>
<span id="cb100-111"><a href="import-and-format-data.html#cb100-111"></a>   </span>
<span id="cb100-112"><a href="import-and-format-data.html#cb100-112"></a>   </span>
<span id="cb100-113"><a href="import-and-format-data.html#cb100-113"></a>   <span class="co"># incidence = 8</span></span>
<span id="cb100-114"><a href="import-and-format-data.html#cb100-114"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-115"><a href="import-and-format-data.html#cb100-115"></a><span class="st">       </span>(<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb100-116"><a href="import-and-format-data.html#cb100-116"></a><span class="st">        </span><span class="kw">length</span>(MarysM<span class="fl">.13</span>D[i, col_ref])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb100-117"><a href="import-and-format-data.html#cb100-117"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="dv">8</span></span>
<span id="cb100-118"><a href="import-and-format-data.html#cb100-118"></a>      <span class="cf">next</span>()</span>
<span id="cb100-119"><a href="import-and-format-data.html#cb100-119"></a>   }</span>
<span id="cb100-120"><a href="import-and-format-data.html#cb100-120"></a>   </span>
<span id="cb100-121"><a href="import-and-format-data.html#cb100-121"></a>   </span>
<span id="cb100-122"><a href="import-and-format-data.html#cb100-122"></a>   <span class="co"># incidence = 9</span></span>
<span id="cb100-123"><a href="import-and-format-data.html#cb100-123"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-124"><a href="import-and-format-data.html#cb100-124"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref2] <span class="op">&gt;=</span><span class="st"> </span>(<span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.75</span>)) <span class="op">&amp;&amp;</span></span>
<span id="cb100-125"><a href="import-and-format-data.html#cb100-125"></a><span class="st">       </span><span class="co"># ten leaves from 5 sample sites with a maximum % leaf area infected with PM of 100% * 0.75 as a threshold for leaf drop</span></span>
<span id="cb100-126"><a href="import-and-format-data.html#cb100-126"></a><span class="st">       </span>(<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb100-127"><a href="import-and-format-data.html#cb100-127"></a><span class="st">        </span><span class="kw">length</span>(MarysM<span class="fl">.13</span>D[i, col_ref])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb100-128"><a href="import-and-format-data.html#cb100-128"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="dv">9</span></span>
<span id="cb100-129"><a href="import-and-format-data.html#cb100-129"></a>      <span class="cf">next</span>()</span>
<span id="cb100-130"><a href="import-and-format-data.html#cb100-130"></a>   }</span>
<span id="cb100-131"><a href="import-and-format-data.html#cb100-131"></a>   </span>
<span id="cb100-132"><a href="import-and-format-data.html#cb100-132"></a>   <span class="co"># if there are few (&lt; 10%) leaves with very small infections in all parts of the canopy OR</span></span>
<span id="cb100-133"><a href="import-and-format-data.html#cb100-133"></a>   <span class="co"># if there is a stray colony on a upper leaf in addition to all lower</span></span>
<span id="cb100-134"><a href="import-and-format-data.html#cb100-134"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-135"><a href="import-and-format-data.html#cb100-135"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-136"><a href="import-and-format-data.html#cb100-136"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-137"><a href="import-and-format-data.html#cb100-137"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref2]) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">150</span>) {</span>
<span id="cb100-138"><a href="import-and-format-data.html#cb100-138"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="fl">2.5</span></span>
<span id="cb100-139"><a href="import-and-format-data.html#cb100-139"></a>      <span class="cf">next</span>()</span>
<span id="cb100-140"><a href="import-and-format-data.html#cb100-140"></a>   }</span>
<span id="cb100-141"><a href="import-and-format-data.html#cb100-141"></a>   </span>
<span id="cb100-142"><a href="import-and-format-data.html#cb100-142"></a>   <span class="co"># incidence = 7.5  In the upper canopy with less than 75% plants infected</span></span>
<span id="cb100-143"><a href="import-and-format-data.html#cb100-143"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-144"><a href="import-and-format-data.html#cb100-144"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-145"><a href="import-and-format-data.html#cb100-145"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-146"><a href="import-and-format-data.html#cb100-146"></a><span class="st">       </span>(<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb100-147"><a href="import-and-format-data.html#cb100-147"></a><span class="st">        </span><span class="kw">length</span>(MarysM<span class="fl">.13</span>D[i, col_ref]) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb100-148"><a href="import-and-format-data.html#cb100-148"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref2]) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2000</span>) {</span>
<span id="cb100-149"><a href="import-and-format-data.html#cb100-149"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="fl">7.5</span></span>
<span id="cb100-150"><a href="import-and-format-data.html#cb100-150"></a>      <span class="cf">next</span>()</span>
<span id="cb100-151"><a href="import-and-format-data.html#cb100-151"></a>   }</span>
<span id="cb100-152"><a href="import-and-format-data.html#cb100-152"></a>   <span class="co">#</span></span>
<span id="cb100-153"><a href="import-and-format-data.html#cb100-153"></a>   <span class="co"># incidence = 6.5</span></span>
<span id="cb100-154"><a href="import-and-format-data.html#cb100-154"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-155"><a href="import-and-format-data.html#cb100-155"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-156"><a href="import-and-format-data.html#cb100-156"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref2] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)  <span class="op">&amp;&amp;</span></span>
<span id="cb100-157"><a href="import-and-format-data.html#cb100-157"></a><span class="st">       </span>(<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb100-158"><a href="import-and-format-data.html#cb100-158"></a><span class="st">        </span><span class="kw">length</span>(MarysM<span class="fl">.13</span>D[i, col_ref]) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.65</span>)) {</span>
<span id="cb100-159"><a href="import-and-format-data.html#cb100-159"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="fl">6.5</span></span>
<span id="cb100-160"><a href="import-and-format-data.html#cb100-160"></a>      <span class="cf">next</span>()</span>
<span id="cb100-161"><a href="import-and-format-data.html#cb100-161"></a>   }</span>
<span id="cb100-162"><a href="import-and-format-data.html#cb100-162"></a>   <span class="co">#</span></span>
<span id="cb100-163"><a href="import-and-format-data.html#cb100-163"></a>   <span class="co">#</span></span>
<span id="cb100-164"><a href="import-and-format-data.html#cb100-164"></a>   <span class="co"># incidence = 4.5 If PM is in the the lower and mid-canopy in less than 75% of plants and one or two in the upper canopy</span></span>
<span id="cb100-165"><a href="import-and-format-data.html#cb100-165"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-166"><a href="import-and-format-data.html#cb100-166"></a><span class="st">       </span><span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb100-167"><a href="import-and-format-data.html#cb100-167"></a><span class="st">       </span>(<span class="kw">sum</span>(MarysM<span class="fl">.13</span>D[i, col_ref] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb100-168"><a href="import-and-format-data.html#cb100-168"></a><span class="st">        </span><span class="kw">length</span>(MarysM<span class="fl">.13</span>D[i, col_ref])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb100-169"><a href="import-and-format-data.html#cb100-169"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="fl">4.5</span></span>
<span id="cb100-170"><a href="import-and-format-data.html#cb100-170"></a>      <span class="cf">next</span>()</span>
<span id="cb100-171"><a href="import-and-format-data.html#cb100-171"></a>   } <span class="cf">else</span>{</span>
<span id="cb100-172"><a href="import-and-format-data.html#cb100-172"></a>      <span class="co"># If none of the conditions are met give the incidence zero</span></span>
<span id="cb100-173"><a href="import-and-format-data.html#cb100-173"></a>      incidence2[i] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb100-174"><a href="import-and-format-data.html#cb100-174"></a>   }</span>
<span id="cb100-175"><a href="import-and-format-data.html#cb100-175"></a>   </span>
<span id="cb100-176"><a href="import-and-format-data.html#cb100-176"></a>}<span class="co"># End of incidence2 loop</span></span>
<span id="cb100-177"><a href="import-and-format-data.html#cb100-177"></a></span>
<span id="cb100-178"><a href="import-and-format-data.html#cb100-178"></a><span class="cf">if</span>(<span class="kw">any</span>(incidence2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)){</span>
<span id="cb100-179"><a href="import-and-format-data.html#cb100-179"></a>   <span class="kw">warning</span>(<span class="st">&quot;Code caluculated incidence on &#39;0&#39; which is off the incidence scale&quot;</span>)</span>
<span id="cb100-180"><a href="import-and-format-data.html#cb100-180"></a>} </span>
<span id="cb100-181"><a href="import-and-format-data.html#cb100-181"></a></span>
<span id="cb100-182"><a href="import-and-format-data.html#cb100-182"></a><span class="co"># Re-format data-frame</span></span>
<span id="cb100-183"><a href="import-and-format-data.html#cb100-183"></a><span class="cf">if</span>(D_assess <span class="op">==</span><span class="st"> &quot;18 DAT1 18-3-2013&quot;</span>){</span>
<span id="cb100-184"><a href="import-and-format-data.html#cb100-184"></a>MarysM<span class="fl">.13</span>D<span class="fl">.1</span> &lt;-<span class="st"> </span>MarysM<span class="fl">.13</span>D[,<span class="kw">c</span>(<span class="st">&quot;Treat&quot;</span>, <span class="st">&quot;Rep&quot;</span>, <span class="st">&quot;Run&quot;</span>, <span class="st">&quot;Plot&quot;</span>)]</span>
<span id="cb100-185"><a href="import-and-format-data.html#cb100-185"></a>MarysM<span class="fl">.13</span>D<span class="fl">.1</span><span class="op">$</span>Inc_18D &lt;-<span class="st">  </span>incidence2</span>
<span id="cb100-186"><a href="import-and-format-data.html#cb100-186"></a>}</span>
<span id="cb100-187"><a href="import-and-format-data.html#cb100-187"></a>   </span>
<span id="cb100-188"><a href="import-and-format-data.html#cb100-188"></a><span class="cf">if</span>(D_assess <span class="op">==</span><span class="st"> &quot;19 DAT1 19-3-2013&quot;</span>){</span>
<span id="cb100-189"><a href="import-and-format-data.html#cb100-189"></a>   MarysM<span class="fl">.13</span>D<span class="fl">.1</span><span class="op">$</span>Inc_19D &lt;-<span class="st">  </span>incidence2</span>
<span id="cb100-190"><a href="import-and-format-data.html#cb100-190"></a>}</span>
<span id="cb100-191"><a href="import-and-format-data.html#cb100-191"></a>   </span>
<span id="cb100-192"><a href="import-and-format-data.html#cb100-192"></a>} <span class="co">#end of loop on disease observations</span></span></code></pre></div>
<pre><code>## New names:
## * Treat -&gt; Treat...1
## * Rep -&gt; Rep...2
## * Run -&gt; Run...3
## * Plot -&gt; Plot...4
## * `` -&gt; ...6
## * ...</code></pre>
<pre><code>## New names:
## * `` -&gt; ...6
## * `1` -&gt; `1...7`
## * `2` -&gt; `2...8`
## * `3` -&gt; `3...9`
## * `4` -&gt; `4...10`
## * ...</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="import-and-format-data.html#cb103-1"></a><span class="kw">write.csv</span>(</span>
<span id="cb103-2"><a href="import-and-format-data.html#cb103-2"></a>   MarysM<span class="fl">.13</span>D<span class="fl">.1</span>,</span>
<span id="cb103-3"><a href="import-and-format-data.html#cb103-3"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/AM1304-MaryMount-Disease_means.csv&quot;</span>),</span>
<span id="cb103-4"><a href="import-and-format-data.html#cb103-4"></a>   <span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb103-5"><a href="import-and-format-data.html#cb103-5"></a>)</span>
<span id="cb103-6"><a href="import-and-format-data.html#cb103-6"></a></span>
<span id="cb103-7"><a href="import-and-format-data.html#cb103-7"></a></span>
<span id="cb103-8"><a href="import-and-format-data.html#cb103-8"></a></span>
<span id="cb103-9"><a href="import-and-format-data.html#cb103-9"></a><span class="co"># read in yield and format</span></span>
<span id="cb103-10"><a href="import-and-format-data.html#cb103-10"></a>MarysM<span class="fl">.13</span>Y &lt;-</span>
<span id="cb103-11"><a href="import-and-format-data.html#cb103-11"></a><span class="st">   </span><span class="kw">as.data.frame</span>(</span>
<span id="cb103-12"><a href="import-and-format-data.html#cb103-12"></a>      <span class="kw">read_xlsx</span>(</span>
<span id="cb103-13"><a href="import-and-format-data.html#cb103-13"></a>         <span class="dt">path =</span> <span class="kw">here</span>(<span class="st">&quot;data/AM1304 Fungicides for powdery mildew in mungbean - Marys Mount.xlsx&quot;</span>),</span>
<span id="cb103-14"><a href="import-and-format-data.html#cb103-14"></a>         <span class="dt">sheet =</span> <span class="st">&quot;42 DAT1 Yield&quot;</span>,</span>
<span id="cb103-15"><a href="import-and-format-data.html#cb103-15"></a>         <span class="dt">range =</span> <span class="st">&quot;A14:F58&quot;</span>,</span>
<span id="cb103-16"><a href="import-and-format-data.html#cb103-16"></a>         <span class="dt">col_names =</span> <span class="ot">TRUE</span></span>
<span id="cb103-17"><a href="import-and-format-data.html#cb103-17"></a>      )</span>
<span id="cb103-18"><a href="import-and-format-data.html#cb103-18"></a>   )</span>
<span id="cb103-19"><a href="import-and-format-data.html#cb103-19"></a></span>
<span id="cb103-20"><a href="import-and-format-data.html#cb103-20"></a>MarysM<span class="fl">.13</span>Y<span class="op">$</span>Treat &lt;-<span class="st"> </span><span class="kw">as.character</span>(MarysM<span class="fl">.13</span>Y<span class="op">$</span>Treat)</span>
<span id="cb103-21"><a href="import-and-format-data.html#cb103-21"></a>MarysM<span class="fl">.13</span>Y<span class="op">$</span>Rep &lt;-<span class="st"> </span><span class="kw">as.character</span>(MarysM<span class="fl">.13</span>Y<span class="op">$</span>Rep)</span>
<span id="cb103-22"><a href="import-and-format-data.html#cb103-22"></a></span>
<span id="cb103-23"><a href="import-and-format-data.html#cb103-23"></a></span>
<span id="cb103-24"><a href="import-and-format-data.html#cb103-24"></a>MarysM<span class="fl">.13</span>Y &lt;-<span class="st"> </span>MarysM<span class="fl">.13</span>Y[<span class="kw">order</span>(MarysM<span class="fl">.13</span>Y[,<span class="dv">1</span>],MarysM<span class="fl">.13</span>Y[,<span class="dv">2</span>],MarysM<span class="fl">.13</span>Y[,<span class="dv">3</span>],MarysM<span class="fl">.13</span>Y[,<span class="dv">4</span>]),]</span>
<span id="cb103-25"><a href="import-and-format-data.html#cb103-25"></a></span>
<span id="cb103-26"><a href="import-and-format-data.html#cb103-26"></a>MarysM_<span class="dv">13</span> &lt;-<span class="st"> </span><span class="kw">left_join</span>(MarysM<span class="fl">.13</span>D<span class="fl">.1</span>,MarysM<span class="fl">.13</span>Y)</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;Treat&quot;, &quot;Rep&quot;, &quot;Run&quot;, &quot;Plot&quot;)</code></pre>
</div>
<div id="define-treatment-data-2" class="section level4">
<h4><span class="header-section-number">3.4.5.2</span> Define treatment data</h4>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="import-and-format-data.html#cb105-1"></a>MarysM_<span class="dv">13</span> &lt;-<span class="st"> </span>MarysM_<span class="dv">13</span> <span class="op">%&gt;%</span></span>
<span id="cb105-2"><a href="import-and-format-data.html#cb105-2"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trade_name =</span> </span>
<span id="cb105-3"><a href="import-and-format-data.html#cb105-3"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb105-4"><a href="import-and-format-data.html#cb105-4"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> &quot;Spin-flo&quot;</span>,</span>
<span id="cb105-5"><a href="import-and-format-data.html#cb105-5"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> &quot;Tilt&quot;</span>,</span>
<span id="cb105-6"><a href="import-and-format-data.html#cb105-6"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra&quot;</span>,</span>
<span id="cb105-7"><a href="import-and-format-data.html#cb105-7"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra + adj&quot;</span>,</span>
<span id="cb105-8"><a href="import-and-format-data.html#cb105-8"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> &quot;Cabrio&quot;</span>,</span>
<span id="cb105-9"><a href="import-and-format-data.html#cb105-9"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> &quot;Spin-flo&quot;</span>,</span>
<span id="cb105-10"><a href="import-and-format-data.html#cb105-10"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> &quot;Tilt&quot;</span>,</span>
<span id="cb105-11"><a href="import-and-format-data.html#cb105-11"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra + adj&quot;</span>,</span>
<span id="cb105-12"><a href="import-and-format-data.html#cb105-12"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> &quot;Cabrio&quot;</span>,</span>
<span id="cb105-13"><a href="import-and-format-data.html#cb105-13"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> &quot;Tilt&quot;</span>,</span>
<span id="cb105-14"><a href="import-and-format-data.html#cb105-14"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb105-15"><a href="import-and-format-data.html#cb105-15"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_ai =</span> </span>
<span id="cb105-16"><a href="import-and-format-data.html#cb105-16"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb105-17"><a href="import-and-format-data.html#cb105-17"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> &quot;carbendazim&quot;</span>,</span>
<span id="cb105-18"><a href="import-and-format-data.html#cb105-18"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb105-19"><a href="import-and-format-data.html#cb105-19"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb105-20"><a href="import-and-format-data.html#cb105-20"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb105-21"><a href="import-and-format-data.html#cb105-21"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> &quot;pyraclostrobin&quot;</span>,</span>
<span id="cb105-22"><a href="import-and-format-data.html#cb105-22"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> &quot;carbendazim&quot;</span>,</span>
<span id="cb105-23"><a href="import-and-format-data.html#cb105-23"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb105-24"><a href="import-and-format-data.html#cb105-24"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb105-25"><a href="import-and-format-data.html#cb105-25"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> &quot;pyraclostrobin&quot;</span>,</span>
<span id="cb105-26"><a href="import-and-format-data.html#cb105-26"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb105-27"><a href="import-and-format-data.html#cb105-27"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb105-28"><a href="import-and-format-data.html#cb105-28"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> </span>
<span id="cb105-29"><a href="import-and-format-data.html#cb105-29"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb105-30"><a href="import-and-format-data.html#cb105-30"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">250</span>,</span>
<span id="cb105-31"><a href="import-and-format-data.html#cb105-31"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.5</span>,</span>
<span id="cb105-32"><a href="import-and-format-data.html#cb105-32"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">40</span>,</span>
<span id="cb105-33"><a href="import-and-format-data.html#cb105-33"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">40</span>,</span>
<span id="cb105-34"><a href="import-and-format-data.html#cb105-34"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">125</span>,</span>
<span id="cb105-35"><a href="import-and-format-data.html#cb105-35"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">250</span>,</span>
<span id="cb105-36"><a href="import-and-format-data.html#cb105-36"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.5</span>,</span>
<span id="cb105-37"><a href="import-and-format-data.html#cb105-37"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">40</span>,</span>
<span id="cb105-38"><a href="import-and-format-data.html#cb105-38"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">125</span>,</span>
<span id="cb105-39"><a href="import-and-format-data.html#cb105-39"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.5</span>,</span>
<span id="cb105-40"><a href="import-and-format-data.html#cb105-40"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>))<span class="op">%&gt;%</span></span>
<span id="cb105-41"><a href="import-and-format-data.html#cb105-41"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_1 =</span> </span>
<span id="cb105-42"><a href="import-and-format-data.html#cb105-42"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb105-43"><a href="import-and-format-data.html#cb105-43"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-44"><a href="import-and-format-data.html#cb105-44"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-45"><a href="import-and-format-data.html#cb105-45"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-46"><a href="import-and-format-data.html#cb105-46"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-47"><a href="import-and-format-data.html#cb105-47"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-48"><a href="import-and-format-data.html#cb105-48"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-49"><a href="import-and-format-data.html#cb105-49"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-50"><a href="import-and-format-data.html#cb105-50"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-51"><a href="import-and-format-data.html#cb105-51"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-52"><a href="import-and-format-data.html#cb105-52"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-53"><a href="import-and-format-data.html#cb105-53"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb105-54"><a href="import-and-format-data.html#cb105-54"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_2 =</span> </span>
<span id="cb105-55"><a href="import-and-format-data.html#cb105-55"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-18&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-56"><a href="import-and-format-data.html#cb105-56"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-18&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-57"><a href="import-and-format-data.html#cb105-57"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-18&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-58"><a href="import-and-format-data.html#cb105-58"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-18&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-59"><a href="import-and-format-data.html#cb105-59"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-18&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-60"><a href="import-and-format-data.html#cb105-60"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb105-61"><a href="import-and-format-data.html#cb105-61"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_3 =</span> </span>
<span id="cb105-62"><a href="import-and-format-data.html#cb105-62"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-04-02&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb105-63"><a href="import-and-format-data.html#cb105-63"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb105-64"><a href="import-and-format-data.html#cb105-64"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">spray_n =</span> </span>
<span id="cb105-65"><a href="import-and-format-data.html#cb105-65"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb105-66"><a href="import-and-format-data.html#cb105-66"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb105-67"><a href="import-and-format-data.html#cb105-67"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb105-68"><a href="import-and-format-data.html#cb105-68"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb105-69"><a href="import-and-format-data.html#cb105-69"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb105-70"><a href="import-and-format-data.html#cb105-70"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb105-71"><a href="import-and-format-data.html#cb105-71"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb105-72"><a href="import-and-format-data.html#cb105-72"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb105-73"><a href="import-and-format-data.html#cb105-73"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb105-74"><a href="import-and-format-data.html#cb105-74"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb105-75"><a href="import-and-format-data.html#cb105-75"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>, <span class="co"># third spray not applied ?</span></span>
<span id="cb105-76"><a href="import-and-format-data.html#cb105-76"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>))</span></code></pre></div>
</div>
<div id="input-trial-data-3" class="section level4">
<h4><span class="header-section-number">3.4.5.3</span> Input trial data</h4>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="import-and-format-data.html#cb106-1"></a>MarysM_<span class="dv">13</span>_dat &lt;-<span class="st"> </span></span>
<span id="cb106-2"><a href="import-and-format-data.html#cb106-2"></a><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">trial_ref =</span> <span class="st">&quot;AM1304&quot;</span>,</span>
<span id="cb106-3"><a href="import-and-format-data.html#cb106-3"></a>              <span class="dt">year =</span> <span class="st">&quot;2013&quot;</span>,</span>
<span id="cb106-4"><a href="import-and-format-data.html#cb106-4"></a>              <span class="dt">location =</span> <span class="st">&quot;Marys Mount&quot;</span>,</span>
<span id="cb106-5"><a href="import-and-format-data.html#cb106-5"></a>              <span class="dt">host_genotype =</span> <span class="st">&quot;Crystal&quot;</span>,</span>
<span id="cb106-6"><a href="import-and-format-data.html#cb106-6"></a>              <span class="dt">trial_design =</span> <span class="st">&quot;RCB&quot;</span>,</span>
<span id="cb106-7"><a href="import-and-format-data.html#cb106-7"></a>              <span class="dt">plot_length =</span> <span class="dv">12</span>,</span>
<span id="cb106-8"><a href="import-and-format-data.html#cb106-8"></a>              <span class="dt">plot_width =</span> <span class="dv">4</span>,</span>
<span id="cb106-9"><a href="import-and-format-data.html#cb106-9"></a>              <span class="dt">plant_density =</span> <span class="ot">NA</span>,</span>
<span id="cb106-10"><a href="import-and-format-data.html#cb106-10"></a>              <span class="dt">row_spacing =</span> <span class="dv">1</span>,</span>
<span id="cb106-11"><a href="import-and-format-data.html#cb106-11"></a>              <span class="dt">replicate =</span> MarysM_<span class="dv">13</span><span class="op">$</span>Rep,</span>
<span id="cb106-12"><a href="import-and-format-data.html#cb106-12"></a>              <span class="dt">planting_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2012-12-24&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb106-13"><a href="import-and-format-data.html#cb106-13"></a>              <span class="dt">emergence_date =</span> <span class="ot">NA</span>,</span>
<span id="cb106-14"><a href="import-and-format-data.html#cb106-14"></a>              <span class="dt">flowering_date =</span> <span class="ot">NA</span>,</span>
<span id="cb106-15"><a href="import-and-format-data.html#cb106-15"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb106-16"><a href="import-and-format-data.html#cb106-16"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="ot">NA</span>,</span>
<span id="cb106-17"><a href="import-and-format-data.html#cb106-17"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-03-16&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb106-18"><a href="import-and-format-data.html#cb106-18"></a>              <span class="dt">trade_name =</span> <span class="kw">as.factor</span>(MarysM_<span class="dv">13</span><span class="op">$</span>trade_name),</span>
<span id="cb106-19"><a href="import-and-format-data.html#cb106-19"></a>              <span class="dt">fungicide_ai =</span> MarysM_<span class="dv">13</span><span class="op">$</span>fungicide_ai,</span>
<span id="cb106-20"><a href="import-and-format-data.html#cb106-20"></a>              <span class="dt">dose_ai.ha =</span> MarysM_<span class="dv">13</span><span class="op">$</span>dose_ai.ha,</span>
<span id="cb106-21"><a href="import-and-format-data.html#cb106-21"></a>              <span class="dt">n_treatment =</span> MarysM_<span class="dv">13</span><span class="op">$</span>Treat,</span>
<span id="cb106-22"><a href="import-and-format-data.html#cb106-22"></a>              <span class="dt">fungicide_application_1 =</span> MarysM_<span class="dv">13</span><span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb106-23"><a href="import-and-format-data.html#cb106-23"></a>              <span class="dt">fungicide_application_2 =</span> MarysM_<span class="dv">13</span><span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb106-24"><a href="import-and-format-data.html#cb106-24"></a>              <span class="dt">fungicide_application_3 =</span> MarysM_<span class="dv">13</span><span class="op">$</span>fungicide_application_<span class="dv">3</span>,</span>
<span id="cb106-25"><a href="import-and-format-data.html#cb106-25"></a>              <span class="dt">total_fungicide =</span> MarysM_<span class="dv">13</span><span class="op">$</span>spray_n,</span>
<span id="cb106-26"><a href="import-and-format-data.html#cb106-26"></a>              <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-04-11&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb106-27"><a href="import-and-format-data.html#cb106-27"></a>              <span class="dt">final_assessment =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-03-26&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb106-28"><a href="import-and-format-data.html#cb106-28"></a>              <span class="dt">PM_final_severity =</span> MarysM_<span class="dv">13</span><span class="op">$</span>Inc_19D,</span>
<span id="cb106-29"><a href="import-and-format-data.html#cb106-29"></a>              <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb106-30"><a href="import-and-format-data.html#cb106-30"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">as.numeric</span>(MarysM_<span class="dv">13</span><span class="op">$</span><span class="st">`</span><span class="dt">Yield Kg/ha</span><span class="st">`</span>)<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb106-31"><a href="import-and-format-data.html#cb106-31"></a>              )</span></code></pre></div>
</div>
<div id="audpc-curve-4" class="section level4">
<h4><span class="header-section-number">3.4.5.4</span> AUDPC curve</h4>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="import-and-format-data.html#cb107-1"></a>MarysM_<span class="dv">13</span>_dat &lt;-<span class="st"> </span><span class="kw">cbind</span>(MarysM_<span class="dv">13</span>_dat,</span>
<span id="cb107-2"><a href="import-and-format-data.html#cb107-2"></a>                          <span class="dt">AUDPC =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb107-3"><a href="import-and-format-data.html#cb107-3"></a>                                                   MarysM_<span class="dv">13</span>[,<span class="kw">c</span>(<span class="st">&quot;Inc_18D&quot;</span>,<span class="st">&quot;Inc_19D&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb107-4"><a href="import-and-format-data.html#cb107-4"></a>                                        <span class="dv">1</span>, </span>
<span id="cb107-5"><a href="import-and-format-data.html#cb107-5"></a>                                        <span class="dt">FUN =</span> audpc, </span>
<span id="cb107-6"><a href="import-and-format-data.html#cb107-6"></a>                                        <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">12</span>,<span class="dv">12</span><span class="op">+</span><span class="dv">19</span>)</span>
<span id="cb107-7"><a href="import-and-format-data.html#cb107-7"></a>                                        ),</span>
<span id="cb107-8"><a href="import-and-format-data.html#cb107-8"></a>                     <span class="dt">AUDPS =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb107-9"><a href="import-and-format-data.html#cb107-9"></a>                                                   MarysM_<span class="dv">13</span>[,<span class="kw">c</span>(<span class="st">&quot;Inc_18D&quot;</span>,<span class="st">&quot;Inc_19D&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb107-10"><a href="import-and-format-data.html#cb107-10"></a>                                        <span class="dv">1</span>, </span>
<span id="cb107-11"><a href="import-and-format-data.html#cb107-11"></a>                                        <span class="dt">FUN =</span> audps, </span>
<span id="cb107-12"><a href="import-and-format-data.html#cb107-12"></a>                                        <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">12</span>,<span class="dv">12</span><span class="op">+</span><span class="dv">19</span>)</span>
<span id="cb107-13"><a href="import-and-format-data.html#cb107-13"></a>                                        )</span>
<span id="cb107-14"><a href="import-and-format-data.html#cb107-14"></a>                          )</span></code></pre></div>
</div>
<div id="calculating-the-treatment-means-1" class="section level4">
<h4><span class="header-section-number">3.4.5.5</span> Calculating the treatment means</h4>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="import-and-format-data.html#cb108-1"></a>MarysM_<span class="dv">13</span>_m &lt;-<span class="st"> </span>MarysM_<span class="dv">13</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb108-2"><a href="import-and-format-data.html#cb108-2"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb108-3"><a href="import-and-format-data.html#cb108-3"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb108-4"><a href="import-and-format-data.html#cb108-4"></a>             <span class="dt">year =</span> <span class="kw">unique</span>(year),</span>
<span id="cb108-5"><a href="import-and-format-data.html#cb108-5"></a>             <span class="dt">location =</span> <span class="kw">unique</span>(location),</span>
<span id="cb108-6"><a href="import-and-format-data.html#cb108-6"></a>             <span class="dt">host_genotype =</span> <span class="kw">unique</span>(host_genotype),</span>
<span id="cb108-7"><a href="import-and-format-data.html#cb108-7"></a>             <span class="dt">trial_design =</span> <span class="kw">unique</span>(trial_design),</span>
<span id="cb108-8"><a href="import-and-format-data.html#cb108-8"></a>             <span class="dt">trade_name =</span> <span class="kw">unique</span>(trade_name),</span>
<span id="cb108-9"><a href="import-and-format-data.html#cb108-9"></a>             <span class="dt">fungicide_ai =</span> <span class="kw">unique</span>(fungicide_ai),</span>
<span id="cb108-10"><a href="import-and-format-data.html#cb108-10"></a>             <span class="dt">dose_ai.ha =</span> <span class="kw">unique</span>(dose_ai.ha),</span>
<span id="cb108-11"><a href="import-and-format-data.html#cb108-11"></a>             <span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb108-12"><a href="import-and-format-data.html#cb108-12"></a>              <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb108-13"><a href="import-and-format-data.html#cb108-13"></a>              <span class="dt">plant_density =</span> <span class="kw">unique</span>(plant_density),</span>
<span id="cb108-14"><a href="import-and-format-data.html#cb108-14"></a>              <span class="dt">row_spacing =</span> <span class="kw">unique</span>(row_spacing),</span>
<span id="cb108-15"><a href="import-and-format-data.html#cb108-15"></a>              <span class="dt">replicates =</span> <span class="kw">length</span>(<span class="kw">as.numeric</span>(replicate)),</span>
<span id="cb108-16"><a href="import-and-format-data.html#cb108-16"></a>              <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb108-17"><a href="import-and-format-data.html#cb108-17"></a>              <span class="dt">emergence_date =</span> <span class="ot">NA</span>,</span>
<span id="cb108-18"><a href="import-and-format-data.html#cb108-18"></a>              <span class="dt">flowering_date =</span> <span class="kw">unique</span>(flowering_date),</span>
<span id="cb108-19"><a href="import-and-format-data.html#cb108-19"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">unique</span>(pod_fill_date),</span>
<span id="cb108-20"><a href="import-and-format-data.html#cb108-20"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="kw">unique</span>(mid_late_pod_fill),</span>
<span id="cb108-21"><a href="import-and-format-data.html#cb108-21"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb108-22"><a href="import-and-format-data.html#cb108-22"></a>              <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb108-23"><a href="import-and-format-data.html#cb108-23"></a>              <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb108-24"><a href="import-and-format-data.html#cb108-24"></a>              <span class="dt">fungicide_application_3 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">3</span>),</span>
<span id="cb108-25"><a href="import-and-format-data.html#cb108-25"></a>              <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb108-26"><a href="import-and-format-data.html#cb108-26"></a>              <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb108-27"><a href="import-and-format-data.html#cb108-27"></a>              <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb108-28"><a href="import-and-format-data.html#cb108-28"></a>              <span class="dt">PM_final_severity =</span> <span class="kw">mean</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb108-29"><a href="import-and-format-data.html#cb108-29"></a>              <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb108-30"><a href="import-and-format-data.html#cb108-30"></a>              <span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="co"># this not calculating sd and returning NAs?</span></span>
<span id="cb108-31"><a href="import-and-format-data.html#cb108-31"></a>              <span class="dt">D_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb108-32"><a href="import-and-format-data.html#cb108-32"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb108-33"><a href="import-and-format-data.html#cb108-33"></a>              <span class="dt">raw_graded =</span> <span class="ot">NA</span>,</span>
<span id="cb108-34"><a href="import-and-format-data.html#cb108-34"></a>              <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb108-35"><a href="import-and-format-data.html#cb108-35"></a>              <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb108-36"><a href="import-and-format-data.html#cb108-36"></a>             <span class="dt">AUDPC_m =</span> <span class="kw">mean</span>(AUDPC),</span>
<span id="cb108-37"><a href="import-and-format-data.html#cb108-37"></a>             <span class="dt">AUDPC_sd =</span> <span class="kw">sd</span>(AUDPC),</span>
<span id="cb108-38"><a href="import-and-format-data.html#cb108-38"></a>             <span class="dt">AUDPS_m =</span> <span class="kw">mean</span>(AUDPS),</span>
<span id="cb108-39"><a href="import-and-format-data.html#cb108-39"></a>             <span class="dt">AUDPS_sd =</span> <span class="kw">sd</span>(AUDPS),</span>
<span id="cb108-40"><a href="import-and-format-data.html#cb108-40"></a>             <span class="dt">Inc_Ms =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), </span>
<span id="cb108-41"><a href="import-and-format-data.html#cb108-41"></a>                               <span class="dt">data =</span> MarysM_<span class="dv">13</span>_dat[MarysM_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;propiconazole&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb108-42"><a href="import-and-format-data.html#cb108-42"></a><span class="st">                                                        </span>MarysM_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span> ,]))[<span class="dv">1</span>,<span class="dv">3</span>],</span>
<span id="cb108-43"><a href="import-and-format-data.html#cb108-43"></a>              <span class="dt">Y_Msquare =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), </span>
<span id="cb108-44"><a href="import-and-format-data.html#cb108-44"></a>                                <span class="dt">data =</span> MarysM_<span class="dv">13</span>_dat[MarysM_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;propiconazole&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb108-45"><a href="import-and-format-data.html#cb108-45"></a><span class="st">                                                        </span>MarysM_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span> ,]))[<span class="dv">1</span>,<span class="dv">3</span>]</span>
<span id="cb108-46"><a href="import-and-format-data.html#cb108-46"></a>             )</span></code></pre></div>
<pre><code>## Warning in mask$eval_all_summarise(quo): NAs introduced by coercion

## Warning in mask$eval_all_summarise(quo): NAs introduced by coercion</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="import-and-format-data.html#cb111-1"></a><span class="co"># For some wierd reason standard deviations are comming back NA in the code above</span></span>
<span id="cb111-2"><a href="import-and-format-data.html#cb111-2"></a><span class="co"># Because of n_treatment being converted to a factor I need to wrangle carefully here</span></span>
<span id="cb111-3"><a href="import-and-format-data.html#cb111-3"></a>Mary_tmp &lt;-<span class="st"> </span>MarysM_<span class="dv">13</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb111-4"><a href="import-and-format-data.html#cb111-4"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb111-5"><a href="import-and-format-data.html#cb111-5"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb111-6"><a href="import-and-format-data.html#cb111-6"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="import-and-format-data.html#cb113-1"></a><span class="co"># Remive the existing yield_error columns and replace with new ones</span></span>
<span id="cb113-2"><a href="import-and-format-data.html#cb113-2"></a>MarysM_<span class="dv">13</span>_m &lt;-<span class="st"> </span><span class="kw">left_join</span>(MarysM_<span class="dv">13</span>_m[,<span class="kw">colnames</span>(MarysM_<span class="dv">13</span>_m)[<span class="kw">c</span>(<span class="op">-</span><span class="dv">29</span>,<span class="op">-</span><span class="dv">33</span>)]], Mary_tmp)</span></code></pre></div>
<pre><code>## Joining, by = &quot;n_treatment&quot;</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="import-and-format-data.html#cb115-1"></a><span class="co"># Remove other plots not in experiment</span></span>
<span id="cb115-2"><a href="import-and-format-data.html#cb115-2"></a>MarysM_<span class="dv">13</span>_m &lt;-<span class="st"> </span>MarysM_<span class="dv">13</span>_m[MarysM_<span class="dv">13</span>_m<span class="op">$</span>trade_name <span class="op">!=</span><span class="st"> &quot;other&quot;</span>,]</span>
<span id="cb115-3"><a href="import-and-format-data.html#cb115-3"></a></span>
<span id="cb115-4"><a href="import-and-format-data.html#cb115-4"></a></span>
<span id="cb115-5"><a href="import-and-format-data.html#cb115-5"></a>MarysM_<span class="dv">13</span>_m<span class="op">$</span>n_treatment &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(MarysM_<span class="dv">13</span>_m<span class="op">$</span>n_treatment))</span>
<span id="cb115-6"><a href="import-and-format-data.html#cb115-6"></a>MarysM_<span class="dv">13</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(MarysM_<span class="dv">13</span>_m, PM_MB_means)</span>
<span id="cb115-7"><a href="import-and-format-data.html#cb115-7"></a></span>
<span id="cb115-8"><a href="import-and-format-data.html#cb115-8"></a><span class="co"># insert new calculations into data</span></span>
<span id="cb115-9"><a href="import-and-format-data.html#cb115-9"></a>PM_MB_means &lt;-<span class="st"> </span><span class="kw">replace_data</span>(<span class="dt">template_data =</span> PM_MB_means, </span>
<span id="cb115-10"><a href="import-and-format-data.html#cb115-10"></a>                            <span class="dt">new_data =</span> MarysM_<span class="dv">13</span>_m, </span>
<span id="cb115-11"><a href="import-and-format-data.html#cb115-11"></a>                            <span class="dt">new_data_column =</span> <span class="kw">c</span>(<span class="st">&quot;planting_date&quot;</span>,<span class="st">&quot;AUDPC_m&quot;</span>, <span class="st">&quot;AUDPC_sd&quot;</span>, <span class="st">&quot;AUDPS_m&quot;</span>,<span class="st">&quot;AUDPS_sd&quot;</span>,<span class="st">&quot;Y_Msquare&quot;</span>, <span class="st">&quot;Inc_Ms&quot;</span>),</span>
<span id="cb115-12"><a href="import-and-format-data.html#cb115-12"></a>                            <span class="dt">filter_cols =</span> <span class="kw">c</span>(<span class="st">&quot;trial_ref&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;location&quot;</span>, <span class="st">&quot;host_genotype&quot;</span>, </span>
<span id="cb115-13"><a href="import-and-format-data.html#cb115-13"></a>                                           <span class="st">&quot;fungicide_ai&quot;</span>, <span class="st">&quot;dose_ai.ha&quot;</span>,<span class="st">&quot;n_treatment&quot;</span>))</span></code></pre></div>
<pre><code>## No data changed 0/11</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="import-and-format-data.html#cb117-1"></a><span class="kw">write.csv</span>(</span>
<span id="cb117-2"><a href="import-and-format-data.html#cb117-2"></a>   MarysM_<span class="dv">13</span>_m[<span class="kw">order</span>(<span class="kw">as.numeric</span>(MarysM_<span class="dv">13</span>_m<span class="op">$</span>n_treatment)),],</span>
<span id="cb117-3"><a href="import-and-format-data.html#cb117-3"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/AM1304-MarysMount_means.csv&quot;</span>),</span>
<span id="cb117-4"><a href="import-and-format-data.html#cb117-4"></a>   <span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb117-5"><a href="import-and-format-data.html#cb117-5"></a>)</span></code></pre></div>
</div>
</div>
<div id="premer-2013" class="section level3">
<h3><span class="header-section-number">3.4.6</span> Premer 2013</h3>
<div id="convert-disease-scores-2" class="section level4">
<h4><span class="header-section-number">3.4.6.1</span> Convert disease scores</h4>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="import-and-format-data.html#cb118-1"></a><span class="cf">for</span>(D_assess <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;19 DAT1 19-3-2013&quot;</span>,<span class="st">&quot;31 DAT1 31-3-2013&quot;</span>)){</span>
<span id="cb118-2"><a href="import-and-format-data.html#cb118-2"></a></span>
<span id="cb118-3"><a href="import-and-format-data.html#cb118-3"></a><span class="co"># Import final disease survey</span></span>
<span id="cb118-4"><a href="import-and-format-data.html#cb118-4"></a>Premer<span class="fl">.13</span>D &lt;-</span>
<span id="cb118-5"><a href="import-and-format-data.html#cb118-5"></a><span class="st">   </span><span class="kw">as.data.frame</span>(</span>
<span id="cb118-6"><a href="import-and-format-data.html#cb118-6"></a>      <span class="kw">read_xlsx</span>(</span>
<span id="cb118-7"><a href="import-and-format-data.html#cb118-7"></a>         <span class="dt">path =</span> <span class="kw">here</span>(<span class="st">&quot;data/AM1303 Fungicides for powdery mildew in mungbean - Premer.xlsx&quot;</span>),</span>
<span id="cb118-8"><a href="import-and-format-data.html#cb118-8"></a>         <span class="dt">sheet =</span> D_assess,</span>
<span id="cb118-9"><a href="import-and-format-data.html#cb118-9"></a>         <span class="dt">range =</span> <span class="st">&quot;A14:DC64&quot;</span>,</span>
<span id="cb118-10"><a href="import-and-format-data.html#cb118-10"></a>         <span class="dt">col_names =</span> <span class="ot">TRUE</span></span>
<span id="cb118-11"><a href="import-and-format-data.html#cb118-11"></a>      )</span>
<span id="cb118-12"><a href="import-and-format-data.html#cb118-12"></a>   )</span>
<span id="cb118-13"><a href="import-and-format-data.html#cb118-13"></a></span>
<span id="cb118-14"><a href="import-and-format-data.html#cb118-14"></a></span>
<span id="cb118-15"><a href="import-and-format-data.html#cb118-15"></a></span>
<span id="cb118-16"><a href="import-and-format-data.html#cb118-16"></a><span class="kw">colnames</span>(Premer<span class="fl">.13</span>D)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Treat&quot;</span>, <span class="st">&quot;Rep&quot;</span>, <span class="st">&quot;Run&quot;</span>, <span class="st">&quot;Plot&quot;</span>)</span>
<span id="cb118-17"><a href="import-and-format-data.html#cb118-17"></a>Premer<span class="fl">.13</span>D &lt;-<span class="st"> </span>Premer<span class="fl">.13</span>D[<span class="kw">order</span>(Premer<span class="fl">.13</span>D[,<span class="dv">1</span>],Premer<span class="fl">.13</span>D[,<span class="dv">2</span>],Premer<span class="fl">.13</span>D[,<span class="dv">3</span>],Premer<span class="fl">.13</span>D[,<span class="dv">4</span>]),]</span>
<span id="cb118-18"><a href="import-and-format-data.html#cb118-18"></a></span>
<span id="cb118-19"><a href="import-and-format-data.html#cb118-19"></a></span>
<span id="cb118-20"><a href="import-and-format-data.html#cb118-20"></a><span class="co"># remove Plots not surveyed</span></span>
<span id="cb118-21"><a href="import-and-format-data.html#cb118-21"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(Premer<span class="fl">.13</span>D[, <span class="dv">1</span>])) {</span>
<span id="cb118-22"><a href="import-and-format-data.html#cb118-22"></a>   <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb118-23"><a href="import-and-format-data.html#cb118-23"></a>      plotsRecorded &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">length =</span> <span class="kw">length</span>(Premer<span class="fl">.13</span>D[, <span class="dv">1</span>]))</span>
<span id="cb118-24"><a href="import-and-format-data.html#cb118-24"></a>   }</span>
<span id="cb118-25"><a href="import-and-format-data.html#cb118-25"></a>   </span>
<span id="cb118-26"><a href="import-and-format-data.html#cb118-26"></a>   plotsRecorded[i] &lt;-<span class="st"> </span><span class="kw">all</span>(<span class="kw">is.na</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">7</span><span class="op">:</span><span class="dv">56</span>]))</span>
<span id="cb118-27"><a href="import-and-format-data.html#cb118-27"></a>   </span>
<span id="cb118-28"><a href="import-and-format-data.html#cb118-28"></a>}</span>
<span id="cb118-29"><a href="import-and-format-data.html#cb118-29"></a><span class="co"># remove Plots not surveyed</span></span>
<span id="cb118-30"><a href="import-and-format-data.html#cb118-30"></a>Premer<span class="fl">.13</span>D &lt;-<span class="st"> </span>Premer<span class="fl">.13</span>D[<span class="op">!</span>plotsRecorded, ]</span>
<span id="cb118-31"><a href="import-and-format-data.html#cb118-31"></a></span>
<span id="cb118-32"><a href="import-and-format-data.html#cb118-32"></a>incidence3 &lt;-</span>
<span id="cb118-33"><a href="import-and-format-data.html#cb118-33"></a><span class="st">   </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;numeric&quot;</span>, <span class="dt">length =</span> <span class="kw">length</span>(Premer<span class="fl">.13</span>D[, <span class="dv">1</span>]))</span>
<span id="cb118-34"><a href="import-and-format-data.html#cb118-34"></a></span>
<span id="cb118-35"><a href="import-and-format-data.html#cb118-35"></a></span>
<span id="cb118-36"><a href="import-and-format-data.html#cb118-36"></a><span class="co"># Convert disease survey data to 1-9 Incidence rating scale</span></span>
<span id="cb118-37"><a href="import-and-format-data.html#cb118-37"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(incidence3)) {</span>
<span id="cb118-38"><a href="import-and-format-data.html#cb118-38"></a>   </span>
<span id="cb118-39"><a href="import-and-format-data.html#cb118-39"></a>   <span class="co"># incidence = 1</span></span>
<span id="cb118-40"><a href="import-and-format-data.html#cb118-40"></a>   <span class="cf">if</span> (<span class="kw">all</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)) {</span>
<span id="cb118-41"><a href="import-and-format-data.html#cb118-41"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb118-42"><a href="import-and-format-data.html#cb118-42"></a>      <span class="cf">next</span>()</span>
<span id="cb118-43"><a href="import-and-format-data.html#cb118-43"></a>   }</span>
<span id="cb118-44"><a href="import-and-format-data.html#cb118-44"></a>   </span>
<span id="cb118-45"><a href="import-and-format-data.html#cb118-45"></a>   <span class="co"># incidence = 2</span></span>
<span id="cb118-46"><a href="import-and-format-data.html#cb118-46"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-47"><a href="import-and-format-data.html#cb118-47"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-48"><a href="import-and-format-data.html#cb118-48"></a><span class="st">       </span>(<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span></span>
<span id="cb118-49"><a href="import-and-format-data.html#cb118-49"></a><span class="st">        </span><span class="kw">length</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb118-50"><a href="import-and-format-data.html#cb118-50"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb118-51"><a href="import-and-format-data.html#cb118-51"></a>      <span class="cf">next</span>()</span>
<span id="cb118-52"><a href="import-and-format-data.html#cb118-52"></a>   }</span>
<span id="cb118-53"><a href="import-and-format-data.html#cb118-53"></a>   </span>
<span id="cb118-54"><a href="import-and-format-data.html#cb118-54"></a>   </span>
<span id="cb118-55"><a href="import-and-format-data.html#cb118-55"></a>   <span class="co"># incidence = 3</span></span>
<span id="cb118-56"><a href="import-and-format-data.html#cb118-56"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-57"><a href="import-and-format-data.html#cb118-57"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-58"><a href="import-and-format-data.html#cb118-58"></a><span class="st">       </span>(<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span></span>
<span id="cb118-59"><a href="import-and-format-data.html#cb118-59"></a><span class="st">        </span><span class="kw">length</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb118-60"><a href="import-and-format-data.html#cb118-60"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb118-61"><a href="import-and-format-data.html#cb118-61"></a>   } <span class="cf">else</span>{</span>
<span id="cb118-62"><a href="import-and-format-data.html#cb118-62"></a>      <span class="co"># if it is in the lower half of the canopy and in less than 75% of plants then incidence = 2.5</span></span>
<span id="cb118-63"><a href="import-and-format-data.html#cb118-63"></a>      <span class="cf">if</span> (<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-64"><a href="import-and-format-data.html#cb118-64"></a><span class="st">          </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-65"><a href="import-and-format-data.html#cb118-65"></a><span class="st">          </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-66"><a href="import-and-format-data.html#cb118-66"></a><span class="st">          </span>(<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span></span>
<span id="cb118-67"><a href="import-and-format-data.html#cb118-67"></a><span class="st">           </span><span class="kw">length</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb118-68"><a href="import-and-format-data.html#cb118-68"></a>         incidence3[i] &lt;-<span class="st"> </span><span class="fl">2.5</span></span>
<span id="cb118-69"><a href="import-and-format-data.html#cb118-69"></a>         <span class="cf">next</span>()</span>
<span id="cb118-70"><a href="import-and-format-data.html#cb118-70"></a>      }</span>
<span id="cb118-71"><a href="import-and-format-data.html#cb118-71"></a>   }</span>
<span id="cb118-72"><a href="import-and-format-data.html#cb118-72"></a>   </span>
<span id="cb118-73"><a href="import-and-format-data.html#cb118-73"></a>   </span>
<span id="cb118-74"><a href="import-and-format-data.html#cb118-74"></a>   <span class="co"># incidence = 4</span></span>
<span id="cb118-75"><a href="import-and-format-data.html#cb118-75"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-76"><a href="import-and-format-data.html#cb118-76"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-77"><a href="import-and-format-data.html#cb118-77"></a><span class="st">       </span>(<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span></span>
<span id="cb118-78"><a href="import-and-format-data.html#cb118-78"></a><span class="st">        </span><span class="kw">length</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb118-79"><a href="import-and-format-data.html#cb118-79"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb118-80"><a href="import-and-format-data.html#cb118-80"></a>      <span class="cf">next</span>()</span>
<span id="cb118-81"><a href="import-and-format-data.html#cb118-81"></a>   }</span>
<span id="cb118-82"><a href="import-and-format-data.html#cb118-82"></a>   </span>
<span id="cb118-83"><a href="import-and-format-data.html#cb118-83"></a>   </span>
<span id="cb118-84"><a href="import-and-format-data.html#cb118-84"></a>   <span class="co"># incidence = 5</span></span>
<span id="cb118-85"><a href="import-and-format-data.html#cb118-85"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-86"><a href="import-and-format-data.html#cb118-86"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-87"><a href="import-and-format-data.html#cb118-87"></a><span class="st">       </span>(<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span></span>
<span id="cb118-88"><a href="import-and-format-data.html#cb118-88"></a><span class="st">        </span><span class="kw">length</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb118-89"><a href="import-and-format-data.html#cb118-89"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb118-90"><a href="import-and-format-data.html#cb118-90"></a>      <span class="cf">next</span>()</span>
<span id="cb118-91"><a href="import-and-format-data.html#cb118-91"></a>   }</span>
<span id="cb118-92"><a href="import-and-format-data.html#cb118-92"></a>   </span>
<span id="cb118-93"><a href="import-and-format-data.html#cb118-93"></a>   </span>
<span id="cb118-94"><a href="import-and-format-data.html#cb118-94"></a>   <span class="co"># incidence = 6</span></span>
<span id="cb118-95"><a href="import-and-format-data.html#cb118-95"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-96"><a href="import-and-format-data.html#cb118-96"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-97"><a href="import-and-format-data.html#cb118-97"></a><span class="st">       </span>(<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span></span>
<span id="cb118-98"><a href="import-and-format-data.html#cb118-98"></a><span class="st">        </span><span class="kw">length</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.95</span>) {</span>
<span id="cb118-99"><a href="import-and-format-data.html#cb118-99"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="dv">6</span></span>
<span id="cb118-100"><a href="import-and-format-data.html#cb118-100"></a>      <span class="cf">next</span>()</span>
<span id="cb118-101"><a href="import-and-format-data.html#cb118-101"></a>   }</span>
<span id="cb118-102"><a href="import-and-format-data.html#cb118-102"></a>   </span>
<span id="cb118-103"><a href="import-and-format-data.html#cb118-103"></a>   </span>
<span id="cb118-104"><a href="import-and-format-data.html#cb118-104"></a>   <span class="co"># incidence = 7</span></span>
<span id="cb118-105"><a href="import-and-format-data.html#cb118-105"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-106"><a href="import-and-format-data.html#cb118-106"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-107"><a href="import-and-format-data.html#cb118-107"></a><span class="st">       </span>(<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span></span>
<span id="cb118-108"><a href="import-and-format-data.html#cb118-108"></a><span class="st">        </span><span class="kw">length</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.95</span>) {</span>
<span id="cb118-109"><a href="import-and-format-data.html#cb118-109"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="dv">7</span></span>
<span id="cb118-110"><a href="import-and-format-data.html#cb118-110"></a>      <span class="cf">next</span>()</span>
<span id="cb118-111"><a href="import-and-format-data.html#cb118-111"></a>   }</span>
<span id="cb118-112"><a href="import-and-format-data.html#cb118-112"></a>   </span>
<span id="cb118-113"><a href="import-and-format-data.html#cb118-113"></a>   </span>
<span id="cb118-114"><a href="import-and-format-data.html#cb118-114"></a>   <span class="co"># incidence = 8</span></span>
<span id="cb118-115"><a href="import-and-format-data.html#cb118-115"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-116"><a href="import-and-format-data.html#cb118-116"></a><span class="st">       </span>(<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span></span>
<span id="cb118-117"><a href="import-and-format-data.html#cb118-117"></a><span class="st">        </span><span class="kw">length</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb118-118"><a href="import-and-format-data.html#cb118-118"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="dv">8</span></span>
<span id="cb118-119"><a href="import-and-format-data.html#cb118-119"></a>      <span class="cf">next</span>()</span>
<span id="cb118-120"><a href="import-and-format-data.html#cb118-120"></a>   }</span>
<span id="cb118-121"><a href="import-and-format-data.html#cb118-121"></a>   </span>
<span id="cb118-122"><a href="import-and-format-data.html#cb118-122"></a>   </span>
<span id="cb118-123"><a href="import-and-format-data.html#cb118-123"></a>   <span class="co"># incidence = 9</span></span>
<span id="cb118-124"><a href="import-and-format-data.html#cb118-124"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-125"><a href="import-and-format-data.html#cb118-125"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">7</span><span class="op">:</span><span class="dv">56</span>] <span class="op">&gt;=</span><span class="st"> </span>(<span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.75</span>)) <span class="op">&amp;&amp;</span></span>
<span id="cb118-126"><a href="import-and-format-data.html#cb118-126"></a><span class="st">       </span><span class="co"># ten leaves from 5 sample sites with a maximum % leaf area infected with PM of 100% * 0.75 as a threshold for leaf drop</span></span>
<span id="cb118-127"><a href="import-and-format-data.html#cb118-127"></a><span class="st">       </span>(<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb118-128"><a href="import-and-format-data.html#cb118-128"></a><span class="st">        </span><span class="kw">length</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>])) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb118-129"><a href="import-and-format-data.html#cb118-129"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="dv">9</span></span>
<span id="cb118-130"><a href="import-and-format-data.html#cb118-130"></a>      <span class="cf">next</span>()</span>
<span id="cb118-131"><a href="import-and-format-data.html#cb118-131"></a>   }</span>
<span id="cb118-132"><a href="import-and-format-data.html#cb118-132"></a>   </span>
<span id="cb118-133"><a href="import-and-format-data.html#cb118-133"></a>   <span class="co"># if there are few (&lt; 10%) leaves with very small infections in all parts of the canopy OR</span></span>
<span id="cb118-134"><a href="import-and-format-data.html#cb118-134"></a>   <span class="co"># if there is a stray colony on a upper leaf in addition to all lower</span></span>
<span id="cb118-135"><a href="import-and-format-data.html#cb118-135"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-136"><a href="import-and-format-data.html#cb118-136"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-137"><a href="import-and-format-data.html#cb118-137"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-138"><a href="import-and-format-data.html#cb118-138"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">7</span><span class="op">:</span><span class="dv">56</span>]) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">150</span>) {</span>
<span id="cb118-139"><a href="import-and-format-data.html#cb118-139"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="fl">2.5</span></span>
<span id="cb118-140"><a href="import-and-format-data.html#cb118-140"></a>      <span class="cf">next</span>()</span>
<span id="cb118-141"><a href="import-and-format-data.html#cb118-141"></a>   }</span>
<span id="cb118-142"><a href="import-and-format-data.html#cb118-142"></a>   </span>
<span id="cb118-143"><a href="import-and-format-data.html#cb118-143"></a>   <span class="co"># incidence = 7.5  In the upper canopy with less than 75% plants infected</span></span>
<span id="cb118-144"><a href="import-and-format-data.html#cb118-144"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-145"><a href="import-and-format-data.html#cb118-145"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-146"><a href="import-and-format-data.html#cb118-146"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-147"><a href="import-and-format-data.html#cb118-147"></a><span class="st">       </span>(<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb118-148"><a href="import-and-format-data.html#cb118-148"></a><span class="st">        </span><span class="kw">length</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>]) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb118-149"><a href="import-and-format-data.html#cb118-149"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">7</span><span class="op">:</span><span class="dv">56</span>]) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">150</span>) {</span>
<span id="cb118-150"><a href="import-and-format-data.html#cb118-150"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="fl">7.5</span></span>
<span id="cb118-151"><a href="import-and-format-data.html#cb118-151"></a>      <span class="cf">next</span>()</span>
<span id="cb118-152"><a href="import-and-format-data.html#cb118-152"></a>   }</span>
<span id="cb118-153"><a href="import-and-format-data.html#cb118-153"></a>   <span class="co">#</span></span>
<span id="cb118-154"><a href="import-and-format-data.html#cb118-154"></a>   <span class="co"># incidence = 6.5</span></span>
<span id="cb118-155"><a href="import-and-format-data.html#cb118-155"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-156"><a href="import-and-format-data.html#cb118-156"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-157"><a href="import-and-format-data.html#cb118-157"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">7</span><span class="op">:</span><span class="dv">56</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>)  <span class="op">&amp;&amp;</span></span>
<span id="cb118-158"><a href="import-and-format-data.html#cb118-158"></a><span class="st">       </span>(<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb118-159"><a href="import-and-format-data.html#cb118-159"></a><span class="st">        </span><span class="kw">length</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>]) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.65</span>)) {</span>
<span id="cb118-160"><a href="import-and-format-data.html#cb118-160"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="fl">6.5</span></span>
<span id="cb118-161"><a href="import-and-format-data.html#cb118-161"></a>      <span class="cf">next</span>()</span>
<span id="cb118-162"><a href="import-and-format-data.html#cb118-162"></a>   }</span>
<span id="cb118-163"><a href="import-and-format-data.html#cb118-163"></a>   <span class="co">#</span></span>
<span id="cb118-164"><a href="import-and-format-data.html#cb118-164"></a>   <span class="co">#</span></span>
<span id="cb118-165"><a href="import-and-format-data.html#cb118-165"></a>   <span class="co"># incidence = 4.5 If PM is in the the lower and mid-canopy in less than 75% of plants and one or two in the upper canopy</span></span>
<span id="cb118-166"><a href="import-and-format-data.html#cb118-166"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-167"><a href="import-and-format-data.html#cb118-167"></a><span class="st">       </span><span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb118-168"><a href="import-and-format-data.html#cb118-168"></a><span class="st">       </span>(<span class="kw">sum</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb118-169"><a href="import-and-format-data.html#cb118-169"></a><span class="st">        </span><span class="kw">length</span>(Premer<span class="fl">.13</span>D[i, <span class="dv">58</span><span class="op">:</span><span class="dv">107</span>])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb118-170"><a href="import-and-format-data.html#cb118-170"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="fl">4.5</span></span>
<span id="cb118-171"><a href="import-and-format-data.html#cb118-171"></a>      <span class="cf">next</span>()</span>
<span id="cb118-172"><a href="import-and-format-data.html#cb118-172"></a>   } <span class="cf">else</span>{</span>
<span id="cb118-173"><a href="import-and-format-data.html#cb118-173"></a>      <span class="co"># If none of the conditions are met give the incidence zero</span></span>
<span id="cb118-174"><a href="import-and-format-data.html#cb118-174"></a>      incidence3[i] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb118-175"><a href="import-and-format-data.html#cb118-175"></a>   }</span>
<span id="cb118-176"><a href="import-and-format-data.html#cb118-176"></a>   </span>
<span id="cb118-177"><a href="import-and-format-data.html#cb118-177"></a>}<span class="co"># end incidence loop</span></span>
<span id="cb118-178"><a href="import-and-format-data.html#cb118-178"></a></span>
<span id="cb118-179"><a href="import-and-format-data.html#cb118-179"></a><span class="cf">if</span>(<span class="kw">any</span>(incidence3 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)){</span>
<span id="cb118-180"><a href="import-and-format-data.html#cb118-180"></a>   <span class="kw">warning</span>(<span class="st">&quot;Code caluculated incidence on &#39;0&#39; which is off the incidence scale&quot;</span>)}</span>
<span id="cb118-181"><a href="import-and-format-data.html#cb118-181"></a></span>
<span id="cb118-182"><a href="import-and-format-data.html#cb118-182"></a></span>
<span id="cb118-183"><a href="import-and-format-data.html#cb118-183"></a><span class="co"># Re-format data-frame</span></span>
<span id="cb118-184"><a href="import-and-format-data.html#cb118-184"></a><span class="cf">if</span>(D_assess <span class="op">==</span><span class="st"> &quot;19 DAT1 19-3-2013&quot;</span>){</span>
<span id="cb118-185"><a href="import-and-format-data.html#cb118-185"></a>   Premer<span class="fl">.13</span>D<span class="fl">.1</span> &lt;-<span class="st"> </span>Premer<span class="fl">.13</span>D[,<span class="kw">c</span>(<span class="st">&quot;Treat&quot;</span>, <span class="st">&quot;Rep&quot;</span>, <span class="st">&quot;Run&quot;</span>, <span class="st">&quot;Plot&quot;</span>)]</span>
<span id="cb118-186"><a href="import-and-format-data.html#cb118-186"></a>   Premer<span class="fl">.13</span>D<span class="fl">.1</span><span class="op">$</span>Inc_19D &lt;-<span class="st">  </span>incidence3}</span>
<span id="cb118-187"><a href="import-and-format-data.html#cb118-187"></a>   </span>
<span id="cb118-188"><a href="import-and-format-data.html#cb118-188"></a></span>
<span id="cb118-189"><a href="import-and-format-data.html#cb118-189"></a><span class="cf">if</span>(D_assess <span class="op">==</span><span class="st"> &quot;31 DAT1 31-3-2013&quot;</span>){</span>
<span id="cb118-190"><a href="import-and-format-data.html#cb118-190"></a>   Premer<span class="fl">.13</span>D<span class="fl">.2</span> &lt;-<span class="st"> </span>Premer<span class="fl">.13</span>D[,<span class="kw">c</span>(<span class="st">&quot;Treat&quot;</span>, <span class="st">&quot;Rep&quot;</span>, <span class="st">&quot;Run&quot;</span>, <span class="st">&quot;Plot&quot;</span>)]</span>
<span id="cb118-191"><a href="import-and-format-data.html#cb118-191"></a>   Premer<span class="fl">.13</span>D<span class="fl">.2</span><span class="op">$</span>Inc_31D &lt;-<span class="st">  </span>incidence3}</span>
<span id="cb118-192"><a href="import-and-format-data.html#cb118-192"></a></span>
<span id="cb118-193"><a href="import-and-format-data.html#cb118-193"></a>}<span class="co"># end disease assessment loop</span></span></code></pre></div>
<pre><code>## New names:
## * `` -&gt; ...6
## * `1` -&gt; `1...7`
## * `2` -&gt; `2...8`
## * `3` -&gt; `3...9`
## * `4` -&gt; `4...10`
## * ...</code></pre>
<pre><code>## New names:
## * `` -&gt; ...5
## * `` -&gt; ...6
## * `1` -&gt; `1...7`
## * `2` -&gt; `2...8`
## * `3` -&gt; `3...9`
## * ...</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="import-and-format-data.html#cb121-1"></a><span class="co"># The 19 Days after T1 only assessed the first 6 treatments</span></span>
<span id="cb121-2"><a href="import-and-format-data.html#cb121-2"></a><span class="co"># Therefore it will be dropped</span></span>
<span id="cb121-3"><a href="import-and-format-data.html#cb121-3"></a>Premer<span class="fl">.13</span>D &lt;-<span class="st"> </span>Premer<span class="fl">.13</span>D<span class="fl">.2</span></span>
<span id="cb121-4"><a href="import-and-format-data.html#cb121-4"></a></span>
<span id="cb121-5"><a href="import-and-format-data.html#cb121-5"></a></span>
<span id="cb121-6"><a href="import-and-format-data.html#cb121-6"></a><span class="co"># read in yield and format</span></span>
<span id="cb121-7"><a href="import-and-format-data.html#cb121-7"></a>Premer<span class="fl">.13</span>Y &lt;-</span>
<span id="cb121-8"><a href="import-and-format-data.html#cb121-8"></a><span class="st">   </span><span class="kw">as.data.frame</span>(</span>
<span id="cb121-9"><a href="import-and-format-data.html#cb121-9"></a>      <span class="kw">read_xlsx</span>(</span>
<span id="cb121-10"><a href="import-and-format-data.html#cb121-10"></a>         <span class="dt">path =</span> <span class="kw">here</span>(<span class="st">&quot;data/AM1303 Fungicides for powdery mildew in mungbean - Premer.xlsx&quot;</span>),</span>
<span id="cb121-11"><a href="import-and-format-data.html#cb121-11"></a>         <span class="dt">sheet =</span> <span class="st">&quot;Yield 18-4-2013&quot;</span>,</span>
<span id="cb121-12"><a href="import-and-format-data.html#cb121-12"></a>         <span class="dt">range =</span> <span class="st">&quot;A14:F58&quot;</span>,</span>
<span id="cb121-13"><a href="import-and-format-data.html#cb121-13"></a>         <span class="dt">col_names =</span> <span class="ot">TRUE</span></span>
<span id="cb121-14"><a href="import-and-format-data.html#cb121-14"></a>      )</span>
<span id="cb121-15"><a href="import-and-format-data.html#cb121-15"></a>   )</span>
<span id="cb121-16"><a href="import-and-format-data.html#cb121-16"></a>Premer<span class="fl">.13</span>Y<span class="op">$</span>Treat &lt;-<span class="st"> </span><span class="kw">as.character</span>(Premer<span class="fl">.13</span>Y<span class="op">$</span>Treat)</span>
<span id="cb121-17"><a href="import-and-format-data.html#cb121-17"></a></span>
<span id="cb121-18"><a href="import-and-format-data.html#cb121-18"></a>Premer_<span class="dv">13</span> &lt;-<span class="st"> </span><span class="kw">left_join</span>(Premer<span class="fl">.13</span>D,Premer<span class="fl">.13</span>Y)</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;Treat&quot;, &quot;Rep&quot;, &quot;Run&quot;, &quot;Plot&quot;)</code></pre>
</div>
<div id="define-treatment-data-3" class="section level4">
<h4><span class="header-section-number">3.4.6.2</span> Define treatment data</h4>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="import-and-format-data.html#cb123-1"></a>Premer_<span class="dv">13</span> &lt;-<span class="st"> </span>Premer_<span class="dv">13</span> <span class="op">%&gt;%</span></span>
<span id="cb123-2"><a href="import-and-format-data.html#cb123-2"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trade_name =</span> </span>
<span id="cb123-3"><a href="import-and-format-data.html#cb123-3"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb123-4"><a href="import-and-format-data.html#cb123-4"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> &quot;Spin-flo&quot;</span>,</span>
<span id="cb123-5"><a href="import-and-format-data.html#cb123-5"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> &quot;Tilt&quot;</span>,</span>
<span id="cb123-6"><a href="import-and-format-data.html#cb123-6"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra&quot;</span>,</span>
<span id="cb123-7"><a href="import-and-format-data.html#cb123-7"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra + adj&quot;</span>,</span>
<span id="cb123-8"><a href="import-and-format-data.html#cb123-8"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> &quot;Cabrio&quot;</span>,</span>
<span id="cb123-9"><a href="import-and-format-data.html#cb123-9"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> &quot;Spin-flo&quot;</span>,</span>
<span id="cb123-10"><a href="import-and-format-data.html#cb123-10"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> &quot;Tilt&quot;</span>,</span>
<span id="cb123-11"><a href="import-and-format-data.html#cb123-11"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra + adj&quot;</span>,</span>
<span id="cb123-12"><a href="import-and-format-data.html#cb123-12"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> &quot;Cabrio&quot;</span>,</span>
<span id="cb123-13"><a href="import-and-format-data.html#cb123-13"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> &quot;Tilt&quot;</span>,</span>
<span id="cb123-14"><a href="import-and-format-data.html#cb123-14"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb123-15"><a href="import-and-format-data.html#cb123-15"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_ai =</span> </span>
<span id="cb123-16"><a href="import-and-format-data.html#cb123-16"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb123-17"><a href="import-and-format-data.html#cb123-17"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> &quot;carbendazim&quot;</span>,</span>
<span id="cb123-18"><a href="import-and-format-data.html#cb123-18"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb123-19"><a href="import-and-format-data.html#cb123-19"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb123-20"><a href="import-and-format-data.html#cb123-20"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb123-21"><a href="import-and-format-data.html#cb123-21"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> &quot;pyraclostrobin&quot;</span>,</span>
<span id="cb123-22"><a href="import-and-format-data.html#cb123-22"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> &quot;carbendazim&quot;</span>,</span>
<span id="cb123-23"><a href="import-and-format-data.html#cb123-23"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb123-24"><a href="import-and-format-data.html#cb123-24"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb123-25"><a href="import-and-format-data.html#cb123-25"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> &quot;pyraclostrobin&quot;</span>,</span>
<span id="cb123-26"><a href="import-and-format-data.html#cb123-26"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb123-27"><a href="import-and-format-data.html#cb123-27"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb123-28"><a href="import-and-format-data.html#cb123-28"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> </span>
<span id="cb123-29"><a href="import-and-format-data.html#cb123-29"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb123-30"><a href="import-and-format-data.html#cb123-30"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">250</span>,</span>
<span id="cb123-31"><a href="import-and-format-data.html#cb123-31"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.5</span>,</span>
<span id="cb123-32"><a href="import-and-format-data.html#cb123-32"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">40</span>,</span>
<span id="cb123-33"><a href="import-and-format-data.html#cb123-33"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">40</span>,</span>
<span id="cb123-34"><a href="import-and-format-data.html#cb123-34"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">125</span>,</span>
<span id="cb123-35"><a href="import-and-format-data.html#cb123-35"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">250</span>,</span>
<span id="cb123-36"><a href="import-and-format-data.html#cb123-36"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.5</span>,</span>
<span id="cb123-37"><a href="import-and-format-data.html#cb123-37"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">40</span>,</span>
<span id="cb123-38"><a href="import-and-format-data.html#cb123-38"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">125</span>,</span>
<span id="cb123-39"><a href="import-and-format-data.html#cb123-39"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.5</span>,</span>
<span id="cb123-40"><a href="import-and-format-data.html#cb123-40"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>))<span class="op">%&gt;%</span></span>
<span id="cb123-41"><a href="import-and-format-data.html#cb123-41"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_1 =</span> </span>
<span id="cb123-42"><a href="import-and-format-data.html#cb123-42"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb123-43"><a href="import-and-format-data.html#cb123-43"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-44"><a href="import-and-format-data.html#cb123-44"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-45"><a href="import-and-format-data.html#cb123-45"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-46"><a href="import-and-format-data.html#cb123-46"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-47"><a href="import-and-format-data.html#cb123-47"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-48"><a href="import-and-format-data.html#cb123-48"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-49"><a href="import-and-format-data.html#cb123-49"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-50"><a href="import-and-format-data.html#cb123-50"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-51"><a href="import-and-format-data.html#cb123-51"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-52"><a href="import-and-format-data.html#cb123-52"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-53"><a href="import-and-format-data.html#cb123-53"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb123-54"><a href="import-and-format-data.html#cb123-54"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_2 =</span> </span>
<span id="cb123-55"><a href="import-and-format-data.html#cb123-55"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-19&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-56"><a href="import-and-format-data.html#cb123-56"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-19&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-57"><a href="import-and-format-data.html#cb123-57"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-19&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-58"><a href="import-and-format-data.html#cb123-58"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-19&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-59"><a href="import-and-format-data.html#cb123-59"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-19&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-60"><a href="import-and-format-data.html#cb123-60"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb123-61"><a href="import-and-format-data.html#cb123-61"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_3 =</span> </span>
<span id="cb123-62"><a href="import-and-format-data.html#cb123-62"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-31&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb123-63"><a href="import-and-format-data.html#cb123-63"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb123-64"><a href="import-and-format-data.html#cb123-64"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">spray_n =</span> </span>
<span id="cb123-65"><a href="import-and-format-data.html#cb123-65"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb123-66"><a href="import-and-format-data.html#cb123-66"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb123-67"><a href="import-and-format-data.html#cb123-67"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb123-68"><a href="import-and-format-data.html#cb123-68"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb123-69"><a href="import-and-format-data.html#cb123-69"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb123-70"><a href="import-and-format-data.html#cb123-70"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb123-71"><a href="import-and-format-data.html#cb123-71"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb123-72"><a href="import-and-format-data.html#cb123-72"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb123-73"><a href="import-and-format-data.html#cb123-73"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb123-74"><a href="import-and-format-data.html#cb123-74"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb123-75"><a href="import-and-format-data.html#cb123-75"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>, </span>
<span id="cb123-76"><a href="import-and-format-data.html#cb123-76"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>))</span></code></pre></div>
</div>
<div id="input-trial-data-4" class="section level4">
<h4><span class="header-section-number">3.4.6.3</span> Input trial data</h4>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="import-and-format-data.html#cb124-1"></a>Premer_<span class="dv">13</span>_dat &lt;-<span class="st"> </span></span>
<span id="cb124-2"><a href="import-and-format-data.html#cb124-2"></a><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">trial_ref =</span> <span class="st">&quot;AM1303&quot;</span>,</span>
<span id="cb124-3"><a href="import-and-format-data.html#cb124-3"></a>              <span class="dt">year =</span> <span class="st">&quot;2013&quot;</span>,</span>
<span id="cb124-4"><a href="import-and-format-data.html#cb124-4"></a>              <span class="dt">location =</span> <span class="st">&quot;Premer&quot;</span>,</span>
<span id="cb124-5"><a href="import-and-format-data.html#cb124-5"></a>              <span class="dt">host_genotype =</span> <span class="st">&quot;Crystal&quot;</span>,</span>
<span id="cb124-6"><a href="import-and-format-data.html#cb124-6"></a>              <span class="dt">trial_design =</span> <span class="st">&quot;RCB&quot;</span>,</span>
<span id="cb124-7"><a href="import-and-format-data.html#cb124-7"></a>              <span class="dt">plot_length =</span> <span class="dv">12</span>,</span>
<span id="cb124-8"><a href="import-and-format-data.html#cb124-8"></a>              <span class="dt">plot_width =</span> <span class="dv">4</span>,</span>
<span id="cb124-9"><a href="import-and-format-data.html#cb124-9"></a>              <span class="dt">plant_density =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb124-10"><a href="import-and-format-data.html#cb124-10"></a>              <span class="dt">row_spacing =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb124-11"><a href="import-and-format-data.html#cb124-11"></a>              <span class="dt">replicate =</span> Premer_<span class="dv">13</span><span class="op">$</span>Rep,</span>
<span id="cb124-12"><a href="import-and-format-data.html#cb124-12"></a>              <span class="dt">planting_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2012-12-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb124-13"><a href="import-and-format-data.html#cb124-13"></a>              <span class="dt">emergence_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb124-14"><a href="import-and-format-data.html#cb124-14"></a>              <span class="dt">flowering_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb124-15"><a href="import-and-format-data.html#cb124-15"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb124-16"><a href="import-and-format-data.html#cb124-16"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb124-17"><a href="import-and-format-data.html#cb124-17"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-02-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb124-18"><a href="import-and-format-data.html#cb124-18"></a>              <span class="dt">trade_name =</span> <span class="kw">as.factor</span>(Premer_<span class="dv">13</span><span class="op">$</span>trade_name),</span>
<span id="cb124-19"><a href="import-and-format-data.html#cb124-19"></a>              <span class="dt">fungicide_ai =</span> Premer_<span class="dv">13</span><span class="op">$</span>fungicide_ai,</span>
<span id="cb124-20"><a href="import-and-format-data.html#cb124-20"></a>              <span class="dt">dose_ai.ha =</span> Premer_<span class="dv">13</span><span class="op">$</span>dose_ai.ha,</span>
<span id="cb124-21"><a href="import-and-format-data.html#cb124-21"></a>              <span class="dt">n_treatment =</span> Premer_<span class="dv">13</span><span class="op">$</span>Treat,</span>
<span id="cb124-22"><a href="import-and-format-data.html#cb124-22"></a>              <span class="dt">fungicide_application_1 =</span> Premer_<span class="dv">13</span><span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb124-23"><a href="import-and-format-data.html#cb124-23"></a>              <span class="dt">fungicide_application_2 =</span> Premer_<span class="dv">13</span><span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb124-24"><a href="import-and-format-data.html#cb124-24"></a>              <span class="dt">fungicide_application_3 =</span> Premer_<span class="dv">13</span><span class="op">$</span>fungicide_application_<span class="dv">3</span>,</span>
<span id="cb124-25"><a href="import-and-format-data.html#cb124-25"></a>              <span class="dt">total_fungicide =</span> Premer_<span class="dv">13</span><span class="op">$</span>spray_n,</span>
<span id="cb124-26"><a href="import-and-format-data.html#cb124-26"></a>              <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-04-18&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb124-27"><a href="import-and-format-data.html#cb124-27"></a>              <span class="dt">final_assessment =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-03-31&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb124-28"><a href="import-and-format-data.html#cb124-28"></a>              <span class="dt">PM_final_severity =</span> Premer_<span class="dv">13</span><span class="op">$</span>Inc_31D,</span>
<span id="cb124-29"><a href="import-and-format-data.html#cb124-29"></a>              <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb124-30"><a href="import-and-format-data.html#cb124-30"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">as.numeric</span>(Premer_<span class="dv">13</span><span class="op">$</span><span class="st">`</span><span class="dt">Yield kg/ha</span><span class="st">`</span>)<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb124-31"><a href="import-and-format-data.html#cb124-31"></a>              )</span></code></pre></div>
</div>
<div id="audpc-curve-5" class="section level4">
<h4><span class="header-section-number">3.4.6.4</span> AUDPC curve</h4>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="import-and-format-data.html#cb125-1"></a>Premer_<span class="dv">13</span>_dat &lt;-<span class="st"> </span><span class="kw">cbind</span>(Premer_<span class="dv">13</span>_dat,</span>
<span id="cb125-2"><a href="import-and-format-data.html#cb125-2"></a>                          <span class="dt">AUDPC =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb125-3"><a href="import-and-format-data.html#cb125-3"></a>                                                           Premer_<span class="dv">13</span>[,<span class="kw">c</span>(<span class="st">&quot;Inc_31D&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),<span class="co"># -1 to the data because zero disease = 1 on rating scale// Dates are based off days from first sign</span></span>
<span id="cb125-4"><a href="import-and-format-data.html#cb125-4"></a>                                        <span class="dv">1</span>, </span>
<span id="cb125-5"><a href="import-and-format-data.html#cb125-5"></a>                                        <span class="dt">FUN =</span> audpc, </span>
<span id="cb125-6"><a href="import-and-format-data.html#cb125-6"></a>                                        <span class="dt">dates =</span> <span class="kw">c</span>((Premer_<span class="dv">13</span>_dat<span class="op">$</span>first_sign_disease[<span class="dv">1</span>]<span class="op">-</span><span class="dv">7</span>)<span class="op">-</span></span>
<span id="cb125-7"><a href="import-and-format-data.html#cb125-7"></a><span class="st">                                                     </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-01-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb125-8"><a href="import-and-format-data.html#cb125-8"></a>                                                  <span class="dv">12</span><span class="op">+</span><span class="dv">19</span>)</span>
<span id="cb125-9"><a href="import-and-format-data.html#cb125-9"></a>                                        ),</span>
<span id="cb125-10"><a href="import-and-format-data.html#cb125-10"></a>                     <span class="dt">AUDPS =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb125-11"><a href="import-and-format-data.html#cb125-11"></a>                                                           Premer_<span class="dv">13</span>[,<span class="kw">c</span>(<span class="st">&quot;Inc_31D&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb125-12"><a href="import-and-format-data.html#cb125-12"></a>                                        <span class="dv">1</span>, </span>
<span id="cb125-13"><a href="import-and-format-data.html#cb125-13"></a>                                        <span class="dt">FUN =</span> audps, </span>
<span id="cb125-14"><a href="import-and-format-data.html#cb125-14"></a>                                        <span class="dt">dates =</span> <span class="kw">c</span>((Premer_<span class="dv">13</span>_dat<span class="op">$</span>first_sign_disease[<span class="dv">1</span>]<span class="op">-</span><span class="dv">7</span>)<span class="op">-</span></span>
<span id="cb125-15"><a href="import-and-format-data.html#cb125-15"></a><span class="st">                                                     </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-01-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb125-16"><a href="import-and-format-data.html#cb125-16"></a>                                                  <span class="dv">12</span><span class="op">+</span><span class="dv">19</span>)</span>
<span id="cb125-17"><a href="import-and-format-data.html#cb125-17"></a>                                        )</span>
<span id="cb125-18"><a href="import-and-format-data.html#cb125-18"></a>                          )</span></code></pre></div>
</div>
<div id="calculating-the-treatment-means-2" class="section level4">
<h4><span class="header-section-number">3.4.6.5</span> Calculating the treatment means</h4>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="import-and-format-data.html#cb126-1"></a>Premer_<span class="dv">13</span>_m &lt;-<span class="st"> </span>Premer_<span class="dv">13</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb126-2"><a href="import-and-format-data.html#cb126-2"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb126-3"><a href="import-and-format-data.html#cb126-3"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb126-4"><a href="import-and-format-data.html#cb126-4"></a>             <span class="dt">year =</span> <span class="kw">unique</span>(year),</span>
<span id="cb126-5"><a href="import-and-format-data.html#cb126-5"></a>             <span class="dt">location =</span> <span class="kw">unique</span>(location),</span>
<span id="cb126-6"><a href="import-and-format-data.html#cb126-6"></a>             <span class="dt">host_genotype =</span> <span class="kw">unique</span>(host_genotype),</span>
<span id="cb126-7"><a href="import-and-format-data.html#cb126-7"></a>             <span class="dt">trial_design =</span> <span class="kw">unique</span>(trial_design),</span>
<span id="cb126-8"><a href="import-and-format-data.html#cb126-8"></a>             <span class="dt">trade_name =</span> <span class="kw">unique</span>(trade_name),</span>
<span id="cb126-9"><a href="import-and-format-data.html#cb126-9"></a>             <span class="dt">fungicide_ai =</span> <span class="kw">unique</span>(fungicide_ai),</span>
<span id="cb126-10"><a href="import-and-format-data.html#cb126-10"></a>             <span class="dt">dose_ai.ha =</span> <span class="kw">unique</span>(dose_ai.ha),</span>
<span id="cb126-11"><a href="import-and-format-data.html#cb126-11"></a>            <span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb126-12"><a href="import-and-format-data.html#cb126-12"></a>              <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb126-13"><a href="import-and-format-data.html#cb126-13"></a>              <span class="dt">plant_density =</span> <span class="kw">unique</span>(plant_density),</span>
<span id="cb126-14"><a href="import-and-format-data.html#cb126-14"></a>              <span class="dt">row_spacing =</span> <span class="kw">unique</span>(row_spacing),</span>
<span id="cb126-15"><a href="import-and-format-data.html#cb126-15"></a>              <span class="dt">replicates =</span> <span class="kw">length</span>(<span class="kw">as.numeric</span>(replicate)),</span>
<span id="cb126-16"><a href="import-and-format-data.html#cb126-16"></a>              <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb126-17"><a href="import-and-format-data.html#cb126-17"></a>              <span class="dt">emergence_date =</span> <span class="ot">NA</span>,</span>
<span id="cb126-18"><a href="import-and-format-data.html#cb126-18"></a>              <span class="dt">flowering_date =</span> <span class="kw">unique</span>(flowering_date),</span>
<span id="cb126-19"><a href="import-and-format-data.html#cb126-19"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">unique</span>(pod_fill_date),</span>
<span id="cb126-20"><a href="import-and-format-data.html#cb126-20"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="kw">unique</span>(mid_late_pod_fill),</span>
<span id="cb126-21"><a href="import-and-format-data.html#cb126-21"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb126-22"><a href="import-and-format-data.html#cb126-22"></a>              <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb126-23"><a href="import-and-format-data.html#cb126-23"></a>              <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb126-24"><a href="import-and-format-data.html#cb126-24"></a>              <span class="dt">fungicide_application_3 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">3</span>),</span>
<span id="cb126-25"><a href="import-and-format-data.html#cb126-25"></a>              <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb126-26"><a href="import-and-format-data.html#cb126-26"></a>              <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb126-27"><a href="import-and-format-data.html#cb126-27"></a>              <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb126-28"><a href="import-and-format-data.html#cb126-28"></a>              <span class="dt">PM_final_severity =</span> <span class="kw">mean</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb126-29"><a href="import-and-format-data.html#cb126-29"></a>              <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb126-30"><a href="import-and-format-data.html#cb126-30"></a>              <span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="co"># Produces NAs and needs to be reproduced again below</span></span>
<span id="cb126-31"><a href="import-and-format-data.html#cb126-31"></a>              <span class="dt">D_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb126-32"><a href="import-and-format-data.html#cb126-32"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb126-33"><a href="import-and-format-data.html#cb126-33"></a>              <span class="dt">raw_graded =</span> <span class="ot">NA</span>,</span>
<span id="cb126-34"><a href="import-and-format-data.html#cb126-34"></a>              <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb126-35"><a href="import-and-format-data.html#cb126-35"></a>              <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb126-36"><a href="import-and-format-data.html#cb126-36"></a>             <span class="dt">AUDPC_m =</span> <span class="kw">mean</span>(AUDPC),</span>
<span id="cb126-37"><a href="import-and-format-data.html#cb126-37"></a>             <span class="dt">AUDPC_sd =</span> <span class="kw">sd</span>(AUDPC),</span>
<span id="cb126-38"><a href="import-and-format-data.html#cb126-38"></a>            <span class="dt">AUDPS_m =</span> <span class="kw">mean</span>(AUDPS),</span>
<span id="cb126-39"><a href="import-and-format-data.html#cb126-39"></a>             <span class="dt">AUDPS_sd =</span> <span class="kw">sd</span>(AUDPS),</span>
<span id="cb126-40"><a href="import-and-format-data.html#cb126-40"></a>             <span class="dt">Inc_Ms =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), </span>
<span id="cb126-41"><a href="import-and-format-data.html#cb126-41"></a>                               <span class="dt">data =</span> Premer_<span class="dv">13</span>_dat[Premer_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;propiconazole&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb126-42"><a href="import-and-format-data.html#cb126-42"></a><span class="st">                                                        </span>Premer_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span> ,]))[<span class="dv">1</span>,<span class="dv">3</span>],</span>
<span id="cb126-43"><a href="import-and-format-data.html#cb126-43"></a>              <span class="dt">Y_Msquare =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), </span>
<span id="cb126-44"><a href="import-and-format-data.html#cb126-44"></a>                                <span class="dt">data =</span> Premer_<span class="dv">13</span>_dat[Premer_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;propiconazole&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb126-45"><a href="import-and-format-data.html#cb126-45"></a><span class="st">                                                        </span>Premer_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span> ,]))[<span class="dv">1</span>,<span class="dv">3</span>]</span>
<span id="cb126-46"><a href="import-and-format-data.html#cb126-46"></a>   )</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="import-and-format-data.html#cb128-1"></a><span class="co"># For some wierd reason standard deviations are comming back NA in the code above</span></span>
<span id="cb128-2"><a href="import-and-format-data.html#cb128-2"></a><span class="co"># Because of n_treatment being converted to a factor I need to wrangle carefully here</span></span>
<span id="cb128-3"><a href="import-and-format-data.html#cb128-3"></a>Prem_tmp &lt;-<span class="st"> </span>Premer_<span class="dv">13</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb128-4"><a href="import-and-format-data.html#cb128-4"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb128-5"><a href="import-and-format-data.html#cb128-5"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb128-6"><a href="import-and-format-data.html#cb128-6"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="import-and-format-data.html#cb130-1"></a><span class="co"># Remive the existing yield_error columns and replace with new ones</span></span>
<span id="cb130-2"><a href="import-and-format-data.html#cb130-2"></a>Premer_<span class="dv">13</span>_m &lt;-<span class="st"> </span><span class="kw">left_join</span>(Premer_<span class="dv">13</span>_m[,<span class="kw">colnames</span>(Premer_<span class="dv">13</span>_m)[<span class="kw">c</span>(<span class="op">-</span><span class="dv">29</span>,<span class="op">-</span><span class="dv">33</span>)]], Prem_tmp)</span></code></pre></div>
<pre><code>## Joining, by = &quot;n_treatment&quot;</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="import-and-format-data.html#cb132-1"></a><span class="co"># Remove other plots not in experiment</span></span>
<span id="cb132-2"><a href="import-and-format-data.html#cb132-2"></a>Premer_<span class="dv">13</span>_m &lt;-<span class="st"> </span>Premer_<span class="dv">13</span>_m[Premer_<span class="dv">13</span>_m<span class="op">$</span>trade_name <span class="op">!=</span><span class="st"> &quot;other&quot;</span>,]</span>
<span id="cb132-3"><a href="import-and-format-data.html#cb132-3"></a></span>
<span id="cb132-4"><a href="import-and-format-data.html#cb132-4"></a></span>
<span id="cb132-5"><a href="import-and-format-data.html#cb132-5"></a>Premer_<span class="dv">13</span>_m<span class="op">$</span>n_treatment &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(Premer_<span class="dv">13</span>_m<span class="op">$</span>n_treatment))</span>
<span id="cb132-6"><a href="import-and-format-data.html#cb132-6"></a>Premer_<span class="dv">13</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(Premer_<span class="dv">13</span>_m, PM_MB_means)</span>
<span id="cb132-7"><a href="import-and-format-data.html#cb132-7"></a></span>
<span id="cb132-8"><a href="import-and-format-data.html#cb132-8"></a></span>
<span id="cb132-9"><a href="import-and-format-data.html#cb132-9"></a></span>
<span id="cb132-10"><a href="import-and-format-data.html#cb132-10"></a><span class="co">##########################</span></span>
<span id="cb132-11"><a href="import-and-format-data.html#cb132-11"></a><span class="co"># For some wierd reason standard deviations are comming back NA in the code above</span></span>
<span id="cb132-12"><a href="import-and-format-data.html#cb132-12"></a>Premer_<span class="dv">13</span>_m[,<span class="kw">c</span>(<span class="st">&quot;disease_error&quot;</span>,<span class="st">&quot;yield_error&quot;</span>)] &lt;-<span class="st"> </span></span>
<span id="cb132-13"><a href="import-and-format-data.html#cb132-13"></a><span class="st">   </span>Premer_<span class="dv">13</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb132-14"><a href="import-and-format-data.html#cb132-14"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb132-15"><a href="import-and-format-data.html#cb132-15"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb132-16"><a href="import-and-format-data.html#cb132-16"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb132-17"><a href="import-and-format-data.html#cb132-17"></a><span class="st">   </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&quot;disease_error&quot;</span>,<span class="st">&quot;yield_error&quot;</span>))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="import-and-format-data.html#cb134-1"></a>Premer_<span class="dv">13</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(Premer_<span class="dv">13</span>_m, PM_MB_means)</span>
<span id="cb134-2"><a href="import-and-format-data.html#cb134-2"></a></span>
<span id="cb134-3"><a href="import-and-format-data.html#cb134-3"></a><span class="co"># insert new calculations into data</span></span>
<span id="cb134-4"><a href="import-and-format-data.html#cb134-4"></a>PM_MB_means &lt;-<span class="st"> </span><span class="kw">replace_data</span>(<span class="dt">template_data =</span> PM_MB_means, </span>
<span id="cb134-5"><a href="import-and-format-data.html#cb134-5"></a>                            <span class="dt">new_data =</span> Premer_<span class="dv">13</span>_m, </span>
<span id="cb134-6"><a href="import-and-format-data.html#cb134-6"></a>                            <span class="dt">new_data_column =</span> <span class="kw">c</span>(<span class="st">&quot;planting_date&quot;</span>,<span class="st">&quot;AUDPC_m&quot;</span>, <span class="st">&quot;AUDPC_sd&quot;</span>, <span class="st">&quot;AUDPS_m&quot;</span>,<span class="st">&quot;AUDPS_sd&quot;</span>,<span class="st">&quot;Y_Msquare&quot;</span>, <span class="st">&quot;Inc_Ms&quot;</span>),</span>
<span id="cb134-7"><a href="import-and-format-data.html#cb134-7"></a>                            <span class="dt">filter_cols =</span> <span class="kw">c</span>(<span class="st">&quot;trial_ref&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;location&quot;</span>, <span class="st">&quot;host_genotype&quot;</span>, </span>
<span id="cb134-8"><a href="import-and-format-data.html#cb134-8"></a>                                           <span class="st">&quot;fungicide_ai&quot;</span>, <span class="st">&quot;dose_ai.ha&quot;</span>,<span class="st">&quot;n_treatment&quot;</span>))</span></code></pre></div>
<pre><code>## No data changed 0/11</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="import-and-format-data.html#cb136-1"></a><span class="kw">write.csv</span>(</span>
<span id="cb136-2"><a href="import-and-format-data.html#cb136-2"></a>   Premer_<span class="dv">13</span>_m,</span>
<span id="cb136-3"><a href="import-and-format-data.html#cb136-3"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/AM1303-Premer-Disease_means.csv&quot;</span>),<span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb136-4"><a href="import-and-format-data.html#cb136-4"></a>)</span></code></pre></div>
</div>
</div>
<div id="millmerran-2013" class="section level3">
<h3><span class="header-section-number">3.4.7</span> Millmerran 2013</h3>
<div id="convert-disease-scores-3" class="section level4">
<h4><span class="header-section-number">3.4.7.1</span> Convert disease scores</h4>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="import-and-format-data.html#cb137-1"></a><span class="cf">for</span>(D_assess <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;Assessment Sheet 5.4.2013&quot;</span>,<span class="st">&quot;Assessment Sheet 24.4.2013&quot;</span>)){</span>
<span id="cb137-2"><a href="import-and-format-data.html#cb137-2"></a></span>
<span id="cb137-3"><a href="import-and-format-data.html#cb137-3"></a><span class="co"># Import final disease survey</span></span>
<span id="cb137-4"><a href="import-and-format-data.html#cb137-4"></a>Millm_13D &lt;-</span>
<span id="cb137-5"><a href="import-and-format-data.html#cb137-5"></a><span class="st">   </span><span class="kw">as.data.frame</span>(</span>
<span id="cb137-6"><a href="import-and-format-data.html#cb137-6"></a>      <span class="kw">read_xlsx</span>(</span>
<span id="cb137-7"><a href="import-and-format-data.html#cb137-7"></a>         <span class="dt">path =</span> <span class="kw">here</span>(<span class="st">&quot;data/BB1305 Fungicides for powdery mildew in mungbean - Millmerran.xlsx&quot;</span>),</span>
<span id="cb137-8"><a href="import-and-format-data.html#cb137-8"></a>         <span class="dt">sheet =</span> D_assess,</span>
<span id="cb137-9"><a href="import-and-format-data.html#cb137-9"></a>         <span class="dt">range =</span> <span class="st">&quot;A12:AH56&quot;</span>,</span>
<span id="cb137-10"><a href="import-and-format-data.html#cb137-10"></a>         <span class="dt">col_names =</span> <span class="ot">TRUE</span></span>
<span id="cb137-11"><a href="import-and-format-data.html#cb137-11"></a>      )</span>
<span id="cb137-12"><a href="import-and-format-data.html#cb137-12"></a>   )</span>
<span id="cb137-13"><a href="import-and-format-data.html#cb137-13"></a></span>
<span id="cb137-14"><a href="import-and-format-data.html#cb137-14"></a></span>
<span id="cb137-15"><a href="import-and-format-data.html#cb137-15"></a></span>
<span id="cb137-16"><a href="import-and-format-data.html#cb137-16"></a><span class="kw">colnames</span>(Millm_13D)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Run&quot;</span>, <span class="st">&quot;Plot&quot;</span>, <span class="st">&quot;Treat&quot;</span>, <span class="st">&quot;Rep&quot;</span>)</span>
<span id="cb137-17"><a href="import-and-format-data.html#cb137-17"></a>Millm_13D &lt;-<span class="st"> </span>Millm_13D[<span class="kw">order</span>(Millm_13D[,<span class="dv">1</span>],Millm_13D[,<span class="dv">2</span>],Millm_13D[,<span class="dv">3</span>],Millm_13D[,<span class="dv">4</span>]),]</span>
<span id="cb137-18"><a href="import-and-format-data.html#cb137-18"></a></span>
<span id="cb137-19"><a href="import-and-format-data.html#cb137-19"></a></span>
<span id="cb137-20"><a href="import-and-format-data.html#cb137-20"></a><span class="kw">sum</span>(<span class="kw">is.na</span>(Millm_13D[, <span class="dv">5</span><span class="op">:</span><span class="dv">34</span>]))</span>
<span id="cb137-21"><a href="import-and-format-data.html#cb137-21"></a><span class="co"># replace NAs with zero Plots not surveyed</span></span>
<span id="cb137-22"><a href="import-and-format-data.html#cb137-22"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">5</span><span class="op">:</span><span class="dv">34</span>) {</span>
<span id="cb137-23"><a href="import-and-format-data.html#cb137-23"></a>   <span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">seq_along</span>(Millm_13D[, i])) {</span>
<span id="cb137-24"><a href="import-and-format-data.html#cb137-24"></a>      <span class="cf">if</span> (<span class="kw">is.na</span>(Millm_13D[j, i])) {</span>
<span id="cb137-25"><a href="import-and-format-data.html#cb137-25"></a>         Millm_13D[j, i] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb137-26"><a href="import-and-format-data.html#cb137-26"></a>      }</span>
<span id="cb137-27"><a href="import-and-format-data.html#cb137-27"></a>   }</span>
<span id="cb137-28"><a href="import-and-format-data.html#cb137-28"></a>}</span>
<span id="cb137-29"><a href="import-and-format-data.html#cb137-29"></a></span>
<span id="cb137-30"><a href="import-and-format-data.html#cb137-30"></a></span>
<span id="cb137-31"><a href="import-and-format-data.html#cb137-31"></a></span>
<span id="cb137-32"><a href="import-and-format-data.html#cb137-32"></a>incidence4 &lt;-</span>
<span id="cb137-33"><a href="import-and-format-data.html#cb137-33"></a><span class="st">   </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;numeric&quot;</span>, <span class="dt">length =</span> <span class="kw">length</span>(Millm_13D[, <span class="dv">1</span>]))</span>
<span id="cb137-34"><a href="import-and-format-data.html#cb137-34"></a></span>
<span id="cb137-35"><a href="import-and-format-data.html#cb137-35"></a><span class="co"># column index table for incidence ratings</span></span>
<span id="cb137-36"><a href="import-and-format-data.html#cb137-36"></a><span class="co"># Calculate incidence</span></span>
<span id="cb137-37"><a href="import-and-format-data.html#cb137-37"></a><span class="co">#     Sites</span></span>
<span id="cb137-38"><a href="import-and-format-data.html#cb137-38"></a><span class="co"># low canopy  c(5:13)</span></span>
<span id="cb137-39"><a href="import-and-format-data.html#cb137-39"></a><span class="co"># mid canopy c(15:23)</span></span>
<span id="cb137-40"><a href="import-and-format-data.html#cb137-40"></a><span class="co"># upp canopy c(25:33)</span></span>
<span id="cb137-41"><a href="import-and-format-data.html#cb137-41"></a></span>
<span id="cb137-42"><a href="import-and-format-data.html#cb137-42"></a></span>
<span id="cb137-43"><a href="import-and-format-data.html#cb137-43"></a><span class="co"># Convert disease survey data to 1-9 Incidence rating scale</span></span>
<span id="cb137-44"><a href="import-and-format-data.html#cb137-44"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(incidence4)) {</span>
<span id="cb137-45"><a href="import-and-format-data.html#cb137-45"></a>   </span>
<span id="cb137-46"><a href="import-and-format-data.html#cb137-46"></a>   <span class="co"># incidence = 1</span></span>
<span id="cb137-47"><a href="import-and-format-data.html#cb137-47"></a>   <span class="cf">if</span> (<span class="kw">all</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)) {</span>
<span id="cb137-48"><a href="import-and-format-data.html#cb137-48"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb137-49"><a href="import-and-format-data.html#cb137-49"></a>      <span class="cf">next</span>()</span>
<span id="cb137-50"><a href="import-and-format-data.html#cb137-50"></a>   }</span>
<span id="cb137-51"><a href="import-and-format-data.html#cb137-51"></a>   </span>
<span id="cb137-52"><a href="import-and-format-data.html#cb137-52"></a>   <span class="co"># incidence = 2</span></span>
<span id="cb137-53"><a href="import-and-format-data.html#cb137-53"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Millm_13D[i, <span class="dv">5</span><span class="op">:</span><span class="dv">13</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-54"><a href="import-and-format-data.html#cb137-54"></a><span class="st">       </span><span class="kw">all</span>(Millm_13D[i, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb137-55"><a href="import-and-format-data.html#cb137-55"></a><span class="st">       </span><span class="kw">all</span>(Millm_13D[i, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb137-56"><a href="import-and-format-data.html#cb137-56"></a><span class="st">       </span>(<span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb137-57"><a href="import-and-format-data.html#cb137-57"></a><span class="st">        </span><span class="kw">length</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>)])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb137-58"><a href="import-and-format-data.html#cb137-58"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb137-59"><a href="import-and-format-data.html#cb137-59"></a>      <span class="cf">next</span>()</span>
<span id="cb137-60"><a href="import-and-format-data.html#cb137-60"></a>   }</span>
<span id="cb137-61"><a href="import-and-format-data.html#cb137-61"></a>   </span>
<span id="cb137-62"><a href="import-and-format-data.html#cb137-62"></a>   </span>
<span id="cb137-63"><a href="import-and-format-data.html#cb137-63"></a>   <span class="co"># incidence = 3</span></span>
<span id="cb137-64"><a href="import-and-format-data.html#cb137-64"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Millm_13D[i, <span class="dv">5</span><span class="op">:</span><span class="dv">13</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-65"><a href="import-and-format-data.html#cb137-65"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-66"><a href="import-and-format-data.html#cb137-66"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-67"><a href="import-and-format-data.html#cb137-67"></a><span class="st">       </span>(<span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb137-68"><a href="import-and-format-data.html#cb137-68"></a><span class="st">        </span><span class="kw">length</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>)])) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb137-69"><a href="import-and-format-data.html#cb137-69"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb137-70"><a href="import-and-format-data.html#cb137-70"></a>   } <span class="cf">else</span>{</span>
<span id="cb137-71"><a href="import-and-format-data.html#cb137-71"></a>      <span class="co"># if it is in the lower half of the canopy and in less than 75% of plants then incidence = 2.5</span></span>
<span id="cb137-72"><a href="import-and-format-data.html#cb137-72"></a>      <span class="cf">if</span> (<span class="kw">sum</span>(Millm_13D[i, <span class="dv">5</span><span class="op">:</span><span class="dv">13</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-73"><a href="import-and-format-data.html#cb137-73"></a><span class="st">          </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-74"><a href="import-and-format-data.html#cb137-74"></a><span class="st">          </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-75"><a href="import-and-format-data.html#cb137-75"></a><span class="st">          </span>(<span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb137-76"><a href="import-and-format-data.html#cb137-76"></a><span class="st">           </span><span class="kw">length</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>)])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb137-77"><a href="import-and-format-data.html#cb137-77"></a>         incidence4[i] &lt;-<span class="st"> </span><span class="fl">2.5</span></span>
<span id="cb137-78"><a href="import-and-format-data.html#cb137-78"></a>         <span class="cf">next</span>()</span>
<span id="cb137-79"><a href="import-and-format-data.html#cb137-79"></a>      }</span>
<span id="cb137-80"><a href="import-and-format-data.html#cb137-80"></a>   }</span>
<span id="cb137-81"><a href="import-and-format-data.html#cb137-81"></a>   </span>
<span id="cb137-82"><a href="import-and-format-data.html#cb137-82"></a>   </span>
<span id="cb137-83"><a href="import-and-format-data.html#cb137-83"></a>   <span class="co"># incidence = 4</span></span>
<span id="cb137-84"><a href="import-and-format-data.html#cb137-84"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Millm_13D[i, <span class="dv">5</span><span class="op">:</span><span class="dv">13</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-85"><a href="import-and-format-data.html#cb137-85"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-86"><a href="import-and-format-data.html#cb137-86"></a><span class="st">       </span><span class="kw">all</span>(Millm_13D[i, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb137-87"><a href="import-and-format-data.html#cb137-87"></a><span class="st">       </span>(<span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb137-88"><a href="import-and-format-data.html#cb137-88"></a><span class="st">        </span><span class="kw">length</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>)])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb137-89"><a href="import-and-format-data.html#cb137-89"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb137-90"><a href="import-and-format-data.html#cb137-90"></a>      <span class="cf">next</span>()</span>
<span id="cb137-91"><a href="import-and-format-data.html#cb137-91"></a>   }</span>
<span id="cb137-92"><a href="import-and-format-data.html#cb137-92"></a>   </span>
<span id="cb137-93"><a href="import-and-format-data.html#cb137-93"></a>   </span>
<span id="cb137-94"><a href="import-and-format-data.html#cb137-94"></a>   <span class="co"># incidence = 5</span></span>
<span id="cb137-95"><a href="import-and-format-data.html#cb137-95"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Millm_13D[i, <span class="dv">5</span><span class="op">:</span><span class="dv">13</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-96"><a href="import-and-format-data.html#cb137-96"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-97"><a href="import-and-format-data.html#cb137-97"></a><span class="st">       </span><span class="kw">all</span>(Millm_13D[i, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb137-98"><a href="import-and-format-data.html#cb137-98"></a><span class="st">       </span>(<span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb137-99"><a href="import-and-format-data.html#cb137-99"></a><span class="st">        </span><span class="kw">length</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>)])) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb137-100"><a href="import-and-format-data.html#cb137-100"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb137-101"><a href="import-and-format-data.html#cb137-101"></a>      <span class="cf">next</span>()</span>
<span id="cb137-102"><a href="import-and-format-data.html#cb137-102"></a>   }</span>
<span id="cb137-103"><a href="import-and-format-data.html#cb137-103"></a>   </span>
<span id="cb137-104"><a href="import-and-format-data.html#cb137-104"></a>   </span>
<span id="cb137-105"><a href="import-and-format-data.html#cb137-105"></a>   <span class="co"># incidence = 6</span></span>
<span id="cb137-106"><a href="import-and-format-data.html#cb137-106"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Millm_13D[i, <span class="dv">5</span><span class="op">:</span><span class="dv">13</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-107"><a href="import-and-format-data.html#cb137-107"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-108"><a href="import-and-format-data.html#cb137-108"></a><span class="st">       </span><span class="kw">all</span>(Millm_13D[i, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span></span>
<span id="cb137-109"><a href="import-and-format-data.html#cb137-109"></a><span class="st">       </span>(<span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb137-110"><a href="import-and-format-data.html#cb137-110"></a><span class="st">        </span><span class="kw">length</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>)])) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.90</span>) {</span>
<span id="cb137-111"><a href="import-and-format-data.html#cb137-111"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="dv">6</span></span>
<span id="cb137-112"><a href="import-and-format-data.html#cb137-112"></a>      <span class="cf">next</span>()</span>
<span id="cb137-113"><a href="import-and-format-data.html#cb137-113"></a>   }</span>
<span id="cb137-114"><a href="import-and-format-data.html#cb137-114"></a>   </span>
<span id="cb137-115"><a href="import-and-format-data.html#cb137-115"></a>   </span>
<span id="cb137-116"><a href="import-and-format-data.html#cb137-116"></a>   <span class="co"># incidence = 7</span></span>
<span id="cb137-117"><a href="import-and-format-data.html#cb137-117"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Millm_13D[i, <span class="dv">5</span><span class="op">:</span><span class="dv">13</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-118"><a href="import-and-format-data.html#cb137-118"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-119"><a href="import-and-format-data.html#cb137-119"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-120"><a href="import-and-format-data.html#cb137-120"></a><span class="st">       </span>(<span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb137-121"><a href="import-and-format-data.html#cb137-121"></a><span class="st">        </span><span class="kw">length</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>)])) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.90</span>) {</span>
<span id="cb137-122"><a href="import-and-format-data.html#cb137-122"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="dv">7</span></span>
<span id="cb137-123"><a href="import-and-format-data.html#cb137-123"></a>      <span class="cf">next</span>()</span>
<span id="cb137-124"><a href="import-and-format-data.html#cb137-124"></a>   }</span>
<span id="cb137-125"><a href="import-and-format-data.html#cb137-125"></a>   </span>
<span id="cb137-126"><a href="import-and-format-data.html#cb137-126"></a>   </span>
<span id="cb137-127"><a href="import-and-format-data.html#cb137-127"></a>   <span class="co"># incidence = 8</span></span>
<span id="cb137-128"><a href="import-and-format-data.html#cb137-128"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Millm_13D[i, <span class="dv">5</span><span class="op">:</span><span class="dv">13</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-129"><a href="import-and-format-data.html#cb137-129"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-130"><a href="import-and-format-data.html#cb137-130"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-131"><a href="import-and-format-data.html#cb137-131"></a><span class="st">       </span>(<span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb137-132"><a href="import-and-format-data.html#cb137-132"></a><span class="st">        </span><span class="kw">length</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)])) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb137-133"><a href="import-and-format-data.html#cb137-133"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="dv">8</span></span>
<span id="cb137-134"><a href="import-and-format-data.html#cb137-134"></a>      <span class="cf">next</span>()</span>
<span id="cb137-135"><a href="import-and-format-data.html#cb137-135"></a>   }</span>
<span id="cb137-136"><a href="import-and-format-data.html#cb137-136"></a>   </span>
<span id="cb137-137"><a href="import-and-format-data.html#cb137-137"></a>   </span>
<span id="cb137-138"><a href="import-and-format-data.html#cb137-138"></a>   <span class="co"># incidence = 9</span></span>
<span id="cb137-139"><a href="import-and-format-data.html#cb137-139"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Millm_13D[i, <span class="dv">5</span><span class="op">:</span><span class="dv">13</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-140"><a href="import-and-format-data.html#cb137-140"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-141"><a href="import-and-format-data.html#cb137-141"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-142"><a href="import-and-format-data.html#cb137-142"></a><span class="st">       </span>(<span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb137-143"><a href="import-and-format-data.html#cb137-143"></a><span class="st">        </span><span class="kw">length</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)])) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.75</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-144"><a href="import-and-format-data.html#cb137-144"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)]) <span class="op">&gt;</span><span class="st"> </span>(<span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">*</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb137-145"><a href="import-and-format-data.html#cb137-145"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="dv">9</span></span>
<span id="cb137-146"><a href="import-and-format-data.html#cb137-146"></a>      <span class="cf">next</span>()</span>
<span id="cb137-147"><a href="import-and-format-data.html#cb137-147"></a>   }</span>
<span id="cb137-148"><a href="import-and-format-data.html#cb137-148"></a>   </span>
<span id="cb137-149"><a href="import-and-format-data.html#cb137-149"></a>   </span>
<span id="cb137-150"><a href="import-and-format-data.html#cb137-150"></a>   <span class="co"># if there are few (&lt; 10%) leaves with very small infections in all parts of the canopy OR</span></span>
<span id="cb137-151"><a href="import-and-format-data.html#cb137-151"></a>   <span class="co"># if there is a stray colony on a upper leaf in addition to all lower</span></span>
<span id="cb137-152"><a href="import-and-format-data.html#cb137-152"></a>   </span>
<span id="cb137-153"><a href="import-and-format-data.html#cb137-153"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Millm_13D[i, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-154"><a href="import-and-format-data.html#cb137-154"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-155"><a href="import-and-format-data.html#cb137-155"></a><span class="st">       </span>(<span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)]) <span class="op">/</span></span>
<span id="cb137-156"><a href="import-and-format-data.html#cb137-156"></a><span class="st">        </span><span class="kw">length</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)]) <span class="op">/</span><span class="st"> </span><span class="dv">100</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.1</span>) {</span>
<span id="cb137-157"><a href="import-and-format-data.html#cb137-157"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="fl">2.5</span></span>
<span id="cb137-158"><a href="import-and-format-data.html#cb137-158"></a>      <span class="cf">next</span>()</span>
<span id="cb137-159"><a href="import-and-format-data.html#cb137-159"></a>   }</span>
<span id="cb137-160"><a href="import-and-format-data.html#cb137-160"></a>   </span>
<span id="cb137-161"><a href="import-and-format-data.html#cb137-161"></a>   <span class="co"># incidence = 7.5  In the upper canopy with less than 75% plants infected</span></span>
<span id="cb137-162"><a href="import-and-format-data.html#cb137-162"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Millm_13D[i, <span class="dv">5</span><span class="op">:</span><span class="dv">13</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-163"><a href="import-and-format-data.html#cb137-163"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-164"><a href="import-and-format-data.html#cb137-164"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-165"><a href="import-and-format-data.html#cb137-165"></a><span class="st">       </span>(<span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span></span>
<span id="cb137-166"><a href="import-and-format-data.html#cb137-166"></a><span class="st">        </span><span class="kw">length</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)])) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.75</span>) {</span>
<span id="cb137-167"><a href="import-and-format-data.html#cb137-167"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="fl">7.5</span></span>
<span id="cb137-168"><a href="import-and-format-data.html#cb137-168"></a>      <span class="cf">next</span>()</span>
<span id="cb137-169"><a href="import-and-format-data.html#cb137-169"></a>   }</span>
<span id="cb137-170"><a href="import-and-format-data.html#cb137-170"></a>   </span>
<span id="cb137-171"><a href="import-and-format-data.html#cb137-171"></a>   <span class="co"># if there are few more colonies(&lt; 10%) leaves with very small infections in all parts of the canopy OR</span></span>
<span id="cb137-172"><a href="import-and-format-data.html#cb137-172"></a>   <span class="co"># if there is a stray colony on a upper leaf in addition to all lower</span></span>
<span id="cb137-173"><a href="import-and-format-data.html#cb137-173"></a>   </span>
<span id="cb137-174"><a href="import-and-format-data.html#cb137-174"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Millm_13D[i, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">6</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-175"><a href="import-and-format-data.html#cb137-175"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-176"><a href="import-and-format-data.html#cb137-176"></a><span class="st">       </span>(<span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)]) <span class="op">/</span></span>
<span id="cb137-177"><a href="import-and-format-data.html#cb137-177"></a><span class="st">        </span><span class="kw">length</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)]) <span class="op">/</span><span class="st"> </span><span class="dv">100</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.1</span>) {</span>
<span id="cb137-178"><a href="import-and-format-data.html#cb137-178"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="fl">3.5</span></span>
<span id="cb137-179"><a href="import-and-format-data.html#cb137-179"></a>      <span class="cf">next</span>()</span>
<span id="cb137-180"><a href="import-and-format-data.html#cb137-180"></a>   }</span>
<span id="cb137-181"><a href="import-and-format-data.html#cb137-181"></a>   </span>
<span id="cb137-182"><a href="import-and-format-data.html#cb137-182"></a>   <span class="cf">if</span> (<span class="kw">sum</span>(Millm_13D[i, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-183"><a href="import-and-format-data.html#cb137-183"></a><span class="st">       </span><span class="kw">sum</span>(Millm_13D[i, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span></span>
<span id="cb137-184"><a href="import-and-format-data.html#cb137-184"></a><span class="st">       </span>(<span class="kw">sum</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)]) <span class="op">/</span></span>
<span id="cb137-185"><a href="import-and-format-data.html#cb137-185"></a><span class="st">        </span><span class="kw">length</span>(Millm_13D[i, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">15</span><span class="op">:</span><span class="dv">23</span>, <span class="dv">25</span><span class="op">:</span><span class="dv">33</span>)]) <span class="op">/</span><span class="st"> </span><span class="dv">100</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.5</span>) {</span>
<span id="cb137-186"><a href="import-and-format-data.html#cb137-186"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="fl">6.5</span></span>
<span id="cb137-187"><a href="import-and-format-data.html#cb137-187"></a>      <span class="cf">next</span>()</span>
<span id="cb137-188"><a href="import-and-format-data.html#cb137-188"></a>   }</span>
<span id="cb137-189"><a href="import-and-format-data.html#cb137-189"></a>   <span class="cf">else</span>{</span>
<span id="cb137-190"><a href="import-and-format-data.html#cb137-190"></a>      <span class="co"># If none of the conditions are met give the incidence zero</span></span>
<span id="cb137-191"><a href="import-and-format-data.html#cb137-191"></a>      incidence4[i] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb137-192"><a href="import-and-format-data.html#cb137-192"></a>   }</span>
<span id="cb137-193"><a href="import-and-format-data.html#cb137-193"></a>}</span>
<span id="cb137-194"><a href="import-and-format-data.html#cb137-194"></a><span class="co"># end incidence loop</span></span>
<span id="cb137-195"><a href="import-and-format-data.html#cb137-195"></a></span>
<span id="cb137-196"><a href="import-and-format-data.html#cb137-196"></a><span class="cf">if</span>(<span class="kw">any</span>(incidence4 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)){</span>
<span id="cb137-197"><a href="import-and-format-data.html#cb137-197"></a>   <span class="kw">warning</span>(<span class="st">&quot;Code caluculated incidence on &#39;0&#39; which is off the incidence scale&quot;</span>)}</span>
<span id="cb137-198"><a href="import-and-format-data.html#cb137-198"></a></span>
<span id="cb137-199"><a href="import-and-format-data.html#cb137-199"></a></span>
<span id="cb137-200"><a href="import-and-format-data.html#cb137-200"></a><span class="co"># Re-format data-frame</span></span>
<span id="cb137-201"><a href="import-and-format-data.html#cb137-201"></a><span class="cf">if</span>(D_assess <span class="op">==</span><span class="st"> &quot;Assessment Sheet 5.4.2013&quot;</span>){</span>
<span id="cb137-202"><a href="import-and-format-data.html#cb137-202"></a>   Millm_13D<span class="fl">.1</span> &lt;-<span class="st"> </span>Millm_13D[,<span class="kw">c</span>(<span class="st">&quot;Treat&quot;</span>, <span class="st">&quot;Rep&quot;</span>, <span class="st">&quot;Run&quot;</span>, <span class="st">&quot;Plot&quot;</span>)]</span>
<span id="cb137-203"><a href="import-and-format-data.html#cb137-203"></a>   Millm_13D<span class="fl">.1</span><span class="op">$</span>Inc_23D &lt;-<span class="st">  </span>incidence4}</span>
<span id="cb137-204"><a href="import-and-format-data.html#cb137-204"></a>   </span>
<span id="cb137-205"><a href="import-and-format-data.html#cb137-205"></a></span>
<span id="cb137-206"><a href="import-and-format-data.html#cb137-206"></a><span class="cf">if</span>(D_assess <span class="op">==</span><span class="st"> &quot;Assessment Sheet 24.4.2013&quot;</span>){</span>
<span id="cb137-207"><a href="import-and-format-data.html#cb137-207"></a>   Millm_13D<span class="fl">.2</span> &lt;-<span class="st"> </span>Millm_13D[,<span class="kw">c</span>(<span class="st">&quot;Treat&quot;</span>, <span class="st">&quot;Rep&quot;</span>, <span class="st">&quot;Run&quot;</span>, <span class="st">&quot;Plot&quot;</span>)]</span>
<span id="cb137-208"><a href="import-and-format-data.html#cb137-208"></a>   Millm_13D<span class="fl">.2</span><span class="op">$</span>Inc_42D &lt;-<span class="st">  </span>incidence4}</span>
<span id="cb137-209"><a href="import-and-format-data.html#cb137-209"></a></span>
<span id="cb137-210"><a href="import-and-format-data.html#cb137-210"></a>}<span class="co"># end disease assessment loop</span></span></code></pre></div>
<pre><code>## New names:
## * `1` -&gt; `1...5`
## * `2` -&gt; `2...6`
## * `3` -&gt; `3...7`
## * `4` -&gt; `4...8`
## * `5` -&gt; `5...9`
## * ...
## New names:
## * `1` -&gt; `1...5`
## * `2` -&gt; `2...6`
## * `3` -&gt; `3...7`
## * `4` -&gt; `4...8`
## * `5` -&gt; `5...9`
## * ...</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="import-and-format-data.html#cb139-1"></a><span class="co"># The 19 Days after T1 only assessed the first 6 treatments</span></span>
<span id="cb139-2"><a href="import-and-format-data.html#cb139-2"></a><span class="co"># Therefore it will be dropped</span></span>
<span id="cb139-3"><a href="import-and-format-data.html#cb139-3"></a>Millm_13D &lt;-<span class="st"> </span><span class="kw">left_join</span>(Millm_13D<span class="fl">.1</span>, Millm_13D<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;Treat&quot;, &quot;Rep&quot;, &quot;Run&quot;, &quot;Plot&quot;)</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="import-and-format-data.html#cb141-1"></a><span class="co"># read in yield and format</span></span>
<span id="cb141-2"><a href="import-and-format-data.html#cb141-2"></a>Millm<span class="fl">.13</span>Y &lt;-</span>
<span id="cb141-3"><a href="import-and-format-data.html#cb141-3"></a><span class="st">   </span><span class="kw">as.data.frame</span>(</span>
<span id="cb141-4"><a href="import-and-format-data.html#cb141-4"></a>      <span class="kw">read_xlsx</span>(</span>
<span id="cb141-5"><a href="import-and-format-data.html#cb141-5"></a>         <span class="dt">path =</span> <span class="kw">here</span>(<span class="st">&quot;data/BB1305 Fungicides for powdery mildew in mungbean - Millmerran.xlsx&quot;</span>),</span>
<span id="cb141-6"><a href="import-and-format-data.html#cb141-6"></a>         <span class="dt">sheet =</span> <span class="st">&quot;Harvest Sheet 6.5.2013&quot;</span>,</span>
<span id="cb141-7"><a href="import-and-format-data.html#cb141-7"></a>         <span class="dt">range =</span> <span class="st">&quot;A11:F55&quot;</span>,</span>
<span id="cb141-8"><a href="import-and-format-data.html#cb141-8"></a>         <span class="dt">col_names =</span> <span class="ot">TRUE</span></span>
<span id="cb141-9"><a href="import-and-format-data.html#cb141-9"></a>      )</span>
<span id="cb141-10"><a href="import-and-format-data.html#cb141-10"></a>   )</span>
<span id="cb141-11"><a href="import-and-format-data.html#cb141-11"></a>Millm<span class="fl">.13</span>Y<span class="op">$</span>Treatment &lt;-<span class="st"> </span><span class="kw">as.character</span>(Millm<span class="fl">.13</span>Y<span class="op">$</span>Treatment)</span>
<span id="cb141-12"><a href="import-and-format-data.html#cb141-12"></a>Millm<span class="fl">.13</span>Y<span class="op">$</span>Treat &lt;-<span class="st"> </span><span class="kw">as.double</span>(Millm<span class="fl">.13</span>Y<span class="op">$</span>Treat)</span>
<span id="cb141-13"><a href="import-and-format-data.html#cb141-13"></a><span class="kw">colnames</span>(Millm<span class="fl">.13</span>Y)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Run&quot;</span>, <span class="st">&quot;Plot&quot;</span>,<span class="st">&quot;TreatY&quot;</span>, <span class="st">&quot;Rep&quot;</span>)</span>
<span id="cb141-14"><a href="import-and-format-data.html#cb141-14"></a></span>
<span id="cb141-15"><a href="import-and-format-data.html#cb141-15"></a>Millm_<span class="dv">13</span> &lt;-<span class="st"> </span><span class="kw">left_join</span>(Millm_13D, Millm<span class="fl">.13</span>Y, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;Run&quot;</span>, <span class="st">&quot;Plot&quot;</span>,<span class="st">&quot;Treat&quot;</span>, <span class="st">&quot;Rep&quot;</span>))</span></code></pre></div>
</div>
<div id="define-treatment-data-4" class="section level4">
<h4><span class="header-section-number">3.4.7.2</span> Define treatment data</h4>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="import-and-format-data.html#cb142-1"></a>Millm_<span class="dv">13</span> &lt;-<span class="st"> </span>Millm_<span class="dv">13</span> <span class="op">%&gt;%</span></span>
<span id="cb142-2"><a href="import-and-format-data.html#cb142-2"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trade_name =</span> </span>
<span id="cb142-3"><a href="import-and-format-data.html#cb142-3"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb142-4"><a href="import-and-format-data.html#cb142-4"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> &quot;Spin-flo&quot;</span>,</span>
<span id="cb142-5"><a href="import-and-format-data.html#cb142-5"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> &quot;Tilt&quot;</span>,</span>
<span id="cb142-6"><a href="import-and-format-data.html#cb142-6"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra&quot;</span>,</span>
<span id="cb142-7"><a href="import-and-format-data.html#cb142-7"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra + adj&quot;</span>,</span>
<span id="cb142-8"><a href="import-and-format-data.html#cb142-8"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> &quot;Cabrio&quot;</span>,</span>
<span id="cb142-9"><a href="import-and-format-data.html#cb142-9"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> &quot;Spin-flo&quot;</span>,</span>
<span id="cb142-10"><a href="import-and-format-data.html#cb142-10"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> &quot;Tilt&quot;</span>,</span>
<span id="cb142-11"><a href="import-and-format-data.html#cb142-11"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> &quot;Amistar Xtra + adj&quot;</span>,</span>
<span id="cb142-12"><a href="import-and-format-data.html#cb142-12"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> &quot;Cabrio&quot;</span>,</span>
<span id="cb142-13"><a href="import-and-format-data.html#cb142-13"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> &quot;Tilt&quot;</span>,</span>
<span id="cb142-14"><a href="import-and-format-data.html#cb142-14"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb142-15"><a href="import-and-format-data.html#cb142-15"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_ai =</span> </span>
<span id="cb142-16"><a href="import-and-format-data.html#cb142-16"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb142-17"><a href="import-and-format-data.html#cb142-17"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> &quot;carbendazim&quot;</span>,</span>
<span id="cb142-18"><a href="import-and-format-data.html#cb142-18"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb142-19"><a href="import-and-format-data.html#cb142-19"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb142-20"><a href="import-and-format-data.html#cb142-20"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb142-21"><a href="import-and-format-data.html#cb142-21"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> &quot;pyraclostrobin&quot;</span>,</span>
<span id="cb142-22"><a href="import-and-format-data.html#cb142-22"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> &quot;carbendazim&quot;</span>,</span>
<span id="cb142-23"><a href="import-and-format-data.html#cb142-23"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb142-24"><a href="import-and-format-data.html#cb142-24"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> &quot;200 g/L azoxystrobin + 80 g/L cyproconazole&quot;</span>,</span>
<span id="cb142-25"><a href="import-and-format-data.html#cb142-25"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> &quot;pyraclostrobin&quot;</span>,</span>
<span id="cb142-26"><a href="import-and-format-data.html#cb142-26"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb142-27"><a href="import-and-format-data.html#cb142-27"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb142-28"><a href="import-and-format-data.html#cb142-28"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> </span>
<span id="cb142-29"><a href="import-and-format-data.html#cb142-29"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb142-30"><a href="import-and-format-data.html#cb142-30"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">250</span>,</span>
<span id="cb142-31"><a href="import-and-format-data.html#cb142-31"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.5</span>,</span>
<span id="cb142-32"><a href="import-and-format-data.html#cb142-32"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">40</span>,</span>
<span id="cb142-33"><a href="import-and-format-data.html#cb142-33"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">40</span>,</span>
<span id="cb142-34"><a href="import-and-format-data.html#cb142-34"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">125</span>,</span>
<span id="cb142-35"><a href="import-and-format-data.html#cb142-35"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">250</span>,</span>
<span id="cb142-36"><a href="import-and-format-data.html#cb142-36"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.5</span>,</span>
<span id="cb142-37"><a href="import-and-format-data.html#cb142-37"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">40</span>,</span>
<span id="cb142-38"><a href="import-and-format-data.html#cb142-38"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">125</span>,</span>
<span id="cb142-39"><a href="import-and-format-data.html#cb142-39"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.5</span>,</span>
<span id="cb142-40"><a href="import-and-format-data.html#cb142-40"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>))<span class="op">%&gt;%</span></span>
<span id="cb142-41"><a href="import-and-format-data.html#cb142-41"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_1 =</span> </span>
<span id="cb142-42"><a href="import-and-format-data.html#cb142-42"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb142-43"><a href="import-and-format-data.html#cb142-43"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-44"><a href="import-and-format-data.html#cb142-44"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-45"><a href="import-and-format-data.html#cb142-45"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-46"><a href="import-and-format-data.html#cb142-46"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-47"><a href="import-and-format-data.html#cb142-47"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-48"><a href="import-and-format-data.html#cb142-48"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-49"><a href="import-and-format-data.html#cb142-49"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-50"><a href="import-and-format-data.html#cb142-50"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-51"><a href="import-and-format-data.html#cb142-51"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-52"><a href="import-and-format-data.html#cb142-52"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-53"><a href="import-and-format-data.html#cb142-53"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb142-54"><a href="import-and-format-data.html#cb142-54"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_2 =</span> </span>
<span id="cb142-55"><a href="import-and-format-data.html#cb142-55"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-21&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-56"><a href="import-and-format-data.html#cb142-56"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-21&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-57"><a href="import-and-format-data.html#cb142-57"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-21&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-58"><a href="import-and-format-data.html#cb142-58"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-21&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-59"><a href="import-and-format-data.html#cb142-59"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-21&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-60"><a href="import-and-format-data.html#cb142-60"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb142-61"><a href="import-and-format-data.html#cb142-61"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_3 =</span> </span>
<span id="cb142-62"><a href="import-and-format-data.html#cb142-62"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2013-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb142-63"><a href="import-and-format-data.html#cb142-63"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb142-64"><a href="import-and-format-data.html#cb142-64"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">spray_n =</span> </span>
<span id="cb142-65"><a href="import-and-format-data.html#cb142-65"></a>             <span class="kw">case_when</span>(Treat <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb142-66"><a href="import-and-format-data.html#cb142-66"></a>                       Treat <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb142-67"><a href="import-and-format-data.html#cb142-67"></a>                       Treat <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb142-68"><a href="import-and-format-data.html#cb142-68"></a>                       Treat <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb142-69"><a href="import-and-format-data.html#cb142-69"></a>                       Treat <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb142-70"><a href="import-and-format-data.html#cb142-70"></a>                       Treat <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb142-71"><a href="import-and-format-data.html#cb142-71"></a>                       Treat <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb142-72"><a href="import-and-format-data.html#cb142-72"></a>                       Treat <span class="op">==</span><span class="st"> &quot;8&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb142-73"><a href="import-and-format-data.html#cb142-73"></a>                       Treat <span class="op">==</span><span class="st"> &quot;9&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb142-74"><a href="import-and-format-data.html#cb142-74"></a>                       Treat <span class="op">==</span><span class="st"> &quot;10&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb142-75"><a href="import-and-format-data.html#cb142-75"></a>                       Treat <span class="op">==</span><span class="st"> &quot;11&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>, </span>
<span id="cb142-76"><a href="import-and-format-data.html#cb142-76"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>))</span></code></pre></div>
</div>
<div id="input-trial-data-5" class="section level4">
<h4><span class="header-section-number">3.4.7.3</span> Input trial data</h4>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="import-and-format-data.html#cb143-1"></a>Millm_<span class="dv">13</span>_dat &lt;-<span class="st"> </span></span>
<span id="cb143-2"><a href="import-and-format-data.html#cb143-2"></a><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">trial_ref =</span> <span class="st">&quot;BB1305&quot;</span>,</span>
<span id="cb143-3"><a href="import-and-format-data.html#cb143-3"></a>              <span class="dt">year =</span> <span class="st">&quot;2013&quot;</span>,</span>
<span id="cb143-4"><a href="import-and-format-data.html#cb143-4"></a>              <span class="dt">location =</span> <span class="st">&quot;Millmerran&quot;</span>,</span>
<span id="cb143-5"><a href="import-and-format-data.html#cb143-5"></a>              <span class="dt">host_genotype =</span> <span class="st">&quot;Crystal&quot;</span>,</span>
<span id="cb143-6"><a href="import-and-format-data.html#cb143-6"></a>              <span class="dt">trial_design =</span> <span class="st">&quot;RCB&quot;</span>,</span>
<span id="cb143-7"><a href="import-and-format-data.html#cb143-7"></a>              <span class="dt">plot_length =</span> <span class="dv">12</span>,</span>
<span id="cb143-8"><a href="import-and-format-data.html#cb143-8"></a>              <span class="dt">plot_width =</span> <span class="dv">4</span>,</span>
<span id="cb143-9"><a href="import-and-format-data.html#cb143-9"></a>              <span class="dt">plant_density =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb143-10"><a href="import-and-format-data.html#cb143-10"></a>              <span class="dt">row_spacing =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,</span>
<span id="cb143-11"><a href="import-and-format-data.html#cb143-11"></a>              <span class="dt">replicate =</span> Millm_<span class="dv">13</span><span class="op">$</span>Rep,</span>
<span id="cb143-12"><a href="import-and-format-data.html#cb143-12"></a>              <span class="dt">planting_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-01-12&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>), <span class="co"># Lawrie prices guess for planting date</span></span>
<span id="cb143-13"><a href="import-and-format-data.html#cb143-13"></a>              <span class="dt">emergence_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb143-14"><a href="import-and-format-data.html#cb143-14"></a>              <span class="dt">flowering_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb143-15"><a href="import-and-format-data.html#cb143-15"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-03-21&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb143-16"><a href="import-and-format-data.html#cb143-16"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb143-17"><a href="import-and-format-data.html#cb143-17"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-03-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb143-18"><a href="import-and-format-data.html#cb143-18"></a>              <span class="dt">trade_name =</span> <span class="kw">as.factor</span>(Millm_<span class="dv">13</span><span class="op">$</span>trade_name),</span>
<span id="cb143-19"><a href="import-and-format-data.html#cb143-19"></a>              <span class="dt">fungicide_ai =</span> Millm_<span class="dv">13</span><span class="op">$</span>fungicide_ai,</span>
<span id="cb143-20"><a href="import-and-format-data.html#cb143-20"></a>              <span class="dt">dose_ai.ha =</span> Millm_<span class="dv">13</span><span class="op">$</span>dose_ai.ha,</span>
<span id="cb143-21"><a href="import-and-format-data.html#cb143-21"></a>              <span class="dt">n_treatment =</span> Millm_<span class="dv">13</span><span class="op">$</span>Treat,</span>
<span id="cb143-22"><a href="import-and-format-data.html#cb143-22"></a>              <span class="dt">fungicide_application_1 =</span> Millm_<span class="dv">13</span><span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb143-23"><a href="import-and-format-data.html#cb143-23"></a>              <span class="dt">fungicide_application_2 =</span> Millm_<span class="dv">13</span><span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb143-24"><a href="import-and-format-data.html#cb143-24"></a>              <span class="dt">fungicide_application_3 =</span> Millm_<span class="dv">13</span><span class="op">$</span>fungicide_application_<span class="dv">3</span>,</span>
<span id="cb143-25"><a href="import-and-format-data.html#cb143-25"></a>              <span class="dt">total_fungicide =</span> Millm_<span class="dv">13</span><span class="op">$</span>spray_n,</span>
<span id="cb143-26"><a href="import-and-format-data.html#cb143-26"></a>              <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-05-06&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb143-27"><a href="import-and-format-data.html#cb143-27"></a>              <span class="dt">final_assessment =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2013-04-24&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb143-28"><a href="import-and-format-data.html#cb143-28"></a>              <span class="dt">PM_final_severity =</span> Millm_<span class="dv">13</span><span class="op">$</span>Inc_42D,</span>
<span id="cb143-29"><a href="import-and-format-data.html#cb143-29"></a>              <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb143-30"><a href="import-and-format-data.html#cb143-30"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">as.numeric</span>(Millm_<span class="dv">13</span><span class="op">$</span><span class="st">`</span><span class="dt">kg/Ha</span><span class="st">`</span>)<span class="op">/</span><span class="dv">1000</span>,</span>
<span id="cb143-31"><a href="import-and-format-data.html#cb143-31"></a>              <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="audpc-curve-6" class="section level4">
<h4><span class="header-section-number">3.4.7.4</span> AUDPC curve</h4>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="import-and-format-data.html#cb144-1"></a>Millm_<span class="dv">13</span>_dat &lt;-<span class="st"> </span><span class="kw">cbind</span>(Millm_<span class="dv">13</span>_dat,</span>
<span id="cb144-2"><a href="import-and-format-data.html#cb144-2"></a>                          <span class="dt">AUDPC =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb144-3"><a href="import-and-format-data.html#cb144-3"></a>                                                           Millm_<span class="dv">13</span>[,<span class="kw">c</span>(<span class="st">&quot;Inc_23D&quot;</span>,<span class="st">&quot;Inc_42D&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb144-4"><a href="import-and-format-data.html#cb144-4"></a>                                        <span class="dv">1</span>, </span>
<span id="cb144-5"><a href="import-and-format-data.html#cb144-5"></a>                                        <span class="dt">FUN =</span> audpc, </span>
<span id="cb144-6"><a href="import-and-format-data.html#cb144-6"></a>                                        <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">23</span>,<span class="dv">42</span>)</span>
<span id="cb144-7"><a href="import-and-format-data.html#cb144-7"></a>                                        ),</span>
<span id="cb144-8"><a href="import-and-format-data.html#cb144-8"></a>                     <span class="dt">AUDPS =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb144-9"><a href="import-and-format-data.html#cb144-9"></a>                                                           Millm_<span class="dv">13</span>[,<span class="kw">c</span>(<span class="st">&quot;Inc_23D&quot;</span>,<span class="st">&quot;Inc_42D&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb144-10"><a href="import-and-format-data.html#cb144-10"></a>                                        <span class="dv">1</span>, </span>
<span id="cb144-11"><a href="import-and-format-data.html#cb144-11"></a>                                        <span class="dt">FUN =</span> audps, </span>
<span id="cb144-12"><a href="import-and-format-data.html#cb144-12"></a>                                        <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">23</span>,<span class="dv">42</span>)</span>
<span id="cb144-13"><a href="import-and-format-data.html#cb144-13"></a>                                        )</span>
<span id="cb144-14"><a href="import-and-format-data.html#cb144-14"></a>                          )</span></code></pre></div>
</div>
<div id="calculating-the-treatment-means-3" class="section level4">
<h4><span class="header-section-number">3.4.7.5</span> Calculating the treatment means</h4>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="import-and-format-data.html#cb145-1"></a>Millm_<span class="dv">13</span>_m &lt;-<span class="st"> </span>Millm_<span class="dv">13</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb145-2"><a href="import-and-format-data.html#cb145-2"></a><span class="st">   </span><span class="kw">group_by</span>(trial_ref, year, location, host_genotype, trial_design, </span>
<span id="cb145-3"><a href="import-and-format-data.html#cb145-3"></a>            trade_name,fungicide_ai,dose_ai.ha,n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb145-4"><a href="import-and-format-data.html#cb145-4"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb145-5"><a href="import-and-format-data.html#cb145-5"></a>             <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb145-6"><a href="import-and-format-data.html#cb145-6"></a>             <span class="dt">plant_density =</span> <span class="kw">unique</span>(plant_density),</span>
<span id="cb145-7"><a href="import-and-format-data.html#cb145-7"></a>             <span class="dt">row_spacing =</span> <span class="kw">unique</span>(row_spacing),</span>
<span id="cb145-8"><a href="import-and-format-data.html#cb145-8"></a>             <span class="dt">replicates =</span> <span class="kw">length</span>(<span class="kw">as.numeric</span>(replicate)),</span>
<span id="cb145-9"><a href="import-and-format-data.html#cb145-9"></a>             <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb145-10"><a href="import-and-format-data.html#cb145-10"></a>             <span class="dt">emergence_date =</span> <span class="ot">NA</span>,</span>
<span id="cb145-11"><a href="import-and-format-data.html#cb145-11"></a>             <span class="dt">flowering_date =</span> <span class="kw">unique</span>(flowering_date),</span>
<span id="cb145-12"><a href="import-and-format-data.html#cb145-12"></a>             <span class="dt">pod_fill_date =</span> <span class="kw">unique</span>(pod_fill_date),</span>
<span id="cb145-13"><a href="import-and-format-data.html#cb145-13"></a>             <span class="dt">mid_late_pod_fill =</span> <span class="kw">unique</span>(mid_late_pod_fill),</span>
<span id="cb145-14"><a href="import-and-format-data.html#cb145-14"></a>             <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb145-15"><a href="import-and-format-data.html#cb145-15"></a>             <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb145-16"><a href="import-and-format-data.html#cb145-16"></a>             <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb145-17"><a href="import-and-format-data.html#cb145-17"></a>             <span class="dt">fungicide_application_3 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">3</span>),</span>
<span id="cb145-18"><a href="import-and-format-data.html#cb145-18"></a>             <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb145-19"><a href="import-and-format-data.html#cb145-19"></a>             <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb145-20"><a href="import-and-format-data.html#cb145-20"></a>             <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb145-21"><a href="import-and-format-data.html#cb145-21"></a>             <span class="dt">PM_final_severity =</span> <span class="kw">mean</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb145-22"><a href="import-and-format-data.html#cb145-22"></a>             <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb145-23"><a href="import-and-format-data.html#cb145-23"></a>             <span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="co"># Createds NAs and need repeating below</span></span>
<span id="cb145-24"><a href="import-and-format-data.html#cb145-24"></a>             <span class="dt">D_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb145-25"><a href="import-and-format-data.html#cb145-25"></a>             <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb145-26"><a href="import-and-format-data.html#cb145-26"></a>             <span class="dt">raw_graded =</span> <span class="ot">NA</span>,</span>
<span id="cb145-27"><a href="import-and-format-data.html#cb145-27"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb145-28"><a href="import-and-format-data.html#cb145-28"></a>             <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb145-29"><a href="import-and-format-data.html#cb145-29"></a>             <span class="dt">AUDPC_m =</span> <span class="kw">mean</span>(AUDPC),</span>
<span id="cb145-30"><a href="import-and-format-data.html#cb145-30"></a>             <span class="dt">AUDPC_sd =</span> <span class="kw">sd</span>(AUDPC),</span>
<span id="cb145-31"><a href="import-and-format-data.html#cb145-31"></a>             <span class="dt">AUDPS_m =</span> <span class="kw">mean</span>(AUDPS),</span>
<span id="cb145-32"><a href="import-and-format-data.html#cb145-32"></a>             <span class="dt">AUDPS_sd =</span> <span class="kw">sd</span>(AUDPS),</span>
<span id="cb145-33"><a href="import-and-format-data.html#cb145-33"></a>             <span class="dt">Inc_Ms =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), </span>
<span id="cb145-34"><a href="import-and-format-data.html#cb145-34"></a>                               <span class="dt">data =</span> Millm_<span class="dv">13</span>_dat[Millm_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;propiconazole&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb145-35"><a href="import-and-format-data.html#cb145-35"></a><span class="st">                                                        </span>Millm_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span> ,]))[<span class="dv">1</span>,<span class="dv">3</span>],</span>
<span id="cb145-36"><a href="import-and-format-data.html#cb145-36"></a>              <span class="dt">Y_Msquare =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), </span>
<span id="cb145-37"><a href="import-and-format-data.html#cb145-37"></a>                                <span class="dt">data =</span> Millm_<span class="dv">13</span>_dat[Millm_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;propiconazole&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb145-38"><a href="import-and-format-data.html#cb145-38"></a><span class="st">                                                        </span>Millm_<span class="dv">13</span>_dat<span class="op">$</span>fungicide_ai <span class="op">==</span><span class="st"> &quot;control&quot;</span> ,]))[<span class="dv">1</span>,<span class="dv">3</span>]</span>
<span id="cb145-39"><a href="import-and-format-data.html#cb145-39"></a>             )</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;trial_ref&#39;, &#39;year&#39;, &#39;location&#39;, &#39;host_genotype&#39;, &#39;trial_design&#39;, &#39;trade_name&#39;, &#39;fungicide_ai&#39;, &#39;dose_ai.ha&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="import-and-format-data.html#cb147-1"></a><span class="co"># For some wierd reason standard deviations are comming back NA in the code above</span></span>
<span id="cb147-2"><a href="import-and-format-data.html#cb147-2"></a><span class="co"># Because of n_treatment being converted to a factor I need to wrangle carefully here</span></span>
<span id="cb147-3"><a href="import-and-format-data.html#cb147-3"></a>Millm_tmp &lt;-<span class="st"> </span>Millm_<span class="dv">13</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb147-4"><a href="import-and-format-data.html#cb147-4"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb147-5"><a href="import-and-format-data.html#cb147-5"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb147-6"><a href="import-and-format-data.html#cb147-6"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="import-and-format-data.html#cb149-1"></a><span class="co"># Remive the existing yield_error columns and replace with new ones</span></span>
<span id="cb149-2"><a href="import-and-format-data.html#cb149-2"></a>Millm_<span class="dv">13</span>_m &lt;-<span class="st"> </span><span class="kw">left_join</span>(Millm_<span class="dv">13</span>_m[,<span class="kw">colnames</span>(Millm_<span class="dv">13</span>_m)[<span class="kw">c</span>(<span class="op">-</span><span class="dv">29</span>,<span class="op">-</span><span class="dv">33</span>)]], Millm_tmp)</span></code></pre></div>
<pre><code>## Joining, by = &quot;n_treatment&quot;</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="import-and-format-data.html#cb151-1"></a><span class="co"># Remove other plots not in experiment</span></span>
<span id="cb151-2"><a href="import-and-format-data.html#cb151-2"></a>Millm_<span class="dv">13</span>_m &lt;-<span class="st"> </span>Millm_<span class="dv">13</span>_m[Millm_<span class="dv">13</span>_m<span class="op">$</span>trade_name <span class="op">!=</span><span class="st"> &quot;other&quot;</span>,]</span>
<span id="cb151-3"><a href="import-and-format-data.html#cb151-3"></a></span>
<span id="cb151-4"><a href="import-and-format-data.html#cb151-4"></a></span>
<span id="cb151-5"><a href="import-and-format-data.html#cb151-5"></a>Millm_<span class="dv">13</span>_m<span class="op">$</span>n_treatment &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(Millm_<span class="dv">13</span>_m<span class="op">$</span>n_treatment))</span>
<span id="cb151-6"><a href="import-and-format-data.html#cb151-6"></a>Millm_<span class="dv">13</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(Millm_<span class="dv">13</span>_m, PM_MB_means)</span>
<span id="cb151-7"><a href="import-and-format-data.html#cb151-7"></a></span>
<span id="cb151-8"><a href="import-and-format-data.html#cb151-8"></a><span class="co"># insert new calculations into data</span></span>
<span id="cb151-9"><a href="import-and-format-data.html#cb151-9"></a>PM_MB_means &lt;-<span class="st"> </span><span class="kw">replace_data</span>(<span class="dt">template_data =</span> PM_MB_means, </span>
<span id="cb151-10"><a href="import-and-format-data.html#cb151-10"></a>                            <span class="dt">new_data =</span> Millm_<span class="dv">13</span>_m, </span>
<span id="cb151-11"><a href="import-and-format-data.html#cb151-11"></a>                            <span class="dt">new_data_column =</span> <span class="kw">c</span>(<span class="st">&quot;planting_date&quot;</span>,<span class="st">&quot;AUDPC_m&quot;</span>, <span class="st">&quot;AUDPC_sd&quot;</span>, <span class="st">&quot;AUDPS_m&quot;</span>,<span class="st">&quot;AUDPS_sd&quot;</span>,<span class="st">&quot;Y_Msquare&quot;</span>, <span class="st">&quot;Inc_Ms&quot;</span>),</span>
<span id="cb151-12"><a href="import-and-format-data.html#cb151-12"></a>                            <span class="dt">filter_cols =</span> <span class="kw">c</span>(<span class="st">&quot;trial_ref&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;location&quot;</span>, <span class="st">&quot;host_genotype&quot;</span>, </span>
<span id="cb151-13"><a href="import-and-format-data.html#cb151-13"></a>                                           <span class="st">&quot;fungicide_ai&quot;</span>, <span class="st">&quot;dose_ai.ha&quot;</span>,<span class="st">&quot;n_treatment&quot;</span>))</span></code></pre></div>
<pre><code>## No data changed 0/11</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="import-and-format-data.html#cb153-1"></a><span class="kw">write.csv</span>(</span>
<span id="cb153-2"><a href="import-and-format-data.html#cb153-2"></a>   Millm_<span class="dv">13</span>_m[<span class="kw">order</span>(<span class="kw">as.numeric</span>(Millm_<span class="dv">13</span>_m<span class="op">$</span>n_treatment)),],</span>
<span id="cb153-3"><a href="import-and-format-data.html#cb153-3"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/BB1305_Millmerran_means.csv&quot;</span>), <span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb153-4"><a href="import-and-format-data.html#cb153-4"></a>)</span></code></pre></div>
</div>
</div>
<div id="hermitage-2015" class="section level3">
<h3><span class="header-section-number">3.4.8</span> Hermitage 2015</h3>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="import-and-format-data.html#cb154-1"></a>Herm_<span class="dv">15</span> &lt;-</span>
<span id="cb154-2"><a href="import-and-format-data.html#cb154-2"></a><span class="st">   </span><span class="kw">read.xlsx</span>(</span>
<span id="cb154-3"><a href="import-and-format-data.html#cb154-3"></a>      <span class="kw">here</span>(<span class="st">&quot;data/Mugbean powdery mildew 2014-15 inc results v2.xlsx&quot;</span>),</span>
<span id="cb154-4"><a href="import-and-format-data.html#cb154-4"></a>      <span class="dt">sheet =</span> <span class="st">&quot;HRS yield data&quot;</span>,</span>
<span id="cb154-5"><a href="import-and-format-data.html#cb154-5"></a>      <span class="dt">startRow =</span> <span class="dv">4</span>,</span>
<span id="cb154-6"><a href="import-and-format-data.html#cb154-6"></a>      <span class="dt">colNames =</span> <span class="ot">TRUE</span>,</span>
<span id="cb154-7"><a href="import-and-format-data.html#cb154-7"></a>      <span class="dt">detectDates =</span> <span class="ot">TRUE</span></span>
<span id="cb154-8"><a href="import-and-format-data.html#cb154-8"></a>   )[<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>]</span>
<span id="cb154-9"><a href="import-and-format-data.html#cb154-9"></a></span>
<span id="cb154-10"><a href="import-and-format-data.html#cb154-10"></a></span>
<span id="cb154-11"><a href="import-and-format-data.html#cb154-11"></a></span>
<span id="cb154-12"><a href="import-and-format-data.html#cb154-12"></a>Herm_<span class="dv">15</span><span class="op">$</span>Year &lt;-<span class="st"> </span><span class="dv">2015</span></span>
<span id="cb154-13"><a href="import-and-format-data.html#cb154-13"></a>Herm_<span class="dv">15</span><span class="op">$</span>location &lt;-<span class="st"> &quot;Hermitage&quot;</span></span>
<span id="cb154-14"><a href="import-and-format-data.html#cb154-14"></a></span>
<span id="cb154-15"><a href="import-and-format-data.html#cb154-15"></a><span class="co"># Disease incidence assessments through the 2016 season</span></span>
<span id="cb154-16"><a href="import-and-format-data.html#cb154-16"></a>Herm_<span class="fl">15.</span>DR  &lt;-</span>
<span id="cb154-17"><a href="import-and-format-data.html#cb154-17"></a><span class="st">   </span><span class="kw">read.xlsx</span>(</span>
<span id="cb154-18"><a href="import-and-format-data.html#cb154-18"></a>      <span class="kw">here</span>(<span class="st">&quot;data/Mugbean powdery mildew 2014-15 inc results v2.xlsx&quot;</span>),</span>
<span id="cb154-19"><a href="import-and-format-data.html#cb154-19"></a>      <span class="dt">sheet =</span> <span class="st">&quot;HRS ratings &amp; graphs&quot;</span>,</span>
<span id="cb154-20"><a href="import-and-format-data.html#cb154-20"></a>      <span class="dt">startRow =</span> <span class="dv">5</span>,</span>
<span id="cb154-21"><a href="import-and-format-data.html#cb154-21"></a>      <span class="dt">colNames =</span> <span class="ot">TRUE</span></span>
<span id="cb154-22"><a href="import-and-format-data.html#cb154-22"></a>   )[<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]</span>
<span id="cb154-23"><a href="import-and-format-data.html#cb154-23"></a></span>
<span id="cb154-24"><a href="import-and-format-data.html#cb154-24"></a>Herm_<span class="dv">15</span><span class="op">$</span>Plot.Length &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(Herm_<span class="dv">15</span><span class="op">$</span>Plot.Length)</span>
<span id="cb154-25"><a href="import-and-format-data.html#cb154-25"></a>Herm_<span class="dv">15</span><span class="op">$</span>Plot.Weight &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(Herm_<span class="dv">15</span><span class="op">$</span>Plot.Weight)</span>
<span id="cb154-26"><a href="import-and-format-data.html#cb154-26"></a>Herm_<span class="dv">15</span><span class="op">$</span>Plot.weight &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(Herm_<span class="dv">15</span><span class="op">$</span>Plot.weight)</span>
<span id="cb154-27"><a href="import-and-format-data.html#cb154-27"></a>Herm_<span class="dv">15</span><span class="op">$</span><span class="st">`</span><span class="dt">Plot.Yield.(kg/ha)</span><span class="st">`</span> &lt;-</span>
<span id="cb154-28"><a href="import-and-format-data.html#cb154-28"></a><span class="st">   </span><span class="kw">as.numeric</span>(Herm_<span class="dv">15</span><span class="op">$</span><span class="st">`</span><span class="dt">Plot.Yield.(kg/ha)</span><span class="st">`</span>)</span>
<span id="cb154-29"><a href="import-and-format-data.html#cb154-29"></a>Herm_<span class="dv">15</span><span class="op">$</span><span class="st">`</span><span class="dt">Plot.Yield.(t/ha)</span><span class="st">`</span> &lt;-</span>
<span id="cb154-30"><a href="import-and-format-data.html#cb154-30"></a><span class="st">   </span><span class="kw">as.numeric</span>(Herm_<span class="dv">15</span><span class="op">$</span><span class="st">`</span><span class="dt">Plot.Yield.(t/ha)</span><span class="st">`</span>)</span>
<span id="cb154-31"><a href="import-and-format-data.html#cb154-31"></a></span>
<span id="cb154-32"><a href="import-and-format-data.html#cb154-32"></a><span class="co"># Rename the plot column and remove lines without data</span></span>
<span id="cb154-33"><a href="import-and-format-data.html#cb154-33"></a><span class="kw">colnames</span>(Herm_<span class="dv">15</span>)[<span class="dv">3</span>] &lt;-<span class="st"> &quot;Plot&quot;</span></span>
<span id="cb154-34"><a href="import-and-format-data.html#cb154-34"></a>Herm_<span class="fl">15.</span>DR &lt;-<span class="st"> </span>Herm_<span class="fl">15.</span>DR[<span class="op">!</span><span class="kw">is.na</span>(Herm_<span class="fl">15.</span>DR<span class="op">$</span>Treatment),]</span>
<span id="cb154-35"><a href="import-and-format-data.html#cb154-35"></a></span>
<span id="cb154-36"><a href="import-and-format-data.html#cb154-36"></a></span>
<span id="cb154-37"><a href="import-and-format-data.html#cb154-37"></a><span class="co"># rename the disease assesment columns</span></span>
<span id="cb154-38"><a href="import-and-format-data.html#cb154-38"></a><span class="co"># For comparing between trials I am forcing the assumption </span></span>
<span id="cb154-39"><a href="import-and-format-data.html#cb154-39"></a><span class="co">#   that the disease did not exist prior to it being spotted in the trial. </span></span>
<span id="cb154-40"><a href="import-and-format-data.html#cb154-40"></a><span class="co">#   Therefore day0 observes zero disease and day1 is first sign</span></span>
<span id="cb154-41"><a href="import-and-format-data.html#cb154-41"></a><span class="kw">colnames</span>(Herm_<span class="fl">15.</span>DR)[<span class="dv">4</span><span class="op">:</span><span class="dv">8</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;day0&quot;</span>, <span class="st">&quot;day1&quot;</span>, <span class="st">&quot;day8&quot;</span>, <span class="st">&quot;day15&quot;</span>,<span class="st">&quot;day22&quot;</span>) </span>
<span id="cb154-42"><a href="import-and-format-data.html#cb154-42"></a>Herm_<span class="fl">15.</span>DR<span class="op">$</span>day0 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(Herm_<span class="fl">15.</span>DR<span class="op">$</span>day0)</span>
<span id="cb154-43"><a href="import-and-format-data.html#cb154-43"></a>Herm_<span class="fl">15.</span>DR<span class="op">$</span>day1 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(Herm_<span class="fl">15.</span>DR<span class="op">$</span>day1)</span>
<span id="cb154-44"><a href="import-and-format-data.html#cb154-44"></a>Herm_<span class="fl">15.</span>DR<span class="op">$</span>day8 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(Herm_<span class="fl">15.</span>DR<span class="op">$</span>day8)</span>
<span id="cb154-45"><a href="import-and-format-data.html#cb154-45"></a>Herm_<span class="fl">15.</span>DR<span class="op">$</span>day15 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(Herm_<span class="fl">15.</span>DR<span class="op">$</span>day15)</span>
<span id="cb154-46"><a href="import-and-format-data.html#cb154-46"></a>Herm_<span class="fl">15.</span>DR<span class="op">$</span>day22 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(Herm_<span class="fl">15.</span>DR<span class="op">$</span>day22)</span>
<span id="cb154-47"><a href="import-and-format-data.html#cb154-47"></a></span>
<span id="cb154-48"><a href="import-and-format-data.html#cb154-48"></a></span>
<span id="cb154-49"><a href="import-and-format-data.html#cb154-49"></a></span>
<span id="cb154-50"><a href="import-and-format-data.html#cb154-50"></a><span class="co"># Merge yield and disease data</span></span>
<span id="cb154-51"><a href="import-and-format-data.html#cb154-51"></a>Herm_<span class="dv">15</span> &lt;-<span class="st"> </span><span class="kw">left_join</span>(Herm_<span class="fl">15.</span>DR, Herm_<span class="dv">15</span>)</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;Plot&quot;, &quot;Treatment&quot;)</code></pre>
<div id="define-treatment-data-5" class="section level4">
<h4><span class="header-section-number">3.4.8.1</span> Define treatment data</h4>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="import-and-format-data.html#cb156-1"></a>Herm_<span class="dv">15</span>_dat &lt;-<span class="st"> </span>Herm_<span class="dv">15</span> <span class="op">%&gt;%</span></span>
<span id="cb156-2"><a href="import-and-format-data.html#cb156-2"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">n_treatment =</span> </span>
<span id="cb156-3"><a href="import-and-format-data.html#cb156-3"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1st sign +1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>,</span>
<span id="cb156-4"><a href="import-and-format-data.html#cb156-4"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;control&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb156-5"><a href="import-and-format-data.html#cb156-5"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1st sign&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,</span>
<span id="cb156-6"><a href="import-and-format-data.html#cb156-6"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1/3C + 1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">6</span>,</span>
<span id="cb156-7"><a href="import-and-format-data.html#cb156-7"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;5wks+2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb156-8"><a href="import-and-format-data.html#cb156-8"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1/3C&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb156-9"><a href="import-and-format-data.html#cb156-9"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">9998</span>))<span class="op">%&gt;%</span></span>
<span id="cb156-10"><a href="import-and-format-data.html#cb156-10"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trade_name =</span> </span>
<span id="cb156-11"><a href="import-and-format-data.html#cb156-11"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;control&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb156-12"><a href="import-and-format-data.html#cb156-12"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Folicur&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb156-13"><a href="import-and-format-data.html#cb156-13"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_ai =</span> </span>
<span id="cb156-14"><a href="import-and-format-data.html#cb156-14"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;control&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb156-15"><a href="import-and-format-data.html#cb156-15"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;tebuconazole&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb156-16"><a href="import-and-format-data.html#cb156-16"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> </span>
<span id="cb156-17"><a href="import-and-format-data.html#cb156-17"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;control&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb156-18"><a href="import-and-format-data.html#cb156-18"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.35</span>))<span class="op">%&gt;%</span></span>
<span id="cb156-19"><a href="import-and-format-data.html#cb156-19"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_1 =</span> </span>
<span id="cb156-20"><a href="import-and-format-data.html#cb156-20"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1st sign +1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2015-03-17&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb156-21"><a href="import-and-format-data.html#cb156-21"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;control&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb156-22"><a href="import-and-format-data.html#cb156-22"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1st sign&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2015-03-17&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb156-23"><a href="import-and-format-data.html#cb156-23"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1/3C + 1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2015-03-23&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb156-24"><a href="import-and-format-data.html#cb156-24"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;5wks+2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2015-03-02&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb156-25"><a href="import-and-format-data.html#cb156-25"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1/3C&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2015-03-24&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb156-26"><a href="import-and-format-data.html#cb156-26"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb156-27"><a href="import-and-format-data.html#cb156-27"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_2 =</span> </span>
<span id="cb156-28"><a href="import-and-format-data.html#cb156-28"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1st sign +1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2015-03-31&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb156-29"><a href="import-and-format-data.html#cb156-29"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;control&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb156-30"><a href="import-and-format-data.html#cb156-30"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1/3C + 1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2015-04-07&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb156-31"><a href="import-and-format-data.html#cb156-31"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;5wks+2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2015-03-17&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb156-32"><a href="import-and-format-data.html#cb156-32"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb156-33"><a href="import-and-format-data.html#cb156-33"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_3 =</span> </span>
<span id="cb156-34"><a href="import-and-format-data.html#cb156-34"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;5wks+2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2015-03-31&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb156-35"><a href="import-and-format-data.html#cb156-35"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb156-36"><a href="import-and-format-data.html#cb156-36"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">spray_n =</span> </span>
<span id="cb156-37"><a href="import-and-format-data.html#cb156-37"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1st sign +1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb156-38"><a href="import-and-format-data.html#cb156-38"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;control&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb156-39"><a href="import-and-format-data.html#cb156-39"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1st sign&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb156-40"><a href="import-and-format-data.html#cb156-40"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1/3C + 1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb156-41"><a href="import-and-format-data.html#cb156-41"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;5wks+2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,</span>
<span id="cb156-42"><a href="import-and-format-data.html#cb156-42"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1/3C&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb156-43"><a href="import-and-format-data.html#cb156-43"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">9999</span>))</span></code></pre></div>
</div>
<div id="input-trial-data-6" class="section level4">
<h4><span class="header-section-number">3.4.8.2</span> Input trial data</h4>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="import-and-format-data.html#cb157-1"></a>Herm_<span class="dv">15</span>_dat &lt;-<span class="st"> </span></span>
<span id="cb157-2"><a href="import-and-format-data.html#cb157-2"></a><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">trial_ref =</span> <span class="st">&quot;mung1415/01&quot;</span>,</span>
<span id="cb157-3"><a href="import-and-format-data.html#cb157-3"></a>              <span class="dt">year =</span> <span class="st">&quot;2015&quot;</span>,</span>
<span id="cb157-4"><a href="import-and-format-data.html#cb157-4"></a>              <span class="dt">location =</span> <span class="st">&quot;Hermitage&quot;</span>,</span>
<span id="cb157-5"><a href="import-and-format-data.html#cb157-5"></a>              <span class="dt">host_genotype =</span> <span class="st">&quot;Jade&quot;</span>,</span>
<span id="cb157-6"><a href="import-and-format-data.html#cb157-6"></a>              <span class="dt">trial_design =</span> <span class="st">&quot;RCB&quot;</span>,</span>
<span id="cb157-7"><a href="import-and-format-data.html#cb157-7"></a>              <span class="dt">plot_length =</span> <span class="dv">12</span>,</span>
<span id="cb157-8"><a href="import-and-format-data.html#cb157-8"></a>              <span class="dt">plot_width =</span> <span class="dv">4</span>,</span>
<span id="cb157-9"><a href="import-and-format-data.html#cb157-9"></a>              <span class="dt">plant_density =</span> <span class="ot">NA</span>,</span>
<span id="cb157-10"><a href="import-and-format-data.html#cb157-10"></a>              <span class="dt">row_spacing =</span> <span class="fl">0.75</span>,</span>
<span id="cb157-11"><a href="import-and-format-data.html#cb157-11"></a>              <span class="dt">replicate =</span> Herm_<span class="dv">15</span>_dat<span class="op">$</span>Rep,</span>
<span id="cb157-12"><a href="import-and-format-data.html#cb157-12"></a>              <span class="dt">planting_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2015-01-19&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb157-13"><a href="import-and-format-data.html#cb157-13"></a>              <span class="dt">emergence_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2015-01-24&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb157-14"><a href="import-and-format-data.html#cb157-14"></a>              <span class="dt">flowering_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb157-15"><a href="import-and-format-data.html#cb157-15"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb157-16"><a href="import-and-format-data.html#cb157-16"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb157-17"><a href="import-and-format-data.html#cb157-17"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2015-03-16&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb157-18"><a href="import-and-format-data.html#cb157-18"></a>              <span class="dt">trade_name =</span> <span class="kw">as.factor</span>(Herm_<span class="dv">15</span>_dat<span class="op">$</span>trade_name),</span>
<span id="cb157-19"><a href="import-and-format-data.html#cb157-19"></a>              <span class="dt">fungicide_ai =</span> Herm_<span class="dv">15</span>_dat<span class="op">$</span>fungicide_ai,</span>
<span id="cb157-20"><a href="import-and-format-data.html#cb157-20"></a>              <span class="dt">dose_ai.ha =</span> Herm_<span class="dv">15</span>_dat<span class="op">$</span>dose_ai.ha,</span>
<span id="cb157-21"><a href="import-and-format-data.html#cb157-21"></a>              <span class="dt">n_treatment =</span> <span class="kw">as.numeric</span>(Herm_<span class="dv">15</span>_dat<span class="op">$</span>n_treatment),</span>
<span id="cb157-22"><a href="import-and-format-data.html#cb157-22"></a>              <span class="dt">fungicide_application_1 =</span> Herm_<span class="dv">15</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb157-23"><a href="import-and-format-data.html#cb157-23"></a>              <span class="dt">fungicide_application_2 =</span> Herm_<span class="dv">15</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb157-24"><a href="import-and-format-data.html#cb157-24"></a>              <span class="dt">fungicide_application_3 =</span> Herm_<span class="dv">15</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">3</span>,</span>
<span id="cb157-25"><a href="import-and-format-data.html#cb157-25"></a>              <span class="dt">total_fungicide =</span> Herm_<span class="dv">15</span>_dat<span class="op">$</span>spray_n,</span>
<span id="cb157-26"><a href="import-and-format-data.html#cb157-26"></a>              <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2015-04-20&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb157-27"><a href="import-and-format-data.html#cb157-27"></a>              <span class="dt">final_assessment =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2015-04-06&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb157-28"><a href="import-and-format-data.html#cb157-28"></a>              <span class="dt">PM_final_severity =</span> Herm_<span class="dv">15</span>_dat<span class="op">$</span>day22,</span>
<span id="cb157-29"><a href="import-and-format-data.html#cb157-29"></a>              <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb157-30"><a href="import-and-format-data.html#cb157-30"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">as.numeric</span>(Herm_<span class="dv">15</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">Plot.Yield.(t/ha)</span><span class="st">`</span>),</span>
<span id="cb157-31"><a href="import-and-format-data.html#cb157-31"></a>              <span class="dt">AUDPC =</span> <span class="kw">apply</span>(Herm_<span class="dv">15</span>_dat[,<span class="kw">c</span>(<span class="st">&quot;day0&quot;</span>, <span class="st">&quot;day1&quot;</span>, <span class="st">&quot;day8&quot;</span>, <span class="st">&quot;day15&quot;</span>,<span class="st">&quot;day22&quot;</span>)]<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>, </span>
<span id="cb157-32"><a href="import-and-format-data.html#cb157-32"></a>                            <span class="dt">FUN =</span> audpc, </span>
<span id="cb157-33"><a href="import-and-format-data.html#cb157-33"></a>                            <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">15</span>,<span class="dv">22</span>)),</span>
<span id="cb157-34"><a href="import-and-format-data.html#cb157-34"></a>              <span class="co"># -1 to the data because zero disease = 1 on rating scale// Dates are based off days from first sign</span></span>
<span id="cb157-35"><a href="import-and-format-data.html#cb157-35"></a>              <span class="dt">AUDPS =</span> <span class="kw">apply</span>(Herm_<span class="dv">15</span>_dat[,<span class="kw">c</span>(<span class="st">&quot;day0&quot;</span>, <span class="st">&quot;day1&quot;</span>, <span class="st">&quot;day8&quot;</span>, <span class="st">&quot;day15&quot;</span>,<span class="st">&quot;day22&quot;</span>)]<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>, </span>
<span id="cb157-36"><a href="import-and-format-data.html#cb157-36"></a>                            <span class="dt">FUN =</span> audps, </span>
<span id="cb157-37"><a href="import-and-format-data.html#cb157-37"></a>                            <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">15</span>,<span class="dv">22</span>)),</span>
<span id="cb157-38"><a href="import-and-format-data.html#cb157-38"></a>              <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="calculating-treatment-means" class="section level4">
<h4><span class="header-section-number">3.4.8.3</span> Calculating treatment means</h4>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="import-and-format-data.html#cb158-1"></a>Herm_<span class="dv">15</span>_m &lt;-<span class="st"> </span>Herm_<span class="dv">15</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb158-2"><a href="import-and-format-data.html#cb158-2"></a><span class="st">   </span><span class="kw">group_by</span>(host_genotype, n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb158-3"><a href="import-and-format-data.html#cb158-3"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb158-4"><a href="import-and-format-data.html#cb158-4"></a>             <span class="dt">year =</span> <span class="kw">unique</span>(year),</span>
<span id="cb158-5"><a href="import-and-format-data.html#cb158-5"></a>             <span class="dt">location =</span> <span class="kw">unique</span>(location),</span>
<span id="cb158-6"><a href="import-and-format-data.html#cb158-6"></a>             <span class="dt">trial_design =</span> <span class="kw">unique</span>(trial_design),</span>
<span id="cb158-7"><a href="import-and-format-data.html#cb158-7"></a>             <span class="dt">trade_name =</span> <span class="kw">unique</span>(trade_name),</span>
<span id="cb158-8"><a href="import-and-format-data.html#cb158-8"></a>             <span class="dt">fungicide_ai =</span> <span class="kw">unique</span>(fungicide_ai),</span>
<span id="cb158-9"><a href="import-and-format-data.html#cb158-9"></a>             <span class="dt">dose_ai.ha =</span> <span class="kw">unique</span>(dose_ai.ha),</span>
<span id="cb158-10"><a href="import-and-format-data.html#cb158-10"></a>             <span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb158-11"><a href="import-and-format-data.html#cb158-11"></a>             <span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb158-12"><a href="import-and-format-data.html#cb158-12"></a>             <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb158-13"><a href="import-and-format-data.html#cb158-13"></a>             <span class="dt">plant_density =</span> <span class="kw">unique</span>(plant_density),</span>
<span id="cb158-14"><a href="import-and-format-data.html#cb158-14"></a>             <span class="dt">row_spacing =</span> <span class="kw">unique</span>(row_spacing),</span>
<span id="cb158-15"><a href="import-and-format-data.html#cb158-15"></a>             <span class="dt">replicates =</span> <span class="kw">length</span>(<span class="kw">as.numeric</span>(replicate)),</span>
<span id="cb158-16"><a href="import-and-format-data.html#cb158-16"></a>             <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb158-17"><a href="import-and-format-data.html#cb158-17"></a>             <span class="dt">emergence_date =</span> <span class="kw">unique</span>(emergence_date),</span>
<span id="cb158-18"><a href="import-and-format-data.html#cb158-18"></a>             <span class="dt">flowering_date =</span> <span class="kw">unique</span>(flowering_date),</span>
<span id="cb158-19"><a href="import-and-format-data.html#cb158-19"></a>             <span class="dt">pod_fill_date =</span> <span class="kw">unique</span>(pod_fill_date),</span>
<span id="cb158-20"><a href="import-and-format-data.html#cb158-20"></a>             <span class="dt">mid_late_pod_fill =</span> <span class="kw">unique</span>(mid_late_pod_fill),</span>
<span id="cb158-21"><a href="import-and-format-data.html#cb158-21"></a>             <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb158-22"><a href="import-and-format-data.html#cb158-22"></a>             <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb158-23"><a href="import-and-format-data.html#cb158-23"></a>             <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb158-24"><a href="import-and-format-data.html#cb158-24"></a>             <span class="dt">fungicide_application_3 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">3</span>),</span>
<span id="cb158-25"><a href="import-and-format-data.html#cb158-25"></a>             <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb158-26"><a href="import-and-format-data.html#cb158-26"></a>             <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb158-27"><a href="import-and-format-data.html#cb158-27"></a>             <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb158-28"><a href="import-and-format-data.html#cb158-28"></a>             <span class="dt">PM_final_severity =</span> <span class="kw">mean</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb158-29"><a href="import-and-format-data.html#cb158-29"></a>             <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb158-30"><a href="import-and-format-data.html#cb158-30"></a>             <span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="co"># generates NAs and needs repeating below</span></span>
<span id="cb158-31"><a href="import-and-format-data.html#cb158-31"></a>             <span class="dt">D_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb158-32"><a href="import-and-format-data.html#cb158-32"></a>             <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb158-33"><a href="import-and-format-data.html#cb158-33"></a>             <span class="dt">raw_graded =</span> <span class="ot">NA</span>,</span>
<span id="cb158-34"><a href="import-and-format-data.html#cb158-34"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb158-35"><a href="import-and-format-data.html#cb158-35"></a>             <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb158-36"><a href="import-and-format-data.html#cb158-36"></a>             <span class="dt">AUDPC_m =</span> <span class="kw">mean</span>(AUDPC),</span>
<span id="cb158-37"><a href="import-and-format-data.html#cb158-37"></a>             <span class="dt">AUDPC_sd =</span> <span class="kw">sd</span>(AUDPC),</span>
<span id="cb158-38"><a href="import-and-format-data.html#cb158-38"></a>             <span class="dt">AUDPS_m =</span> <span class="kw">mean</span>(AUDPS),</span>
<span id="cb158-39"><a href="import-and-format-data.html#cb158-39"></a>             <span class="dt">AUDPS_sd =</span> <span class="kw">sd</span>(AUDPS),</span>
<span id="cb158-40"><a href="import-and-format-data.html#cb158-40"></a>             <span class="dt">Inc_Ms =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), </span>
<span id="cb158-41"><a href="import-and-format-data.html#cb158-41"></a>                               <span class="dt">data =</span> Herm_<span class="dv">15</span>_dat))[<span class="dv">1</span>,<span class="dv">3</span>],</span>
<span id="cb158-42"><a href="import-and-format-data.html#cb158-42"></a>              <span class="dt">Y_Msquare =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), </span>
<span id="cb158-43"><a href="import-and-format-data.html#cb158-43"></a>                                <span class="dt">data =</span> Herm_<span class="dv">15</span>_dat))[<span class="dv">1</span>,<span class="dv">3</span>]</span>
<span id="cb158-44"><a href="import-and-format-data.html#cb158-44"></a>   )</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;host_genotype&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="import-and-format-data.html#cb160-1"></a><span class="co"># For some wierd reason standard deviations are comming back NA in the code above</span></span>
<span id="cb160-2"><a href="import-and-format-data.html#cb160-2"></a>Herm_<span class="dv">15</span>_m[,<span class="kw">c</span>(<span class="st">&quot;disease_error&quot;</span>,<span class="st">&quot;yield_error&quot;</span>)] &lt;-<span class="st"> </span></span>
<span id="cb160-3"><a href="import-and-format-data.html#cb160-3"></a><span class="st">   </span>Herm_<span class="dv">15</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb160-4"><a href="import-and-format-data.html#cb160-4"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb160-5"><a href="import-and-format-data.html#cb160-5"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb160-6"><a href="import-and-format-data.html#cb160-6"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb160-7"><a href="import-and-format-data.html#cb160-7"></a><span class="st">   </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&quot;disease_error&quot;</span>,<span class="st">&quot;yield_error&quot;</span>))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="import-and-format-data.html#cb162-1"></a>Herm_<span class="dv">15</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(Herm_<span class="dv">15</span>_m, PM_MB_means)</span>
<span id="cb162-2"><a href="import-and-format-data.html#cb162-2"></a></span>
<span id="cb162-3"><a href="import-and-format-data.html#cb162-3"></a><span class="co"># insert new calculations into data</span></span>
<span id="cb162-4"><a href="import-and-format-data.html#cb162-4"></a>PM_MB_means &lt;-<span class="st"> </span><span class="kw">replace_data</span>(<span class="dt">template_data =</span> PM_MB_means, </span>
<span id="cb162-5"><a href="import-and-format-data.html#cb162-5"></a>                            <span class="dt">new_data =</span> Herm_<span class="dv">15</span>_m, </span>
<span id="cb162-6"><a href="import-and-format-data.html#cb162-6"></a>                            <span class="dt">new_data_column =</span> <span class="kw">c</span>(<span class="st">&quot;AUDPC_m&quot;</span>, <span class="st">&quot;AUDPC_sd&quot;</span>, <span class="st">&quot;AUDPS_m&quot;</span>,<span class="st">&quot;AUDPS_sd&quot;</span>,<span class="st">&quot;Y_Msquare&quot;</span>, <span class="st">&quot;Inc_Ms&quot;</span>),</span>
<span id="cb162-7"><a href="import-and-format-data.html#cb162-7"></a>                            <span class="dt">filter_cols =</span> <span class="kw">c</span>(<span class="st">&quot;trial_ref&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;location&quot;</span>, <span class="st">&quot;host_genotype&quot;</span>, </span>
<span id="cb162-8"><a href="import-and-format-data.html#cb162-8"></a>                                           <span class="st">&quot;fungicide_ai&quot;</span>, <span class="st">&quot;dose_ai.ha&quot;</span>,<span class="st">&quot;n_treatment&quot;</span>))</span></code></pre></div>
<pre><code>## No data changed 0/6</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="import-and-format-data.html#cb164-1"></a><span class="kw">write.csv</span>(</span>
<span id="cb164-2"><a href="import-and-format-data.html#cb164-2"></a>   Herm_<span class="dv">15</span>_m,</span>
<span id="cb164-3"><a href="import-and-format-data.html#cb164-3"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/Herm_15_means.csv&quot;</span>),<span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb164-4"><a href="import-and-format-data.html#cb164-4"></a>)</span></code></pre></div>
</div>
</div>
<div id="hermitage-2016" class="section level3">
<h3><span class="header-section-number">3.4.9</span> Hermitage 2016</h3>
<p>Disease data for Hermitage 2016 only exists as a mean of treatments within the <code>2016 Mungbean PM trials summary.xlsx</code> file.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="import-and-format-data.html#cb165-1"></a><span class="co"># Yield data from 2016 Hermitage trial with final disease severity</span></span>
<span id="cb165-2"><a href="import-and-format-data.html#cb165-2"></a>Herm_<span class="dv">16</span> &lt;-</span>
<span id="cb165-3"><a href="import-and-format-data.html#cb165-3"></a><span class="st">   </span><span class="kw">read.xlsx</span>(</span>
<span id="cb165-4"><a href="import-and-format-data.html#cb165-4"></a>      <span class="kw">here</span>(<span class="st">&quot;data/Yeild Data 2016 Kingaroy Hermitage (PaulM adjusted).xlsx&quot;</span>),</span>
<span id="cb165-5"><a href="import-and-format-data.html#cb165-5"></a>      <span class="dt">sheet =</span> <span class="st">&quot;Hermitage&quot;</span>,</span>
<span id="cb165-6"><a href="import-and-format-data.html#cb165-6"></a>      <span class="dt">startRow =</span> <span class="dv">1</span>,</span>
<span id="cb165-7"><a href="import-and-format-data.html#cb165-7"></a>      <span class="dt">colNames =</span> <span class="ot">TRUE</span></span>
<span id="cb165-8"><a href="import-and-format-data.html#cb165-8"></a>   )[<span class="dv">1</span><span class="op">:</span><span class="dv">28</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>]</span>
<span id="cb165-9"><a href="import-and-format-data.html#cb165-9"></a></span>
<span id="cb165-10"><a href="import-and-format-data.html#cb165-10"></a></span>
<span id="cb165-11"><a href="import-and-format-data.html#cb165-11"></a>Herm_<span class="dv">16</span><span class="op">$</span>Year &lt;-<span class="st"> </span><span class="dv">2016</span></span>
<span id="cb165-12"><a href="import-and-format-data.html#cb165-12"></a>Herm_<span class="dv">16</span><span class="op">$</span>location &lt;-<span class="st"> &quot;Hermitage&quot;</span></span>
<span id="cb165-13"><a href="import-and-format-data.html#cb165-13"></a></span>
<span id="cb165-14"><a href="import-and-format-data.html#cb165-14"></a>Herm_<span class="dv">16</span><span class="op">$</span>Plot &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">unlist</span>(<span class="kw">strsplit</span>(</span>
<span id="cb165-15"><a href="import-and-format-data.html#cb165-15"></a>   Herm_<span class="dv">16</span><span class="op">$</span>Plot, <span class="st">&quot;P&quot;</span>))[</span>
<span id="cb165-16"><a href="import-and-format-data.html#cb165-16"></a>      <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">56</span>, <span class="dt">by =</span> <span class="dv">2</span>)])</span></code></pre></div>
<div id="define-treatment-data-6" class="section level4">
<h4><span class="header-section-number">3.4.9.1</span> Define treatment data</h4>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="import-and-format-data.html#cb166-1"></a>Herm_<span class="dv">16</span>_dat &lt;-<span class="st"> </span>Herm_<span class="dv">16</span> <span class="op">%&gt;%</span></span>
<span id="cb166-2"><a href="import-and-format-data.html#cb166-2"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trade_name =</span> </span>
<span id="cb166-3"><a href="import-and-format-data.html#cb166-3"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb166-4"><a href="import-and-format-data.html#cb166-4"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Folicur&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb166-5"><a href="import-and-format-data.html#cb166-5"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_ai =</span> </span>
<span id="cb166-6"><a href="import-and-format-data.html#cb166-6"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb166-7"><a href="import-and-format-data.html#cb166-7"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;tebuconazole&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb166-8"><a href="import-and-format-data.html#cb166-8"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> </span>
<span id="cb166-9"><a href="import-and-format-data.html#cb166-9"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb166-10"><a href="import-and-format-data.html#cb166-10"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.35</span>))<span class="op">%&gt;%</span></span>
<span id="cb166-11"><a href="import-and-format-data.html#cb166-11"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_1 =</span> </span>
<span id="cb166-12"><a href="import-and-format-data.html#cb166-12"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb166-13"><a href="import-and-format-data.html#cb166-13"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-17&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb166-14"><a href="import-and-format-data.html#cb166-14"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-17&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb166-15"><a href="import-and-format-data.html#cb166-15"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-17&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb166-16"><a href="import-and-format-data.html#cb166-16"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-8&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb166-17"><a href="import-and-format-data.html#cb166-17"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-8&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb166-18"><a href="import-and-format-data.html#cb166-18"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-17&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb166-19"><a href="import-and-format-data.html#cb166-19"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb166-20"><a href="import-and-format-data.html#cb166-20"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_2 =</span> </span>
<span id="cb166-21"><a href="import-and-format-data.html#cb166-21"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb166-22"><a href="import-and-format-data.html#cb166-22"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-30&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb166-23"><a href="import-and-format-data.html#cb166-23"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-30&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb166-24"><a href="import-and-format-data.html#cb166-24"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-22&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb166-25"><a href="import-and-format-data.html#cb166-25"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-30&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb166-26"><a href="import-and-format-data.html#cb166-26"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb166-27"><a href="import-and-format-data.html#cb166-27"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_3 =</span> </span>
<span id="cb166-28"><a href="import-and-format-data.html#cb166-28"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-04-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb166-29"><a href="import-and-format-data.html#cb166-29"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb166-30"><a href="import-and-format-data.html#cb166-30"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">spray_n =</span> </span>
<span id="cb166-31"><a href="import-and-format-data.html#cb166-31"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb166-32"><a href="import-and-format-data.html#cb166-32"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb166-33"><a href="import-and-format-data.html#cb166-33"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb166-34"><a href="import-and-format-data.html#cb166-34"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,</span>
<span id="cb166-35"><a href="import-and-format-data.html#cb166-35"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb166-36"><a href="import-and-format-data.html#cb166-36"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb166-37"><a href="import-and-format-data.html#cb166-37"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb166-38"><a href="import-and-format-data.html#cb166-38"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">9999</span>))</span></code></pre></div>
</div>
<div id="input-trial-data-7" class="section level4">
<h4><span class="header-section-number">3.4.9.2</span> Input trial data</h4>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="import-and-format-data.html#cb167-1"></a>Herm_<span class="dv">16</span>_dat &lt;-<span class="st"> </span></span>
<span id="cb167-2"><a href="import-and-format-data.html#cb167-2"></a><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">trial_ref =</span> <span class="st">&quot;mung1516/01&quot;</span>,</span>
<span id="cb167-3"><a href="import-and-format-data.html#cb167-3"></a>              <span class="dt">year =</span> <span class="st">&quot;2016&quot;</span>,</span>
<span id="cb167-4"><a href="import-and-format-data.html#cb167-4"></a>              <span class="dt">location =</span> <span class="st">&quot;Hermitage&quot;</span>,</span>
<span id="cb167-5"><a href="import-and-format-data.html#cb167-5"></a>              <span class="dt">host_genotype =</span> <span class="st">&quot;Jade&quot;</span>,</span>
<span id="cb167-6"><a href="import-and-format-data.html#cb167-6"></a>              <span class="dt">trial_design =</span> <span class="st">&quot;RCB&quot;</span>,</span>
<span id="cb167-7"><a href="import-and-format-data.html#cb167-7"></a>              <span class="dt">plot_length =</span> <span class="dv">12</span>,</span>
<span id="cb167-8"><a href="import-and-format-data.html#cb167-8"></a>              <span class="dt">plot_width =</span> <span class="dv">4</span>,</span>
<span id="cb167-9"><a href="import-and-format-data.html#cb167-9"></a>              <span class="dt">plant_density =</span> <span class="ot">NA</span>,</span>
<span id="cb167-10"><a href="import-and-format-data.html#cb167-10"></a>              <span class="dt">row_spacing =</span> <span class="fl">0.75</span>,</span>
<span id="cb167-11"><a href="import-and-format-data.html#cb167-11"></a>              <span class="dt">replicate =</span> Herm_<span class="dv">16</span>_dat<span class="op">$</span>rep,</span>
<span id="cb167-12"><a href="import-and-format-data.html#cb167-12"></a>              <span class="dt">planting_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2016-02-03&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb167-13"><a href="import-and-format-data.html#cb167-13"></a>              <span class="dt">emergence_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2016-02-12&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb167-14"><a href="import-and-format-data.html#cb167-14"></a>              <span class="dt">flowering_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb167-15"><a href="import-and-format-data.html#cb167-15"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb167-16"><a href="import-and-format-data.html#cb167-16"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2016-04-15&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb167-17"><a href="import-and-format-data.html#cb167-17"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2016-03-08&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb167-18"><a href="import-and-format-data.html#cb167-18"></a>              <span class="dt">trade_name =</span> <span class="kw">as.factor</span>(Herm_<span class="dv">16</span>_dat<span class="op">$</span>trade_name),</span>
<span id="cb167-19"><a href="import-and-format-data.html#cb167-19"></a>              <span class="dt">fungicide_ai =</span> Herm_<span class="dv">16</span>_dat<span class="op">$</span>fungicide_ai,</span>
<span id="cb167-20"><a href="import-and-format-data.html#cb167-20"></a>              <span class="dt">dose_ai.ha =</span> Herm_<span class="dv">16</span>_dat<span class="op">$</span>dose_ai.ha,</span>
<span id="cb167-21"><a href="import-and-format-data.html#cb167-21"></a>              <span class="dt">n_treatment =</span> <span class="kw">as.numeric</span>(Herm_<span class="dv">16</span>_dat<span class="op">$</span>Treatment),</span>
<span id="cb167-22"><a href="import-and-format-data.html#cb167-22"></a>              <span class="dt">fungicide_application_1 =</span> Herm_<span class="dv">16</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb167-23"><a href="import-and-format-data.html#cb167-23"></a>              <span class="dt">fungicide_application_2 =</span> Herm_<span class="dv">16</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb167-24"><a href="import-and-format-data.html#cb167-24"></a>              <span class="dt">fungicide_application_3 =</span> Herm_<span class="dv">16</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">3</span>,</span>
<span id="cb167-25"><a href="import-and-format-data.html#cb167-25"></a>              <span class="dt">total_fungicide =</span> Herm_<span class="dv">16</span>_dat<span class="op">$</span>spray_n,</span>
<span id="cb167-26"><a href="import-and-format-data.html#cb167-26"></a>              <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2016-05-06&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb167-27"><a href="import-and-format-data.html#cb167-27"></a>              <span class="dt">final_assessment =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2016-04-15&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb167-28"><a href="import-and-format-data.html#cb167-28"></a>              <span class="dt">PM_final_severity =</span> <span class="ot">NA</span>,</span>
<span id="cb167-29"><a href="import-and-format-data.html#cb167-29"></a>              <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb167-30"><a href="import-and-format-data.html#cb167-30"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">as.numeric</span>(Herm_<span class="dv">16</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">Raw.Adjusted.Yeild./.ha</span><span class="st">`</span>),</span>
<span id="cb167-31"><a href="import-and-format-data.html#cb167-31"></a>              <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="calculating-treatment-means-1" class="section level4">
<h4><span class="header-section-number">3.4.9.3</span> Calculating treatment means</h4>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="import-and-format-data.html#cb168-1"></a>Herm_<span class="dv">16</span>_m &lt;-<span class="st"> </span>Herm_<span class="dv">16</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb168-2"><a href="import-and-format-data.html#cb168-2"></a><span class="st">   </span><span class="kw">group_by</span>(host_genotype, n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb168-3"><a href="import-and-format-data.html#cb168-3"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb168-4"><a href="import-and-format-data.html#cb168-4"></a>             <span class="dt">year =</span> <span class="kw">unique</span>(year),</span>
<span id="cb168-5"><a href="import-and-format-data.html#cb168-5"></a>             <span class="dt">location =</span> <span class="kw">unique</span>(location),</span>
<span id="cb168-6"><a href="import-and-format-data.html#cb168-6"></a>             <span class="dt">trial_design =</span> <span class="kw">unique</span>(trial_design),</span>
<span id="cb168-7"><a href="import-and-format-data.html#cb168-7"></a>             <span class="dt">trade_name =</span> <span class="kw">unique</span>(trade_name),</span>
<span id="cb168-8"><a href="import-and-format-data.html#cb168-8"></a>             <span class="dt">fungicide_ai =</span> <span class="kw">unique</span>(fungicide_ai),</span>
<span id="cb168-9"><a href="import-and-format-data.html#cb168-9"></a>             <span class="dt">dose_ai.ha =</span> <span class="kw">unique</span>(dose_ai.ha),</span>
<span id="cb168-10"><a href="import-and-format-data.html#cb168-10"></a>             <span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb168-11"><a href="import-and-format-data.html#cb168-11"></a>             <span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb168-12"><a href="import-and-format-data.html#cb168-12"></a>             <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb168-13"><a href="import-and-format-data.html#cb168-13"></a>             <span class="dt">plant_density =</span> <span class="kw">unique</span>(plant_density),</span>
<span id="cb168-14"><a href="import-and-format-data.html#cb168-14"></a>             <span class="dt">row_spacing =</span> <span class="kw">unique</span>(row_spacing),</span>
<span id="cb168-15"><a href="import-and-format-data.html#cb168-15"></a>             <span class="dt">replicates =</span> <span class="kw">length</span>(<span class="kw">as.numeric</span>(replicate)),</span>
<span id="cb168-16"><a href="import-and-format-data.html#cb168-16"></a>             <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb168-17"><a href="import-and-format-data.html#cb168-17"></a>             <span class="dt">emergence_date =</span> <span class="kw">unique</span>(emergence_date),</span>
<span id="cb168-18"><a href="import-and-format-data.html#cb168-18"></a>             <span class="dt">flowering_date =</span> <span class="kw">unique</span>(flowering_date),</span>
<span id="cb168-19"><a href="import-and-format-data.html#cb168-19"></a>             <span class="dt">pod_fill_date =</span> <span class="kw">unique</span>(pod_fill_date),</span>
<span id="cb168-20"><a href="import-and-format-data.html#cb168-20"></a>             <span class="dt">mid_late_pod_fill =</span> <span class="kw">unique</span>(mid_late_pod_fill),</span>
<span id="cb168-21"><a href="import-and-format-data.html#cb168-21"></a>             <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb168-22"><a href="import-and-format-data.html#cb168-22"></a>             <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb168-23"><a href="import-and-format-data.html#cb168-23"></a>             <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb168-24"><a href="import-and-format-data.html#cb168-24"></a>             <span class="dt">fungicide_application_3 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">3</span>),</span>
<span id="cb168-25"><a href="import-and-format-data.html#cb168-25"></a>             <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb168-26"><a href="import-and-format-data.html#cb168-26"></a>             <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb168-27"><a href="import-and-format-data.html#cb168-27"></a>             <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb168-28"><a href="import-and-format-data.html#cb168-28"></a>             <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb168-29"><a href="import-and-format-data.html#cb168-29"></a>             <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb168-30"><a href="import-and-format-data.html#cb168-30"></a>             <span class="dt">raw_graded =</span> <span class="st">&quot;Yes&quot;</span>,</span>
<span id="cb168-31"><a href="import-and-format-data.html#cb168-31"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb168-32"><a href="import-and-format-data.html#cb168-32"></a>             <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb168-33"><a href="import-and-format-data.html#cb168-33"></a>             <span class="dt">Y_Msquare =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), <span class="dt">data =</span> Herm_<span class="dv">16</span>_dat))[<span class="dv">1</span>,<span class="dv">3</span>]</span>
<span id="cb168-34"><a href="import-and-format-data.html#cb168-34"></a>   )</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;host_genotype&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="import-and-format-data.html#cb170-1"></a><span class="co"># For some wierd reason standard deviations are comming back NA in the code above</span></span>
<span id="cb170-2"><a href="import-and-format-data.html#cb170-2"></a>Herm_<span class="dv">16</span>_m[,<span class="st">&quot;yield_error&quot;</span>] &lt;-<span class="st"> </span></span>
<span id="cb170-3"><a href="import-and-format-data.html#cb170-3"></a><span class="st">   </span>Herm_<span class="dv">16</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb170-4"><a href="import-and-format-data.html#cb170-4"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb170-5"><a href="import-and-format-data.html#cb170-5"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb170-6"><a href="import-and-format-data.html#cb170-6"></a><span class="st">   </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&quot;yield_error&quot;</span>))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
</div>
<div id="mean-disease-incidence-data" class="section level4">
<h4><span class="header-section-number">3.4.9.4</span> Mean disease incidence data</h4>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="import-and-format-data.html#cb172-1"></a>Herm_<span class="fl">16.</span>DR  &lt;-</span>
<span id="cb172-2"><a href="import-and-format-data.html#cb172-2"></a><span class="st">   </span><span class="kw">read.xlsx</span>(</span>
<span id="cb172-3"><a href="import-and-format-data.html#cb172-3"></a>      <span class="kw">here</span>(<span class="st">&quot;data/2016 Mungbean PM trials summary.xlsx&quot;</span>),</span>
<span id="cb172-4"><a href="import-and-format-data.html#cb172-4"></a>      <span class="dt">sheet =</span> <span class="st">&quot;Hermitage_2016&quot;</span>,</span>
<span id="cb172-5"><a href="import-and-format-data.html#cb172-5"></a>      <span class="dt">startRow =</span> <span class="dv">5</span>,</span>
<span id="cb172-6"><a href="import-and-format-data.html#cb172-6"></a>      <span class="dt">colNames =</span> <span class="ot">TRUE</span></span>
<span id="cb172-7"><a href="import-and-format-data.html#cb172-7"></a>   )</span>
<span id="cb172-8"><a href="import-and-format-data.html#cb172-8"></a><span class="kw">names</span>(Herm_<span class="fl">16.</span>DR)[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;dae24&quot;</span>,<span class="st">&quot;dae38&quot;</span>,<span class="st">&quot;dae48&quot;</span>,<span class="st">&quot;dae63&quot;</span>,<span class="st">&quot;Final_Yield_tHa&quot;</span>)</span>
<span id="cb172-9"><a href="import-and-format-data.html#cb172-9"></a></span>
<span id="cb172-10"><a href="import-and-format-data.html#cb172-10"></a>Herm_<span class="fl">16.</span>DR &lt;-<span class="st"> </span>Herm_<span class="fl">16.</span>DR <span class="op">%&gt;%</span></span>
<span id="cb172-11"><a href="import-and-format-data.html#cb172-11"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">n_treatment =</span> </span>
<span id="cb172-12"><a href="import-and-format-data.html#cb172-12"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;5wk + 2s (3s)&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>,</span>
<span id="cb172-13"><a href="import-and-format-data.html#cb172-13"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;5wk+1 (2s)&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,</span>
<span id="cb172-14"><a href="import-and-format-data.html#cb172-14"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1/3+1 (2s)&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">7</span>,</span>
<span id="cb172-15"><a href="import-and-format-data.html#cb172-15"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1st sign (1s)&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb172-16"><a href="import-and-format-data.html#cb172-16"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;5wk (1s)&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb172-17"><a href="import-and-format-data.html#cb172-17"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1st sign+1 (2s)&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">6</span>,</span>
<span id="cb172-18"><a href="import-and-format-data.html#cb172-18"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;Unsprayed&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb172-19"><a href="import-and-format-data.html#cb172-19"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">9999</span>))</span>
<span id="cb172-20"><a href="import-and-format-data.html#cb172-20"></a></span>
<span id="cb172-21"><a href="import-and-format-data.html#cb172-21"></a></span>
<span id="cb172-22"><a href="import-and-format-data.html#cb172-22"></a>Herm_<span class="dv">16</span>_m &lt;-<span class="st"> </span><span class="kw">left_join</span>(Herm_<span class="dv">16</span>_m,Herm_<span class="fl">16.</span>DR)</span></code></pre></div>
<pre><code>## Joining, by = &quot;n_treatment&quot;</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="import-and-format-data.html#cb174-1"></a><span class="co"># dae24 recorded no incidence</span></span>
<span id="cb174-2"><a href="import-and-format-data.html#cb174-2"></a>Herm_<span class="dv">16</span>_m<span class="op">$</span>AUDPC_m &lt;-<span class="st"> </span><span class="kw">apply</span>(Herm_<span class="dv">16</span>_m[,<span class="kw">c</span>(<span class="st">&quot;dae24&quot;</span>, <span class="st">&quot;dae38&quot;</span>, <span class="st">&quot;dae48&quot;</span>, <span class="st">&quot;dae63&quot;</span>)]<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>, </span>
<span id="cb174-3"><a href="import-and-format-data.html#cb174-3"></a>                            <span class="dt">FUN =</span> audpc, </span>
<span id="cb174-4"><a href="import-and-format-data.html#cb174-4"></a>                           <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">13</span>,<span class="dv">23</span>,<span class="dv">38</span>))</span>
<span id="cb174-5"><a href="import-and-format-data.html#cb174-5"></a></span>
<span id="cb174-6"><a href="import-and-format-data.html#cb174-6"></a>Herm_<span class="dv">16</span>_m<span class="op">$</span>AUDPS_m &lt;-<span class="st"> </span><span class="kw">apply</span>(Herm_<span class="dv">16</span>_m[,<span class="kw">c</span>(<span class="st">&quot;dae24&quot;</span>, <span class="st">&quot;dae38&quot;</span>, <span class="st">&quot;dae48&quot;</span>, <span class="st">&quot;dae63&quot;</span>)]<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>, </span>
<span id="cb174-7"><a href="import-and-format-data.html#cb174-7"></a>                            <span class="dt">FUN =</span> audps, </span>
<span id="cb174-8"><a href="import-and-format-data.html#cb174-8"></a>                           <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">13</span>,<span class="dv">23</span>,<span class="dv">38</span>))</span>
<span id="cb174-9"><a href="import-and-format-data.html#cb174-9"></a></span>
<span id="cb174-10"><a href="import-and-format-data.html#cb174-10"></a>Herm_<span class="dv">16</span>_m<span class="op">$</span>AUDPC_sd &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb174-11"><a href="import-and-format-data.html#cb174-11"></a>Herm_<span class="dv">16</span>_m<span class="op">$</span>AUDPS_sd &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb174-12"><a href="import-and-format-data.html#cb174-12"></a>Herm_<span class="dv">16</span>_m<span class="op">$</span>PM_final_severity &lt;-<span class="st"> </span>Herm_<span class="dv">16</span>_m<span class="op">$</span>dae63</span>
<span id="cb174-13"><a href="import-and-format-data.html#cb174-13"></a>Herm_<span class="dv">16</span>_m<span class="op">$</span>Inc_Ms &lt;-<span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC_m <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), <span class="dt">data =</span> Herm_<span class="dv">16</span>_m))[<span class="dv">1</span>,<span class="dv">3</span>] <span class="co">#ANOVA F-tests on an essentially perfect fit are unreliable</span></span></code></pre></div>
<pre><code>## Warning in anova.lm(lm(AUDPC_m ~ factor(n_treatment), data = Herm_16_m)): ANOVA
## F-tests on an essentially perfect fit are unreliable</code></pre>
</div>
<div id="tidy-and-save-data" class="section level4">
<h4><span class="header-section-number">3.4.9.5</span> Tidy and save data</h4>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="import-and-format-data.html#cb176-1"></a>Herm_<span class="dv">16</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(Herm_<span class="dv">16</span>_m, PM_MB_means)</span>
<span id="cb176-2"><a href="import-and-format-data.html#cb176-2"></a>Herm_<span class="dv">16</span>_m &lt;-<span class="st"> </span>Herm_<span class="dv">16</span>_m[,<span class="op">!</span><span class="kw">colnames</span>(Herm_<span class="dv">16</span>_m) <span class="op">%in%</span></span>
<span id="cb176-3"><a href="import-and-format-data.html#cb176-3"></a><span class="st">                          </span><span class="kw">c</span>(<span class="st">&#39;Treatment&#39;</span>,<span class="st">&quot;dae24&quot;</span>,<span class="st">&quot;dae38&quot;</span>,<span class="st">&quot;dae48&quot;</span>,<span class="st">&quot;dae63&quot;</span>,<span class="st">&quot;Final_Yield_tHa&quot;</span>)]</span>
<span id="cb176-4"><a href="import-and-format-data.html#cb176-4"></a></span>
<span id="cb176-5"><a href="import-and-format-data.html#cb176-5"></a><span class="co">#final Yields from disease data different to yield data set</span></span>
<span id="cb176-6"><a href="import-and-format-data.html#cb176-6"></a></span>
<span id="cb176-7"><a href="import-and-format-data.html#cb176-7"></a><span class="co"># insert new calculations into data</span></span>
<span id="cb176-8"><a href="import-and-format-data.html#cb176-8"></a>PM_MB_means &lt;-<span class="st"> </span><span class="kw">replace_data</span>(<span class="dt">template_data =</span> PM_MB_means, </span>
<span id="cb176-9"><a href="import-and-format-data.html#cb176-9"></a>                            <span class="dt">new_data =</span> Herm_<span class="dv">16</span>_m, </span>
<span id="cb176-10"><a href="import-and-format-data.html#cb176-10"></a>                             <span class="dt">new_data_column =</span> <span class="kw">c</span>(<span class="st">&quot;AUDPC_m&quot;</span>, <span class="st">&quot;AUDPC_sd&quot;</span>, <span class="st">&quot;AUDPS_m&quot;</span>,<span class="st">&quot;AUDPS_sd&quot;</span>,<span class="st">&quot;Y_Msquare&quot;</span>, <span class="st">&quot;Inc_Ms&quot;</span>),</span>
<span id="cb176-11"><a href="import-and-format-data.html#cb176-11"></a>                            <span class="dt">filter_cols =</span> <span class="kw">c</span>(<span class="st">&quot;trial_ref&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;location&quot;</span>, <span class="st">&quot;host_genotype&quot;</span>, </span>
<span id="cb176-12"><a href="import-and-format-data.html#cb176-12"></a>                                           <span class="st">&quot;fungicide_ai&quot;</span>, <span class="st">&quot;dose_ai.ha&quot;</span>,<span class="st">&quot;n_treatment&quot;</span>))</span></code></pre></div>
<pre><code>## No data changed 0/7</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="import-and-format-data.html#cb178-1"></a><span class="kw">write.csv</span>(</span>
<span id="cb178-2"><a href="import-and-format-data.html#cb178-2"></a>   Herm_<span class="dv">16</span>_m,</span>
<span id="cb178-3"><a href="import-and-format-data.html#cb178-3"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/Herm_16_means.csv&quot;</span>),<span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb178-4"><a href="import-and-format-data.html#cb178-4"></a>)</span></code></pre></div>
</div>
</div>
<div id="kingaroy-2016" class="section level3">
<h3><span class="header-section-number">3.4.10</span> Kingaroy 2016</h3>
<p>Disease data for Kingaroy 2016 only exists as a mean of treatments within the <code>2016 Mungbean PM trials summary.xlsx</code> file.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="import-and-format-data.html#cb179-1"></a><span class="co"># Yield data from 2016 Hermitage trial with final disease severity</span></span>
<span id="cb179-2"><a href="import-and-format-data.html#cb179-2"></a>King_<span class="dv">16</span> &lt;-</span>
<span id="cb179-3"><a href="import-and-format-data.html#cb179-3"></a><span class="st">   </span><span class="kw">read.xlsx</span>(</span>
<span id="cb179-4"><a href="import-and-format-data.html#cb179-4"></a>      <span class="kw">here</span>(<span class="st">&quot;data/Yeild Data 2016 Kingaroy Hermitage (PaulM adjusted).xlsx&quot;</span>),</span>
<span id="cb179-5"><a href="import-and-format-data.html#cb179-5"></a>      <span class="dt">sheet =</span> <span class="st">&quot;Kingaroy&quot;</span>,</span>
<span id="cb179-6"><a href="import-and-format-data.html#cb179-6"></a>      <span class="dt">startRow =</span> <span class="dv">1</span>,</span>
<span id="cb179-7"><a href="import-and-format-data.html#cb179-7"></a>      <span class="dt">colNames =</span> <span class="ot">TRUE</span></span>
<span id="cb179-8"><a href="import-and-format-data.html#cb179-8"></a>   )[<span class="dv">1</span><span class="op">:</span><span class="dv">28</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>]</span>
<span id="cb179-9"><a href="import-and-format-data.html#cb179-9"></a></span>
<span id="cb179-10"><a href="import-and-format-data.html#cb179-10"></a><span class="co"># Create Year and location variables</span></span>
<span id="cb179-11"><a href="import-and-format-data.html#cb179-11"></a>King_<span class="dv">16</span><span class="op">$</span>Year &lt;-<span class="st"> </span><span class="dv">2016</span></span>
<span id="cb179-12"><a href="import-and-format-data.html#cb179-12"></a>King_<span class="dv">16</span><span class="op">$</span>location &lt;-<span class="st"> &quot;Kingaroy&quot;</span></span>
<span id="cb179-13"><a href="import-and-format-data.html#cb179-13"></a></span>
<span id="cb179-14"><a href="import-and-format-data.html#cb179-14"></a></span>
<span id="cb179-15"><a href="import-and-format-data.html#cb179-15"></a><span class="co"># Convert plot values to numeric and remove &quot;P&quot; prefix</span></span>
<span id="cb179-16"><a href="import-and-format-data.html#cb179-16"></a>King_<span class="dv">16</span><span class="op">$</span>Plot &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">unlist</span>(<span class="kw">strsplit</span>(</span>
<span id="cb179-17"><a href="import-and-format-data.html#cb179-17"></a>   King_<span class="dv">16</span><span class="op">$</span>Plot, <span class="st">&quot;P&quot;</span>))[</span>
<span id="cb179-18"><a href="import-and-format-data.html#cb179-18"></a>      <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">56</span>, <span class="dt">by =</span> <span class="dv">2</span>)])</span></code></pre></div>
<div id="define-treatment-data-7" class="section level4">
<h4><span class="header-section-number">3.4.10.1</span> Define treatment data</h4>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="import-and-format-data.html#cb180-1"></a>King_<span class="dv">16</span>_dat &lt;-<span class="st"> </span>King_<span class="dv">16</span> <span class="op">%&gt;%</span></span>
<span id="cb180-2"><a href="import-and-format-data.html#cb180-2"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trade_name =</span> </span>
<span id="cb180-3"><a href="import-and-format-data.html#cb180-3"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb180-4"><a href="import-and-format-data.html#cb180-4"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Folicur&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb180-5"><a href="import-and-format-data.html#cb180-5"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_ai =</span> </span>
<span id="cb180-6"><a href="import-and-format-data.html#cb180-6"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb180-7"><a href="import-and-format-data.html#cb180-7"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;tebuconazole&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb180-8"><a href="import-and-format-data.html#cb180-8"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> </span>
<span id="cb180-9"><a href="import-and-format-data.html#cb180-9"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb180-10"><a href="import-and-format-data.html#cb180-10"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="fl">62.35</span>))<span class="op">%&gt;%</span></span>
<span id="cb180-11"><a href="import-and-format-data.html#cb180-11"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_1 =</span> </span>
<span id="cb180-12"><a href="import-and-format-data.html#cb180-12"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb180-13"><a href="import-and-format-data.html#cb180-13"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-22&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb180-14"><a href="import-and-format-data.html#cb180-14"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-22&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb180-15"><a href="import-and-format-data.html#cb180-15"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-22&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb180-16"><a href="import-and-format-data.html#cb180-16"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-09&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb180-17"><a href="import-and-format-data.html#cb180-17"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-09&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb180-18"><a href="import-and-format-data.html#cb180-18"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-22&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb180-19"><a href="import-and-format-data.html#cb180-19"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb180-20"><a href="import-and-format-data.html#cb180-20"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_2 =</span> </span>
<span id="cb180-21"><a href="import-and-format-data.html#cb180-21"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb180-22"><a href="import-and-format-data.html#cb180-22"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-04-05&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb180-23"><a href="import-and-format-data.html#cb180-23"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-04-05&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb180-24"><a href="import-and-format-data.html#cb180-24"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-03-22&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb180-25"><a href="import-and-format-data.html#cb180-25"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-04-05&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb180-26"><a href="import-and-format-data.html#cb180-26"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb180-27"><a href="import-and-format-data.html#cb180-27"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_3 =</span> </span>
<span id="cb180-28"><a href="import-and-format-data.html#cb180-28"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-04-19&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb180-29"><a href="import-and-format-data.html#cb180-29"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb180-30"><a href="import-and-format-data.html#cb180-30"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">spray_n =</span> </span>
<span id="cb180-31"><a href="import-and-format-data.html#cb180-31"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb180-32"><a href="import-and-format-data.html#cb180-32"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb180-33"><a href="import-and-format-data.html#cb180-33"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb180-34"><a href="import-and-format-data.html#cb180-34"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,</span>
<span id="cb180-35"><a href="import-and-format-data.html#cb180-35"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb180-36"><a href="import-and-format-data.html#cb180-36"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb180-37"><a href="import-and-format-data.html#cb180-37"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;7&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb180-38"><a href="import-and-format-data.html#cb180-38"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">9999</span>))</span></code></pre></div>
</div>
<div id="input-trial-data-8" class="section level4">
<h4><span class="header-section-number">3.4.10.2</span> Input trial data</h4>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="import-and-format-data.html#cb181-1"></a>King_<span class="dv">16</span>_dat &lt;-<span class="st"> </span></span>
<span id="cb181-2"><a href="import-and-format-data.html#cb181-2"></a><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">trial_ref =</span> <span class="st">&quot;mung1516/02&quot;</span>,</span>
<span id="cb181-3"><a href="import-and-format-data.html#cb181-3"></a>              <span class="dt">year =</span> <span class="st">&quot;2016&quot;</span>,</span>
<span id="cb181-4"><a href="import-and-format-data.html#cb181-4"></a>              <span class="dt">location =</span> <span class="st">&quot;Kingaroy&quot;</span>,</span>
<span id="cb181-5"><a href="import-and-format-data.html#cb181-5"></a>              <span class="dt">host_genotype =</span> <span class="st">&quot;Jade&quot;</span>,</span>
<span id="cb181-6"><a href="import-and-format-data.html#cb181-6"></a>              <span class="dt">trial_design =</span> <span class="st">&quot;RCB&quot;</span>,</span>
<span id="cb181-7"><a href="import-and-format-data.html#cb181-7"></a>              <span class="dt">plot_length =</span> <span class="dv">12</span>,</span>
<span id="cb181-8"><a href="import-and-format-data.html#cb181-8"></a>              <span class="dt">plot_width =</span> <span class="dv">4</span>,</span>
<span id="cb181-9"><a href="import-and-format-data.html#cb181-9"></a>              <span class="dt">plant_density =</span> <span class="ot">NA</span>,</span>
<span id="cb181-10"><a href="import-and-format-data.html#cb181-10"></a>              <span class="dt">row_spacing =</span> <span class="fl">0.75</span>,</span>
<span id="cb181-11"><a href="import-and-format-data.html#cb181-11"></a>              <span class="dt">replicate =</span> King_<span class="dv">16</span>_dat<span class="op">$</span>rep,</span>
<span id="cb181-12"><a href="import-and-format-data.html#cb181-12"></a>              <span class="dt">planting_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2016-02-11&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb181-13"><a href="import-and-format-data.html#cb181-13"></a>              <span class="dt">emergence_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2016-02-19&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb181-14"><a href="import-and-format-data.html#cb181-14"></a>              <span class="dt">flowering_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb181-15"><a href="import-and-format-data.html#cb181-15"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2016-04-05&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb181-16"><a href="import-and-format-data.html#cb181-16"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb181-17"><a href="import-and-format-data.html#cb181-17"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2016-03-09&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb181-18"><a href="import-and-format-data.html#cb181-18"></a>              <span class="dt">trade_name =</span> <span class="kw">as.factor</span>(King_<span class="dv">16</span>_dat<span class="op">$</span>trade_name),</span>
<span id="cb181-19"><a href="import-and-format-data.html#cb181-19"></a>              <span class="dt">fungicide_ai =</span> King_<span class="dv">16</span>_dat<span class="op">$</span>fungicide_ai,</span>
<span id="cb181-20"><a href="import-and-format-data.html#cb181-20"></a>              <span class="dt">dose_ai.ha =</span> King_<span class="dv">16</span>_dat<span class="op">$</span>dose_ai.ha,</span>
<span id="cb181-21"><a href="import-and-format-data.html#cb181-21"></a>              <span class="dt">n_treatment =</span> <span class="kw">as.numeric</span>(King_<span class="dv">16</span>_dat<span class="op">$</span>Treatment),</span>
<span id="cb181-22"><a href="import-and-format-data.html#cb181-22"></a>              <span class="dt">fungicide_application_1 =</span> King_<span class="dv">16</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb181-23"><a href="import-and-format-data.html#cb181-23"></a>              <span class="dt">fungicide_application_2 =</span> King_<span class="dv">16</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb181-24"><a href="import-and-format-data.html#cb181-24"></a>              <span class="dt">fungicide_application_3 =</span> King_<span class="dv">16</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">3</span>,</span>
<span id="cb181-25"><a href="import-and-format-data.html#cb181-25"></a>              <span class="dt">total_fungicide =</span> King_<span class="dv">16</span>_dat<span class="op">$</span>spray_n,</span>
<span id="cb181-26"><a href="import-and-format-data.html#cb181-26"></a>              <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2016-05-10&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb181-27"><a href="import-and-format-data.html#cb181-27"></a>              <span class="dt">final_assessment =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2016-04-19&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb181-28"><a href="import-and-format-data.html#cb181-28"></a>              <span class="dt">PM_final_severity =</span> <span class="ot">NA</span>,</span>
<span id="cb181-29"><a href="import-and-format-data.html#cb181-29"></a>              <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb181-30"><a href="import-and-format-data.html#cb181-30"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">as.numeric</span>(King_<span class="dv">16</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">Raw.Adjusted.Yeild./.ha</span><span class="st">`</span>),</span>
<span id="cb181-31"><a href="import-and-format-data.html#cb181-31"></a>              <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="calculating-treatment-means-2" class="section level4">
<h4><span class="header-section-number">3.4.10.3</span> Calculating treatment means</h4>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="import-and-format-data.html#cb182-1"></a>King_<span class="dv">16</span>_m &lt;-<span class="st"> </span>King_<span class="dv">16</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb182-2"><a href="import-and-format-data.html#cb182-2"></a><span class="st">   </span><span class="kw">group_by</span>(host_genotype, n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb182-3"><a href="import-and-format-data.html#cb182-3"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb182-4"><a href="import-and-format-data.html#cb182-4"></a>             <span class="dt">year =</span> <span class="kw">unique</span>(year),</span>
<span id="cb182-5"><a href="import-and-format-data.html#cb182-5"></a>             <span class="dt">location =</span> <span class="kw">unique</span>(location),</span>
<span id="cb182-6"><a href="import-and-format-data.html#cb182-6"></a>             <span class="dt">trial_design =</span> <span class="kw">unique</span>(trial_design),</span>
<span id="cb182-7"><a href="import-and-format-data.html#cb182-7"></a>             <span class="dt">trade_name =</span> <span class="kw">unique</span>(trade_name),</span>
<span id="cb182-8"><a href="import-and-format-data.html#cb182-8"></a>             <span class="dt">fungicide_ai =</span> <span class="kw">unique</span>(fungicide_ai),</span>
<span id="cb182-9"><a href="import-and-format-data.html#cb182-9"></a>             <span class="dt">dose_ai.ha =</span> <span class="kw">unique</span>(dose_ai.ha),</span>
<span id="cb182-10"><a href="import-and-format-data.html#cb182-10"></a>             <span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb182-11"><a href="import-and-format-data.html#cb182-11"></a>             <span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb182-12"><a href="import-and-format-data.html#cb182-12"></a>             <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb182-13"><a href="import-and-format-data.html#cb182-13"></a>             <span class="dt">plant_density =</span> <span class="kw">unique</span>(plant_density),</span>
<span id="cb182-14"><a href="import-and-format-data.html#cb182-14"></a>             <span class="dt">row_spacing =</span> <span class="kw">unique</span>(row_spacing),</span>
<span id="cb182-15"><a href="import-and-format-data.html#cb182-15"></a>             <span class="dt">replicates =</span> <span class="kw">length</span>(<span class="kw">as.numeric</span>(replicate)),</span>
<span id="cb182-16"><a href="import-and-format-data.html#cb182-16"></a>             <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb182-17"><a href="import-and-format-data.html#cb182-17"></a>             <span class="dt">emergence_date =</span> <span class="kw">unique</span>(emergence_date),</span>
<span id="cb182-18"><a href="import-and-format-data.html#cb182-18"></a>             <span class="dt">flowering_date =</span> <span class="kw">unique</span>(flowering_date),</span>
<span id="cb182-19"><a href="import-and-format-data.html#cb182-19"></a>             <span class="dt">pod_fill_date =</span> <span class="kw">unique</span>(pod_fill_date),</span>
<span id="cb182-20"><a href="import-and-format-data.html#cb182-20"></a>             <span class="dt">mid_late_pod_fill =</span> <span class="kw">unique</span>(mid_late_pod_fill),</span>
<span id="cb182-21"><a href="import-and-format-data.html#cb182-21"></a>             <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb182-22"><a href="import-and-format-data.html#cb182-22"></a>             <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb182-23"><a href="import-and-format-data.html#cb182-23"></a>             <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb182-24"><a href="import-and-format-data.html#cb182-24"></a>             <span class="dt">fungicide_application_3 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">3</span>),</span>
<span id="cb182-25"><a href="import-and-format-data.html#cb182-25"></a>             <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb182-26"><a href="import-and-format-data.html#cb182-26"></a>             <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb182-27"><a href="import-and-format-data.html#cb182-27"></a>             <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb182-28"><a href="import-and-format-data.html#cb182-28"></a>             <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb182-29"><a href="import-and-format-data.html#cb182-29"></a>             <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb182-30"><a href="import-and-format-data.html#cb182-30"></a>             <span class="dt">raw_graded =</span> <span class="st">&quot;Yes&quot;</span>,</span>
<span id="cb182-31"><a href="import-and-format-data.html#cb182-31"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="co"># Calculation returned as NA, repeated below</span></span>
<span id="cb182-32"><a href="import-and-format-data.html#cb182-32"></a>             <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb182-33"><a href="import-and-format-data.html#cb182-33"></a>             <span class="dt">Y_Msquare =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), <span class="dt">data =</span> King_<span class="dv">16</span>_dat))[<span class="dv">1</span>,<span class="dv">3</span>]</span>
<span id="cb182-34"><a href="import-and-format-data.html#cb182-34"></a>   )</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;host_genotype&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="import-and-format-data.html#cb184-1"></a><span class="co"># For some wierd reason standard deviations are comming back NA in the code above</span></span>
<span id="cb184-2"><a href="import-and-format-data.html#cb184-2"></a>King_<span class="dv">16</span>_m[,<span class="st">&quot;yield_error&quot;</span>] &lt;-<span class="st"> </span></span>
<span id="cb184-3"><a href="import-and-format-data.html#cb184-3"></a><span class="st">   </span>King_<span class="dv">16</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb184-4"><a href="import-and-format-data.html#cb184-4"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb184-5"><a href="import-and-format-data.html#cb184-5"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb184-6"><a href="import-and-format-data.html#cb184-6"></a><span class="st">   </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&quot;yield_error&quot;</span>))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
</div>
<div id="mean-disease-incidence-assessments-through-the-2016-season" class="section level4">
<h4><span class="header-section-number">3.4.10.4</span> Mean Disease incidence assessments through the 2016 season</h4>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="import-and-format-data.html#cb186-1"></a>King_<span class="fl">16.</span>DR  &lt;-</span>
<span id="cb186-2"><a href="import-and-format-data.html#cb186-2"></a><span class="st">   </span><span class="kw">read.xlsx</span>(</span>
<span id="cb186-3"><a href="import-and-format-data.html#cb186-3"></a>      <span class="kw">here</span>(<span class="st">&quot;data/2016 Mungbean PM trials summary.xlsx&quot;</span>),</span>
<span id="cb186-4"><a href="import-and-format-data.html#cb186-4"></a>      <span class="dt">sheet =</span> <span class="st">&quot;Kingaroy_2016&quot;</span>,</span>
<span id="cb186-5"><a href="import-and-format-data.html#cb186-5"></a>      <span class="dt">startRow =</span> <span class="dv">5</span>,</span>
<span id="cb186-6"><a href="import-and-format-data.html#cb186-6"></a>      <span class="dt">colNames =</span> <span class="ot">TRUE</span></span>
<span id="cb186-7"><a href="import-and-format-data.html#cb186-7"></a>   )</span>
<span id="cb186-8"><a href="import-and-format-data.html#cb186-8"></a></span>
<span id="cb186-9"><a href="import-and-format-data.html#cb186-9"></a><span class="co"># Rename columns</span></span>
<span id="cb186-10"><a href="import-and-format-data.html#cb186-10"></a><span class="kw">colnames</span>(King_<span class="fl">16.</span>DR)[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;dae20&quot;</span>,<span class="st">&quot;dae34&quot;</span>,<span class="st">&quot;dae46&quot;</span>,<span class="st">&quot;PM_final_severity&quot;</span>,<span class="st">&quot;Final_Yield_tHa&quot;</span>)</span>
<span id="cb186-11"><a href="import-and-format-data.html#cb186-11"></a></span>
<span id="cb186-12"><a href="import-and-format-data.html#cb186-12"></a><span class="co"># Define Treatments</span></span>
<span id="cb186-13"><a href="import-and-format-data.html#cb186-13"></a>King_<span class="fl">16.</span>DR &lt;-<span class="st"> </span>King_<span class="fl">16.</span>DR <span class="op">%&gt;%</span></span>
<span id="cb186-14"><a href="import-and-format-data.html#cb186-14"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">n_treatment =</span> </span>
<span id="cb186-15"><a href="import-and-format-data.html#cb186-15"></a>             <span class="kw">case_when</span>(Treatment <span class="op">==</span><span class="st"> &quot;4wk+2 (3s)&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>,</span>
<span id="cb186-16"><a href="import-and-format-data.html#cb186-16"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;4wk+1 (2s)&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,</span>
<span id="cb186-17"><a href="import-and-format-data.html#cb186-17"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1/3+1 (2s)&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">7</span>,</span>
<span id="cb186-18"><a href="import-and-format-data.html#cb186-18"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1st sign (1s)&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb186-19"><a href="import-and-format-data.html#cb186-19"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;4wk (1s)&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb186-20"><a href="import-and-format-data.html#cb186-20"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;1st sign+1 (2s)&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">6</span>,</span>
<span id="cb186-21"><a href="import-and-format-data.html#cb186-21"></a>                       Treatment <span class="op">==</span><span class="st"> &quot;Unsprayed&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb186-22"><a href="import-and-format-data.html#cb186-22"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">9999</span>))</span>
<span id="cb186-23"><a href="import-and-format-data.html#cb186-23"></a></span>
<span id="cb186-24"><a href="import-and-format-data.html#cb186-24"></a></span>
<span id="cb186-25"><a href="import-and-format-data.html#cb186-25"></a></span>
<span id="cb186-26"><a href="import-and-format-data.html#cb186-26"></a><span class="co"># Join disease assesment data with grain yield data</span></span>
<span id="cb186-27"><a href="import-and-format-data.html#cb186-27"></a>King_<span class="dv">16</span>_m &lt;-<span class="st"> </span><span class="kw">left_join</span>(King_<span class="dv">16</span>_m,King_<span class="fl">16.</span>DR)</span></code></pre></div>
<pre><code>## Joining, by = &quot;n_treatment&quot;</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="import-and-format-data.html#cb188-1"></a><span class="co"># Calculate AUDPC</span></span>
<span id="cb188-2"><a href="import-and-format-data.html#cb188-2"></a>King_<span class="dv">16</span>_m<span class="op">$</span>AUDPC_m &lt;-<span class="st"> </span><span class="kw">apply</span>(King_<span class="dv">16</span>_m[,<span class="kw">c</span>(<span class="st">&quot;dae20&quot;</span>, <span class="st">&quot;dae34&quot;</span>, <span class="st">&quot;dae46&quot;</span>, <span class="st">&quot;PM_final_severity&quot;</span>)]<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>, </span>
<span id="cb188-3"><a href="import-and-format-data.html#cb188-3"></a>                            <span class="dt">FUN =</span> audps, <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">34</span>,<span class="dv">46</span>,<span class="dv">60</span>))</span>
<span id="cb188-4"><a href="import-and-format-data.html#cb188-4"></a>King_<span class="dv">16</span>_m<span class="op">$</span>AUDPS_m &lt;-<span class="st"> </span><span class="kw">apply</span>(King_<span class="dv">16</span>_m[,<span class="kw">c</span>(<span class="st">&quot;dae20&quot;</span>, <span class="st">&quot;dae34&quot;</span>, <span class="st">&quot;dae46&quot;</span>, <span class="st">&quot;PM_final_severity&quot;</span>)]<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>, </span>
<span id="cb188-5"><a href="import-and-format-data.html#cb188-5"></a>                            <span class="dt">FUN =</span> audps, <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">34</span>,<span class="dv">46</span>,<span class="dv">60</span>))</span>
<span id="cb188-6"><a href="import-and-format-data.html#cb188-6"></a></span>
<span id="cb188-7"><a href="import-and-format-data.html#cb188-7"></a><span class="co"># Create AUDPC/S standard deviation columns</span></span>
<span id="cb188-8"><a href="import-and-format-data.html#cb188-8"></a><span class="co">#  defined as NA because we only had treatment mean data</span></span>
<span id="cb188-9"><a href="import-and-format-data.html#cb188-9"></a><span class="co">#  for this experiment</span></span>
<span id="cb188-10"><a href="import-and-format-data.html#cb188-10"></a>King_<span class="dv">16</span>_m<span class="op">$</span>AUDPS_sd &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb188-11"><a href="import-and-format-data.html#cb188-11"></a>King_<span class="dv">16</span>_m<span class="op">$</span>AUDPC_sd &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb188-12"><a href="import-and-format-data.html#cb188-12"></a></span>
<span id="cb188-13"><a href="import-and-format-data.html#cb188-13"></a><span class="co"># Calculate disease mean squares</span></span>
<span id="cb188-14"><a href="import-and-format-data.html#cb188-14"></a>King_<span class="dv">16</span>_m<span class="op">$</span>Inc_Ms &lt;-<span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC_m <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment), </span>
<span id="cb188-15"><a href="import-and-format-data.html#cb188-15"></a>                             <span class="dt">data =</span> King_<span class="dv">16</span>_m))[<span class="dv">1</span>,<span class="dv">3</span>] <span class="co">#ANOVA F-tests on an essentially perfect fit are unreliable</span></span></code></pre></div>
<pre><code>## Warning in anova.lm(lm(AUDPC_m ~ factor(n_treatment), data = King_16_m)): ANOVA
## F-tests on an essentially perfect fit are unreliable</code></pre>
</div>
<div id="tidy-and-save-data-1" class="section level4">
<h4><span class="header-section-number">3.4.10.5</span> Tidy and save data</h4>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="import-and-format-data.html#cb190-1"></a>King_<span class="dv">16</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(King_<span class="dv">16</span>_m, PM_MB_means)</span>
<span id="cb190-2"><a href="import-and-format-data.html#cb190-2"></a>King_<span class="dv">16</span>_m &lt;-<span class="st"> </span>King_<span class="dv">16</span>_m[,<span class="op">!</span><span class="kw">colnames</span>(King_<span class="dv">16</span>_m) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Treatment&#39;</span>,<span class="st">&quot;dae20&quot;</span>,<span class="st">&quot;dae34&quot;</span>,<span class="st">&quot;dae46&quot;</span>,<span class="st">&quot;Final_Yield_tHa&quot;</span>)]</span>
<span id="cb190-3"><a href="import-and-format-data.html#cb190-3"></a></span>
<span id="cb190-4"><a href="import-and-format-data.html#cb190-4"></a></span>
<span id="cb190-5"><a href="import-and-format-data.html#cb190-5"></a><span class="co"># insert new calculations into data</span></span>
<span id="cb190-6"><a href="import-and-format-data.html#cb190-6"></a>PM_MB_means &lt;-<span class="st"> </span><span class="kw">replace_data</span>(<span class="dt">template_data =</span> PM_MB_means, </span>
<span id="cb190-7"><a href="import-and-format-data.html#cb190-7"></a>                            <span class="dt">new_data =</span> King_<span class="dv">16</span>_m, </span>
<span id="cb190-8"><a href="import-and-format-data.html#cb190-8"></a>                            <span class="dt">new_data_column =</span> <span class="kw">c</span>(<span class="st">&quot;AUDPC_m&quot;</span>, <span class="st">&quot;AUDPC_sd&quot;</span>, <span class="st">&quot;AUDPS_m&quot;</span>,<span class="st">&quot;AUDPS_sd&quot;</span>,<span class="st">&quot;Y_Msquare&quot;</span>, <span class="st">&quot;Inc_Ms&quot;</span>),</span>
<span id="cb190-9"><a href="import-and-format-data.html#cb190-9"></a>                            <span class="dt">filter_cols =</span> <span class="kw">c</span>(<span class="st">&quot;trial_ref&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;location&quot;</span>, <span class="st">&quot;host_genotype&quot;</span>, </span>
<span id="cb190-10"><a href="import-and-format-data.html#cb190-10"></a>                                           <span class="st">&quot;fungicide_ai&quot;</span>, <span class="st">&quot;dose_ai.ha&quot;</span>,<span class="st">&quot;n_treatment&quot;</span>))</span></code></pre></div>
<pre><code>## No data changed 0/7</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="import-and-format-data.html#cb192-1"></a><span class="kw">write.csv</span>(</span>
<span id="cb192-2"><a href="import-and-format-data.html#cb192-2"></a>   King_<span class="dv">16</span>_m,</span>
<span id="cb192-3"><a href="import-and-format-data.html#cb192-3"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/King_16_means.csv&quot;</span>),</span>
<span id="cb192-4"><a href="import-and-format-data.html#cb192-4"></a>   <span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb192-5"><a href="import-and-format-data.html#cb192-5"></a>)</span></code></pre></div>
</div>
</div>
<div id="missen-flats-2017" class="section level3">
<h3><span class="header-section-number">3.4.11</span> Missen Flats 2017</h3>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="import-and-format-data.html#cb193-1"></a><span class="co"># ____________________________________________________________</span></span>
<span id="cb193-2"><a href="import-and-format-data.html#cb193-2"></a><span class="co"># _____________   Missen Flats (Fogarty&#39;s) 2017     ____________</span></span>
<span id="cb193-3"><a href="import-and-format-data.html#cb193-3"></a>Fogerty_<span class="dv">17</span> &lt;-</span>
<span id="cb193-4"><a href="import-and-format-data.html#cb193-4"></a><span class="st">   </span><span class="kw">read.xlsx</span>(</span>
<span id="cb193-5"><a href="import-and-format-data.html#cb193-5"></a>      <span class="kw">here</span>(<span class="st">&quot;data/Fogerty Work File 2017 (Autosaved).xlsx&quot;</span>),</span>
<span id="cb193-6"><a href="import-and-format-data.html#cb193-6"></a>      <span class="dt">sheet =</span> <span class="st">&quot;Data&quot;</span>,</span>
<span id="cb193-7"><a href="import-and-format-data.html#cb193-7"></a>      <span class="dt">startRow =</span> <span class="dv">3</span>,</span>
<span id="cb193-8"><a href="import-and-format-data.html#cb193-8"></a>      <span class="dt">colNames =</span> <span class="ot">TRUE</span>,</span>
<span id="cb193-9"><a href="import-and-format-data.html#cb193-9"></a>      <span class="dt">detectDates =</span> <span class="ot">TRUE</span></span>
<span id="cb193-10"><a href="import-and-format-data.html#cb193-10"></a>   )[, <span class="dv">1</span><span class="op">:</span><span class="dv">43</span>]</span>
<span id="cb193-11"><a href="import-and-format-data.html#cb193-11"></a></span>
<span id="cb193-12"><a href="import-and-format-data.html#cb193-12"></a></span>
<span id="cb193-13"><a href="import-and-format-data.html#cb193-13"></a><span class="co"># Columns to keep</span></span>
<span id="cb193-14"><a href="import-and-format-data.html#cb193-14"></a>Fogerty_<span class="dv">17</span> &lt;-<span class="st"> </span>Fogerty_<span class="dv">17</span>[, <span class="kw">c</span>(<span class="st">&#39;Plot&#39;</span>, <span class="st">&#39;Rep&#39;</span>, <span class="st">&#39;Row&#39;</span>, <span class="st">&#39;Column&#39;</span>, <span class="st">&#39;Chem.Trt&#39;</span>,</span>
<span id="cb193-15"><a href="import-and-format-data.html#cb193-15"></a>                           <span class="st">&#39;Chemical&#39;</span>, <span class="st">&#39;Row.Spacing.(m)&#39;</span>, <span class="st">&#39;Treatment.No&#39;</span>,</span>
<span id="cb193-16"><a href="import-and-format-data.html#cb193-16"></a>                           <span class="st">&#39;Treatment&#39;</span>, <span class="st">&#39;Population.plsnts/ha&#39;</span>,</span>
<span id="cb193-17"><a href="import-and-format-data.html#cb193-17"></a>                           <span class="st">&#39;2017-03-07&#39;</span>, <span class="st">&#39;2017-03-19&#39;</span>, <span class="st">&#39;2017-03-24&#39;</span>,</span>
<span id="cb193-18"><a href="import-and-format-data.html#cb193-18"></a>                           <span class="st">&#39;2017-04-02&#39;</span>, <span class="st">&#39;2017-04-10&#39;</span>, <span class="st">&#39;2017-04-18&#39;</span>,</span>
<span id="cb193-19"><a href="import-and-format-data.html#cb193-19"></a>                           <span class="st">&#39;Yield.t/ha&#39;</span>, <span class="st">&#39;Grain.Moisture.%&#39;</span>, <span class="st">&#39;Temp.moisture.Taken&#39;</span>,</span>
<span id="cb193-20"><a href="import-and-format-data.html#cb193-20"></a>                           <span class="st">&#39;100.grain.wt.Grams&#39;</span>)]</span>
<span id="cb193-21"><a href="import-and-format-data.html#cb193-21"></a></span>
<span id="cb193-22"><a href="import-and-format-data.html#cb193-22"></a><span class="co"># could also use gsub to remove Ts in the treatment variable</span></span>
<span id="cb193-23"><a href="import-and-format-data.html#cb193-23"></a>Fogerty_<span class="dv">17</span><span class="op">$</span>Treatment.No &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">unlist</span>(<span class="kw">strsplit</span>(</span>
<span id="cb193-24"><a href="import-and-format-data.html#cb193-24"></a>   Fogerty_<span class="dv">17</span><span class="op">$</span>Treatment.No, <span class="st">&quot;T&quot;</span>))[</span>
<span id="cb193-25"><a href="import-and-format-data.html#cb193-25"></a>      <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">324</span>, <span class="dt">by =</span> <span class="dv">2</span>)])</span></code></pre></div>
<div id="define-treatment-data-8" class="section level4">
<h4><span class="header-section-number">3.4.11.1</span> Define treatment data</h4>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="import-and-format-data.html#cb194-1"></a>Fogerty_<span class="dv">17</span>_dat &lt;-<span class="st"> </span>Fogerty_<span class="dv">17</span> <span class="op">%&gt;%</span></span>
<span id="cb194-2"><a href="import-and-format-data.html#cb194-2"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trade_name =</span> </span>
<span id="cb194-3"><a href="import-and-format-data.html#cb194-3"></a>             <span class="kw">case_when</span>(Chem.Trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;Folicur&quot;</span>,</span>
<span id="cb194-4"><a href="import-and-format-data.html#cb194-4"></a>                       Chem.Trt <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &quot;Throttle&quot;</span>,</span>
<span id="cb194-5"><a href="import-and-format-data.html#cb194-5"></a>                       Chem.Trt <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &quot;Custodia&quot;</span>,</span>
<span id="cb194-6"><a href="import-and-format-data.html#cb194-6"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb194-7"><a href="import-and-format-data.html#cb194-7"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_ai =</span> </span>
<span id="cb194-8"><a href="import-and-format-data.html#cb194-8"></a>             <span class="kw">as.character</span>(<span class="kw">case_when</span>(Chem.Trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;tebuconazole&quot;</span>,</span>
<span id="cb194-9"><a href="import-and-format-data.html#cb194-9"></a>                                    Chem.Trt <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb194-10"><a href="import-and-format-data.html#cb194-10"></a>                                    Chem.Trt <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &quot;200 g/L tebuconazole + 120 g/L azoxystrobin&quot;</span>,</span>
<span id="cb194-11"><a href="import-and-format-data.html#cb194-11"></a>                                    <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>)))<span class="op">%&gt;%</span></span>
<span id="cb194-12"><a href="import-and-format-data.html#cb194-12"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> </span>
<span id="cb194-13"><a href="import-and-format-data.html#cb194-13"></a>             <span class="kw">case_when</span>(Chem.Trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="dv">62</span>,</span>
<span id="cb194-14"><a href="import-and-format-data.html#cb194-14"></a>                       Chem.Trt <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="dv">125</span>,</span>
<span id="cb194-15"><a href="import-and-format-data.html#cb194-15"></a>                       Chem.Trt <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">60</span>,</span>
<span id="cb194-16"><a href="import-and-format-data.html#cb194-16"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA_real_</span>))<span class="op">%&gt;%</span></span>
<span id="cb194-17"><a href="import-and-format-data.html#cb194-17"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_1 =</span> </span>
<span id="cb194-18"><a href="import-and-format-data.html#cb194-18"></a>             <span class="kw">case_when</span>(Treatment.No <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb194-19"><a href="import-and-format-data.html#cb194-19"></a>                       Treatment.No <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-02-22&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb194-20"><a href="import-and-format-data.html#cb194-20"></a>                       Treatment.No <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-03-08&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb194-21"><a href="import-and-format-data.html#cb194-21"></a>                       Treatment.No <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-03-08&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb194-22"><a href="import-and-format-data.html#cb194-22"></a>                       Treatment.No <span class="op">==</span><span class="st"> </span><span class="dv">5</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-03-19&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb194-23"><a href="import-and-format-data.html#cb194-23"></a>                       Treatment.No <span class="op">==</span><span class="st"> </span><span class="dv">6</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-03-08&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb194-24"><a href="import-and-format-data.html#cb194-24"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb194-25"><a href="import-and-format-data.html#cb194-25"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_2 =</span> </span>
<span id="cb194-26"><a href="import-and-format-data.html#cb194-26"></a>             <span class="kw">case_when</span>(Treatment.No <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-03-24&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb194-27"><a href="import-and-format-data.html#cb194-27"></a>                       Treatment.No <span class="op">==</span><span class="st"> </span><span class="dv">6</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-04-02&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb194-28"><a href="import-and-format-data.html#cb194-28"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb194-29"><a href="import-and-format-data.html#cb194-29"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">spray_n =</span> </span>
<span id="cb194-30"><a href="import-and-format-data.html#cb194-30"></a>             <span class="kw">case_when</span>(Treatment.No <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb194-31"><a href="import-and-format-data.html#cb194-31"></a>                       Treatment.No <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb194-32"><a href="import-and-format-data.html#cb194-32"></a>                       Treatment.No <span class="op">==</span><span class="st"> </span><span class="dv">6</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb194-33"><a href="import-and-format-data.html#cb194-33"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="input-trial-data-9" class="section level4">
<h4><span class="header-section-number">3.4.11.2</span> Input trial data</h4>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="import-and-format-data.html#cb195-1"></a><span class="co"># Remove zeros because of recording errors (some people recorded zero for no incidence when it should be 1)</span></span>
<span id="cb195-2"><a href="import-and-format-data.html#cb195-2"></a>Fogerty_<span class="dv">17</span>_dat[Fogerty_<span class="dv">17</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">2017-03-07</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span> ,<span class="kw">c</span>(<span class="st">&quot;2017-03-07&quot;</span>)] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb195-3"><a href="import-and-format-data.html#cb195-3"></a></span>
<span id="cb195-4"><a href="import-and-format-data.html#cb195-4"></a></span>
<span id="cb195-5"><a href="import-and-format-data.html#cb195-5"></a>Fogerty_<span class="dv">17</span>_dat &lt;-<span class="st"> </span></span>
<span id="cb195-6"><a href="import-and-format-data.html#cb195-6"></a><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">trial_ref =</span> <span class="st">&quot;mung1617/02&quot;</span>,</span>
<span id="cb195-7"><a href="import-and-format-data.html#cb195-7"></a>              <span class="dt">year =</span> <span class="st">&quot;2017&quot;</span>,</span>
<span id="cb195-8"><a href="import-and-format-data.html#cb195-8"></a>              <span class="dt">location =</span> <span class="st">&quot;Missen Flats&quot;</span>,</span>
<span id="cb195-9"><a href="import-and-format-data.html#cb195-9"></a>              <span class="dt">host_genotype =</span> <span class="st">&quot;Jade&quot;</span>,</span>
<span id="cb195-10"><a href="import-and-format-data.html#cb195-10"></a>              <span class="dt">trial_design =</span> <span class="st">&quot;RCB&quot;</span>,</span>
<span id="cb195-11"><a href="import-and-format-data.html#cb195-11"></a>              <span class="dt">plot_length =</span> <span class="dv">10</span>,</span>
<span id="cb195-12"><a href="import-and-format-data.html#cb195-12"></a>              <span class="dt">plot_width =</span> <span class="dv">2</span>,</span>
<span id="cb195-13"><a href="import-and-format-data.html#cb195-13"></a>              <span class="dt">plant_density =</span> Fogerty_<span class="dv">17</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">Population.plsnts/ha</span><span class="st">`</span>,</span>
<span id="cb195-14"><a href="import-and-format-data.html#cb195-14"></a>              <span class="dt">row_spacing =</span> Fogerty_<span class="dv">17</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">Row.Spacing.(m)</span><span class="st">`</span>,</span>
<span id="cb195-15"><a href="import-and-format-data.html#cb195-15"></a>              <span class="dt">replicate =</span> Fogerty_<span class="dv">17</span>_dat<span class="op">$</span>Rep,</span>
<span id="cb195-16"><a href="import-and-format-data.html#cb195-16"></a>              <span class="dt">planting_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-01-27&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb195-17"><a href="import-and-format-data.html#cb195-17"></a>              <span class="dt">emergence_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-02-01&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb195-18"><a href="import-and-format-data.html#cb195-18"></a>              <span class="dt">flowering_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb195-19"><a href="import-and-format-data.html#cb195-19"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb195-20"><a href="import-and-format-data.html#cb195-20"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb195-21"><a href="import-and-format-data.html#cb195-21"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-03-07&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb195-22"><a href="import-and-format-data.html#cb195-22"></a>              <span class="dt">trade_name =</span> <span class="kw">as.character</span>(Fogerty_<span class="dv">17</span>_dat<span class="op">$</span>trade_name),</span>
<span id="cb195-23"><a href="import-and-format-data.html#cb195-23"></a>              <span class="dt">fungicide_ai =</span> <span class="kw">as.character</span>(Fogerty_<span class="dv">17</span>_dat<span class="op">$</span>fungicide_ai),</span>
<span id="cb195-24"><a href="import-and-format-data.html#cb195-24"></a>              <span class="dt">dose_ai.ha =</span> Fogerty_<span class="dv">17</span>_dat<span class="op">$</span>dose_ai.ha,</span>
<span id="cb195-25"><a href="import-and-format-data.html#cb195-25"></a>              <span class="dt">n_treatment =</span> <span class="kw">as.numeric</span>(Fogerty_<span class="dv">17</span>_dat<span class="op">$</span>Treatment.No),</span>
<span id="cb195-26"><a href="import-and-format-data.html#cb195-26"></a>              <span class="dt">fungicide_application_1 =</span> Fogerty_<span class="dv">17</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb195-27"><a href="import-and-format-data.html#cb195-27"></a>              <span class="dt">fungicide_application_2 =</span> Fogerty_<span class="dv">17</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb195-28"><a href="import-and-format-data.html#cb195-28"></a>              <span class="dt">total_fungicide =</span> Fogerty_<span class="dv">17</span>_dat<span class="op">$</span>spray_n,</span>
<span id="cb195-29"><a href="import-and-format-data.html#cb195-29"></a>              <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-05-11&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb195-30"><a href="import-and-format-data.html#cb195-30"></a>              <span class="dt">final_assessment =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-04-18&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb195-31"><a href="import-and-format-data.html#cb195-31"></a>              <span class="dt">PM_final_severity =</span> Fogerty_<span class="dv">17</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">2017-04-18</span><span class="st">`</span>,</span>
<span id="cb195-32"><a href="import-and-format-data.html#cb195-32"></a>              <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb195-33"><a href="import-and-format-data.html#cb195-33"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">as.numeric</span>(Fogerty_<span class="dv">17</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">Yield.t/ha</span><span class="st">`</span>),</span>
<span id="cb195-34"><a href="import-and-format-data.html#cb195-34"></a>              <span class="dt">AUDPC =</span> <span class="kw">apply</span>(Fogerty_<span class="dv">17</span>_dat[,<span class="kw">c</span>(<span class="st">&quot;2017-03-07&quot;</span>, <span class="st">&quot;2017-03-19&quot;</span>, <span class="st">&quot;2017-03-24&quot;</span>,</span>
<span id="cb195-35"><a href="import-and-format-data.html#cb195-35"></a>                                              <span class="st">&quot;2017-04-02&quot;</span>,<span class="st">&quot;2017-04-10&quot;</span>,<span class="st">&quot;2017-04-18&quot;</span>)]<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>, </span>
<span id="cb195-36"><a href="import-and-format-data.html#cb195-36"></a>                            <span class="dt">FUN =</span> audpc, <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">12</span>,<span class="dv">17</span>,<span class="dv">26</span>,<span class="dv">34</span>,<span class="dv">42</span>)), <span class="co"># -1 to the data because zero disease = 1 on rating scale// Dates are based off days from first sign</span></span>
<span id="cb195-37"><a href="import-and-format-data.html#cb195-37"></a>              <span class="dt">AUDPS =</span> <span class="kw">apply</span>(Fogerty_<span class="dv">17</span>_dat[,<span class="kw">c</span>(<span class="st">&quot;2017-03-07&quot;</span>, <span class="st">&quot;2017-03-19&quot;</span>, <span class="st">&quot;2017-03-24&quot;</span>,</span>
<span id="cb195-38"><a href="import-and-format-data.html#cb195-38"></a>                                              <span class="st">&quot;2017-04-02&quot;</span>,<span class="st">&quot;2017-04-10&quot;</span>,<span class="st">&quot;2017-04-18&quot;</span>)]<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>, </span>
<span id="cb195-39"><a href="import-and-format-data.html#cb195-39"></a>                            <span class="dt">FUN =</span> audps, <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">12</span>,<span class="dv">17</span>,<span class="dv">26</span>,<span class="dv">34</span>,<span class="dv">42</span>)),</span>
<span id="cb195-40"><a href="import-and-format-data.html#cb195-40"></a>              <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="calculating-treatment-means-3" class="section level4">
<h4><span class="header-section-number">3.4.11.3</span> Calculating treatment means</h4>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="import-and-format-data.html#cb196-1"></a>Fogerty_<span class="dv">17</span>_m &lt;-<span class="st"> </span>Fogerty_<span class="dv">17</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb196-2"><a href="import-and-format-data.html#cb196-2"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment, row_spacing, fungicide_ai) <span class="op">%&gt;%</span></span>
<span id="cb196-3"><a href="import-and-format-data.html#cb196-3"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb196-4"><a href="import-and-format-data.html#cb196-4"></a>             <span class="dt">year =</span> <span class="kw">unique</span>(year),</span>
<span id="cb196-5"><a href="import-and-format-data.html#cb196-5"></a>             <span class="dt">location =</span> <span class="kw">unique</span>(location),</span>
<span id="cb196-6"><a href="import-and-format-data.html#cb196-6"></a>             <span class="dt">host_genotype =</span> <span class="kw">unique</span>(host_genotype),</span>
<span id="cb196-7"><a href="import-and-format-data.html#cb196-7"></a>             <span class="dt">trial_design =</span> <span class="kw">unique</span>(trial_design),</span>
<span id="cb196-8"><a href="import-and-format-data.html#cb196-8"></a>             <span class="dt">trade_name =</span> <span class="kw">unique</span>(trade_name),</span>
<span id="cb196-9"><a href="import-and-format-data.html#cb196-9"></a>             <span class="dt">dose_ai.ha =</span> <span class="kw">unique</span>(dose_ai.ha),</span>
<span id="cb196-10"><a href="import-and-format-data.html#cb196-10"></a>             <span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb196-11"><a href="import-and-format-data.html#cb196-11"></a>             <span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb196-12"><a href="import-and-format-data.html#cb196-12"></a>             <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb196-13"><a href="import-and-format-data.html#cb196-13"></a>             <span class="dt">plant_density =</span> <span class="kw">mean</span>(plant_density, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb196-14"><a href="import-and-format-data.html#cb196-14"></a>             <span class="dt">replicates =</span> <span class="kw">length</span>(<span class="kw">as.numeric</span>(replicate)),</span>
<span id="cb196-15"><a href="import-and-format-data.html#cb196-15"></a>             <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb196-16"><a href="import-and-format-data.html#cb196-16"></a>             <span class="dt">emergence_date =</span> <span class="kw">unique</span>(emergence_date),</span>
<span id="cb196-17"><a href="import-and-format-data.html#cb196-17"></a>             <span class="dt">flowering_date =</span> <span class="kw">unique</span>(flowering_date),</span>
<span id="cb196-18"><a href="import-and-format-data.html#cb196-18"></a>             <span class="dt">pod_fill_date =</span> <span class="kw">unique</span>(pod_fill_date),</span>
<span id="cb196-19"><a href="import-and-format-data.html#cb196-19"></a>             <span class="dt">mid_late_pod_fill =</span> <span class="kw">unique</span>(mid_late_pod_fill),</span>
<span id="cb196-20"><a href="import-and-format-data.html#cb196-20"></a>             <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb196-21"><a href="import-and-format-data.html#cb196-21"></a>             <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb196-22"><a href="import-and-format-data.html#cb196-22"></a>             <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb196-23"><a href="import-and-format-data.html#cb196-23"></a>             <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb196-24"><a href="import-and-format-data.html#cb196-24"></a>             <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb196-25"><a href="import-and-format-data.html#cb196-25"></a>             <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb196-26"><a href="import-and-format-data.html#cb196-26"></a>             <span class="dt">PM_final_severity =</span> <span class="kw">mean</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb196-27"><a href="import-and-format-data.html#cb196-27"></a>             <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb196-28"><a href="import-and-format-data.html#cb196-28"></a>             <span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="co"># Generating NAs so it will be repeated below</span></span>
<span id="cb196-29"><a href="import-and-format-data.html#cb196-29"></a>             <span class="dt">D_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb196-30"><a href="import-and-format-data.html#cb196-30"></a>             <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb196-31"><a href="import-and-format-data.html#cb196-31"></a>             <span class="dt">raw_graded =</span> <span class="ot">NA</span>,</span>
<span id="cb196-32"><a href="import-and-format-data.html#cb196-32"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb196-33"><a href="import-and-format-data.html#cb196-33"></a>             <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb196-34"><a href="import-and-format-data.html#cb196-34"></a>             <span class="dt">AUDPC_m =</span> <span class="kw">mean</span>(AUDPC),</span>
<span id="cb196-35"><a href="import-and-format-data.html#cb196-35"></a>             <span class="dt">AUDPC_sd =</span> <span class="kw">sd</span>(AUDPC),</span>
<span id="cb196-36"><a href="import-and-format-data.html#cb196-36"></a>             <span class="dt">AUDPS_m =</span> <span class="kw">mean</span>(AUDPS),</span>
<span id="cb196-37"><a href="import-and-format-data.html#cb196-37"></a>             <span class="dt">AUDPS_sd =</span> <span class="kw">sd</span>(AUDPS),</span>
<span id="cb196-38"><a href="import-and-format-data.html#cb196-38"></a>             <span class="dt">Inc_Ms =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment) <span class="op">+</span><span class="st"> </span>fungicide_ai <span class="op">+</span><span class="st"> </span>row_spacing, </span>
<span id="cb196-39"><a href="import-and-format-data.html#cb196-39"></a>                                  <span class="dt">data =</span> <span class="kw">subset</span>(Fogerty_<span class="dv">17</span>_dat, trade_name <span class="op">!=</span><span class="st"> &quot;Custodia&quot;</span>)))[<span class="dv">1</span>,<span class="dv">3</span>], <span class="co"># of only triazoles</span></span>
<span id="cb196-40"><a href="import-and-format-data.html#cb196-40"></a>             <span class="dt">Y_Msquare =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(n_treatment) <span class="op">+</span><span class="st"> </span>fungicide_ai <span class="op">+</span><span class="st"> </span>row_spacing, </span>
<span id="cb196-41"><a href="import-and-format-data.html#cb196-41"></a>                                  <span class="dt">data =</span> <span class="kw">subset</span>(Fogerty_<span class="dv">17</span>_dat, trade_name <span class="op">!=</span><span class="st"> &quot;Custodia&quot;</span>)))[<span class="dv">1</span>,<span class="dv">3</span>] <span class="co"># of only triazoles</span></span>
<span id="cb196-42"><a href="import-and-format-data.html#cb196-42"></a>   )</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;n_treatment&#39;, &#39;row_spacing&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="import-and-format-data.html#cb198-1"></a><span class="co"># For some weird reason standard deviations are comming back NA in the code above</span></span>
<span id="cb198-2"><a href="import-and-format-data.html#cb198-2"></a>Fogerty_<span class="dv">17</span>_m[,<span class="kw">c</span>(<span class="st">&quot;n_treatment&quot;</span>,<span class="st">&quot;row_spacing&quot;</span>, <span class="st">&quot;disease_error&quot;</span>,<span class="st">&quot;yield_error&quot;</span>)] &lt;-</span>
<span id="cb198-3"><a href="import-and-format-data.html#cb198-3"></a><span class="st">   </span>Fogerty_<span class="dv">17</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb198-4"><a href="import-and-format-data.html#cb198-4"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment, row_spacing, fungicide_ai) <span class="op">%&gt;%</span></span>
<span id="cb198-5"><a href="import-and-format-data.html#cb198-5"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb198-6"><a href="import-and-format-data.html#cb198-6"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb198-7"><a href="import-and-format-data.html#cb198-7"></a><span class="st">   </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&quot;n_treatment&quot;</span>,<span class="st">&quot;row_spacing&quot;</span>,<span class="st">&quot;disease_error&quot;</span>,<span class="st">&quot;yield_error&quot;</span>))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;n_treatment&#39;, &#39;row_spacing&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="import-and-format-data.html#cb200-1"></a><span class="co"># Define control treatments</span></span>
<span id="cb200-2"><a href="import-and-format-data.html#cb200-2"></a>Fogerty_<span class="dv">17</span>_m[Fogerty_<span class="dv">17</span>_m<span class="op">$</span>n_treatment <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;fungicide_ai&quot;</span>] &lt;-<span class="st"> &quot;control&quot;</span></span>
<span id="cb200-3"><a href="import-and-format-data.html#cb200-3"></a>Fogerty_<span class="dv">17</span>_m[Fogerty_<span class="dv">17</span>_m<span class="op">$</span>n_treatment <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,<span class="st">&quot;dose_ai.ha&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb200-4"><a href="import-and-format-data.html#cb200-4"></a>Fogerty_<span class="dv">17</span>_m[Fogerty_<span class="dv">17</span>_m<span class="op">$</span>n_treatment <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;trade_name&quot;</span>] &lt;-<span class="st"> &quot;control&quot;</span></span>
<span id="cb200-5"><a href="import-and-format-data.html#cb200-5"></a></span>
<span id="cb200-6"><a href="import-and-format-data.html#cb200-6"></a><span class="co"># Format and organise the dataframe</span></span>
<span id="cb200-7"><a href="import-and-format-data.html#cb200-7"></a>Fogerty_<span class="dv">17</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(Fogerty_<span class="dv">17</span>_m, PM_MB_means)</span>
<span id="cb200-8"><a href="import-and-format-data.html#cb200-8"></a>Fogerty_<span class="dv">17</span>_m &lt;-<span class="st"> </span><span class="kw">copy_class</span>(PM_MB_means, Fogerty_<span class="dv">17</span>_m)</span>
<span id="cb200-9"><a href="import-and-format-data.html#cb200-9"></a></span>
<span id="cb200-10"><a href="import-and-format-data.html#cb200-10"></a><span class="co"># I have comment out this code because it does not replace the control plots properly as there is nothing to separate them from each other</span></span>
<span id="cb200-11"><a href="import-and-format-data.html#cb200-11"></a><span class="co"># insert new calculations into data</span></span>
<span id="cb200-12"><a href="import-and-format-data.html#cb200-12"></a><span class="co">#PM_MB_means &lt;-   </span></span>
<span id="cb200-13"><a href="import-and-format-data.html#cb200-13"></a>   <span class="co"># replace_data(template_data = PM_MB_means,</span></span>
<span id="cb200-14"><a href="import-and-format-data.html#cb200-14"></a>   <span class="co">#                          new_data = Fogerty_17_m,</span></span>
<span id="cb200-15"><a href="import-and-format-data.html#cb200-15"></a>   <span class="co">#                          new_data_column = &quot;AUDPC_m&quot;,</span></span>
<span id="cb200-16"><a href="import-and-format-data.html#cb200-16"></a>   <span class="co">#                          ignore_columns = c(5:8,10:16,29:46),</span></span>
<span id="cb200-17"><a href="import-and-format-data.html#cb200-17"></a>   <span class="co">#                          subset_factor = &quot;mung1617/02&quot;)</span></span>
<span id="cb200-18"><a href="import-and-format-data.html#cb200-18"></a></span>
<span id="cb200-19"><a href="import-and-format-data.html#cb200-19"></a></span>
<span id="cb200-20"><a href="import-and-format-data.html#cb200-20"></a></span>
<span id="cb200-21"><a href="import-and-format-data.html#cb200-21"></a><span class="cf">if</span>(<span class="kw">all</span>(<span class="kw">dim</span>(Fogerty_<span class="dv">17</span>_m) <span class="op">==</span><span class="st"> </span><span class="kw">dim</span>(PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> &quot;mung1617/02&quot;</span>,]))){</span>
<span id="cb200-22"><a href="import-and-format-data.html#cb200-22"></a>PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> &quot;mung1617/02&quot;</span>,] &lt;-<span class="st"> </span></span>
<span id="cb200-23"><a href="import-and-format-data.html#cb200-23"></a><span class="st">   </span>Fogerty_<span class="dv">17</span>_m</span>
<span id="cb200-24"><a href="import-and-format-data.html#cb200-24"></a>}<span class="cf">else</span>{<span class="kw">warning</span>(<span class="st">&quot;Dimensions don&#39;t match check data&quot;</span>)}</span>
<span id="cb200-25"><a href="import-and-format-data.html#cb200-25"></a></span>
<span id="cb200-26"><a href="import-and-format-data.html#cb200-26"></a></span>
<span id="cb200-27"><a href="import-and-format-data.html#cb200-27"></a></span>
<span id="cb200-28"><a href="import-and-format-data.html#cb200-28"></a><span class="kw">write.csv</span>(</span>
<span id="cb200-29"><a href="import-and-format-data.html#cb200-29"></a>   Fogerty_<span class="dv">17</span>_m,</span>
<span id="cb200-30"><a href="import-and-format-data.html#cb200-30"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/Fogerty_17_mean.csv&quot;</span>),</span>
<span id="cb200-31"><a href="import-and-format-data.html#cb200-31"></a>   <span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb200-32"><a href="import-and-format-data.html#cb200-32"></a>)</span></code></pre></div>
</div>
</div>
<div id="hermitage-2017" class="section level3">
<h3><span class="header-section-number">3.4.12</span> Hermitage 2017</h3>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="import-and-format-data.html#cb201-1"></a><span class="co"># _____________   Hermitage  2017     ____________</span></span>
<span id="cb201-2"><a href="import-and-format-data.html#cb201-2"></a>Herm_<span class="dv">17</span> &lt;-</span>
<span id="cb201-3"><a href="import-and-format-data.html#cb201-3"></a><span class="st">   </span><span class="kw">read.xlsx</span>(</span>
<span id="cb201-4"><a href="import-and-format-data.html#cb201-4"></a>      <span class="kw">here</span>(<span class="st">&quot;data/Hermitage working file 2017 .xlsx&quot;</span>),</span>
<span id="cb201-5"><a href="import-and-format-data.html#cb201-5"></a>      <span class="dt">sheet =</span> <span class="st">&quot;Hermitage Trial&quot;</span>,</span>
<span id="cb201-6"><a href="import-and-format-data.html#cb201-6"></a>      <span class="dt">rows =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">165</span>,</span>
<span id="cb201-7"><a href="import-and-format-data.html#cb201-7"></a>      <span class="dt">cols =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">38</span>,</span>
<span id="cb201-8"><a href="import-and-format-data.html#cb201-8"></a>      <span class="dt">colNames =</span> <span class="ot">TRUE</span>,</span>
<span id="cb201-9"><a href="import-and-format-data.html#cb201-9"></a>      <span class="dt">detectDates =</span> <span class="ot">TRUE</span></span>
<span id="cb201-10"><a href="import-and-format-data.html#cb201-10"></a>   )</span>
<span id="cb201-11"><a href="import-and-format-data.html#cb201-11"></a></span>
<span id="cb201-12"><a href="import-and-format-data.html#cb201-12"></a><span class="co"># Adjust the Yield to 12% moisture</span></span>
<span id="cb201-13"><a href="import-and-format-data.html#cb201-13"></a>Herm_<span class="dv">17</span><span class="op">$</span><span class="st">`</span><span class="dt">Yield.T/Ha</span><span class="st">`</span> &lt;-</span>
<span id="cb201-14"><a href="import-and-format-data.html#cb201-14"></a><span class="st">   </span>(Herm_<span class="dv">17</span><span class="op">$</span><span class="st">`</span><span class="dt">Yield.T/Ha</span><span class="st">`</span> <span class="op">/</span><span class="st"> </span>Herm_<span class="dv">17</span><span class="op">$</span><span class="st">`</span><span class="dt">Moisture%</span><span class="st">`</span>) <span class="op">*</span><span class="st"> </span><span class="dv">12</span></span></code></pre></div>
<div id="define-treatment-data-9" class="section level4">
<h4><span class="header-section-number">3.4.12.1</span> Define treatment data</h4>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="import-and-format-data.html#cb202-1"></a>Herm_<span class="dv">17</span>_dat &lt;-<span class="st"> </span>Herm_<span class="dv">17</span> <span class="op">%&gt;%</span></span>
<span id="cb202-2"><a href="import-and-format-data.html#cb202-2"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trade_name =</span> </span>
<span id="cb202-3"><a href="import-and-format-data.html#cb202-3"></a>             <span class="kw">case_when</span>(Chemical.Trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;Folicur&quot;</span>,</span>
<span id="cb202-4"><a href="import-and-format-data.html#cb202-4"></a>                       Chemical.Trt <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &quot;Throttle&quot;</span>,</span>
<span id="cb202-5"><a href="import-and-format-data.html#cb202-5"></a>                       Chemical.Trt <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &quot;Custodia&quot;</span>,</span>
<span id="cb202-6"><a href="import-and-format-data.html#cb202-6"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb202-7"><a href="import-and-format-data.html#cb202-7"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_ai =</span> </span>
<span id="cb202-8"><a href="import-and-format-data.html#cb202-8"></a>             <span class="kw">case_when</span>(Chemical.Trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;tebuconazole&quot;</span>,</span>
<span id="cb202-9"><a href="import-and-format-data.html#cb202-9"></a>                       Chemical.Trt <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb202-10"><a href="import-and-format-data.html#cb202-10"></a>                       Chemical.Trt <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &quot;200 g/L tebuconazole + 120 g/L azoxystrobin&quot;</span>,</span>
<span id="cb202-11"><a href="import-and-format-data.html#cb202-11"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb202-12"><a href="import-and-format-data.html#cb202-12"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> </span>
<span id="cb202-13"><a href="import-and-format-data.html#cb202-13"></a>             <span class="kw">case_when</span>(Chemical.Trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="dv">62</span>,</span>
<span id="cb202-14"><a href="import-and-format-data.html#cb202-14"></a>                       Chemical.Trt <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="dv">125</span>,</span>
<span id="cb202-15"><a href="import-and-format-data.html#cb202-15"></a>                       Chemical.Trt <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">60</span>,</span>
<span id="cb202-16"><a href="import-and-format-data.html#cb202-16"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">9999</span>))<span class="op">%&gt;%</span></span>
<span id="cb202-17"><a href="import-and-format-data.html#cb202-17"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_1 =</span> </span>
<span id="cb202-18"><a href="import-and-format-data.html#cb202-18"></a>             <span class="kw">case_when</span>(Manage.Trt <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb202-19"><a href="import-and-format-data.html#cb202-19"></a>                       Manage.Trt <span class="op">==</span><span class="st"> &quot;T2&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-03-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb202-20"><a href="import-and-format-data.html#cb202-20"></a>                       Manage.Trt <span class="op">==</span><span class="st"> &quot;T3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-03-24&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb202-21"><a href="import-and-format-data.html#cb202-21"></a>                       Manage.Trt <span class="op">==</span><span class="st"> &quot;T4&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-03-27&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb202-22"><a href="import-and-format-data.html#cb202-22"></a>                       Manage.Trt <span class="op">==</span><span class="st"> &quot;T5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-03-27&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb202-23"><a href="import-and-format-data.html#cb202-23"></a>                       Manage.Trt <span class="op">==</span><span class="st"> &quot;T6&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-04-05&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb202-24"><a href="import-and-format-data.html#cb202-24"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb202-25"><a href="import-and-format-data.html#cb202-25"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_2 =</span> </span>
<span id="cb202-26"><a href="import-and-format-data.html#cb202-26"></a>             <span class="kw">case_when</span>(Manage.Trt <span class="op">==</span><span class="st"> &quot;T3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-04-07&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb202-27"><a href="import-and-format-data.html#cb202-27"></a>                       Manage.Trt <span class="op">==</span><span class="st"> &quot;T5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2017-04-11&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb202-28"><a href="import-and-format-data.html#cb202-28"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb202-29"><a href="import-and-format-data.html#cb202-29"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">spray_n =</span> </span>
<span id="cb202-30"><a href="import-and-format-data.html#cb202-30"></a>             <span class="kw">case_when</span>(Manage.Trt <span class="op">==</span><span class="st"> &quot;1&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb202-31"><a href="import-and-format-data.html#cb202-31"></a>                       Manage.Trt <span class="op">==</span><span class="st"> &quot;T3&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb202-32"><a href="import-and-format-data.html#cb202-32"></a>                       Manage.Trt <span class="op">==</span><span class="st"> &quot;T5&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb202-33"><a href="import-and-format-data.html#cb202-33"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="input-trial-data-10" class="section level4">
<h4><span class="header-section-number">3.4.12.2</span> Input trial data</h4>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="import-and-format-data.html#cb203-1"></a>Herm_<span class="dv">17</span>_dat &lt;-<span class="st"> </span></span>
<span id="cb203-2"><a href="import-and-format-data.html#cb203-2"></a><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">trial_ref =</span> <span class="st">&quot;mung1617/01&quot;</span>,</span>
<span id="cb203-3"><a href="import-and-format-data.html#cb203-3"></a>              <span class="dt">year =</span> <span class="st">&quot;2017&quot;</span>,</span>
<span id="cb203-4"><a href="import-and-format-data.html#cb203-4"></a>              <span class="dt">location =</span> <span class="st">&quot;Hermitage&quot;</span>,</span>
<span id="cb203-5"><a href="import-and-format-data.html#cb203-5"></a>              <span class="dt">host_genotype =</span> <span class="st">&quot;Jade&quot;</span>,</span>
<span id="cb203-6"><a href="import-and-format-data.html#cb203-6"></a>              <span class="dt">trial_design =</span> <span class="st">&quot;RCB&quot;</span>,</span>
<span id="cb203-7"><a href="import-and-format-data.html#cb203-7"></a>              <span class="dt">plot_length =</span> Herm_<span class="dv">17</span>_dat<span class="op">$</span>Plot.Length,</span>
<span id="cb203-8"><a href="import-and-format-data.html#cb203-8"></a>              <span class="dt">plot_width =</span> <span class="dv">2</span>,</span>
<span id="cb203-9"><a href="import-and-format-data.html#cb203-9"></a>              <span class="dt">plant_density =</span> <span class="ot">NA</span>,</span>
<span id="cb203-10"><a href="import-and-format-data.html#cb203-10"></a>              <span class="dt">row_spacing =</span> Herm_<span class="dv">17</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">Row.Spacing.(m)</span><span class="st">`</span>,</span>
<span id="cb203-11"><a href="import-and-format-data.html#cb203-11"></a>              <span class="dt">replicate =</span> Herm_<span class="dv">17</span>_dat<span class="op">$</span>Rep,</span>
<span id="cb203-12"><a href="import-and-format-data.html#cb203-12"></a>              <span class="dt">planting_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-02-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb203-13"><a href="import-and-format-data.html#cb203-13"></a>              <span class="dt">emergence_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-02-20&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb203-14"><a href="import-and-format-data.html#cb203-14"></a>              <span class="dt">flowering_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb203-15"><a href="import-and-format-data.html#cb203-15"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb203-16"><a href="import-and-format-data.html#cb203-16"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb203-17"><a href="import-and-format-data.html#cb203-17"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-03-24&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb203-18"><a href="import-and-format-data.html#cb203-18"></a>              <span class="dt">trade_name =</span> <span class="kw">as.character</span>(Herm_<span class="dv">17</span>_dat<span class="op">$</span>trade_name),</span>
<span id="cb203-19"><a href="import-and-format-data.html#cb203-19"></a>              <span class="dt">fungicide_ai =</span> Herm_<span class="dv">17</span>_dat<span class="op">$</span>fungicide_ai,</span>
<span id="cb203-20"><a href="import-and-format-data.html#cb203-20"></a>              <span class="dt">dose_ai.ha =</span> Herm_<span class="dv">17</span>_dat<span class="op">$</span>dose_ai.ha,</span>
<span id="cb203-21"><a href="import-and-format-data.html#cb203-21"></a>              <span class="dt">n_treatment =</span> <span class="kw">as.numeric</span>(<span class="kw">unlist</span>(<span class="kw">strsplit</span>(Herm_<span class="dv">17</span>_dat<span class="op">$</span>Manage.Trt, <span class="st">&quot;T&quot;</span>)</span>
<span id="cb203-22"><a href="import-and-format-data.html#cb203-22"></a>                                              )[<span class="kw">unlist</span>(<span class="kw">strsplit</span>(Herm_<span class="dv">17</span>_dat<span class="op">$</span>Manage.Trt, <span class="st">&quot;T&quot;</span>)) <span class="op">!=</span><span class="st"> &quot;&quot;</span>]),</span>
<span id="cb203-23"><a href="import-and-format-data.html#cb203-23"></a>              <span class="dt">fungicide_application_1 =</span> Herm_<span class="dv">17</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb203-24"><a href="import-and-format-data.html#cb203-24"></a>              <span class="dt">fungicide_application_2 =</span> Herm_<span class="dv">17</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb203-25"><a href="import-and-format-data.html#cb203-25"></a>              <span class="dt">total_fungicide =</span> Herm_<span class="dv">17</span>_dat<span class="op">$</span>spray_n,</span>
<span id="cb203-26"><a href="import-and-format-data.html#cb203-26"></a>              <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-06-26&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb203-27"><a href="import-and-format-data.html#cb203-27"></a>              <span class="dt">final_assessment =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-05-11&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb203-28"><a href="import-and-format-data.html#cb203-28"></a>              <span class="dt">PM_final_severity =</span> Herm_<span class="dv">17</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">I_11/05/2017</span><span class="st">`</span>,</span>
<span id="cb203-29"><a href="import-and-format-data.html#cb203-29"></a>              <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb203-30"><a href="import-and-format-data.html#cb203-30"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">as.numeric</span>(Herm_<span class="dv">17</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">Yield.T/Ha</span><span class="st">`</span>),</span>
<span id="cb203-31"><a href="import-and-format-data.html#cb203-31"></a>              <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb203-32"><a href="import-and-format-data.html#cb203-32"></a></span>
<span id="cb203-33"><a href="import-and-format-data.html#cb203-33"></a>Herm_<span class="dv">17</span>_dat &lt;-<span class="st"> </span><span class="kw">cbind</span>(Herm_<span class="dv">17</span>_dat,<span class="kw">data.frame</span>(</span>
<span id="cb203-34"><a href="import-and-format-data.html#cb203-34"></a>   <span class="dt">AUDPC =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb203-35"><a href="import-and-format-data.html#cb203-35"></a>                            Herm_<span class="dv">17</span>[,<span class="kw">c</span>(<span class="st">&quot;2017-03-24&quot;</span>,<span class="st">&quot;I_2/04/2017&quot;</span>, <span class="st">&quot;I_11/04/2017&quot;</span>, </span>
<span id="cb203-36"><a href="import-and-format-data.html#cb203-36"></a>                                       <span class="st">&quot;I_18/04/2017&quot;</span>, <span class="st">&quot;I_24/04/2017&quot;</span>,<span class="st">&quot;I_3/05/2017&quot;</span>,<span class="st">&quot;I_11/05/2017&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),<span class="dv">1</span>, </span>
<span id="cb203-37"><a href="import-and-format-data.html#cb203-37"></a>                 <span class="dt">FUN =</span> audpc, </span>
<span id="cb203-38"><a href="import-and-format-data.html#cb203-38"></a>                 <span class="dt">dates =</span> <span class="kw">c</span>((Herm_<span class="dv">17</span>_dat<span class="op">$</span>first_sign_disease[<span class="dv">1</span>]<span class="op">-</span><span class="dv">7</span>)<span class="op">-</span></span>
<span id="cb203-39"><a href="import-and-format-data.html#cb203-39"></a><span class="st">                              </span>Herm_<span class="dv">17</span>_dat<span class="op">$</span>planting_date[<span class="dv">1</span>],</span>
<span id="cb203-40"><a href="import-and-format-data.html#cb203-40"></a>                           <span class="dv">39</span>,<span class="dv">48</span>,<span class="dv">57</span>,<span class="dv">64</span>,<span class="dv">70</span>,<span class="dv">79</span>,<span class="dv">87</span>)</span>
<span id="cb203-41"><a href="import-and-format-data.html#cb203-41"></a>                 ),</span>
<span id="cb203-42"><a href="import-and-format-data.html#cb203-42"></a>   <span class="dt">AUDPS =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb203-43"><a href="import-and-format-data.html#cb203-43"></a>                            Herm_<span class="dv">17</span>[,<span class="kw">c</span>(<span class="st">&quot;2017-03-24&quot;</span>,<span class="st">&quot;I_2/04/2017&quot;</span>, <span class="st">&quot;I_11/04/2017&quot;</span>, </span>
<span id="cb203-44"><a href="import-and-format-data.html#cb203-44"></a>                                       <span class="st">&quot;I_18/04/2017&quot;</span>, <span class="st">&quot;I_24/04/2017&quot;</span>,<span class="st">&quot;I_3/05/2017&quot;</span>,<span class="st">&quot;I_11/05/2017&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),<span class="dv">1</span>, </span>
<span id="cb203-45"><a href="import-and-format-data.html#cb203-45"></a>                 <span class="dt">FUN =</span> audps, </span>
<span id="cb203-46"><a href="import-and-format-data.html#cb203-46"></a>                 <span class="dt">dates =</span> <span class="kw">c</span>((Herm_<span class="dv">17</span>_dat<span class="op">$</span>first_sign_disease[<span class="dv">1</span>]<span class="op">-</span><span class="dv">7</span>)<span class="op">-</span></span>
<span id="cb203-47"><a href="import-and-format-data.html#cb203-47"></a><span class="st">                              </span>Herm_<span class="dv">17</span>_dat<span class="op">$</span>planting_date[<span class="dv">1</span>],</span>
<span id="cb203-48"><a href="import-and-format-data.html#cb203-48"></a>                           <span class="dv">39</span>,<span class="dv">48</span>,<span class="dv">57</span>,<span class="dv">64</span>,<span class="dv">70</span>,<span class="dv">79</span>,<span class="dv">87</span>))</span>
<span id="cb203-49"><a href="import-and-format-data.html#cb203-49"></a>   ))</span></code></pre></div>
</div>
<div id="calculating-treatment-means-4" class="section level4">
<h4><span class="header-section-number">3.4.12.3</span> Calculating treatment means</h4>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="import-and-format-data.html#cb204-1"></a>Herm_<span class="dv">17</span>_m &lt;-<span class="st"> </span>Herm_<span class="dv">17</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb204-2"><a href="import-and-format-data.html#cb204-2"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment, fungicide_ai,row_spacing) <span class="op">%&gt;%</span></span>
<span id="cb204-3"><a href="import-and-format-data.html#cb204-3"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb204-4"><a href="import-and-format-data.html#cb204-4"></a>             <span class="dt">year =</span> <span class="kw">unique</span>(year),</span>
<span id="cb204-5"><a href="import-and-format-data.html#cb204-5"></a>             <span class="dt">location =</span> <span class="kw">unique</span>(location),</span>
<span id="cb204-6"><a href="import-and-format-data.html#cb204-6"></a>             <span class="dt">host_genotype =</span> <span class="kw">unique</span>(host_genotype),</span>
<span id="cb204-7"><a href="import-and-format-data.html#cb204-7"></a>             <span class="dt">trial_design =</span> <span class="kw">unique</span>(trial_design),</span>
<span id="cb204-8"><a href="import-and-format-data.html#cb204-8"></a>             <span class="dt">trade_name =</span> <span class="kw">unique</span>(trade_name),</span>
<span id="cb204-9"><a href="import-and-format-data.html#cb204-9"></a>             <span class="dt">dose_ai.ha =</span> <span class="kw">unique</span>(dose_ai.ha),</span>
<span id="cb204-10"><a href="import-and-format-data.html#cb204-10"></a>             <span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb204-11"><a href="import-and-format-data.html#cb204-11"></a>             <span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb204-12"><a href="import-and-format-data.html#cb204-12"></a>             <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb204-13"><a href="import-and-format-data.html#cb204-13"></a>             <span class="dt">plant_density =</span> <span class="kw">mean</span>(plant_density, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb204-14"><a href="import-and-format-data.html#cb204-14"></a>             <span class="dt">replicates =</span> <span class="kw">length</span>(<span class="kw">as.numeric</span>(replicate)),</span>
<span id="cb204-15"><a href="import-and-format-data.html#cb204-15"></a>             <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb204-16"><a href="import-and-format-data.html#cb204-16"></a>             <span class="dt">emergence_date =</span> <span class="kw">unique</span>(emergence_date),</span>
<span id="cb204-17"><a href="import-and-format-data.html#cb204-17"></a>             <span class="dt">flowering_date =</span> <span class="kw">unique</span>(flowering_date),</span>
<span id="cb204-18"><a href="import-and-format-data.html#cb204-18"></a>             <span class="dt">pod_fill_date =</span> <span class="kw">unique</span>(pod_fill_date),</span>
<span id="cb204-19"><a href="import-and-format-data.html#cb204-19"></a>             <span class="dt">mid_late_pod_fill =</span> <span class="kw">unique</span>(mid_late_pod_fill),</span>
<span id="cb204-20"><a href="import-and-format-data.html#cb204-20"></a>             <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb204-21"><a href="import-and-format-data.html#cb204-21"></a>             <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb204-22"><a href="import-and-format-data.html#cb204-22"></a>             <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb204-23"><a href="import-and-format-data.html#cb204-23"></a>             <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb204-24"><a href="import-and-format-data.html#cb204-24"></a>             <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb204-25"><a href="import-and-format-data.html#cb204-25"></a>             <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb204-26"><a href="import-and-format-data.html#cb204-26"></a>             <span class="dt">PM_final_severity =</span> <span class="kw">mean</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb204-27"><a href="import-and-format-data.html#cb204-27"></a>             <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb204-28"><a href="import-and-format-data.html#cb204-28"></a>             <span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="co"># why is this not working</span></span>
<span id="cb204-29"><a href="import-and-format-data.html#cb204-29"></a>             <span class="dt">D_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb204-30"><a href="import-and-format-data.html#cb204-30"></a>             <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb204-31"><a href="import-and-format-data.html#cb204-31"></a>             <span class="dt">raw_graded =</span> <span class="ot">NA</span>,</span>
<span id="cb204-32"><a href="import-and-format-data.html#cb204-32"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb204-33"><a href="import-and-format-data.html#cb204-33"></a>             <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb204-34"><a href="import-and-format-data.html#cb204-34"></a>             <span class="dt">AUDPC_m =</span> <span class="kw">mean</span>(AUDPC),</span>
<span id="cb204-35"><a href="import-and-format-data.html#cb204-35"></a>             <span class="dt">AUDPC_sd =</span> <span class="kw">sd</span>(AUDPC),</span>
<span id="cb204-36"><a href="import-and-format-data.html#cb204-36"></a>             <span class="dt">AUDPS_m =</span> <span class="kw">mean</span>(AUDPS),</span>
<span id="cb204-37"><a href="import-and-format-data.html#cb204-37"></a>             <span class="dt">AUDPS_sd =</span> <span class="kw">sd</span>(AUDPS),</span>
<span id="cb204-38"><a href="import-and-format-data.html#cb204-38"></a>             <span class="dt">Inc_Ms =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC <span class="op">~</span><span class="st"> </span></span>
<span id="cb204-39"><a href="import-and-format-data.html#cb204-39"></a><span class="st">                                  </span><span class="kw">factor</span>(n_treatment) <span class="op">+</span><span class="st"> </span>fungicide_ai <span class="op">+</span><span class="st"> </span>row_spacing, </span>
<span id="cb204-40"><a href="import-and-format-data.html#cb204-40"></a>                               <span class="dt">data =</span> <span class="kw">subset</span>(Herm_<span class="dv">17</span>_dat, trade_name <span class="op">!=</span><span class="st"> &quot;Custodia&quot;</span>)))[<span class="dv">1</span>,<span class="dv">3</span>], <span class="co"># of only triazoles</span></span>
<span id="cb204-41"><a href="import-and-format-data.html#cb204-41"></a>             <span class="dt">Y_Msquare =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span></span>
<span id="cb204-42"><a href="import-and-format-data.html#cb204-42"></a><span class="st">                                  </span><span class="kw">factor</span>(n_treatment) <span class="op">+</span><span class="st"> </span>fungicide_ai <span class="op">+</span><span class="st"> </span>row_spacing, </span>
<span id="cb204-43"><a href="import-and-format-data.html#cb204-43"></a>                               <span class="dt">data =</span> <span class="kw">subset</span>(Herm_<span class="dv">17</span>_dat, trade_name <span class="op">!=</span><span class="st"> &quot;Custodia&quot;</span>)))[<span class="dv">1</span>,<span class="dv">3</span>] <span class="co"># of only triazoles</span></span>
<span id="cb204-44"><a href="import-and-format-data.html#cb204-44"></a>   )</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;n_treatment&#39;, &#39;fungicide_ai&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="import-and-format-data.html#cb206-1"></a><span class="co"># For some weird reason standard deviations are comming back NA in the code above</span></span>
<span id="cb206-2"><a href="import-and-format-data.html#cb206-2"></a>Herm_<span class="dv">17</span>_m[,<span class="kw">c</span>(<span class="st">&quot;n_treatment&quot;</span>,<span class="st">&quot;fungicide_ai&quot;</span>,<span class="st">&quot;row_spacing&quot;</span>, <span class="st">&quot;disease_error&quot;</span>,<span class="st">&quot;yield_error&quot;</span>)] &lt;-</span>
<span id="cb206-3"><a href="import-and-format-data.html#cb206-3"></a><span class="st">   </span>Herm_<span class="dv">17</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb206-4"><a href="import-and-format-data.html#cb206-4"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment, fungicide_ai,row_spacing) <span class="op">%&gt;%</span></span>
<span id="cb206-5"><a href="import-and-format-data.html#cb206-5"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb206-6"><a href="import-and-format-data.html#cb206-6"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb206-7"><a href="import-and-format-data.html#cb206-7"></a><span class="st">   </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&quot;n_treatment&quot;</span>,<span class="st">&quot;fungicide_ai&quot;</span>,<span class="st">&quot;row_spacing&quot;</span>,<span class="st">&quot;disease_error&quot;</span>,<span class="st">&quot;yield_error&quot;</span>))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;n_treatment&#39;, &#39;fungicide_ai&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="import-and-format-data.html#cb208-1"></a><span class="co"># Add control treatment detail</span></span>
<span id="cb208-2"><a href="import-and-format-data.html#cb208-2"></a>Herm_<span class="dv">17</span>_m &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Herm_<span class="dv">17</span>_m)</span>
<span id="cb208-3"><a href="import-and-format-data.html#cb208-3"></a>Herm_<span class="dv">17</span>_m[Herm_<span class="dv">17</span>_m<span class="op">$</span>n_treatment <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;fungicide_ai&quot;</span>] &lt;-<span class="st"> &quot;control&quot;</span></span>
<span id="cb208-4"><a href="import-and-format-data.html#cb208-4"></a>Herm_<span class="dv">17</span>_m[Herm_<span class="dv">17</span>_m<span class="op">$</span>n_treatment <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,<span class="st">&quot;dose_ai.ha&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb208-5"><a href="import-and-format-data.html#cb208-5"></a>Herm_<span class="dv">17</span>_m[Herm_<span class="dv">17</span>_m<span class="op">$</span>n_treatment <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;trade_name&quot;</span>] &lt;-<span class="st"> &quot;control&quot;</span></span>
<span id="cb208-6"><a href="import-and-format-data.html#cb208-6"></a></span>
<span id="cb208-7"><a href="import-and-format-data.html#cb208-7"></a></span>
<span id="cb208-8"><a href="import-and-format-data.html#cb208-8"></a></span>
<span id="cb208-9"><a href="import-and-format-data.html#cb208-9"></a>Herm_<span class="dv">17</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(Herm_<span class="dv">17</span>_m, PM_MB_means)</span>
<span id="cb208-10"><a href="import-and-format-data.html#cb208-10"></a>Herm_<span class="dv">17</span>_m &lt;-<span class="st"> </span><span class="kw">copy_class</span>(PM_MB_means,Herm_<span class="dv">17</span>_m)</span>
<span id="cb208-11"><a href="import-and-format-data.html#cb208-11"></a></span>
<span id="cb208-12"><a href="import-and-format-data.html#cb208-12"></a></span>
<span id="cb208-13"><a href="import-and-format-data.html#cb208-13"></a><span class="cf">if</span>(<span class="kw">all</span>(<span class="kw">dim</span>(Herm_<span class="dv">17</span>_m) <span class="op">==</span><span class="st"> </span><span class="kw">dim</span>(PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> &quot;mung1617/01&quot;</span>,]))){</span>
<span id="cb208-14"><a href="import-and-format-data.html#cb208-14"></a>PM_MB_means[PM_MB_means<span class="op">$</span>trial_ref <span class="op">==</span><span class="st"> &quot;mung1617/01&quot;</span>,] &lt;-<span class="st"> </span></span>
<span id="cb208-15"><a href="import-and-format-data.html#cb208-15"></a><span class="st">   </span>Herm_<span class="dv">17</span>_m</span>
<span id="cb208-16"><a href="import-and-format-data.html#cb208-16"></a>}<span class="cf">else</span>{<span class="kw">warning</span>(<span class="st">&quot;Dimensions don&#39;t match check data&quot;</span>)}</span>
<span id="cb208-17"><a href="import-and-format-data.html#cb208-17"></a></span>
<span id="cb208-18"><a href="import-and-format-data.html#cb208-18"></a></span>
<span id="cb208-19"><a href="import-and-format-data.html#cb208-19"></a><span class="kw">write.csv</span>(</span>
<span id="cb208-20"><a href="import-and-format-data.html#cb208-20"></a>   Herm_<span class="dv">17</span>_m,</span>
<span id="cb208-21"><a href="import-and-format-data.html#cb208-21"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/Hermitage_17_mean.csv&quot;</span>),</span>
<span id="cb208-22"><a href="import-and-format-data.html#cb208-22"></a>   <span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb208-23"><a href="import-and-format-data.html#cb208-23"></a>)</span></code></pre></div>
</div>
</div>
<div id="wellcamp-2018" class="section level3">
<h3><span class="header-section-number">3.4.13</span> Wellcamp 2018</h3>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="import-and-format-data.html#cb209-1"></a>Well_<span class="dv">18</span> &lt;-</span>
<span id="cb209-2"><a href="import-and-format-data.html#cb209-2"></a><span class="st">   </span><span class="kw">read.xlsx</span>(</span>
<span id="cb209-3"><a href="import-and-format-data.html#cb209-3"></a>      <span class="kw">here</span>(<span class="st">&quot;data/Wellcamp Fungicide x Row Spacing x Plant Population - Experimental Design Fogarty 2018.xlsx&quot;</span>),</span>
<span id="cb209-4"><a href="import-and-format-data.html#cb209-4"></a>      <span class="dt">sheet =</span> <span class="st">&quot;Data&quot;</span>,</span>
<span id="cb209-5"><a href="import-and-format-data.html#cb209-5"></a>      <span class="dt">startRow =</span> <span class="dv">1</span>,</span>
<span id="cb209-6"><a href="import-and-format-data.html#cb209-6"></a>      <span class="dt">colNames =</span> <span class="ot">TRUE</span></span>
<span id="cb209-7"><a href="import-and-format-data.html#cb209-7"></a>   )</span>
<span id="cb209-8"><a href="import-and-format-data.html#cb209-8"></a></span>
<span id="cb209-9"><a href="import-and-format-data.html#cb209-9"></a><span class="kw">colnames</span>(Well_<span class="dv">18</span>)[<span class="dv">13</span><span class="op">:</span><span class="dv">14</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Row.Spacing_ID&quot;</span>, <span class="st">&quot;Fungicide_ID&quot;</span>)</span></code></pre></div>
<div id="define-treatment-data-10" class="section level4">
<h4><span class="header-section-number">3.4.13.1</span> Define treatment data</h4>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="import-and-format-data.html#cb210-1"></a>Well_<span class="dv">18</span>_dat &lt;-<span class="st"> </span>Well_<span class="dv">18</span> <span class="op">%&gt;%</span></span>
<span id="cb210-2"><a href="import-and-format-data.html#cb210-2"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trade_name =</span> </span>
<span id="cb210-3"><a href="import-and-format-data.html#cb210-3"></a>             <span class="kw">case_when</span>(Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;Folicur&quot;</span>,</span>
<span id="cb210-4"><a href="import-and-format-data.html#cb210-4"></a>                       Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &quot;Throttle&quot;</span>,</span>
<span id="cb210-5"><a href="import-and-format-data.html#cb210-5"></a>                       Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &quot;Custodia&quot;</span>,</span>
<span id="cb210-6"><a href="import-and-format-data.html#cb210-6"></a>                       Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb210-7"><a href="import-and-format-data.html#cb210-7"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb210-8"><a href="import-and-format-data.html#cb210-8"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_ai =</span> </span>
<span id="cb210-9"><a href="import-and-format-data.html#cb210-9"></a>             <span class="kw">case_when</span>(Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;tebuconazole&quot;</span>,</span>
<span id="cb210-10"><a href="import-and-format-data.html#cb210-10"></a>                       Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &quot;propiconazole&quot;</span>,</span>
<span id="cb210-11"><a href="import-and-format-data.html#cb210-11"></a>                       Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &quot;200 g/L tebuconazole + 120 g/L azoxystrobin&quot;</span>,</span>
<span id="cb210-12"><a href="import-and-format-data.html#cb210-12"></a>                       Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb210-13"><a href="import-and-format-data.html#cb210-13"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;other&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb210-14"><a href="import-and-format-data.html#cb210-14"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> </span>
<span id="cb210-15"><a href="import-and-format-data.html#cb210-15"></a>             <span class="kw">case_when</span>(Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="dv">60</span>,</span>
<span id="cb210-16"><a href="import-and-format-data.html#cb210-16"></a>                       Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="dv">62</span>,</span>
<span id="cb210-17"><a href="import-and-format-data.html#cb210-17"></a>                       Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">125</span>,</span>
<span id="cb210-18"><a href="import-and-format-data.html#cb210-18"></a>                       Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb210-19"><a href="import-and-format-data.html#cb210-19"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">9999</span>))<span class="op">%&gt;%</span></span>
<span id="cb210-20"><a href="import-and-format-data.html#cb210-20"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">Row.Spacing =</span> </span>
<span id="cb210-21"><a href="import-and-format-data.html#cb210-21"></a>             <span class="kw">case_when</span>(Row.Sp.Trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="fl">0.25</span>,</span>
<span id="cb210-22"><a href="import-and-format-data.html#cb210-22"></a>                       Row.Sp.Trt <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="fl">0.5</span>,</span>
<span id="cb210-23"><a href="import-and-format-data.html#cb210-23"></a>                       Row.Sp.Trt <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb210-24"><a href="import-and-format-data.html#cb210-24"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">9999</span>))<span class="op">%&gt;%</span></span>
<span id="cb210-25"><a href="import-and-format-data.html#cb210-25"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_2 =</span> </span>
<span id="cb210-26"><a href="import-and-format-data.html#cb210-26"></a>             <span class="kw">case_when</span>(Fung.Trt <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-04-16&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb210-27"><a href="import-and-format-data.html#cb210-27"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb210-28"><a href="import-and-format-data.html#cb210-28"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_1 =</span> </span>
<span id="cb210-29"><a href="import-and-format-data.html#cb210-29"></a>             <span class="kw">case_when</span>(Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb210-30"><a href="import-and-format-data.html#cb210-30"></a>                       Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb210-31"><a href="import-and-format-data.html#cb210-31"></a>                       Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb210-32"><a href="import-and-format-data.html#cb210-32"></a>                       Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-03-28&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb210-33"><a href="import-and-format-data.html#cb210-33"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb210-34"><a href="import-and-format-data.html#cb210-34"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">spray_n =</span> </span>
<span id="cb210-35"><a href="import-and-format-data.html#cb210-35"></a>             <span class="kw">case_when</span>(Fung.Trt <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb210-36"><a href="import-and-format-data.html#cb210-36"></a>                       Fung.Trt <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb210-37"><a href="import-and-format-data.html#cb210-37"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA_real_</span>))</span></code></pre></div>
</div>
<div id="input-trial-data-11" class="section level4">
<h4><span class="header-section-number">3.4.13.2</span> Input trial data</h4>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="import-and-format-data.html#cb211-1"></a>Well_<span class="dv">18</span>_dat &lt;-<span class="st"> </span></span>
<span id="cb211-2"><a href="import-and-format-data.html#cb211-2"></a><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">trial_ref =</span> <span class="st">&quot;mung1718/01&quot;</span>,</span>
<span id="cb211-3"><a href="import-and-format-data.html#cb211-3"></a>              <span class="dt">year =</span> <span class="st">&quot;2018&quot;</span>,</span>
<span id="cb211-4"><a href="import-and-format-data.html#cb211-4"></a>              <span class="dt">location =</span> <span class="st">&quot;Wellcamp&quot;</span>,</span>
<span id="cb211-5"><a href="import-and-format-data.html#cb211-5"></a>              <span class="dt">host_genotype =</span> <span class="st">&quot;Jade&quot;</span>,</span>
<span id="cb211-6"><a href="import-and-format-data.html#cb211-6"></a>              <span class="dt">trial_design =</span> <span class="st">&quot;RCB&quot;</span>,</span>
<span id="cb211-7"><a href="import-and-format-data.html#cb211-7"></a>              <span class="dt">plot_length =</span> Well_<span class="dv">18</span>_dat<span class="op">$</span>Row.Length,</span>
<span id="cb211-8"><a href="import-and-format-data.html#cb211-8"></a>              <span class="dt">plot_width =</span> <span class="dv">2</span>,</span>
<span id="cb211-9"><a href="import-and-format-data.html#cb211-9"></a>              <span class="dt">plant_density =</span> Well_<span class="dv">18</span>_dat<span class="op">$</span>Plant.Pop,</span>
<span id="cb211-10"><a href="import-and-format-data.html#cb211-10"></a>              <span class="dt">row_spacing =</span> Well_<span class="dv">18</span>_dat<span class="op">$</span>Row.Spacing,</span>
<span id="cb211-11"><a href="import-and-format-data.html#cb211-11"></a>              <span class="dt">replicate =</span> Well_<span class="dv">18</span>_dat<span class="op">$</span>Rep,</span>
<span id="cb211-12"><a href="import-and-format-data.html#cb211-12"></a>              <span class="dt">planting_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2018-02-13&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb211-13"><a href="import-and-format-data.html#cb211-13"></a>              <span class="dt">emergence_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb211-14"><a href="import-and-format-data.html#cb211-14"></a>              <span class="dt">flowering_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb211-15"><a href="import-and-format-data.html#cb211-15"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb211-16"><a href="import-and-format-data.html#cb211-16"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb211-17"><a href="import-and-format-data.html#cb211-17"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2018-03-21&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb211-18"><a href="import-and-format-data.html#cb211-18"></a>              <span class="dt">trade_name =</span> <span class="kw">as.factor</span>(Well_<span class="dv">18</span>_dat<span class="op">$</span>trade_name),</span>
<span id="cb211-19"><a href="import-and-format-data.html#cb211-19"></a>              <span class="dt">fungicide_ai =</span> Well_<span class="dv">18</span>_dat<span class="op">$</span>fungicide_ai,</span>
<span id="cb211-20"><a href="import-and-format-data.html#cb211-20"></a>              <span class="dt">dose_ai.ha =</span> Well_<span class="dv">18</span>_dat<span class="op">$</span>dose_ai.ha,</span>
<span id="cb211-21"><a href="import-and-format-data.html#cb211-21"></a>              <span class="dt">n_treatment =</span> Well_<span class="dv">18</span>_dat<span class="op">$</span>Treatment,</span>
<span id="cb211-22"><a href="import-and-format-data.html#cb211-22"></a>              <span class="dt">fungicide_application_1 =</span> Well_<span class="dv">18</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb211-23"><a href="import-and-format-data.html#cb211-23"></a>              <span class="dt">fungicide_application_2 =</span> Well_<span class="dv">18</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb211-24"><a href="import-and-format-data.html#cb211-24"></a>              <span class="dt">total_fungicide =</span> Well_<span class="dv">18</span>_dat<span class="op">$</span>spray_n,</span>
<span id="cb211-25"><a href="import-and-format-data.html#cb211-25"></a>              <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2018-05-31&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb211-26"><a href="import-and-format-data.html#cb211-26"></a>              <span class="dt">final_assessment =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2018-05-02&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb211-27"><a href="import-and-format-data.html#cb211-27"></a>              <span class="dt">PM_final_severity =</span> Well_<span class="dv">18</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">IR.2-5-18</span><span class="st">`</span>,</span>
<span id="cb211-28"><a href="import-and-format-data.html#cb211-28"></a>              <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb211-29"><a href="import-and-format-data.html#cb211-29"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">as.numeric</span>(Well_<span class="dv">18</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">Yield./.ha</span><span class="st">`</span>)</span>
<span id="cb211-30"><a href="import-and-format-data.html#cb211-30"></a>              )</span>
<span id="cb211-31"><a href="import-and-format-data.html#cb211-31"></a></span>
<span id="cb211-32"><a href="import-and-format-data.html#cb211-32"></a><span class="co"># Calculate AUDPC</span></span>
<span id="cb211-33"><a href="import-and-format-data.html#cb211-33"></a>Well_<span class="dv">18</span>_dat &lt;-<span class="st"> </span><span class="kw">cbind</span>(Well_<span class="dv">18</span>_dat,</span>
<span id="cb211-34"><a href="import-and-format-data.html#cb211-34"></a>                          <span class="dt">AUDPC =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb211-35"><a href="import-and-format-data.html#cb211-35"></a>                                                   Well_<span class="dv">18</span>[,<span class="kw">c</span>(<span class="st">&quot;IR.23-3-18&quot;</span>,<span class="st">&quot;IR.5-4-18&quot;</span>, <span class="st">&quot;IR.11-4-18&quot;</span>, <span class="st">&quot;IR.18-4-18&quot;</span>,<span class="st">&quot;IR.26-4-18&quot;</span>,<span class="st">&quot;IR.2-5-18&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb211-36"><a href="import-and-format-data.html#cb211-36"></a>                                        <span class="dv">1</span>, </span>
<span id="cb211-37"><a href="import-and-format-data.html#cb211-37"></a>                                        <span class="dt">FUN =</span> audpc, </span>
<span id="cb211-38"><a href="import-and-format-data.html#cb211-38"></a>                                        <span class="dt">dates =</span> <span class="kw">c</span>((Well_<span class="dv">18</span>_dat<span class="op">$</span>first_sign_disease[<span class="dv">1</span>]<span class="op">-</span><span class="dv">7</span>)<span class="op">-</span></span>
<span id="cb211-39"><a href="import-and-format-data.html#cb211-39"></a><span class="st">                                                     </span>Well_<span class="dv">18</span>_dat<span class="op">$</span>planting_date[<span class="dv">1</span>],</span>
<span id="cb211-40"><a href="import-and-format-data.html#cb211-40"></a>                                                  <span class="dv">38</span>,<span class="dv">51</span> ,<span class="dv">57</span>,<span class="dv">64</span>,<span class="dv">72</span>,<span class="dv">78</span>)</span>
<span id="cb211-41"><a href="import-and-format-data.html#cb211-41"></a>                                        ),</span>
<span id="cb211-42"><a href="import-and-format-data.html#cb211-42"></a>                     <span class="dt">AUDPS =</span> <span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,</span>
<span id="cb211-43"><a href="import-and-format-data.html#cb211-43"></a>                                                   Well_<span class="dv">18</span>[,<span class="kw">c</span>(<span class="st">&quot;IR.23-3-18&quot;</span>,<span class="st">&quot;IR.5-4-18&quot;</span>, <span class="st">&quot;IR.11-4-18&quot;</span>, <span class="st">&quot;IR.18-4-18&quot;</span>,<span class="st">&quot;IR.26-4-18&quot;</span>,<span class="st">&quot;IR.2-5-18&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb211-44"><a href="import-and-format-data.html#cb211-44"></a>                                        <span class="dv">1</span>, </span>
<span id="cb211-45"><a href="import-and-format-data.html#cb211-45"></a>                                        <span class="dt">FUN =</span> audps, </span>
<span id="cb211-46"><a href="import-and-format-data.html#cb211-46"></a>                                        <span class="dt">dates =</span> <span class="kw">c</span>((Well_<span class="dv">18</span>_dat<span class="op">$</span>first_sign_disease[<span class="dv">1</span>]<span class="op">-</span><span class="dv">7</span>)<span class="op">-</span></span>
<span id="cb211-47"><a href="import-and-format-data.html#cb211-47"></a><span class="st">                                                     </span>Well_<span class="dv">18</span>_dat<span class="op">$</span>planting_date[<span class="dv">1</span>],</span>
<span id="cb211-48"><a href="import-and-format-data.html#cb211-48"></a>                                                  <span class="dv">38</span>,<span class="dv">51</span> ,<span class="dv">57</span>,<span class="dv">64</span>,<span class="dv">72</span>,<span class="dv">78</span>)</span>
<span id="cb211-49"><a href="import-and-format-data.html#cb211-49"></a>                                        )</span>
<span id="cb211-50"><a href="import-and-format-data.html#cb211-50"></a>                          )</span></code></pre></div>
</div>
<div id="calculating-treatment-means-5" class="section level4">
<h4><span class="header-section-number">3.4.13.3</span> Calculating treatment means</h4>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="import-and-format-data.html#cb212-1"></a>Well_<span class="dv">18</span>_m &lt;-<span class="st"> </span>Well_<span class="dv">18</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb212-2"><a href="import-and-format-data.html#cb212-2"></a><span class="st">   </span><span class="kw">group_by</span>(host_genotype, n_treatment, row_spacing, fungicide_ai) <span class="op">%&gt;%</span></span>
<span id="cb212-3"><a href="import-and-format-data.html#cb212-3"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb212-4"><a href="import-and-format-data.html#cb212-4"></a>             <span class="dt">year =</span> <span class="kw">unique</span>(year),</span>
<span id="cb212-5"><a href="import-and-format-data.html#cb212-5"></a>             <span class="dt">location =</span> <span class="kw">unique</span>(location),</span>
<span id="cb212-6"><a href="import-and-format-data.html#cb212-6"></a>             <span class="dt">trial_design =</span> <span class="kw">unique</span>(trial_design),</span>
<span id="cb212-7"><a href="import-and-format-data.html#cb212-7"></a>             <span class="dt">trade_name =</span> <span class="kw">unique</span>(trade_name),</span>
<span id="cb212-8"><a href="import-and-format-data.html#cb212-8"></a>             <span class="dt">dose_ai.ha =</span> <span class="kw">unique</span>(dose_ai.ha),</span>
<span id="cb212-9"><a href="import-and-format-data.html#cb212-9"></a>             <span class="dt">trial_ref =</span> <span class="kw">unique</span>(trial_ref),</span>
<span id="cb212-10"><a href="import-and-format-data.html#cb212-10"></a>             <span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb212-11"><a href="import-and-format-data.html#cb212-11"></a>             <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb212-12"><a href="import-and-format-data.html#cb212-12"></a>             <span class="dt">plant_density =</span> <span class="kw">mean</span>(plant_density, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb212-13"><a href="import-and-format-data.html#cb212-13"></a>             <span class="dt">replicates =</span> <span class="kw">length</span>(<span class="kw">as.numeric</span>(replicate)),</span>
<span id="cb212-14"><a href="import-and-format-data.html#cb212-14"></a>             <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb212-15"><a href="import-and-format-data.html#cb212-15"></a>             <span class="dt">emergence_date =</span> <span class="kw">unique</span>(emergence_date),</span>
<span id="cb212-16"><a href="import-and-format-data.html#cb212-16"></a>             <span class="dt">flowering_date =</span> <span class="kw">unique</span>(flowering_date),</span>
<span id="cb212-17"><a href="import-and-format-data.html#cb212-17"></a>             <span class="dt">pod_fill_date =</span> <span class="kw">unique</span>(pod_fill_date),</span>
<span id="cb212-18"><a href="import-and-format-data.html#cb212-18"></a>             <span class="dt">mid_late_pod_fill =</span> <span class="kw">unique</span>(mid_late_pod_fill),</span>
<span id="cb212-19"><a href="import-and-format-data.html#cb212-19"></a>             <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb212-20"><a href="import-and-format-data.html#cb212-20"></a>             <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb212-21"><a href="import-and-format-data.html#cb212-21"></a>             <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb212-22"><a href="import-and-format-data.html#cb212-22"></a>             <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb212-23"><a href="import-and-format-data.html#cb212-23"></a>             <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb212-24"><a href="import-and-format-data.html#cb212-24"></a>             <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb212-25"><a href="import-and-format-data.html#cb212-25"></a>             <span class="dt">PM_final_severity =</span> <span class="kw">mean</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb212-26"><a href="import-and-format-data.html#cb212-26"></a>             <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb212-27"><a href="import-and-format-data.html#cb212-27"></a>             <span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="co"># Generates NAs repeated below</span></span>
<span id="cb212-28"><a href="import-and-format-data.html#cb212-28"></a>             <span class="dt">D_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb212-29"><a href="import-and-format-data.html#cb212-29"></a>             <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb212-30"><a href="import-and-format-data.html#cb212-30"></a>             <span class="dt">raw_graded =</span> <span class="ot">NA</span>,</span>
<span id="cb212-31"><a href="import-and-format-data.html#cb212-31"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb212-32"><a href="import-and-format-data.html#cb212-32"></a>             <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb212-33"><a href="import-and-format-data.html#cb212-33"></a>             <span class="dt">AUDPC_m =</span> <span class="kw">mean</span>(AUDPC),</span>
<span id="cb212-34"><a href="import-and-format-data.html#cb212-34"></a>             <span class="dt">AUDPC_sd =</span> <span class="kw">sd</span>(AUDPC),</span>
<span id="cb212-35"><a href="import-and-format-data.html#cb212-35"></a>             <span class="dt">AUDPS_m =</span> <span class="kw">mean</span>(AUDPS),</span>
<span id="cb212-36"><a href="import-and-format-data.html#cb212-36"></a>             <span class="dt">AUDPS_sd =</span> <span class="kw">sd</span>(AUDPS),</span>
<span id="cb212-37"><a href="import-and-format-data.html#cb212-37"></a>             <span class="dt">Inc_Ms =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC <span class="op">~</span><span class="st"> </span></span>
<span id="cb212-38"><a href="import-and-format-data.html#cb212-38"></a><span class="st">                                  </span><span class="kw">factor</span>(n_treatment) <span class="op">+</span><span class="st"> </span>fungicide_ai <span class="op">+</span><span class="st"> </span>row_spacing, </span>
<span id="cb212-39"><a href="import-and-format-data.html#cb212-39"></a>                               <span class="dt">data =</span> <span class="kw">subset</span>(Well_<span class="dv">18</span>_dat, trade_name <span class="op">!=</span><span class="st"> &quot;Custodia&quot;</span>)))[<span class="dv">1</span>,<span class="dv">3</span>], <span class="co"># of only triazoles</span></span>
<span id="cb212-40"><a href="import-and-format-data.html#cb212-40"></a>             <span class="dt">Y_Msquare =</span> <span class="kw">anova</span>(<span class="kw">lm</span>(grain_yield.t.ha. <span class="op">~</span><span class="st"> </span></span>
<span id="cb212-41"><a href="import-and-format-data.html#cb212-41"></a><span class="st">                                  </span><span class="kw">factor</span>(n_treatment) <span class="op">+</span><span class="st"> </span>fungicide_ai <span class="op">+</span><span class="st"> </span>row_spacing, </span>
<span id="cb212-42"><a href="import-and-format-data.html#cb212-42"></a>                               <span class="dt">data =</span> <span class="kw">subset</span>(Well_<span class="dv">18</span>_dat, trade_name <span class="op">!=</span><span class="st"> &quot;Custodia&quot;</span>)))[<span class="dv">1</span>,<span class="dv">3</span>] <span class="co"># of only triazoles</span></span>
<span id="cb212-43"><a href="import-and-format-data.html#cb212-43"></a>   )</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;host_genotype&#39;, &#39;n_treatment&#39;, &#39;row_spacing&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="import-and-format-data.html#cb214-1"></a><span class="co"># For some weird reason standard deviations are coming back NA in the code above</span></span>
<span id="cb214-2"><a href="import-and-format-data.html#cb214-2"></a>Well_<span class="dv">18</span>_m[,<span class="kw">c</span>(<span class="st">&quot;n_treatment&quot;</span>,<span class="st">&quot;row_spacing&quot;</span>, <span class="st">&quot;disease_error&quot;</span>,<span class="st">&quot;yield_error&quot;</span>)] &lt;-<span class="st"> </span></span>
<span id="cb214-3"><a href="import-and-format-data.html#cb214-3"></a><span class="st">   </span>Well_<span class="dv">18</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb214-4"><a href="import-and-format-data.html#cb214-4"></a><span class="st">   </span><span class="kw">group_by</span>(n_treatment, row_spacing, fungicide_ai) <span class="op">%&gt;%</span></span>
<span id="cb214-5"><a href="import-and-format-data.html#cb214-5"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb214-6"><a href="import-and-format-data.html#cb214-6"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb214-7"><a href="import-and-format-data.html#cb214-7"></a><span class="st">   </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&quot;disease_error&quot;</span>,<span class="st">&quot;yield_error&quot;</span>))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;n_treatment&#39;, &#39;row_spacing&#39; (override with `.groups` argument)</code></pre>
<pre><code>## Adding missing grouping variables: `n_treatment`, `row_spacing`</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="import-and-format-data.html#cb217-1"></a>Well_<span class="dv">18</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(Well_<span class="dv">18</span>_m, PM_MB_means)</span>
<span id="cb217-2"><a href="import-and-format-data.html#cb217-2"></a>Well_<span class="dv">18</span>_m &lt;-<span class="st"> </span><span class="kw">copy_class</span>(PM_MB_means,Well_<span class="dv">18</span>_m)</span>
<span id="cb217-3"><a href="import-and-format-data.html#cb217-3"></a></span>
<span id="cb217-4"><a href="import-and-format-data.html#cb217-4"></a><span class="co"># insert new calculations into data</span></span>
<span id="cb217-5"><a href="import-and-format-data.html#cb217-5"></a>PM_MB_means &lt;-<span class="st"> </span></span>
<span id="cb217-6"><a href="import-and-format-data.html#cb217-6"></a><span class="st">   </span><span class="kw">replace_data</span>(<span class="dt">template_data =</span> PM_MB_means, </span>
<span id="cb217-7"><a href="import-and-format-data.html#cb217-7"></a>                            <span class="dt">new_data =</span> Well_<span class="dv">18</span>_m, </span>
<span id="cb217-8"><a href="import-and-format-data.html#cb217-8"></a>                            <span class="dt">new_data_column =</span> <span class="kw">c</span>(<span class="st">&quot;total_fungicide&quot;</span>,<span class="st">&quot;AUDPC_m&quot;</span>, <span class="st">&quot;AUDPC_sd&quot;</span>),</span>
<span id="cb217-9"><a href="import-and-format-data.html#cb217-9"></a>                            <span class="dt">filter_cols =</span> <span class="kw">c</span>(<span class="st">&quot;trial_ref&quot;</span>,<span class="st">&quot;year&quot;</span>,<span class="st">&quot;location&quot;</span>,<span class="st">&quot;n_treatment&quot;</span>))</span></code></pre></div>
<pre><code>## No data changed 0/24</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="import-and-format-data.html#cb219-1"></a><span class="kw">write.csv</span>(</span>
<span id="cb219-2"><a href="import-and-format-data.html#cb219-2"></a>   Well_<span class="dv">18</span>_m,</span>
<span id="cb219-3"><a href="import-and-format-data.html#cb219-3"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/Wellcamp_18_mean.csv&quot;</span>),</span>
<span id="cb219-4"><a href="import-and-format-data.html#cb219-4"></a>   <span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb219-5"><a href="import-and-format-data.html#cb219-5"></a>)</span></code></pre></div>
</div>
</div>
<div id="hermitage-2019" class="section level3">
<h3><span class="header-section-number">3.4.14</span> Hermitage 2019</h3>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="import-and-format-data.html#cb220-1"></a>PM_MB_<span class="dv">19</span> &lt;-</span>
<span id="cb220-2"><a href="import-and-format-data.html#cb220-2"></a><span class="st">   </span><span class="kw">read.xlsx</span>(</span>
<span id="cb220-3"><a href="import-and-format-data.html#cb220-3"></a>      <span class="kw">here</span>(<span class="st">&quot;data/1901 Mungbean powdery mildew disease and yeild data.xlsx&quot;</span>),</span>
<span id="cb220-4"><a href="import-and-format-data.html#cb220-4"></a>      <span class="dt">startRow =</span> <span class="dv">2</span>,</span>
<span id="cb220-5"><a href="import-and-format-data.html#cb220-5"></a>      <span class="dt">cols =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">21</span>)</span>
<span id="cb220-6"><a href="import-and-format-data.html#cb220-6"></a>   )</span>
<span id="cb220-7"><a href="import-and-format-data.html#cb220-7"></a></span>
<span id="cb220-8"><a href="import-and-format-data.html#cb220-8"></a><span class="co"># Remove these plots as the results can&#39;t be trusted</span></span>
<span id="cb220-9"><a href="import-and-format-data.html#cb220-9"></a>PM_MB_<span class="dv">19</span> &lt;-<span class="st"> </span><span class="kw">subset</span>(PM_MB_<span class="dv">19</span>, Harvest.Plot.Number <span class="op">!=</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb220-10"><a href="import-and-format-data.html#cb220-10"></a>PM_MB_<span class="dv">19</span> &lt;-<span class="st"> </span><span class="kw">subset</span>(PM_MB_<span class="dv">19</span>, Harvest.Plot.Number <span class="op">!=</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb220-11"><a href="import-and-format-data.html#cb220-11"></a></span>
<span id="cb220-12"><a href="import-and-format-data.html#cb220-12"></a><span class="co"># Calculate area under the disease progress curve</span></span>
<span id="cb220-13"><a href="import-and-format-data.html#cb220-13"></a>PM_MB_<span class="dv">19</span><span class="op">$</span>AUDPC &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,PM_MB_<span class="dv">19</span>[,<span class="kw">c</span>(<span class="st">&quot;15-4-19.Incedence&quot;</span>, <span class="st">&quot;23-4-19.Incedence&quot;</span>, <span class="st">&quot;1-5-19.Incedence&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),<span class="dv">1</span>,<span class="dt">FUN =</span> audpc, <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">70</span>,<span class="dv">78</span>,<span class="dv">86</span>))</span>
<span id="cb220-14"><a href="import-and-format-data.html#cb220-14"></a>PM_MB_<span class="dv">19</span><span class="op">$</span>AUDPS &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,PM_MB_<span class="dv">19</span>[,<span class="kw">c</span>(<span class="st">&quot;15-4-19.Incedence&quot;</span>, <span class="st">&quot;23-4-19.Incedence&quot;</span>, <span class="st">&quot;1-5-19.Incedence&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),<span class="dv">1</span>,<span class="dt">FUN =</span> audps, <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">70</span>,<span class="dv">78</span>,<span class="dv">86</span>))</span>
<span id="cb220-15"><a href="import-and-format-data.html#cb220-15"></a></span>
<span id="cb220-16"><a href="import-and-format-data.html#cb220-16"></a><span class="co"># Calculate area under the disease progress curve for plots which were not assessed at on 2019-05-01</span></span>
<span id="cb220-17"><a href="import-and-format-data.html#cb220-17"></a>PM_MB_<span class="dv">19</span>[<span class="kw">is.na</span>(PM_MB_<span class="dv">19</span><span class="op">$</span><span class="st">`</span><span class="dt">1-5-19.Incedence</span><span class="st">`</span>),<span class="st">&quot;AUDPC&quot;</span>] &lt;-<span class="st"> </span></span>
<span id="cb220-18"><a href="import-and-format-data.html#cb220-18"></a><span class="st">   </span><span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,PM_MB_<span class="dv">19</span>[<span class="kw">is.na</span>(PM_MB_<span class="dv">19</span><span class="op">$</span><span class="st">`</span><span class="dt">1-5-19.Incedence</span><span class="st">`</span>),</span>
<span id="cb220-19"><a href="import-and-format-data.html#cb220-19"></a>                                      <span class="kw">c</span>(<span class="st">&quot;15-4-19.Incedence&quot;</span>, <span class="st">&quot;23-4-19.Incedence&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb220-20"><a href="import-and-format-data.html#cb220-20"></a>         <span class="dv">1</span>,<span class="dt">FUN =</span> audpc,</span>
<span id="cb220-21"><a href="import-and-format-data.html#cb220-21"></a>         <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">70</span>,<span class="dv">78</span>))</span>
<span id="cb220-22"><a href="import-and-format-data.html#cb220-22"></a>PM_MB_<span class="dv">19</span>[<span class="kw">is.na</span>(PM_MB_<span class="dv">19</span><span class="op">$</span><span class="st">`</span><span class="dt">1-5-19.Incedence</span><span class="st">`</span>),<span class="st">&quot;AUDPS&quot;</span>] &lt;-<span class="st"> </span></span>
<span id="cb220-23"><a href="import-and-format-data.html#cb220-23"></a><span class="st">   </span><span class="kw">apply</span>(<span class="kw">data.frame</span>(<span class="dt">zero =</span> <span class="dv">0</span>,PM_MB_<span class="dv">19</span>[<span class="kw">is.na</span>(PM_MB_<span class="dv">19</span><span class="op">$</span><span class="st">`</span><span class="dt">1-5-19.Incedence</span><span class="st">`</span>),</span>
<span id="cb220-24"><a href="import-and-format-data.html#cb220-24"></a>                                      <span class="kw">c</span>(<span class="st">&quot;15-4-19.Incedence&quot;</span>, <span class="st">&quot;23-4-19.Incedence&quot;</span>)]<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb220-25"><a href="import-and-format-data.html#cb220-25"></a>         <span class="dv">1</span>,<span class="dt">FUN =</span> audps, </span>
<span id="cb220-26"><a href="import-and-format-data.html#cb220-26"></a>         <span class="dt">dates =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">70</span>,<span class="dv">78</span>))</span></code></pre></div>
<div id="define-treatment-data-11" class="section level4">
<h4><span class="header-section-number">3.4.14.1</span> Define treatment data</h4>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="import-and-format-data.html#cb221-1"></a>Herm_<span class="dv">19</span>_dat &lt;-<span class="st"> </span>PM_MB_<span class="dv">19</span> <span class="op">%&gt;%</span></span>
<span id="cb221-2"><a href="import-and-format-data.html#cb221-2"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_1 =</span> </span>
<span id="cb221-3"><a href="import-and-format-data.html#cb221-3"></a>             <span class="kw">case_when</span>(<span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-04-15&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb221-4"><a href="import-and-format-data.html#cb221-4"></a>                       <span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-04-15&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb221-5"><a href="import-and-format-data.html#cb221-5"></a>                       <span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-04-23&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb221-6"><a href="import-and-format-data.html#cb221-6"></a>                       <span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb221-7"><a href="import-and-format-data.html#cb221-7"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb221-8"><a href="import-and-format-data.html#cb221-8"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_application_2 =</span> </span>
<span id="cb221-9"><a href="import-and-format-data.html#cb221-9"></a>             <span class="kw">case_when</span>(<span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-04-29&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb221-10"><a href="import-and-format-data.html#cb221-10"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb221-11"><a href="import-and-format-data.html#cb221-11"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">spray_n =</span> </span>
<span id="cb221-12"><a href="import-and-format-data.html#cb221-12"></a>             <span class="kw">case_when</span>(<span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb221-13"><a href="import-and-format-data.html#cb221-13"></a>                       <span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb221-14"><a href="import-and-format-data.html#cb221-14"></a>                       <span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb221-15"><a href="import-and-format-data.html#cb221-15"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>))<span class="op">%&gt;%</span></span>
<span id="cb221-16"><a href="import-and-format-data.html#cb221-16"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trial_ref =</span> </span>
<span id="cb221-17"><a href="import-and-format-data.html#cb221-17"></a>             <span class="kw">case_when</span>(TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;mung1819/01&quot;</span>,</span>
<span id="cb221-18"><a href="import-and-format-data.html#cb221-18"></a>                       TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &quot;mung1819/02&quot;</span>,</span>
<span id="cb221-19"><a href="import-and-format-data.html#cb221-19"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA_character_</span>))<span class="op">%&gt;%</span></span>
<span id="cb221-20"><a href="import-and-format-data.html#cb221-20"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">planting_date =</span> </span>
<span id="cb221-21"><a href="import-and-format-data.html#cb221-21"></a>             <span class="kw">case_when</span>(TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-02-04&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb221-22"><a href="import-and-format-data.html#cb221-22"></a>                       TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-02-18&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb221-23"><a href="import-and-format-data.html#cb221-23"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb221-24"><a href="import-and-format-data.html#cb221-24"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">emergence_date =</span> </span>
<span id="cb221-25"><a href="import-and-format-data.html#cb221-25"></a>             <span class="kw">case_when</span>(TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-02-11&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb221-26"><a href="import-and-format-data.html#cb221-26"></a>                       TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-02-25&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb221-27"><a href="import-and-format-data.html#cb221-27"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb221-28"><a href="import-and-format-data.html#cb221-28"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">final_assessment =</span> </span>
<span id="cb221-29"><a href="import-and-format-data.html#cb221-29"></a>             <span class="kw">case_when</span>(TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-04-24&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb221-30"><a href="import-and-format-data.html#cb221-30"></a>                       TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-05-01&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb221-31"><a href="import-and-format-data.html#cb221-31"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="ot">NA</span>)))<span class="op">%&gt;%</span></span>
<span id="cb221-32"><a href="import-and-format-data.html#cb221-32"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">PM_final_severity =</span> </span>
<span id="cb221-33"><a href="import-and-format-data.html#cb221-33"></a>             <span class="kw">case_when</span>(<span class="kw">is.na</span>(<span class="st">`</span><span class="dt">1-5-19.Incedence</span><span class="st">`</span>) <span class="op">~</span><span class="st"> `</span><span class="dt">23-4-19.Incedence</span><span class="st">`</span>,</span>
<span id="cb221-34"><a href="import-and-format-data.html#cb221-34"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> `</span><span class="dt">1-5-19.Incedence</span><span class="st">`</span>))<span class="op">%&gt;%</span></span>
<span id="cb221-35"><a href="import-and-format-data.html#cb221-35"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">trade_name =</span> </span>
<span id="cb221-36"><a href="import-and-format-data.html#cb221-36"></a>             <span class="kw">case_when</span>(<span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb221-37"><a href="import-and-format-data.html#cb221-37"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;Folicur&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb221-38"><a href="import-and-format-data.html#cb221-38"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">fungicide_ai =</span> </span>
<span id="cb221-39"><a href="import-and-format-data.html#cb221-39"></a>             <span class="kw">case_when</span>(<span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> &quot;control&quot;</span>,</span>
<span id="cb221-40"><a href="import-and-format-data.html#cb221-40"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;tebuconazole&quot;</span>))<span class="op">%&gt;%</span></span>
<span id="cb221-41"><a href="import-and-format-data.html#cb221-41"></a><span class="st">   </span></span>
<span id="cb221-42"><a href="import-and-format-data.html#cb221-42"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dose_ai.ha =</span> </span>
<span id="cb221-43"><a href="import-and-format-data.html#cb221-43"></a>             <span class="kw">case_when</span>(<span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</span>
<span id="cb221-44"><a href="import-and-format-data.html#cb221-44"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">62</span>))<span class="op">%&gt;%</span></span>
<span id="cb221-45"><a href="import-and-format-data.html#cb221-45"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">Y_Msquare =</span> </span>
<span id="cb221-46"><a href="import-and-format-data.html#cb221-46"></a>             <span class="kw">case_when</span>(TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(Yeild<span class="op">/</span><span class="dv">1000</span> <span class="op">~</span><span class="st"> </span></span>
<span id="cb221-47"><a href="import-and-format-data.html#cb221-47"></a><span class="st">                                  </span><span class="kw">factor</span>(<span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span>) , </span>
<span id="cb221-48"><a href="import-and-format-data.html#cb221-48"></a>                               <span class="dt">data =</span> PM_MB_<span class="dv">19</span>[PM_MB_<span class="dv">19</span><span class="op">$</span>TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,]))[<span class="dv">1</span>,<span class="dv">3</span>],</span>
<span id="cb221-49"><a href="import-and-format-data.html#cb221-49"></a>                       TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(Yeild<span class="op">/</span><span class="dv">1000</span> <span class="op">~</span><span class="st"> </span></span>
<span id="cb221-50"><a href="import-and-format-data.html#cb221-50"></a><span class="st">                                  </span><span class="kw">factor</span>(<span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span>) , </span>
<span id="cb221-51"><a href="import-and-format-data.html#cb221-51"></a>                               <span class="dt">data =</span> PM_MB_<span class="dv">19</span>[PM_MB_<span class="dv">19</span><span class="op">$</span>TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">2</span>,]))[<span class="dv">1</span>,<span class="dv">3</span>],</span>
<span id="cb221-52"><a href="import-and-format-data.html#cb221-52"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA_real_</span>))<span class="op">%&gt;%</span></span>
<span id="cb221-53"><a href="import-and-format-data.html#cb221-53"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">Inc_Ms =</span> </span>
<span id="cb221-54"><a href="import-and-format-data.html#cb221-54"></a>             <span class="kw">case_when</span>(TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC <span class="op">~</span><span class="st"> </span></span>
<span id="cb221-55"><a href="import-and-format-data.html#cb221-55"></a><span class="st">                                  </span><span class="kw">factor</span>(<span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span>) , </span>
<span id="cb221-56"><a href="import-and-format-data.html#cb221-56"></a>                               <span class="dt">data =</span> PM_MB_<span class="dv">19</span>[PM_MB_<span class="dv">19</span><span class="op">$</span>TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,]))[<span class="dv">1</span>,<span class="dv">3</span>],</span>
<span id="cb221-57"><a href="import-and-format-data.html#cb221-57"></a>                       TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(AUDPC <span class="op">~</span><span class="st"> </span></span>
<span id="cb221-58"><a href="import-and-format-data.html#cb221-58"></a><span class="st">                                  </span><span class="kw">factor</span>(<span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span>) , </span>
<span id="cb221-59"><a href="import-and-format-data.html#cb221-59"></a>                               <span class="dt">data =</span> PM_MB_<span class="dv">19</span>[PM_MB_<span class="dv">19</span><span class="op">$</span>TOS.NUM <span class="op">==</span><span class="st"> </span><span class="dv">2</span>,]))[<span class="dv">1</span>,<span class="dv">3</span>],</span>
<span id="cb221-60"><a href="import-and-format-data.html#cb221-60"></a>                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA_real_</span>))</span></code></pre></div>
</div>
<div id="input-trial-data-12" class="section level4">
<h4><span class="header-section-number">3.4.14.2</span> Input trial data</h4>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="import-and-format-data.html#cb222-1"></a>Herm_<span class="dv">19</span>_dat &lt;-<span class="st"> </span></span>
<span id="cb222-2"><a href="import-and-format-data.html#cb222-2"></a><span class="st">   </span><span class="kw">data.frame</span>(<span class="dt">trial_ref =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>trial_ref,</span>
<span id="cb222-3"><a href="import-and-format-data.html#cb222-3"></a>              <span class="dt">year =</span> <span class="st">&quot;2019&quot;</span>,</span>
<span id="cb222-4"><a href="import-and-format-data.html#cb222-4"></a>              <span class="dt">location =</span> <span class="st">&quot;Hermitage&quot;</span>,</span>
<span id="cb222-5"><a href="import-and-format-data.html#cb222-5"></a>              <span class="dt">host_genotype =</span> <span class="st">&quot;Jade&quot;</span>,</span>
<span id="cb222-6"><a href="import-and-format-data.html#cb222-6"></a>              <span class="dt">trial_design =</span> <span class="st">&quot;RCB&quot;</span>,</span>
<span id="cb222-7"><a href="import-and-format-data.html#cb222-7"></a>              <span class="dt">plot_length =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>Plot.Lengths,</span>
<span id="cb222-8"><a href="import-and-format-data.html#cb222-8"></a>              <span class="dt">plot_width =</span> <span class="dv">2</span>,</span>
<span id="cb222-9"><a href="import-and-format-data.html#cb222-9"></a>              <span class="dt">plant_density =</span> <span class="ot">NA_character_</span>,</span>
<span id="cb222-10"><a href="import-and-format-data.html#cb222-10"></a>              <span class="dt">row_spacing =</span> <span class="fl">0.25</span>,</span>
<span id="cb222-11"><a href="import-and-format-data.html#cb222-11"></a>              <span class="dt">replicate =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>Rep.Num,</span>
<span id="cb222-12"><a href="import-and-format-data.html#cb222-12"></a>              <span class="dt">planting_date =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>planting_date,</span>
<span id="cb222-13"><a href="import-and-format-data.html#cb222-13"></a>              <span class="dt">emergence_date =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>emergence_date,</span>
<span id="cb222-14"><a href="import-and-format-data.html#cb222-14"></a>              <span class="dt">flowering_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb222-15"><a href="import-and-format-data.html#cb222-15"></a>              <span class="dt">pod_fill_date =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb222-16"><a href="import-and-format-data.html#cb222-16"></a>              <span class="dt">mid_late_pod_fill =</span> <span class="kw">as.Date</span>(<span class="ot">NA</span>),</span>
<span id="cb222-17"><a href="import-and-format-data.html#cb222-17"></a>              <span class="dt">first_sign_disease =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2018-04-12&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb222-18"><a href="import-and-format-data.html#cb222-18"></a>              <span class="dt">trade_name =</span> <span class="kw">as.factor</span>(Herm_<span class="dv">19</span>_dat<span class="op">$</span>trade_name),</span>
<span id="cb222-19"><a href="import-and-format-data.html#cb222-19"></a>              <span class="dt">fungicide_ai =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>fungicide_ai,</span>
<span id="cb222-20"><a href="import-and-format-data.html#cb222-20"></a>              <span class="dt">dose_ai.ha =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>dose_ai.ha,</span>
<span id="cb222-21"><a href="import-and-format-data.html#cb222-21"></a>              <span class="dt">n_treatment =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span><span class="st">`</span><span class="dt">T/ment.NUM</span><span class="st">`</span>,</span>
<span id="cb222-22"><a href="import-and-format-data.html#cb222-22"></a>              <span class="dt">fungicide_application_1 =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">1</span>,</span>
<span id="cb222-23"><a href="import-and-format-data.html#cb222-23"></a>              <span class="dt">fungicide_application_2 =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>fungicide_application_<span class="dv">2</span>,</span>
<span id="cb222-24"><a href="import-and-format-data.html#cb222-24"></a>              <span class="dt">total_fungicide =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>spray_n,</span>
<span id="cb222-25"><a href="import-and-format-data.html#cb222-25"></a>              <span class="dt">harvest_date =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2018-05-22&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>),</span>
<span id="cb222-26"><a href="import-and-format-data.html#cb222-26"></a>              <span class="dt">final_assessment =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>final_assessment,</span>
<span id="cb222-27"><a href="import-and-format-data.html#cb222-27"></a>              <span class="dt">PM_final_severity =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>PM_final_severity,</span>
<span id="cb222-28"><a href="import-and-format-data.html#cb222-28"></a>              <span class="dt">rating_scale =</span> <span class="st">&quot;1-9&quot;</span>,</span>
<span id="cb222-29"><a href="import-and-format-data.html#cb222-29"></a>              <span class="dt">grain_yield.t.ha. =</span> <span class="kw">as.numeric</span>(Herm_<span class="dv">19</span>_dat<span class="op">$</span>Yeild)<span class="op">/</span><span class="dv">1000</span>,</span>
<span id="cb222-30"><a href="import-and-format-data.html#cb222-30"></a>              <span class="dt">Y_Msquare =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>Y_Msquare,</span>
<span id="cb222-31"><a href="import-and-format-data.html#cb222-31"></a>              <span class="dt">Inc_Ms =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>Inc_Ms,</span>
<span id="cb222-32"><a href="import-and-format-data.html#cb222-32"></a>              <span class="dt">AUDPC =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>AUDPC,</span>
<span id="cb222-33"><a href="import-and-format-data.html#cb222-33"></a>              <span class="dt">AUDPS =</span> Herm_<span class="dv">19</span>_dat<span class="op">$</span>AUDPS</span>
<span id="cb222-34"><a href="import-and-format-data.html#cb222-34"></a>              )</span></code></pre></div>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="import-and-format-data.html#cb223-1"></a>Herm_<span class="dv">19</span>_m &lt;-<span class="st"> </span>Herm_<span class="dv">19</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb223-2"><a href="import-and-format-data.html#cb223-2"></a><span class="st">   </span><span class="kw">group_by</span>(trial_ref, n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb223-3"><a href="import-and-format-data.html#cb223-3"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">year =</span> <span class="kw">unique</span>(year),</span>
<span id="cb223-4"><a href="import-and-format-data.html#cb223-4"></a>             <span class="dt">location =</span> <span class="kw">unique</span>(location),</span>
<span id="cb223-5"><a href="import-and-format-data.html#cb223-5"></a>             <span class="dt">host_genotype =</span> <span class="st">&quot;Jade&quot;</span>,</span>
<span id="cb223-6"><a href="import-and-format-data.html#cb223-6"></a>             <span class="dt">trial_design =</span> <span class="kw">unique</span>(trial_design),</span>
<span id="cb223-7"><a href="import-and-format-data.html#cb223-7"></a>             <span class="dt">trade_name =</span> <span class="kw">unique</span>(trade_name),</span>
<span id="cb223-8"><a href="import-and-format-data.html#cb223-8"></a>             <span class="dt">dose_ai.ha =</span> <span class="kw">unique</span>(dose_ai.ha),</span>
<span id="cb223-9"><a href="import-and-format-data.html#cb223-9"></a>             <span class="dt">plot_length.m. =</span> <span class="kw">mean</span>(plot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb223-10"><a href="import-and-format-data.html#cb223-10"></a>             <span class="dt">plot_width.m. =</span> <span class="kw">mean</span>(plot_width, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb223-11"><a href="import-and-format-data.html#cb223-11"></a>             <span class="dt">plant_density =</span> <span class="st">&quot;40k&quot;</span>,</span>
<span id="cb223-12"><a href="import-and-format-data.html#cb223-12"></a>             <span class="dt">row_spacing =</span> <span class="kw">unique</span>(row_spacing),</span>
<span id="cb223-13"><a href="import-and-format-data.html#cb223-13"></a>             <span class="dt">replicates =</span> <span class="kw">length</span>(<span class="kw">as.numeric</span>(replicate)),</span>
<span id="cb223-14"><a href="import-and-format-data.html#cb223-14"></a>             <span class="dt">planting_date =</span> <span class="kw">unique</span>(planting_date),</span>
<span id="cb223-15"><a href="import-and-format-data.html#cb223-15"></a>             <span class="dt">emergence_date =</span> <span class="kw">unique</span>(emergence_date),</span>
<span id="cb223-16"><a href="import-and-format-data.html#cb223-16"></a>             <span class="dt">flowering_date =</span> <span class="kw">unique</span>(flowering_date),</span>
<span id="cb223-17"><a href="import-and-format-data.html#cb223-17"></a>             <span class="dt">pod_fill_date =</span> <span class="kw">unique</span>(pod_fill_date),</span>
<span id="cb223-18"><a href="import-and-format-data.html#cb223-18"></a>             <span class="dt">mid_late_pod_fill =</span> <span class="kw">unique</span>(mid_late_pod_fill),</span>
<span id="cb223-19"><a href="import-and-format-data.html#cb223-19"></a>             <span class="dt">first_sign_disease =</span> <span class="kw">unique</span>(first_sign_disease),</span>
<span id="cb223-20"><a href="import-and-format-data.html#cb223-20"></a>             <span class="dt">fungicide_application_1 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">1</span>),</span>
<span id="cb223-21"><a href="import-and-format-data.html#cb223-21"></a>             <span class="dt">fungicide_application_2 =</span> <span class="kw">unique</span>(fungicide_application_<span class="dv">2</span>),</span>
<span id="cb223-22"><a href="import-and-format-data.html#cb223-22"></a>             <span class="dt">total_fungicide =</span> <span class="kw">unique</span>(total_fungicide),</span>
<span id="cb223-23"><a href="import-and-format-data.html#cb223-23"></a>             <span class="dt">fungicide_ai =</span> <span class="kw">unique</span>(fungicide_ai),</span>
<span id="cb223-24"><a href="import-and-format-data.html#cb223-24"></a>             <span class="dt">harvest_date =</span> <span class="kw">unique</span>(harvest_date),</span>
<span id="cb223-25"><a href="import-and-format-data.html#cb223-25"></a>             <span class="dt">final_assessment =</span> <span class="kw">unique</span>(final_assessment),</span>
<span id="cb223-26"><a href="import-and-format-data.html#cb223-26"></a>             <span class="dt">PM_final_severity =</span> <span class="kw">mean</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb223-27"><a href="import-and-format-data.html#cb223-27"></a>             <span class="dt">rating_scale =</span> <span class="kw">unique</span>(rating_scale),</span>
<span id="cb223-28"><a href="import-and-format-data.html#cb223-28"></a>             <span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="co"># Producing NAs so code is repeated below</span></span>
<span id="cb223-29"><a href="import-and-format-data.html#cb223-29"></a>             <span class="dt">D_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb223-30"><a href="import-and-format-data.html#cb223-30"></a>             <span class="dt">grain_yield.t.ha. =</span> <span class="kw">mean</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb223-31"><a href="import-and-format-data.html#cb223-31"></a>             <span class="dt">raw_graded =</span> <span class="ot">NA</span>,</span>
<span id="cb223-32"><a href="import-and-format-data.html#cb223-32"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb223-33"><a href="import-and-format-data.html#cb223-33"></a>             <span class="dt">Y_error_type =</span> <span class="st">&quot;stdev&quot;</span>,</span>
<span id="cb223-34"><a href="import-and-format-data.html#cb223-34"></a>             <span class="dt">AUDPC_m =</span> <span class="kw">mean</span>(AUDPC),</span>
<span id="cb223-35"><a href="import-and-format-data.html#cb223-35"></a>             <span class="dt">AUDPC_sd =</span> <span class="kw">sd</span>(AUDPC),</span>
<span id="cb223-36"><a href="import-and-format-data.html#cb223-36"></a>             <span class="dt">AUDPS_m =</span> <span class="kw">mean</span>(AUDPS),</span>
<span id="cb223-37"><a href="import-and-format-data.html#cb223-37"></a>             <span class="dt">AUDPS_sd =</span> <span class="kw">sd</span>(AUDPS),</span>
<span id="cb223-38"><a href="import-and-format-data.html#cb223-38"></a>             <span class="dt">Y_Msquare =</span> <span class="kw">unique</span>(Y_Msquare),</span>
<span id="cb223-39"><a href="import-and-format-data.html#cb223-39"></a>             <span class="dt">Inc_Ms =</span> <span class="kw">unique</span>(Inc_Ms)</span>
<span id="cb223-40"><a href="import-and-format-data.html#cb223-40"></a>   )</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;trial_ref&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="import-and-format-data.html#cb225-1"></a><span class="co"># For some weird reason standard deviations are comming back NA in the code above</span></span>
<span id="cb225-2"><a href="import-and-format-data.html#cb225-2"></a>Herm_<span class="dv">19</span>_m[,<span class="kw">c</span>(<span class="st">&quot;trial_ref&quot;</span>,<span class="st">&quot;disease_error&quot;</span>,<span class="st">&quot;yield_error&quot;</span>)] &lt;-</span>
<span id="cb225-3"><a href="import-and-format-data.html#cb225-3"></a><span class="st">   </span>Herm_<span class="dv">19</span>_dat <span class="op">%&gt;%</span></span>
<span id="cb225-4"><a href="import-and-format-data.html#cb225-4"></a><span class="st">   </span><span class="kw">group_by</span>(trial_ref, n_treatment) <span class="op">%&gt;%</span></span>
<span id="cb225-5"><a href="import-and-format-data.html#cb225-5"></a><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">disease_error =</span> <span class="kw">sd</span>(PM_final_severity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb225-6"><a href="import-and-format-data.html#cb225-6"></a>             <span class="dt">yield_error =</span> <span class="kw">sd</span>(grain_yield.t.ha., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb225-7"><a href="import-and-format-data.html#cb225-7"></a><span class="st">   </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&quot;disease_error&quot;</span>,<span class="st">&quot;yield_error&quot;</span>))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;trial_ref&#39; (override with `.groups` argument)</code></pre>
<pre><code>## Adding missing grouping variables: `trial_ref`</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="import-and-format-data.html#cb228-1"></a>Herm_<span class="dv">19</span>_m &lt;-<span class="st"> </span><span class="kw">fold_data</span>(Herm_<span class="dv">19</span>_m, PM_MB_means)</span>
<span id="cb228-2"><a href="import-and-format-data.html#cb228-2"></a></span>
<span id="cb228-3"><a href="import-and-format-data.html#cb228-3"></a><span class="co"># insert new calculations into data</span></span>
<span id="cb228-4"><a href="import-and-format-data.html#cb228-4"></a>PM_MB_means &lt;-<span class="st"> </span><span class="kw">replace_data</span>(<span class="dt">template_data =</span> PM_MB_means, </span>
<span id="cb228-5"><a href="import-and-format-data.html#cb228-5"></a>                            <span class="dt">new_data =</span> Herm_<span class="dv">19</span>_m, </span>
<span id="cb228-6"><a href="import-and-format-data.html#cb228-6"></a>                            <span class="dt">new_data_column =</span> <span class="kw">c</span>(<span class="st">&quot;AUDPC_m&quot;</span>, <span class="st">&quot;AUDPC_sd&quot;</span>, <span class="st">&quot;AUDPS_m&quot;</span>,<span class="st">&quot;AUDPS_sd&quot;</span>,<span class="st">&quot;Y_Msquare&quot;</span>, <span class="st">&quot;Inc_Ms&quot;</span>),</span>
<span id="cb228-7"><a href="import-and-format-data.html#cb228-7"></a>                            <span class="dt">filter_cols =</span> <span class="kw">c</span>(<span class="st">&quot;trial_ref&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;location&quot;</span>, <span class="st">&quot;host_genotype&quot;</span>, </span>
<span id="cb228-8"><a href="import-and-format-data.html#cb228-8"></a>                                           <span class="st">&quot;fungicide_ai&quot;</span>, <span class="st">&quot;dose_ai.ha&quot;</span>,<span class="st">&quot;n_treatment&quot;</span>))</span></code></pre></div>
<pre><code>## 
## Row number/s from template data replaced: c(350)
## total replacements = 1/8</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="import-and-format-data.html#cb230-1"></a><span class="kw">write.csv</span>(</span>
<span id="cb230-2"><a href="import-and-format-data.html#cb230-2"></a>   Herm_<span class="dv">19</span>_m,</span>
<span id="cb230-3"><a href="import-and-format-data.html#cb230-3"></a>   <span class="kw">here</span>(<span class="st">&quot;cache/Hermitage_19_mean.csv&quot;</span>),</span>
<span id="cb230-4"><a href="import-and-format-data.html#cb230-4"></a>   <span class="dt">row.names =</span> <span class="ot">FALSE</span></span>
<span id="cb230-5"><a href="import-and-format-data.html#cb230-5"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="import-and-format-data.html#cb231-1"></a><span class="kw">write.csv</span>(PM_MB_means, <span class="dt">file =</span> <span class="kw">here</span>(<span class="st">&quot;cache/PM_MB_updated.csv&quot;</span>), <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</span></code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="studies-considered-in-meta-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="preliminary-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
